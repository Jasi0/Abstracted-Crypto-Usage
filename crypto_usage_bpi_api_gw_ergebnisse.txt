./pmd/custom-pmd-ruleset.xml-6-         xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd">
./pmd/custom-pmd-ruleset.xml-7-
./pmd/custom-pmd-ruleset.xml:8:    <description>
./pmd/custom-pmd-ruleset.xml-9-        Modifications of the default ruleset
./pmd/custom-pmd-ruleset.xml:10:    </description>
./pmd/custom-pmd-ruleset.xml-11-
./pmd/custom-pmd-ruleset.xml-12-    <rule ref="category/java/bestpractices.xml">
--
./pmd/custom-pmd-ruleset.xml-16-    <rule ref="category/java/bestpractices.xml/LooseCoupling">
./pmd/custom-pmd-ruleset.xml-17-        <properties>
./pmd/custom-pmd-ruleset.xml:18:            <property name="allowedTypes" value="org.springframework.http.HttpHeaders" />
./pmd/custom-pmd-ruleset.xml-19-        </properties>
./pmd/custom-pmd-ruleset.xml-20-    </rule>
--
./tmp/consumer.crt-8-CxMGQ2FuYXJ5MS0wKwYDVQQLEyQ4ZTFhZmZiMi02MmExLTQzY2MtYTY4Ny0yYmE3
./tmp/consumer.crt-9-NWU0YjNkODQxKzApBgNVBAcTImFtdGd4a2J3MC5hY2NvdW50czQwMC5vbmRlbWFu
./tmp/consumer.crt:10:ZC5jb20xLzAtBgNVBAMTJmIvZDhkNDAwNzEtNzk1MS00YjE1LWI0NjYtNjk3YTMx
./tmp/consumer.crt-11-ZGM5YzhjMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAutxVAvFZI/E9
./tmp/consumer.crt-12-4NFhKBrS0zfqYxGryTPkxfqhQgigN/vEEp/1+SU5SaRiGA/93XhF4y4cTJlGNBQn
--
./tmp/consumer.crt-22-Y3JsL2Y4YWJlNTRlLTE5NTEtNDcwZS1hZTJkLWRlNDBjMTYzMzQxYy5jcmwwDQYJ
./tmp/consumer.crt-23-KoZIhvcNAQELBQADggIBAE+I4HDsn6gowka2Me7EPmfbJfSln2a9y6wF28lzT99W
./tmp/consumer.crt:24:tLsaG+TZXymAFjLsCDJfBYO/v6GDcbIYsbaJbExTU1BGur9vPemMKuTlKqslAC71
./tmp/consumer.crt-25-TqRW1iPSX29/3ks43reUn8TYaYajC4I2APp1a+01AGl3MUHsS0fw0pThRpaUCL0S
./tmp/consumer.crt-26-ZVfTx5T1lohrvYXPBdShK3mNoBi2iHwXcj7bADi3AN650AKIXeNdo2lZ6+wxA6kx
--
./tmp/consumer.crt-28-UMcM4jFFV0u1V/37Hn3LyiToTlRCEvHPsQB9ITW4fnTr8/B5tiMX2QgeyL3yZVZ2
./tmp/consumer.crt-29-UtGUOkhfzLkL4yiLpJHHlJviYek3gq1XsDTI8ITpwcei7hUZH2gdHG4VaGMtdMlG
./tmp/consumer.crt:30:IOlxIueK0z2DwJEEwrqns5d8HmBhB9HORzdlo6g8fsE67Uiv4zEhODZyeyiUDCYV
./tmp/consumer.crt-31-Cp2ujlb4nBxAuVCzoiyJdc6Tt5M9YfK4KZZtdzZu2HeQfj5CfrMh2dHk/yPmSa//
./tmp/consumer.crt-32-wGT1DYoIBHvUO1rnMMtGMGRxvxeLmnw/Wff90QGKITP7O3XZq0Bg2xlLxKC5nnXU
--
./tmp/consumer.crt-35------BEGIN CERTIFICATE-----
./tmp/consumer.crt-36-MIIGaDCCBFCgAwIBAgITcAAAAAWaX7qDX+136AAAAAAABTANBgkqhkiG9w0BAQsF
./tmp/consumer.crt:37:ADBNMQswCQYDVQQGEwJERTERMA8GA1UEBwwIV2FsbGRvcmYxDzANBgNVBAoMBlNB
./tmp/consumer.crt-38-UCBTRTEaMBgGA1UEAwwRU0FQIENsb3VkIFJvb3QgQ0EwHhcNMjAwNjIzMDg0NzI4
./tmp/consumer.crt-39-WhcNMzAwNjIzMDg1NzI4WjCBgDELMAkGA1UEBhMCREUxFDASBgNVBAcMC0VVMTAt
--
./tmp/consumer.crt-46-5/SBXpFlAw7MVYPd+FT3mv3xHzPu/+PqY/lTIQgPokXVNV6kp0H29fu45N1s4WIo
./tmp/consumer.crt-47-G9U6EBWdS2aA9W1BefRwkjB3t/OJ6lQkBrSzhkGcYL51UKKpHY1nXaLSH9lA2sjj
./tmp/consumer.crt:48:sQxzdggarsk0wBP8fPnlFEHTSLb//b++dZVeQm5MBsITl2uGLvAjI2vtLsFQx+R2
./tmp/consumer.crt-49-AdPyJasCuIAtVla/+A41Vt09h4jSv2d3KgrYG6KQt1FI+SFElu7swN0lF3rQku8v
./tmp/consumer.crt-50-nmhB9s+J/3EgUlNmGnirfj4MflplaHJpkSenl/B9QHmIl58IKpvwtdEwZ7AQmb03
--
./tmp/consumer.crt-65-qsHiAE3OygknSn2k97ooFGHTsyVt0AInhgVIk38Wip6F275JwX2xYMyyu0YiQEPT
./tmp/consumer.crt-66-5HdAoWcBIl4v6wZz1hWlF4FDD7zDns11ZCeLdCHss9NV8WJ6ClYNSQArtbIoYD1Y
./tmp/consumer.crt:67:9RzJr9LIlRPK82fM9b6peKQ2XUrTkMLFkIiI1HpT+Nt3JgtY/uDkXIV9nlXckDj6
./tmp/consumer.crt-68-u9msfW8J9HU+cBQKAjfl1BoyLijQaXGoSvirJQSwh1Q9zLuH25uCkxhejZ8cDJrq
./tmp/consumer.crt-69-p55i444meVi6Xf66WaHPWyJunQpN/zb14ZpMNB6PFp94gYSxPVyMhVWyCGK5C8mZ
--
./tmp/consumer.key:1:-----BEGIN RSA PRIVATE KEY-----
./tmp/consumer.key-2-MIIEpAIBAAKCAQEAutxVAvFZI/E94NFhKBrS0zfqYxGryTPkxfqhQgigN/vEEp/1
./tmp/consumer.key-3-+SU5SaRiGA/93XhF4y4cTJlGNBQn2rxLtAtey9qmQjdZxsXeb1leDpWKpMDbbM14
--
./tmp/consumer.key-9-fYQnL2yoraGJBPkjPsdVjpNYyjuOjuQuNY6wOoM+9X4w0XuvmybEA5RKCDovtLC0
./tmp/consumer.key-10-RXMU++zFC9gbl6rKJQdNg/h9JIRrYXKFSp4lh+rmBeoXpb1GQp0Xj9mOQclRgfCe
./tmp/consumer.key:11:U6wcDMJmZZp857WL2yhvr9vlO2yAESApomACaoTAeLLoh8pjppbIMBuCmVOLHHD6
./tmp/consumer.key-12-qmk5ZxTUnm48tQIGesNV4S21bmIq7YIF50u703Q7qo184ysk/4p35ji9YXVX5AXf
./tmp/consumer.key-13-p7qFPw+5AoGBAOFzq5dkoiyus0LeApJi+KbeU868VyXZtqIjNkHeShCroPXXqHNL
--
./tmp/consumer.key-25-8NnR2kA5ot95RAPtp49bIfXlr3R50U8YfTOjVCJ8FvO+56zMSghcixTEQSb716ZZ
./tmp/consumer.key-26-UyeBynRaNCsJB8o7gQoEj/t+u8WBF5xdjag7RIYEtlXZrXprJZ9AAg==
./tmp/consumer.key:27:-----END RSA PRIVATE KEY-----
--
./mvnw-60-  Darwin*) darwin=true
./mvnw-61-    # Use /usr/libexec/java_home if available, otherwise fall back to /Library/Java/Home
./mvnw:62:    # See https://developer.apple.com/library/mac/qa/qa1170/_index.html
./mvnw-63-    if [ -z "$JAVA_HOME" ]; then
./mvnw-64-      if [ -x "/usr/libexec/java_home" ]; then
--
./mvnw-81-  PRG="$0"
./mvnw-82-
./mvnw:83:  # need this for relative symlinks
./mvnw-84-  while [ -h "$PRG" ] ; do
./mvnw-85-    ls=`ls -ld "$PRG"`
--
./mvnw-221-      jarUrl="https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
./mvnw-222-    fi
./mvnw:223:    while IFS="=" read key value; do
./mvnw:224:      case "$key" in (wrapperUrl) jarUrl="$value"; break ;;
./mvnw-225-      esac
./mvnw-226-    done < "$BASE_DIR/.mvn/wrapper/maven-wrapper.properties"
--
./circleci.settings.xml-13-        </server>
./circleci.settings.xml-14-        <server>
./circleci.settings.xml:15:            <id>signavio-releases</id>
./circleci.settings.xml-16-            <username>${env.SAP_ARTIFACTORY_USER}</username>
./circleci.settings.xml-17-            <password>${env.SAP_ARTIFACTORY_TOKEN}</password>
./circleci.settings.xml-18-        </server>
./circleci.settings.xml-19-        <server>
./circleci.settings.xml:20:            <id>signavio-snapshots</id>
./circleci.settings.xml-21-            <username>${env.SAP_ARTIFACTORY_USER}</username>
./circleci.settings.xml-22-            <password>${env.SAP_ARTIFACTORY_TOKEN}</password>
--
./circleci.settings.xml-41-                </repository>
./circleci.settings.xml-42-                <repository>
./circleci.settings.xml:43:                    <id>signavio-releases</id>
./circleci.settings.xml:44:                    <url>https://common.repositories.cloud.sap/artifactory/signavio-libs-release</url>
./circleci.settings.xml-45-                </repository>
./circleci.settings.xml-46-                <repository>
./circleci.settings.xml:47:                    <id>signavio-snapshots</id>
./circleci.settings.xml:48:                    <url>https://common.repositories.cloud.sap/artifactory/signavio-libs-snapshot</url>
./circleci.settings.xml-49-                </repository>
./circleci.settings.xml-50-                <repository>
./circleci.settings.xml:51:                    <id>signavio-releases</id>
./circleci.settings.xml-52-                    <name>libs-release-local</name>
./circleci.settings.xml:53:                    <url>https://common.repositories.cloud.sap/artifactory/signavio-libs-release-local</url>
./circleci.settings.xml-54-                </repository>
./circleci.settings.xml-55-            </repositories>
--
./circleci.settings.xml-70-                </pluginRepository>
./circleci.settings.xml-71-                <pluginRepository>
./circleci.settings.xml:72:                    <id>signavio-releases</id>
./circleci.settings.xml:73:                    <url>https://common.repositories.cloud.sap/artifactory/signavio-libs-release</url>
./circleci.settings.xml-74-                </pluginRepository>
./circleci.settings.xml-75-                <pluginRepository>
./circleci.settings.xml:76:                    <id>signavio-snapshots</id>
./circleci.settings.xml:77:                    <url>https://common.repositories.cloud.sap/artifactory/signavio-libs-snapshot</url>
./circleci.settings.xml-78-                </pluginRepository>
./circleci.settings.xml-79-            </pluginRepositories>
--
./circleci.settings.xml-81-        </profile>
./circleci.settings.xml-82-    </profiles>
./circleci.settings.xml:83:    <activeProfiles>
./circleci.settings.xml:84:        <activeProfile>artifactory</activeProfile>
./circleci.settings.xml:85:    </activeProfiles>
./circleci.settings.xml-86-</settings>
--
./README.md:1:# Base Repo for SAP Signavio API Gateway
./README.md-2-
./README.md-3-# Documenation
./README.md:4:[GitHub Pages](https://pages.github.tools.sap/SAP-Signavio-API-Gateway/signavio-api-gw/)
./README.md-5-
./README.md-6-[GitHub Pages DEPRECATED!](https://furry-winner-dc6c85c6.pages.github.io/)
--
./trivy-junit-report.tpl-11-        {{ range .Vulnerabilities }}
./trivy-junit-report.tpl-12-        <testcase classname="{{ .PkgName }}-{{ .InstalledVersion }}" name="[{{ .Vulnerability.Severity }}] {{ .VulnerabilityID }}" time="">
./trivy-junit-report.tpl:13:            <failure message={{escapeXML .Title | printf "%q" }} type="description">{{escapeXML .Description | printf "%q" }}</failure>
./trivy-junit-report.tpl-14-        </testcase>
./trivy-junit-report.tpl-15-    {{- end }}
--
./renovate.json-3-  "branchPrefix": "renovate-",
./renovate.json-4-  "extends": [
./renovate.json:5:    "github>signavio/cdk-renovate-config:default"
./renovate.json-6-  ],
./renovate.json-7-  "packageRules": [
--
./renovate.json-12-    },
./renovate.json-13-    {
./renovate.json:14:      "groupName": "SGS Spring Boot and Spring Cloud",
./renovate.json-15-      "matchPackageNames": [
./renovate.json:16:        "org.springframework.cloud:spring-cloud-dependencies",
./renovate.json:17:        "com.sap.sgs:security-patched-spring-boot-starter"
./renovate.json-18-      ],
./renovate.json-19-      "separateMajorMinor": false
--
./renovate.json-30-      "matchDatasources": ["maven"],
./renovate.json-31-      "registryUrls": [
./renovate.json:32:        "https://common.repositories.cloud.sap/artifactory/signavio-maven-central",
./renovate.json:33:        "https://common.repositories.cloud.sap/artifactory/signavio-libs-release",
./renovate.json:34:        "https://common.repositories.cloud.sap/artifactory/signavio-libs-snapshot",
./renovate.json-35-        "https://common.repositories.cloud.sap/artifactory/deploy.releases"
./renovate.json-36-      ]
--
./pom.xml-5-	<parent>
./pom.xml-6-		<groupId>com.sap.sgs</groupId>
./pom.xml:7:		<artifactId>security-patched-spring-boot-starter</artifactId>
./pom.xml-8-		<version>3.5.7-sap-03</version>
./pom.xml:9:		<relativePath/>
./pom.xml-10-	</parent>
./pom.xml-11-
--
./pom.xml-18-		<spotless.version>2.44.5</spotless.version>
./pom.xml-19-		<maven-surefire.version>3.5.3</maven-surefire.version>
./pom.xml:20:		<spring.framework.version>6.2.12</spring.framework.version>
./pom.xml:21:		<spring.framework.security.version>6.5.5</spring.framework.security.version>
./pom.xml-22-		<jsonwebtoken.version>0.12.6</jsonwebtoken.version>
./pom.xml-23-		<logback.version>1.5.19</logback.version>
--
./pom.xml-44-			</dependency>
./pom.xml-45-			<dependency>
./pom.xml:46:				<groupId>org.springframework.cloud</groupId>
./pom.xml:47:				<artifactId>spring-cloud-gateway-server-webflux</artifactId>
./pom.xml-48-				<version>4.3.2</version>
./pom.xml-49-				<exclusions>
--
./pom.xml-55-			</dependency>
./pom.xml-56-			<dependency>
./pom.xml:57:				<groupId>org.springframework.boot</groupId>
./pom.xml:58:				<artifactId>spring-boot-starter-webflux</artifactId>
./pom.xml-59-				<version>3.5.7</version>
./pom.xml-60-				<exclusions>
./pom.xml-61-					<exclusion>
./pom.xml:62:						<groupId>org.springframework</groupId>
./pom.xml:63:						<artifactId>spring-webflux</artifactId>
./pom.xml-64-					</exclusion>
./pom.xml-65-					<exclusion>
./pom.xml:66:						<groupId>org.springframework</groupId>
./pom.xml:67:						<artifactId>spring-web</artifactId>
./pom.xml-68-					</exclusion>
./pom.xml-69-					<exclusion>
./pom.xml:70:						<groupId>org.springframework.boot</groupId>
./pom.xml:71:						<artifactId>spring-boot-starter</artifactId>
./pom.xml-72-					</exclusion>
./pom.xml-73-				</exclusions>
./pom.xml-74-			</dependency>
./pom.xml-75-			<dependency>
./pom.xml:76:				<groupId>org.springframework</groupId>
./pom.xml:77:				<artifactId>spring-webflux</artifactId>
./pom.xml:78:				<version>${spring.framework.version}</version>
./pom.xml-79-			</dependency>
./pom.xml-80-			<dependency>
./pom.xml:81:				<groupId>org.springframework.cloud</groupId>
./pom.xml:82:				<artifactId>spring-cloud-starter-config</artifactId>
./pom.xml-83-				<version>4.3.0</version>
./pom.xml-84-			</dependency>
./pom.xml-85-			<dependency>
./pom.xml:86:				<groupId>org.springframework.security</groupId>
./pom.xml:87:				<artifactId>spring-security-rsa</artifactId>
./pom.xml-88-				<version>1.1.5</version>
./pom.xml-89-				<exclusions>
./pom.xml-90-					<exclusion>
./pom.xml:91:						<groupId>org.bouncycastle</groupId>
./pom.xml-92-						<artifactId>bcprov-jdk18on</artifactId>
./pom.xml-93-					</exclusion>
--
./pom.xml-100-			</dependency>
./pom.xml-101-			<dependency>
./pom.xml:102:				<groupId>org.springframework</groupId>
./pom.xml:103:				<artifactId>spring-beans</artifactId>
./pom.xml:104:				<version>${spring.framework.version}</version>
./pom.xml-105-			</dependency>
./pom.xml-106-			<dependency>
./pom.xml:107:				<groupId>org.springframework</groupId>
./pom.xml:108:				<artifactId>spring-web</artifactId>
./pom.xml:109:				<version>${spring.framework.version}</version>
./pom.xml-110-			</dependency>
./pom.xml-111-			<dependency>
./pom.xml:112:				<groupId>org.springframework</groupId>
./pom.xml:113:				<artifactId>spring-jcl</artifactId>
./pom.xml:114:				<version>${spring.framework.version}</version>
./pom.xml-115-			</dependency>
./pom.xml-116-			<dependency>
./pom.xml:117:				<groupId>org.springframework</groupId>
./pom.xml:118:				<artifactId>spring-context</artifactId>
./pom.xml:119:				<version>${spring.framework.version}</version>
./pom.xml-120-			</dependency>
./pom.xml-121-			<dependency>
./pom.xml:122:				<groupId>org.springframework.cloud</groupId>
./pom.xml:123:				<artifactId>spring-cloud-starter-circuitbreaker-reactor-resilience4j</artifactId>
./pom.xml-124-				<version>3.3.0</version>
./pom.xml-125-			</dependency>
./pom.xml-126-			<dependency>
./pom.xml:127:				<groupId>org.springframework.cloud</groupId>
./pom.xml:128:				<artifactId>spring-cloud-contract-wiremock</artifactId>
./pom.xml-129-				<version>4.3.0</version>
./pom.xml-130-			</dependency>
./pom.xml-131-			<dependency>
./pom.xml:132:				<groupId>org.springframework.boot</groupId>
./pom.xml:133:				<artifactId>spring-boot-starter-test</artifactId>
./pom.xml-134-				<exclusions>
./pom.xml-135-					<exclusion>
./pom.xml:136:						<groupId>org.springframework.boot</groupId>
./pom.xml:137:						<artifactId>spring-boot-starter</artifactId>
./pom.xml-138-					</exclusion>
./pom.xml-139-					<exclusion>
./pom.xml:140:						<groupId>org.springframework</groupId>
./pom.xml:141:						<artifactId>spring-test</artifactId>
./pom.xml-142-					</exclusion>
./pom.xml-143-					<exclusion>
./pom.xml:144:						<groupId>org.springframework</groupId>
./pom.xml:145:						<artifactId>spring-core</artifactId>
./pom.xml-146-					</exclusion>
./pom.xml-147-					<exclusion>
--
./pom.xml-154-			</dependency>
./pom.xml-155-			<dependency>
./pom.xml:156:				<groupId>org.springframework</groupId>
./pom.xml:157:				<artifactId>spring-test</artifactId>
./pom.xml:158:				<version>${spring.framework.version}</version>
./pom.xml-159-				<scope>test</scope>
./pom.xml-160-			</dependency>
./pom.xml-161-			<dependency>
./pom.xml:162:				<groupId>org.springframework</groupId>
./pom.xml:163:				<artifactId>spring-core</artifactId>
./pom.xml:164:				<version>${spring.framework.version}</version>
./pom.xml-165-			</dependency>
./pom.xml-166-			<dependency>
./pom.xml:167:				<groupId>org.springframework</groupId>
./pom.xml:168:				<artifactId>spring-expression</artifactId>
./pom.xml:169:				<version>${spring.framework.version}</version>
./pom.xml-170-			</dependency>
./pom.xml-171-			<dependency>
./pom.xml:172:				<groupId>org.springframework.boot</groupId>
./pom.xml:173:				<artifactId>spring-boot-starter-actuator</artifactId>
./pom.xml-174-				<version>3.5.0</version>
./pom.xml-175-			</dependency>
--
./pom.xml-186-			</dependency>
./pom.xml-187-			<dependency>
./pom.xml:188:				<groupId>org.springframework.boot</groupId>
./pom.xml:189:				<artifactId>spring-boot-starter-security</artifactId>
./pom.xml-190-				<exclusions>
./pom.xml-191-					<exclusion>
./pom.xml:192:						<groupId>org.springframework.boot</groupId>
./pom.xml:193:						<artifactId>spring-boot-starter</artifactId>
./pom.xml-194-					</exclusion>
./pom.xml-195-					<exclusion>
./pom.xml:196:						<groupId>org.springframework</groupId>
./pom.xml:197:						<artifactId>spring-aop</artifactId>
./pom.xml-198-					</exclusion>
./pom.xml-199-					<exclusion>
./pom.xml:200:						<groupId>org.springframework.boot</groupId>
./pom.xml:201:						<artifactId>spring-security-config</artifactId>
./pom.xml-202-					</exclusion>
./pom.xml-203-					<exclusion>
./pom.xml:204:						<groupId>org.springframework.boot</groupId>
./pom.xml:205:						<artifactId>spring-security-crypto</artifactId>
./pom.xml-206-					</exclusion>
./pom.xml-207-					<exclusion>
./pom.xml:208:						<groupId>org.springframework.boot</groupId>
./pom.xml:209:						<artifactId>spring-security-core</artifactId>
./pom.xml-210-					</exclusion>
./pom.xml-211-					<exclusion>
./pom.xml:212:						<groupId>org.springframework.boot</groupId>
./pom.xml:213:						<artifactId>spring-security-web</artifactId>
./pom.xml-214-					</exclusion>
./pom.xml-215-				</exclusions>
--
./pom.xml-217-			</dependency>
./pom.xml-218-			<dependency>
./pom.xml:219:				<groupId>org.springframework.security</groupId>
./pom.xml:220:				<artifactId>spring-security-config</artifactId>
./pom.xml:221:				<version>${spring.framework.security.version}</version>
./pom.xml-222-			</dependency>
./pom.xml-223-			<dependency>
./pom.xml:224:				<groupId>org.springframework.security</groupId>
./pom.xml:225:				<artifactId>spring-security-web</artifactId>
./pom.xml:226:				<version>${spring.framework.security.version}</version>
./pom.xml-227-			</dependency>
./pom.xml-228-			<dependency>
./pom.xml:229:				<groupId>org.springframework.security</groupId>
./pom.xml:230:				<artifactId>spring-security-crypto</artifactId>
./pom.xml:231:				<version>${spring.framework.security.version}</version>
./pom.xml-232-			</dependency>
./pom.xml-233-			<dependency>
./pom.xml:234:				<groupId>org.springframework.security</groupId>
./pom.xml:235:				<artifactId>spring-security-core</artifactId>
./pom.xml:236:				<version>${spring.framework.security.version}</version>
./pom.xml-237-			</dependency>
./pom.xml-238-			<dependency>
--
./pom.xml-253-				<version>1.11.0</version>
./pom.xml-254-			</dependency>
./pom.xml:255:			<!-- Override transitive mozilla:rhino from rest-assured:json-schema-validator for security -->
./pom.xml-256-			<dependency>
./pom.xml-257-				<groupId>org.mozilla</groupId>
--
./pom.xml-342-			<dependency>
./pom.xml-343-				<groupId>io.jsonwebtoken</groupId>
./pom.xml:344:				<artifactId>jjwt-api</artifactId>
./pom.xml-345-				<version>${jsonwebtoken.version}</version>
./pom.xml-346-			</dependency>
--
./pom.xml-348-			<dependency>
./pom.xml-349-				<groupId>io.jsonwebtoken</groupId>
./pom.xml:350:				<artifactId>jjwt-impl</artifactId>
./pom.xml-351-				<version>${jsonwebtoken.version}</version>
./pom.xml-352-				<scope>runtime</scope>
--
./pom.xml-355-			<dependency>
./pom.xml-356-				<groupId>io.jsonwebtoken</groupId>
./pom.xml:357:				<artifactId>jjwt-jackson</artifactId> <!-- or jjwt-gson if Gson is preferred -->
./pom.xml-358-				<version>${jsonwebtoken.version}</version>
./pom.xml-359-				<scope>runtime</scope>
--
./pom.xml-361-			<dependency>
./pom.xml-362-				<groupId>org.yaml</groupId>
./pom.xml:363:				<artifactId>snakeyaml</artifactId>
./pom.xml-364-				<version>2.4</version>
./pom.xml-365-			</dependency>
--
./pom.xml-399-					<exclusion>
./pom.xml-400-						<groupId>io.netty</groupId>
./pom.xml:401:						<artifactId>netty-transport-native-epoll</artifactId>
./pom.xml-402-					</exclusion>
./pom.xml-403-					<exclusion>
--
./pom.xml-437-
./pom.xml-438-			<dependency>
./pom.xml:439:				<groupId>org.springdoc</groupId>
./pom.xml:440:				<artifactId>springdoc-openapi-starter-webflux-ui</artifactId>
./pom.xml-441-				<version>2.8.9</version>
./pom.xml-442-			</dependency>
--
./pom.xml-480-			<!--	BDSA-2022-3337 + BDSA-2023-3254 -->
./pom.xml-481-			<dependency>
./pom.xml:482:				<groupId>org.bouncycastle</groupId>
./pom.xml-483-				<artifactId>bcprov-jdk15to18</artifactId>
./pom.xml-484-				<version>1.80</version>
--
./pom.xml-498-			</dependency>
./pom.xml-499-			<dependency>
./pom.xml:500:				<groupId>com.signavio</groupId>
./pom.xml-501-				<artifactId>authentication</artifactId>
./pom.xml-502-				<version>1.23.1</version>
./pom.xml-503-			</dependency>
./pom.xml-504-			<dependency>
./pom.xml:505:				<groupId>com.signavio.pam.shared</groupId>
./pom.xml-506-				<artifactId>als-logging</artifactId>
./pom.xml-507-				<version>2.2158</version>
--
./pom.xml-513-			</dependency>
./pom.xml-514-			<dependency>
./pom.xml:515:				<groupId>org.springframework.data</groupId>
./pom.xml:516:				<artifactId>spring-data-redis</artifactId>
./pom.xml-517-				<version>3.5.0</version>
./pom.xml-518-				<exclusions>
./pom.xml-519-					<exclusion>
./pom.xml:520:						<groupId>org.springframework</groupId>
./pom.xml:521:						<artifactId>spring-tx</artifactId>
./pom.xml-522-					</exclusion>
./pom.xml-523-					<exclusion>
./pom.xml:524:						<groupId>org.springframework</groupId>
./pom.xml:525:						<artifactId>spring-oxm</artifactId>
./pom.xml-526-					</exclusion>
./pom.xml-527-					<exclusion>
./pom.xml:528:						<groupId>org.springframework</groupId>
./pom.xml:529:						<artifactId>spring-aop</artifactId>
./pom.xml-530-					</exclusion>
./pom.xml-531-					<exclusion>
./pom.xml:532:						<groupId>org.springframework</groupId>
./pom.xml:533:						<artifactId>spring-context-support</artifactId>
./pom.xml-534-					</exclusion>
./pom.xml-535-					<exclusion>
./pom.xml:536:						<groupId>org.springframework</groupId>
./pom.xml:537:						<artifactId>spring-jdbc</artifactId>
./pom.xml-538-					</exclusion>
./pom.xml-539-					<exclusion>
./pom.xml:540:						<groupId>org.springframework</groupId>
./pom.xml:541:						<artifactId>spring-core-test</artifactId>
./pom.xml-542-					</exclusion>
./pom.xml-543-				</exclusions>
./pom.xml-544-			</dependency>
./pom.xml-545-			<dependency>
./pom.xml:546:				<groupId>org.springframework</groupId>
./pom.xml:547:				<artifactId>spring-tx</artifactId>
./pom.xml:548:				<version>${spring.framework.version}</version>
./pom.xml-549-			</dependency>
./pom.xml-550-			<dependency>
./pom.xml:551:				<groupId>org.springframework</groupId>
./pom.xml:552:				<artifactId>spring-oxm</artifactId>
./pom.xml:553:				<version>${spring.framework.version}</version>
./pom.xml-554-			</dependency>
./pom.xml-555-			<dependency>
./pom.xml:556:				<groupId>org.springframework</groupId>
./pom.xml:557:				<artifactId>spring-aop</artifactId>
./pom.xml:558:				<version>${spring.framework.version}</version>
./pom.xml-559-			</dependency>
./pom.xml-560-			<dependency>
./pom.xml:561:				<groupId>org.springframework</groupId>
./pom.xml:562:				<artifactId>spring-context-support</artifactId>
./pom.xml:563:				<version>${spring.framework.version}</version>
./pom.xml-564-			</dependency>
./pom.xml-565-			<dependency>
./pom.xml:566:				<groupId>org.springframework</groupId>
./pom.xml:567:				<artifactId>spring-jdbc</artifactId>
./pom.xml:568:				<version>${spring.framework.version}</version>
./pom.xml-569-			</dependency>
./pom.xml-570-			<dependency>
./pom.xml:571:				<groupId>org.springframework</groupId>
./pom.xml:572:				<artifactId>spring-core-test</artifactId>
./pom.xml:573:				<version>${spring.framework.version}</version>
./pom.xml-574-			</dependency>
./pom.xml-575-			<dependency>
--
./pom.xml-626-				<version>${logback.version}</version>
./pom.xml-627-			</dependency>
./pom.xml:628:            <!-- Nimbus JOSE+JWT for JWE encryption -->
./pom.xml-629-            <dependency>
./pom.xml:630:                <groupId>com.nimbusds</groupId>
./pom.xml:631:                <artifactId>nimbus-jose-jwt</artifactId>
./pom.xml-632-                <version>10.7</version>
./pom.xml-633-            </dependency>
./pom.xml:634:            <!-- BouncyCastle OpenSSL for PKCS#1 private key support -->
./pom.xml-635-            <dependency>
./pom.xml:636:                <groupId>org.bouncycastle</groupId>
./pom.xml-637-                <artifactId>bcpkix-jdk15to18</artifactId>
./pom.xml-638-                <version>1.76</version>
--
./pom.xml-687-									<rule>
./pom.xml-688-										<element>CLASS</element>
./pom.xml:689:										<excludes>
./pom.xml-690-											<exclude>*Test</exclude>
./pom.xml:691:										</excludes>
./pom.xml-692-										<limits>
./pom.xml-693-											<limit>
--
./pom.xml-749-		<plugins>
./pom.xml-750-			<plugin>
./pom.xml:751:				<groupId>org.springframework.boot</groupId>
./pom.xml:752:				<artifactId>spring-boot-maven-plugin</artifactId>
./pom.xml-753-			</plugin>
./pom.xml-754-			<plugin>
--
./pom.xml-775-				<configuration>
./pom.xml-776-					<java>
./pom.xml:777:						<includes>
./pom.xml-778-							<include>**/src/main/java/**/*.java</include>
./pom.xml-779-							<include>**/src/test/java/**/*.java</include>
./pom.xml:780:						</includes>
./pom.xml:781:						<!-- apply a specific flavor of google-java-format and reflow long strings -->
./pom.xml-782-						<googleJavaFormat>
./pom.xml-783-							<version>1.19.2</version>
./pom.xml-784-							<style>GOOGLE</style>
./pom.xml:785:							<reflowLongStrings>true</reflowLongStrings>
./pom.xml-786-						</googleJavaFormat>
./pom.xml-787-					</java>
--
./pom.xml-792-				<artifactId>maven-surefire-plugin</artifactId>
./pom.xml-793-				<configuration>
./pom.xml:794:					<!-- Activate the use of TCP to transmit events to the MVN plugin. Otherwise System.setOut
./pom.xml:795:                     would write directly to native stream in forked JVM.-->
./pom.xml-796-					<forkNode implementation="org.apache.maven.plugin.surefire.extensions.SurefireForkNodeFactory"/>
./pom.xml-797-				</configuration>
--
./Dockerfile-9-#using jlink to create a custom JRE for the api-gw app
./Dockerfile-10-    jlink \
./Dockerfile:11:    --add-modules "java.base,jdk.jfr,jdk.net,jdk.unsupported,jdk.jdwp.agent,jdk.jcmd,jdk.management,jdk.management.agent,java.compiler,java.naming,java.transaction.xa,java.net.http,java.management,java.prefs,java.security.jgss,java.sql,java.desktop,java.scripting,java.instrument,java.logging,java.xml,java.datatransfer,jdk.crypto.ec" \
./Dockerfile-12-    --strip-debug \
./Dockerfile-13-    --compress 2 \
--
./Dockerfile-30-WORKDIR /
./Dockerfile-31-
./Dockerfile:32:RUN groupadd -r signavioapigw && useradd -r -g signavioapigw signavioapigw
./Dockerfile:33:# if SPRING_PROFILE is null, set it to 'dev' (or leave as is otherwise).
./Dockerfile:34:ENV SPRING_PROFILE=${SPRING_PROFILE:-dev}
./Dockerfile-35-ENV SPM_ENDPOINT=${SPM_ENDPOINT:-http://spm-platform-gateway.spm.svc.cluster.local}
./Dockerfile-36-ENV DEBUG_PARAMS=${DEBUG_PARAMS}
./Dockerfile-37-ENV JVM_OPTIONS=${JVM_OPTIONS}
./Dockerfile-38-
./Dockerfile:39:ENTRYPOINT ["sh","-c","java ${DEBUG_PARAMS} ${JVM_OPTIONS} -jar app.jar --spring.profiles.active=${SPRING_PROFILE}"]
./Dockerfile-40-
./Dockerfile:41:USER signavioapigw
./Dockerfile-42-EXPOSE 8080
--
./mock/pom.xml-19-    <dependencies>
./mock/pom.xml-20-        <dependency>
./mock/pom.xml:21:            <groupId>org.springframework.cloud</groupId>
./mock/pom.xml:22:            <artifactId>spring-cloud-gateway-server-webflux</artifactId>
./mock/pom.xml-23-        </dependency>
./mock/pom.xml-24-        <dependency>
./mock/pom.xml:25:            <groupId>org.springframework.cloud</groupId>
./mock/pom.xml:26:            <artifactId>spring-cloud-starter-circuitbreaker-reactor-resilience4j</artifactId>
./mock/pom.xml-27-        </dependency>
./mock/pom.xml-28-        <dependency>
--
./mock/pom.xml-32-        </dependency>
./mock/pom.xml-33-        <dependency>
./mock/pom.xml:34:            <groupId>org.springframework.boot</groupId>
./mock/pom.xml:35:            <artifactId>spring-boot-starter-test</artifactId>
./mock/pom.xml-36-        </dependency>
./mock/pom.xml-37-        <dependency>
./mock/pom.xml:38:            <groupId>org.springframework</groupId>
./mock/pom.xml:39:            <artifactId>spring-test</artifactId>
./mock/pom.xml-40-            <scope>test</scope>
./mock/pom.xml-41-        </dependency>
./mock/pom.xml-42-        <dependency>
./mock/pom.xml:43:            <groupId>org.springframework</groupId>
./mock/pom.xml:44:            <artifactId>spring-core</artifactId>
./mock/pom.xml-45-        </dependency>
./mock/pom.xml-46-        <dependency>
--
./mock/pom.xml-49-        </dependency>
./mock/pom.xml-50-        <dependency>
./mock/pom.xml:51:            <groupId>org.springframework.boot</groupId>
./mock/pom.xml:52:            <artifactId>spring-boot-autoconfigure</artifactId>
./mock/pom.xml-53-        </dependency>
./mock/pom.xml-54-        <dependency>
./mock/pom.xml:55:            <groupId>org.springframework.boot</groupId>
./mock/pom.xml:56:            <artifactId>spring-boot-starter-webflux</artifactId>
./mock/pom.xml-57-        </dependency>
./mock/pom.xml-58-        <dependency>
./mock/pom.xml:59:            <groupId>org.springframework</groupId>
./mock/pom.xml:60:            <artifactId>spring-webflux</artifactId>
./mock/pom.xml-61-        </dependency>
./mock/pom.xml-62-        <dependency>
./mock/pom.xml:63:            <groupId>org.springframework</groupId>
./mock/pom.xml:64:            <artifactId>spring-web</artifactId>
./mock/pom.xml-65-        </dependency>
./mock/pom.xml-66-        <dependency>
--
./mvnw.cmd-27-@REM M2_HOME - location of maven2's installed home dir
./mvnw.cmd-28-@REM MAVEN_BATCH_ECHO - set to 'on' to enable the echoing of the batch commands
./mvnw.cmd:29:@REM MAVEN_BATCH_PAUSE - set to 'on' to wait for a keystroke before ending
./mvnw.cmd-30-@REM MAVEN_OPTS - parameters passed to the Java VM when running Maven
./mvnw.cmd-31-@REM     e.g. to debug Maven itself, use
--
./mvnw.cmd-41-@if "%MAVEN_BATCH_ECHO%" == "on"  echo %MAVEN_BATCH_ECHO%
./mvnw.cmd-42-
./mvnw.cmd:43:@REM set %HOME% to equivalent of $HOME
./mvnw.cmd:44:if "%HOME%" == "" (set "HOME=%HOMEDRIVE%%HOMEPATH%")
./mvnw.cmd-45-
./mvnw.cmd-46-@REM Execute a user defined script before this one
--
./mvnw.cmd-144-    powershell -Command "&{"^
./mvnw.cmd-145-		"$webclient = new-object System.Net.WebClient;"^
./mvnw.cmd:146:		"if (-not ([string]::IsNullOrEmpty('%MVNW_USERNAME%') -and [string]::IsNullOrEmpty('%MVNW_PASSWORD%'))) {"^
./mvnw.cmd-147-		"$webclient.Credentials = new-object System.Net.NetworkCredential('%MVNW_USERNAME%', '%MVNW_PASSWORD%');"^
./mvnw.cmd-148-		"}"^
./mvnw.cmd:149:		"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $webclient.DownloadFile('%DOWNLOAD_URL%', '%WRAPPER_JAR%')"^
./mvnw.cmd-150-		"}"
./mvnw.cmd-151-    if "%MVNW_VERBOSE%" == "true" (
--
./scripts/als-v3-ca/README.md:1:# Root CA for ALSv3 mTLS communication
./scripts/als-v3-ca/README.md-2-
./scripts/als-v3-ca/README.md-3-## How to create new / rotate client certs in one go
./scripts/als-v3-ca/README.md-4-
./scripts/als-v3-ca/README.md:5:Download the root-ca.key file from SAP PassVault:
./scripts/als-v3-ca/README.md-6-
./scripts/als-v3-ca/README.md:7:- [Root-CA.key Canary](https://password.wdf.sap.corp/passvault/#/pwd/0000517855)
./scripts/als-v3-ca/README.md:8:- [Root-CA.key Prod](https://password.wdf.sap.corp/passvault/#/pwd/0000525595)
./scripts/als-v3-ca/README.md-9-
./scripts/als-v3-ca/README.md:10:Store it as `root-ca.key` file in the directory, `prod` or `canary`.
./scripts/als-v3-ca/README.md:11:Remove the file after the client certs were generated.
./scripts/als-v3-ca/README.md-12-
./scripts/als-v3-ca/README.md:13:run the following script and follow the prompt, it should generate the client
./scripts/als-v3-ca/README.md:14:certs for all the environments in the target directory respectively.
./scripts/als-v3-ca/README.md:15:Note: the passphrase for the private key is stored within the "Password" field in the respective PassVault entry.
./scripts/als-v3-ca/README.md-16-
./scripts/als-v3-ca/README.md-17-```bash
./scripts/als-v3-ca/README.md:18:./generateCerts.sh --env [prod|canary] [prod_eu|prod_ca|....]
./scripts/als-v3-ca/README.md-19-```
./scripts/als-v3-ca/README.md-20-
./scripts/als-v3-ca/README.md-21-## How to create a new / rotate client cert step by step
./scripts/als-v3-ca/README.md-22-
./scripts/als-v3-ca/README.md:23:Download the root-ca.key file from [SAP PassVault](https://password.wdf.sap.corp/passvault/#/pwd/0000517855).
./scripts/als-v3-ca/README.md:24:Store it as `root-ca.key` file in the directory.
./scripts/als-v3-ca/README.md:25:Remove the file after the new client cert was generated.
./scripts/als-v3-ca/README.md-26-
./scripts/als-v3-ca/README.md:27:Generate client private key and CSR.
./scripts/als-v3-ca/README.md-28-Note that ALSv3 Operator doesn't allow two bindings with the same.
./scripts/als-v3-ca/README.md-29-If a certificate for a new client is needed, please, change the CN.
./scripts/als-v3-ca/README.md-30-
./scripts/als-v3-ca/README.md-31-```bash
./scripts/als-v3-ca/README.md:32:openssl genrsa -out client.key 2048
./scripts/als-v3-ca/README.md:33:openssl req -new -key client.key -out client.csr -subj "/CN=ALSv3ClientV1/OU=APIGW/OU=Signavio/O=SAP/L=Walldorf/ST=Baden Wuerttemberg/C=DE"
./scripts/als-v3-ca/README.md-34-```
./scripts/als-v3-ca/README.md-35-
./scripts/als-v3-ca/README.md:36:Sign the CSR with the root CA, valid for 1 year. Use the password from the [SAP PassVault](https://password.wdf.sap.corp/passvault/#/pwd/0000517855).
./scripts/als-v3-ca/README.md-37-
./scripts/als-v3-ca/README.md-38-```bash
./scripts/als-v3-ca/README.md:39:openssl x509 -req -in client.csr -CA root-ca.pem -CAkey root-ca.key -out client.crt -days 365 -extfile client-ext.cnf -extensions client_cert
./scripts/als-v3-ca/README.md-40-```
./scripts/als-v3-ca/README.md-41-
./scripts/als-v3-ca/README.md:42:Handle the client.key as secret and add the content of the file to the [APIGW
./scripts/als-v3-ca/README.md:43:config](https://github.com/signavio/suite-k8sconfig/blob/master/bpi-api-gw/bpi-api-gw-service/values/secrets-staging_cloud_os_eu.enc.yaml#L31) file as secret. Remove the client.key and client.csr files afterward.
./scripts/als-v3-ca/README.md-44-The client.crt is public information and the content can be added to the APIGW suite-k8sconfig file as value.
./scripts/als-v3-ca/README.md-45-
./scripts/als-v3-ca/README.md-46-Commit the updated root-ca.srl file to GIT.
./scripts/als-v3-ca/README.md-47-
./scripts/als-v3-ca/README.md:48:## How to verify the generated *.cert.b64 files?
./scripts/als-v3-ca/README.md-49-
./scripts/als-v3-ca/README.md-50-```bash
./scripts/als-v3-ca/README.md:51:cat scripts/als-v3-ca/prod/prod_ca/client.crt.b64 | base64 --decode | openssl x509 -text -noout -in /dev/stdin;
./scripts/als-v3-ca/README.md-52-```
./scripts/als-v3-ca/README.md-53-
./scripts/als-v3-ca/README.md-54-In the terminal output we should see the parsed content of the certificate. Here we need to check and make sure the following fields are correctly set for the target landscape:
./scripts/als-v3-ca/README.md-55-
./scripts/als-v3-ca/README.md:56:- `subject`, important is the common name (CN), for example `Subject: CN=ALSv3Client-prod_eu, OU=APIGW, OU=Signavio, O=SAP, L=Walldorf, ST=Baden Wuerttemberg, C=DE` is meant for the prod EU landscape.
./scripts/als-v3-ca/README.md-57-- `issuer`, our own root CA
./scripts/als-v3-ca/README.md-58-
./scripts/als-v3-ca/README.md-59-## How was the Root CA created
./scripts/als-v3-ca/README.md-60-
./scripts/als-v3-ca/README.md:61:Generate private key of the root CA encrypted with a password.
./scripts/als-v3-ca/README.md-62-The Password is stored in the [SAP PassVault](https://password.wdf.sap.corp/passvault/#/pwd/0000525595).
./scripts/als-v3-ca/README.md-63-
./scripts/als-v3-ca/README.md-64-```bash
./scripts/als-v3-ca/README.md:65:openssl genrsa -aes256 -out root-ca.key 4096
./scripts/als-v3-ca/README.md-66-```
./scripts/als-v3-ca/README.md-67-
./scripts/als-v3-ca/README.md:68:Generate root CA cert with 3 year validity
./scripts/als-v3-ca/README.md-69-
./scripts/als-v3-ca/README.md-70-```bash
./scripts/als-v3-ca/README.md:71:openssl req -x509 -new -nodes -key root-ca.key -sha256 -days 1068 -out root-ca.pem -subj "/C=DE/ST=Baden Wuerttemberg/L=Walldorf/O=SAP/OU=Signavio/OU=APIGW/CN=APIGW Canary Root CA"
./scripts/als-v3-ca/README.md-72-```
./scripts/als-v3-ca/README.md-73-
./scripts/als-v3-ca/README.md:74:The private root-ca.key was uploaded to [SAP PassVault](https://password.wdf.sap.corp/passvault/#/pwd/0000525595)
./scripts/als-v3-ca/README.md-75-and removed afterward.
./scripts/als-v3-ca/README.md:76:The root-ca.pem is public information and can be stored in the GIT repo.
./scripts/als-v3-ca/README.md-77-
./scripts/als-v3-ca/README.md-78-## Usage and Testing
./scripts/als-v3-ca/README.md:79:The generated client certificates need to be added into the APIGW respective environment variables as secrets in suite-k8sconfig for instance in staging [here](https://github.com/signavio/suite-k8sconfig/blob/master/bpi-api-gw/bpi-api-gw-service/values/secrets-staging_cloud_os_eu.enc.yaml#L28).
./scripts/als-v3-ca/README.md-80-The APIGW application at start up will load and initialize the HTTP client to make secure (https) requests to the ALS system when an audit event gets triggered.
./scripts/als-v3-ca/README.md-81-
--
./scripts/als-v3-ca/README.md-88--H "Content-Type: application/json" \
./scripts/als-v3-ca/README.md-89---cert client.crt \
./scripts/als-v3-ca/README.md:90:--key canary-client.key \
./scripts/als-v3-ca/README.md:91:-d '{ "timeFrom": "2025-06-02T05:07:00.000Z", "timeTo": "2025-06-02T11:20:00.000Z", "source": "/canary/sap.signavio/saas-any" }' \
./scripts/als-v3-ca/README.md-92-https://canary.als.services.cloud.sap/retrieval/v1/query
./scripts/als-v3-ca/README.md-93-```
--
./scripts/als-v3-ca/README.md-95-Example to retrieve audit logs results from a query created:
./scripts/als-v3-ca/README.md-96-```console
./scripts/als-v3-ca/README.md:97:curl --cert ./client.crt --key ./canary-client.key https://canary.als.services.cloud.sap/retrieval/v1/query/9da141cf-18ed-4cdc-bd42-81744a4115c4/results
./scripts/als-v3-ca/README.md-98-```
./scripts/als-v3-ca/README.md-99-
./scripts/als-v3-ca/README.md-100-More info:
./scripts/als-v3-ca/README.md-101-* [API Gateway Audit Logging with ALS](https://wiki.one.int.sap/wiki/display/SIGEWS/Audit+Logging+with+ALS)
./scripts/als-v3-ca/README.md:102:* [Audit Logging at Signavio](https://wiki.one.int.sap/wiki/display/SIGSEC/Audit+Logging+at+Signavio#AuditLoggingatSignavio-Onboarding)
./scripts/als-v3-ca/README.md-103-* [Audit Log Events](https://wiki.one.int.sap/wiki/display/SIGEWS/Audit+Log+Events)
--
./mock/mvnw.cmd-27-@REM M2_HOME - location of maven2's installed home dir
./mock/mvnw.cmd-28-@REM MAVEN_BATCH_ECHO - set to 'on' to enable the echoing of the batch commands
./mock/mvnw.cmd:29:@REM MAVEN_BATCH_PAUSE - set to 'on' to wait for a keystroke before ending
./mock/mvnw.cmd-30-@REM MAVEN_OPTS - parameters passed to the Java VM when running Maven
./mock/mvnw.cmd-31-@REM     e.g. to debug Maven itself, use
--
./mock/mvnw.cmd-41-@if "%MAVEN_BATCH_ECHO%" == "on"  echo %MAVEN_BATCH_ECHO%
./mock/mvnw.cmd-42-
./mock/mvnw.cmd:43:@REM set %HOME% to equivalent of $HOME
./mock/mvnw.cmd:44:if "%HOME%" == "" (set "HOME=%HOMEDRIVE%%HOMEPATH%")
./mock/mvnw.cmd-45-
./mock/mvnw.cmd-46-@REM Execute a user defined script before this one
--
./mock/mvnw.cmd-144-    powershell -Command "&{"^
./mock/mvnw.cmd-145-		"$webclient = new-object System.Net.WebClient;"^
./mock/mvnw.cmd:146:		"if (-not ([string]::IsNullOrEmpty('%MVNW_USERNAME%') -and [string]::IsNullOrEmpty('%MVNW_PASSWORD%'))) {"^
./mock/mvnw.cmd-147-		"$webclient.Credentials = new-object System.Net.NetworkCredential('%MVNW_USERNAME%', '%MVNW_PASSWORD%');"^
./mock/mvnw.cmd-148-		"}"^
./mock/mvnw.cmd:149:		"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $webclient.DownloadFile('%DOWNLOAD_URL%', '%WRAPPER_JAR%')"^
./mock/mvnw.cmd-150-		"}"
./mock/mvnw.cmd-151-    if "%MVNW_VERBOSE%" == "true" (
--
./ai_docs/testing/testing_core.md-2-
./ai_docs/testing/testing_core.md-3-## Tech Stack
./ai_docs/testing/testing_core.md:4:- **Testing Framework**: Spring Boot Test (package org.springframework.test)
./ai_docs/testing/testing_core.md-5-- **Mocking**: Mockito (package org.mockito)
./ai_docs/testing/testing_core.md-6-
--
./ai_docs/testing/testing_core.md-18-
./ai_docs/testing/testing_core.md-19-#### Route/API Tests
./ai_docs/testing/testing_core.md:20:- Use interface WebTestClient from package org.springframework.test.web.reactive.server for test requests
./ai_docs/testing/testing_core.md-21-
./ai_docs/testing/testing_core.md-22-### Mocking Strategy
--
./bpi-api-gw/pom.xml-14-    <properties>
./bpi-api-gw/pom.xml-15-        <java.version>17</java.version>
./bpi-api-gw/pom.xml:16:        <redis.reactive.version>3.1.4</redis.reactive.version>
./bpi-api-gw/pom.xml-17-        <amazon.awssdk.version>2.37.5</amazon.awssdk.version>
./bpi-api-gw/pom.xml-18-    </properties>
--
./bpi-api-gw/pom.xml-20-    <dependencies>
./bpi-api-gw/pom.xml-21-        <dependency>
./bpi-api-gw/pom.xml:22:            <groupId>org.springframework.cloud</groupId>
./bpi-api-gw/pom.xml:23:            <artifactId>spring-cloud-gateway-server-webflux</artifactId>
./bpi-api-gw/pom.xml-24-        </dependency>
./bpi-api-gw/pom.xml-25-        <dependency>
./bpi-api-gw/pom.xml:26:            <groupId>org.springframework.boot</groupId>
./bpi-api-gw/pom.xml:27:            <artifactId>spring-boot-starter-webflux</artifactId>
./bpi-api-gw/pom.xml-28-        </dependency>
./bpi-api-gw/pom.xml-29-        <dependency>
./bpi-api-gw/pom.xml:30:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:31:            <artifactId>spring-webflux</artifactId>
./bpi-api-gw/pom.xml-32-        </dependency>
./bpi-api-gw/pom.xml-33-        <dependency>
./bpi-api-gw/pom.xml:34:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:35:            <artifactId>spring-web</artifactId>
./bpi-api-gw/pom.xml-36-        </dependency>
./bpi-api-gw/pom.xml-37-        <dependency>
./bpi-api-gw/pom.xml:38:            <groupId>org.springframework.cloud</groupId>
./bpi-api-gw/pom.xml:39:            <artifactId>spring-cloud-starter-circuitbreaker-reactor-resilience4j</artifactId>
./bpi-api-gw/pom.xml-40-        </dependency>
./bpi-api-gw/pom.xml-41-        <dependency>
./bpi-api-gw/pom.xml:42:            <groupId>org.springframework.cloud</groupId>
./bpi-api-gw/pom.xml:43:            <artifactId>spring-cloud-contract-wiremock</artifactId>
./bpi-api-gw/pom.xml-44-        </dependency>
./bpi-api-gw/pom.xml-45-        <dependency>
./bpi-api-gw/pom.xml:46:            <groupId>org.springframework.cloud</groupId>
./bpi-api-gw/pom.xml:47:            <artifactId>spring-cloud-starter-config</artifactId>
./bpi-api-gw/pom.xml-48-        </dependency>
./bpi-api-gw/pom.xml-49-        <dependency>
./bpi-api-gw/pom.xml:50:            <groupId>org.springframework.boot</groupId>
./bpi-api-gw/pom.xml:51:            <artifactId>spring-boot-starter-test</artifactId>
./bpi-api-gw/pom.xml-52-            <scope>test</scope>
./bpi-api-gw/pom.xml-53-            <exclusions>
--
./bpi-api-gw/pom.xml-59-        </dependency>
./bpi-api-gw/pom.xml-60-        <dependency>
./bpi-api-gw/pom.xml:61:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:62:            <artifactId>spring-test</artifactId>
./bpi-api-gw/pom.xml-63-            <scope>test</scope>
./bpi-api-gw/pom.xml-64-        </dependency>
./bpi-api-gw/pom.xml:65:        <!-- handy to create SAP specific JWTs -->
./bpi-api-gw/pom.xml-66-        <dependency>
./bpi-api-gw/pom.xml-67-            <groupId>com.sap.cloud.security</groupId>
--
./bpi-api-gw/pom.xml-70-        </dependency>
./bpi-api-gw/pom.xml-71-        <dependency>
./bpi-api-gw/pom.xml:72:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:73:            <artifactId>spring-core</artifactId>
./bpi-api-gw/pom.xml-74-        </dependency>
./bpi-api-gw/pom.xml-75-        <dependency>
./bpi-api-gw/pom.xml:76:            <groupId>org.springframework.boot</groupId>
./bpi-api-gw/pom.xml:77:            <artifactId>spring-boot-starter-actuator</artifactId>
./bpi-api-gw/pom.xml-78-            <exclusions>
./bpi-api-gw/pom.xml-79-                <exclusion>
./bpi-api-gw/pom.xml:80:                    <groupId>org.springframework.boot</groupId>
./bpi-api-gw/pom.xml:81:                    <artifactId>spring-boot-starter</artifactId>
./bpi-api-gw/pom.xml-82-                </exclusion>
./bpi-api-gw/pom.xml-83-            </exclusions>
--
./bpi-api-gw/pom.xml-88-        </dependency>
./bpi-api-gw/pom.xml-89-        <dependency>
./bpi-api-gw/pom.xml:90:            <groupId>org.springframework.boot</groupId>
./bpi-api-gw/pom.xml:91:            <artifactId>spring-boot-starter-security</artifactId>
./bpi-api-gw/pom.xml-92-        </dependency>
./bpi-api-gw/pom.xml-93-        <dependency>
./bpi-api-gw/pom.xml:94:            <groupId>org.springframework.security</groupId>
./bpi-api-gw/pom.xml:95:            <artifactId>spring-security-config</artifactId>
./bpi-api-gw/pom.xml-96-        </dependency>
./bpi-api-gw/pom.xml-97-        <dependency>
./bpi-api-gw/pom.xml:98:            <groupId>org.springframework.security</groupId>
./bpi-api-gw/pom.xml:99:            <artifactId>spring-security-web</artifactId>
./bpi-api-gw/pom.xml-100-        </dependency>
./bpi-api-gw/pom.xml-101-        <dependency>
./bpi-api-gw/pom.xml:102:            <groupId>org.springframework.security</groupId>
./bpi-api-gw/pom.xml:103:            <artifactId>spring-security-rsa</artifactId>
./bpi-api-gw/pom.xml-104-        </dependency>
./bpi-api-gw/pom.xml-105-        <dependency>
--
./bpi-api-gw/pom.xml-186-        <dependency>
./bpi-api-gw/pom.xml-187-            <groupId>io.jsonwebtoken</groupId>
./bpi-api-gw/pom.xml:188:            <artifactId>jjwt-api</artifactId>
./bpi-api-gw/pom.xml-189-        </dependency>
./bpi-api-gw/pom.xml-190-
./bpi-api-gw/pom.xml-191-        <dependency>
./bpi-api-gw/pom.xml-192-            <groupId>io.jsonwebtoken</groupId>
./bpi-api-gw/pom.xml:193:            <artifactId>jjwt-impl</artifactId>
./bpi-api-gw/pom.xml-194-            <scope>runtime</scope>
./bpi-api-gw/pom.xml-195-        </dependency>
--
./bpi-api-gw/pom.xml-197-        <dependency>
./bpi-api-gw/pom.xml-198-            <groupId>io.jsonwebtoken</groupId>
./bpi-api-gw/pom.xml:199:            <artifactId>jjwt-jackson</artifactId> <!-- or jjwt-gson if Gson is preferred -->
./bpi-api-gw/pom.xml-200-            <scope>runtime</scope>
./bpi-api-gw/pom.xml-201-        </dependency>
./bpi-api-gw/pom.xml-202-        <dependency>
./bpi-api-gw/pom.xml-203-            <groupId>org.yaml</groupId>
./bpi-api-gw/pom.xml:204:            <artifactId>snakeyaml</artifactId>
./bpi-api-gw/pom.xml-205-        </dependency>
./bpi-api-gw/pom.xml-206-        <dependency>
--
./bpi-api-gw/pom.xml-209-        </dependency>
./bpi-api-gw/pom.xml-210-        <dependency>
./bpi-api-gw/pom.xml:211:            <groupId>org.springframework.data</groupId>
./bpi-api-gw/pom.xml:212:            <artifactId>spring-data-redis</artifactId>
./bpi-api-gw/pom.xml-213-        </dependency>
./bpi-api-gw/pom.xml-214-        <dependency>
./bpi-api-gw/pom.xml:215:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:216:            <artifactId>spring-tx</artifactId>
./bpi-api-gw/pom.xml-217-        </dependency>
./bpi-api-gw/pom.xml-218-        <dependency>
./bpi-api-gw/pom.xml:219:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:220:            <artifactId>spring-oxm</artifactId>
./bpi-api-gw/pom.xml-221-        </dependency>
./bpi-api-gw/pom.xml-222-        <dependency>
./bpi-api-gw/pom.xml:223:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:224:            <artifactId>spring-aop</artifactId>
./bpi-api-gw/pom.xml-225-        </dependency>
./bpi-api-gw/pom.xml-226-        <dependency>
./bpi-api-gw/pom.xml:227:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:228:            <artifactId>spring-context-support</artifactId>
./bpi-api-gw/pom.xml-229-        </dependency>
./bpi-api-gw/pom.xml-230-        <dependency>
./bpi-api-gw/pom.xml:231:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:232:            <artifactId>spring-jdbc</artifactId>
./bpi-api-gw/pom.xml-233-        </dependency>
./bpi-api-gw/pom.xml-234-        <dependency>
./bpi-api-gw/pom.xml:235:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:236:            <artifactId>spring-core-test</artifactId>
./bpi-api-gw/pom.xml-237-        </dependency>
./bpi-api-gw/pom.xml-238-        <dependency>
./bpi-api-gw/pom.xml:239:            <groupId>org.springframework</groupId>
./bpi-api-gw/pom.xml:240:            <artifactId>spring-expression</artifactId>
./bpi-api-gw/pom.xml-241-        </dependency>
./bpi-api-gw/pom.xml-242-        <dependency>
--
./bpi-api-gw/pom.xml-253-        </dependency>
./bpi-api-gw/pom.xml-254-        <dependency>
./bpi-api-gw/pom.xml:255:            <groupId>org.springdoc</groupId>
./bpi-api-gw/pom.xml:256:            <artifactId>springdoc-openapi-starter-webflux-ui</artifactId>
./bpi-api-gw/pom.xml-257-        </dependency>
./bpi-api-gw/pom.xml-258-
--
./bpi-api-gw/pom.xml-285-        <!--	BDSA-2022-3337 + BDSA-2023-3254 -->
./bpi-api-gw/pom.xml-286-        <dependency>
./bpi-api-gw/pom.xml:287:            <groupId>org.bouncycastle</groupId>
./bpi-api-gw/pom.xml-288-            <artifactId>bcprov-jdk15to18</artifactId>
./bpi-api-gw/pom.xml-289-        </dependency>
./bpi-api-gw/pom.xml:290:        <!-- BouncyCastle OpenSSL for PKCS#1 private key support -->
./bpi-api-gw/pom.xml-291-        <dependency>
./bpi-api-gw/pom.xml:292:            <groupId>org.bouncycastle</groupId>
./bpi-api-gw/pom.xml-293-            <artifactId>bcpkix-jdk15to18</artifactId>
./bpi-api-gw/pom.xml-294-        </dependency>
--
./bpi-api-gw/pom.xml-300-        </dependency>
./bpi-api-gw/pom.xml-301-        <dependency>
./bpi-api-gw/pom.xml:302:            <groupId>com.signavio</groupId>
./bpi-api-gw/pom.xml-303-            <artifactId>authentication</artifactId>
./bpi-api-gw/pom.xml-304-        </dependency>
./bpi-api-gw/pom.xml-305-        <dependency>
./bpi-api-gw/pom.xml:306:            <groupId>com.signavio.pam.shared</groupId>
./bpi-api-gw/pom.xml-307-            <artifactId>als-logging</artifactId>
./bpi-api-gw/pom.xml-308-        </dependency>
--
./bpi-api-gw/pom.xml-348-            <version>${amazon.awssdk.version}</version>
./bpi-api-gw/pom.xml-349-        </dependency>
./bpi-api-gw/pom.xml:350:        <!-- Nimbus JOSE+JWT for JWE encryption -->
./bpi-api-gw/pom.xml-351-        <dependency>
./bpi-api-gw/pom.xml:352:            <groupId>com.nimbusds</groupId>
./bpi-api-gw/pom.xml:353:            <artifactId>nimbus-jose-jwt</artifactId>
./bpi-api-gw/pom.xml-354-        </dependency>
./bpi-api-gw/pom.xml-355-    </dependencies>
--
./bpi-api-gw/pom.xml-362-                <artifactId>jacoco-maven-plugin</artifactId>
./bpi-api-gw/pom.xml-363-                <configuration>
./bpi-api-gw/pom.xml:364:                    <excludes>
./bpi-api-gw/pom.xml-365-                        <exclude>**/*Config.*</exclude>
./bpi-api-gw/pom.xml-366-                        <exclude>**/GatewayApplication.class</exclude>
./bpi-api-gw/pom.xml-367-                        <exclude>**/filters/RedisConfiguration*</exclude>
./bpi-api-gw/pom.xml-368-                        <exclude>**/*Configuration*.*</exclude>
./bpi-api-gw/pom.xml:369:                        <exclude>org/springframework/web/cors/reactive/**/*</exclude>
./bpi-api-gw/pom.xml-370-                        <exclude>**/LaunchDarklyFeatureFlag.class</exclude>
./bpi-api-gw/pom.xml:371:                        <exclude>**/JwtAuthorizationManagerUtils.class</exclude>
./bpi-api-gw/pom.xml-372-                        <exclude>**/dto/**</exclude>
./bpi-api-gw/pom.xml:373:                    </excludes>
./bpi-api-gw/pom.xml-374-                </configuration>
./bpi-api-gw/pom.xml-375-                <executions>
--
./bpi-api-gw/pom.xml-407-                                <rule>
./bpi-api-gw/pom.xml-408-                                    <element>CLASS</element>
./bpi-api-gw/pom.xml:409:                                    <excludes>
./bpi-api-gw/pom.xml-410-                                        <exclude>*Test</exclude>
./bpi-api-gw/pom.xml-411-                                        <exclude>**/dto/**</exclude>
./bpi-api-gw/pom.xml:412:                                    </excludes>
./bpi-api-gw/pom.xml-413-                                    <limits>
./bpi-api-gw/pom.xml-414-                                        <limit>
--
./bpi-api-gw/pom.xml-435-                        <artifactId>maven-surefire-plugin</artifactId>
./bpi-api-gw/pom.xml-436-                        <configuration>
./bpi-api-gw/pom.xml:437:                            <includes>
./bpi-api-gw/pom.xml-438-                                <include>**/com/sap/bpi/api/gw/integration/**/*.java</include>
./bpi-api-gw/pom.xml:439:                            </includes>
./bpi-api-gw/pom.xml-440-                            <reportsDirectory>${project.build.directory}/integration-tests/surefire-reports</reportsDirectory>
./bpi-api-gw/pom.xml-441-                        </configuration>
--
./bpi-api-gw/pom.xml-452-                        <artifactId>maven-surefire-plugin</artifactId>
./bpi-api-gw/pom.xml-453-                        <configuration>
./bpi-api-gw/pom.xml:454:                            <includes>
./bpi-api-gw/pom.xml-455-                                <include>**/com/sap/bpi/api/gw/unit/**/*.java</include>
./bpi-api-gw/pom.xml:456:                            </includes>
./bpi-api-gw/pom.xml-457-                            <reportsDirectory>${project.build.directory}/unit-tests/surefire-reports</reportsDirectory>
./bpi-api-gw/pom.xml-458-                        </configuration>
--
./bpi-api-gw/pom.xml-469-                        <artifactId>maven-surefire-plugin</artifactId>
./bpi-api-gw/pom.xml-470-                        <configuration>
./bpi-api-gw/pom.xml:471:                            <includes>
./bpi-api-gw/pom.xml-472-                                <include>**/com/sap/bpi/api/gw/api/**/*.java</include>
./bpi-api-gw/pom.xml:473:                            </includes>
./bpi-api-gw/pom.xml-474-                            <reportsDirectory>${project.build.directory}/api-tests/surefire-reports</reportsDirectory>
./bpi-api-gw/pom.xml-475-                        </configuration>
--
./bpi-api-gw/pom.xml-486-                        <artifactId>maven-surefire-plugin</artifactId>
./bpi-api-gw/pom.xml-487-                        <configuration>
./bpi-api-gw/pom.xml:488:                            <includes>
./bpi-api-gw/pom.xml-489-                                <include>**/com/sap/bpi/api/gw/api/**/*.java</include>
./bpi-api-gw/pom.xml-490-                                <include>**/com/sap/bpi/api/gw/unit/**/*.java</include>
./bpi-api-gw/pom.xml:491:                            </includes>
./bpi-api-gw/pom.xml-492-                            <reportsDirectory>${project.build.directory}/coverage-tests/surefire-reports</reportsDirectory>
./bpi-api-gw/pom.xml-493-                        </configuration>
--
./bpi-api-gw/pom.xml-498-        <profile>
./bpi-api-gw/pom.xml-499-            <id>sonar</id>
./bpi-api-gw/pom.xml:500:            <activation>
./bpi-api-gw/pom.xml:501:                <activeByDefault>true</activeByDefault>
./bpi-api-gw/pom.xml:502:            </activation>
./bpi-api-gw/pom.xml-503-        </profile>
./bpi-api-gw/pom.xml-504-    </profiles>
--
./ai_docs/Token_Authorization_Architecture.md-3-## Overview
./ai_docs/Token_Authorization_Architecture.md-4-
./ai_docs/Token_Authorization_Architecture.md:5:The Token Authorization Architecture provides a unified authentication layer for the BPI API Gateway that validates multiple token types (Joule JWT, SPM Token, UGW JWT) at the Spring Security boundary. This eliminates duplicate route definitions and consolidates authentication logic.
./ai_docs/Token_Authorization_Architecture.md-6-
./ai_docs/Token_Authorization_Architecture.md:7:### Key Principles
./ai_docs/Token_Authorization_Architecture.md-8-
./ai_docs/Token_Authorization_Architecture.md:9:1. **Authentication at Security Layer** - Token validation happens in Spring Security (TokenAuthorizationManager) for SAP JWT and UGW JWT; SPM Token uses pass-through
./ai_docs/Token_Authorization_Architecture.md:10:2. **Fail-Fast** - Invalid JWT tokens rejected at security boundary before route matching
./ai_docs/Token_Authorization_Architecture.md:11:3. **Separation of Concerns** - Security layer validates JWTs, filter layer validates SPM tokens and performs conversion
./ai_docs/Token_Authorization_Architecture.md-12-4. **Strategy Pattern** - Each token type has its own validation strategy
./ai_docs/Token_Authorization_Architecture.md-13-
--
./ai_docs/Token_Authorization_Architecture.md-19-
./ai_docs/Token_Authorization_Architecture.md-20-                    Incoming Request                          
./ai_docs/Token_Authorization_Architecture.md:21:              (Joule JWT / SPM Token / UGW JWT)               
./ai_docs/Token_Authorization_Architecture.md-22-
./ai_docs/Token_Authorization_Architecture.md-23-                          
./ai_docs/Token_Authorization_Architecture.md-24-                          
./ai_docs/Token_Authorization_Architecture.md-25-
./ai_docs/Token_Authorization_Architecture.md:26:         Spring Security Layer (Strategy Pattern)             
./ai_docs/Token_Authorization_Architecture.md-27-                                                              
./ai_docs/Token_Authorization_Architecture.md-28-      
./ai_docs/Token_Authorization_Architecture.md-29-    TokenTypeDetector                                     
./ai_docs/Token_Authorization_Architecture.md-30-    - Detects token type from request                     
./ai_docs/Token_Authorization_Architecture.md:31:    - Bearer token  decode JWT:                          
./ai_docs/Token_Authorization_Architecture.md:32:       Check issuer pattern  UGW_JWT                    
./ai_docs/Token_Authorization_Architecture.md:33:       Check XSUAA claims  SAP_JWT                      
./ai_docs/Token_Authorization_Architecture.md:34:       Check BTP domain  SAP_JWT                        
./ai_docs/Token_Authorization_Architecture.md:35:    - x-signavio-id header  SPM_TOKEN                    
./ai_docs/Token_Authorization_Architecture.md-36-    - Otherwise  UNKNOWN                                 
./ai_docs/Token_Authorization_Architecture.md-37-      
--
./ai_docs/Token_Authorization_Architecture.md-59-                            
./ai_docs/Token_Authorization_Architecture.md-60-  SAP   SPM    UGW       Future                  
./ai_docs/Token_Authorization_Architecture.md:61:  JWT   Token  JWT       Types                   
./ai_docs/Token_Authorization_Architecture.md-62-                            
./ai_docs/Token_Authorization_Architecture.md-63-
--
./ai_docs/Token_Authorization_Architecture.md-71-                          
./ai_docs/Token_Authorization_Architecture.md-72-
./ai_docs/Token_Authorization_Architecture.md:73:     JWT Conversion Filter (UnifiedJwtConversionFilter)       
./ai_docs/Token_Authorization_Architecture.md-74-            
./ai_docs/Token_Authorization_Architecture.md-75-   1. Read token-type attribute                            
./ai_docs/Token_Authorization_Architecture.md:76:   2. Lookup route JWT config (YAML/inline)                
./ai_docs/Token_Authorization_Architecture.md-77-   3. Delegate to appropriate converter:                   
./ai_docs/Token_Authorization_Architecture.md:78:      - SapJwtToSpmJwtConverter                            
./ai_docs/Token_Authorization_Architecture.md:79:      - SpmTokenToSpmJwtConverter                          
./ai_docs/Token_Authorization_Architecture.md:80:      - UgwJwtToSpmJwtConverter                            
./ai_docs/Token_Authorization_Architecture.md:81:   4. Set Authorization header with SPM JWT                
./ai_docs/Token_Authorization_Architecture.md-82-            
./ai_docs/Token_Authorization_Architecture.md-83-
--
./ai_docs/Token_Authorization_Architecture.md-94-
./ai_docs/Token_Authorization_Architecture.md-95-### 1. TokenTypeDetector
./ai_docs/Token_Authorization_Architecture.md:96:**Location:** `com.sap.bpi.api.gw.security.jwt.TokenTypeDetector`
./ai_docs/Token_Authorization_Architecture.md-97-
./ai_docs/Token_Authorization_Architecture.md-98-**Responsibility:** Detect token type from incoming request
./ai_docs/Token_Authorization_Architecture.md-99-
./ai_docs/Token_Authorization_Architecture.md-100-**Detection Logic:**
./ai_docs/Token_Authorization_Architecture.md:101:1. Check for Bearer token  Decode JWT payload:
./ai_docs/Token_Authorization_Architecture.md:102:   - Check issuer pattern (`bpi-api-gw...signav.io`)  `UGW_JWT`
./ai_docs/Token_Authorization_Architecture.md:103:   - Check for XSUAA claims (`ext_attr.enhancer = "XSUAA"`)  `SAP_JWT`
./ai_docs/Token_Authorization_Architecture.md:104:   - Check if issuer domain ends with `ondemand.com`  `SAP_JWT`
./ai_docs/Token_Authorization_Architecture.md:105:2. Check for `x-signavio-id` header  `SPM_TOKEN`
./ai_docs/Token_Authorization_Architecture.md-106-3. Check for `Cookie` header  `SPM_TOKEN` (GET request edge case)
./ai_docs/Token_Authorization_Architecture.md-107-4. Otherwise  `UNKNOWN`
--
./ai_docs/Token_Authorization_Architecture.md-112-
./ai_docs/Token_Authorization_Architecture.md-113-### 2. TokenAuthorizationManager
./ai_docs/Token_Authorization_Architecture.md:114:**Location:** `com.sap.bpi.api.gw.security.jwt.TokenAuthorizationManager`
./ai_docs/Token_Authorization_Architecture.md-115-
./ai_docs/Token_Authorization_Architecture.md:116:**Responsibility:** Main authorization entry point for Spring Security
./ai_docs/Token_Authorization_Architecture.md-117-
./ai_docs/Token_Authorization_Architecture.md:118:**Key Features:**
./ai_docs/Token_Authorization_Architecture.md:119:- Implements `ReactiveAuthorizationManager<AuthorizationContext>`
./ai_docs/Token_Authorization_Architecture.md-120-- Maintains `EnumMap<TokenType, TokenValidationStrategy>` for O(1) strategy lookup
./ai_docs/Token_Authorization_Architecture.md-121-- Uses TokenTypeDetector for direct token type detection
./ai_docs/Token_Authorization_Architecture.md-122-- Sets exchange attributes for downstream filters
./ai_docs/Token_Authorization_Architecture.md:123:- **Performance:** EnumMap provides faster lookups than HashMap for enum keys
./ai_docs/Token_Authorization_Architecture.md-124-
./ai_docs/Token_Authorization_Architecture.md-125-**Flow:**
--
./ai_docs/Token_Authorization_Architecture.md-132-
./ai_docs/Token_Authorization_Architecture.md-133-**Exchange Attributes Set:**
./ai_docs/Token_Authorization_Architecture.md:134:- `token-type`  "sap-jwt" | "spm-token" | "ugw-jwt"
./ai_docs/Token_Authorization_Architecture.md-135-- `x-client-id`  "joule" | "spm" | "ugw-client"
./ai_docs/Token_Authorization_Architecture.md:136:- `x-signavio-tenant-id`  tenant identifier (for SAP JWT)
./ai_docs/Token_Authorization_Architecture.md-137-- Additional metadata from validation strategies
./ai_docs/Token_Authorization_Architecture.md-138-
--
./ai_docs/Token_Authorization_Architecture.md-140-
./ai_docs/Token_Authorization_Architecture.md-141-### 3. TokenValidationStrategy (Interface)
./ai_docs/Token_Authorization_Architecture.md:142:**Location:** `com.sap.bpi.api.gw.security.jwt.strategy.TokenValidationStrategy`
./ai_docs/Token_Authorization_Architecture.md-143-
./ai_docs/Token_Authorization_Architecture.md-144-**Responsibility:** Contract for token validation implementations
--
./ai_docs/Token_Authorization_Architecture.md-153-### 4. Concrete Strategy Implementations
./ai_docs/Token_Authorization_Architecture.md-154-
./ai_docs/Token_Authorization_Architecture.md:155:#### SapJwtValidationStrategy
./ai_docs/Token_Authorization_Architecture.md:156:**Location:** `com.sap.bpi.api.gw.security.jwt.strategy.SapJwtValidationStrategy`
./ai_docs/Token_Authorization_Architecture.md-157-
./ai_docs/Token_Authorization_Architecture.md:158:- Wraps existing `JouleCompositeJwtVerifier` (handles both XSUAA and IAS)
./ai_docs/Token_Authorization_Architecture.md:159:- Full JWT signature and claims validation
./ai_docs/Token_Authorization_Architecture.md:160:- Returns `TokenType.SAP_JWT`
./ai_docs/Token_Authorization_Architecture.md:161:- Sets `x-signavio-tenant-id` and `x-client-id` ("joule") attributes
./ai_docs/Token_Authorization_Architecture.md-162-- Client ID matches `RequestOrigin.JOULE` for route predicate compatibility
./ai_docs/Token_Authorization_Architecture.md-163-
./ai_docs/Token_Authorization_Architecture.md-164-#### SpmTokenValidationStrategy
./ai_docs/Token_Authorization_Architecture.md:165:**Location:** `com.sap.bpi.api.gw.security.jwt.strategy.SpmTokenValidationStrategy`
./ai_docs/Token_Authorization_Architecture.md-166-
./ai_docs/Token_Authorization_Architecture.md-167-- **Pure pass-through validation** (always returns SUCCESS)
./ai_docs/Token_Authorization_Architecture.md-168-- **NO validation performed** at security layer
./ai_docs/Token_Authorization_Architecture.md:169:- All actual validation delegated to `SpmTokenToSpmJwtFilterFactory` at filter layer via `FilterUtils.getAuthenticationHeadersTuple3Mono()`
./ai_docs/Token_Authorization_Architecture.md-170-- Returns `TokenType.SPM_TOKEN`
./ai_docs/Token_Authorization_Architecture.md-171-- Sets `x-client-id` to "spm"
./ai_docs/Token_Authorization_Architecture.md-172-- **Rationale:** Eliminates duplication - validation logic exists only in FilterUtils, not in both security and filter layers
./ai_docs/Token_Authorization_Architecture.md-173-
./ai_docs/Token_Authorization_Architecture.md:174:#### UgwJwtValidationStrategy
./ai_docs/Token_Authorization_Architecture.md:175:**Location:** `com.sap.bpi.api.gw.security.jwt.strategy.UgwJwtValidationStrategy`
./ai_docs/Token_Authorization_Architecture.md-176-
./ai_docs/Token_Authorization_Architecture.md:177:- **Fully implemented** for internal UGW JWT tokens
./ai_docs/Token_Authorization_Architecture.md:178:- Issuer-based detection: checks if issuer contains `bpi-api-gw` and ends with `signav.io`
./ai_docs/Token_Authorization_Architecture.md:179:- Full JWT signature validation using `UgwJwtConfig` public key
./ai_docs/Token_Authorization_Architecture.md:180:- Returns `TokenType.UGW_JWT`
./ai_docs/Token_Authorization_Architecture.md-181-- Sets `x-client-id` to "ugw-client"
./ai_docs/Token_Authorization_Architecture.md-182-- **Use case:** Internal gateway-to-gateway authentication
--
./ai_docs/Token_Authorization_Architecture.md-185-
./ai_docs/Token_Authorization_Architecture.md-186-### 5. TokenValidationResult
./ai_docs/Token_Authorization_Architecture.md:187:**Location:** `com.sap.bpi.api.gw.security.jwt.strategy.TokenValidationResult`
./ai_docs/Token_Authorization_Architecture.md-188-
./ai_docs/Token_Authorization_Architecture.md-189-**Responsibility:** Encapsulate validation outcome with metadata
--
./ai_docs/Token_Authorization_Architecture.md-195-**Fields:**
./ai_docs/Token_Authorization_Architecture.md-196-- `valid` - boolean
./ai_docs/Token_Authorization_Architecture.md:197:- `tokenType` - String (e.g., "sap-jwt", "spm-token", "ugw-jwt")
./ai_docs/Token_Authorization_Architecture.md:198:- `clientId` - String (e.g., "joule", "spm", "ugw-client")
./ai_docs/Token_Authorization_Architecture.md:199:- `metadata` - Map<String, Object> (tenant-id, user-id, etc.)
./ai_docs/Token_Authorization_Architecture.md:200:- `errorMessage` - String (null if success)
./ai_docs/Token_Authorization_Architecture.md-201-
./ai_docs/Token_Authorization_Architecture.md-202----
./ai_docs/Token_Authorization_Architecture.md-203-
./ai_docs/Token_Authorization_Architecture.md:204:### 6. UnifiedJwtConversionFilterFactory
./ai_docs/Token_Authorization_Architecture.md:205:**Location:** `com.sap.bpi.api.gw.filters.UnifiedJwtConversionFilterFactory`
./ai_docs/Token_Authorization_Architecture.md-206-
./ai_docs/Token_Authorization_Architecture.md:207:**Responsibility:** Convert validated tokens to SPM JWT format
./ai_docs/Token_Authorization_Architecture.md-208-
./ai_docs/Token_Authorization_Architecture.md:209:**Key Features:**
./ai_docs/Token_Authorization_Architecture.md:210:- NO validation for JWTs (already done at security layer)
./ai_docs/Token_Authorization_Architecture.md-211-- SPM token validation occurs here via FilterUtils (pass-through at security layer)
./ai_docs/Token_Authorization_Architecture.md-212-- Reads `token-type` attribute set by TokenAuthorizationManager
--
./ai_docs/Token_Authorization_Architecture.md-215-
./ai_docs/Token_Authorization_Architecture.md-216-**Delegation:**
./ai_docs/Token_Authorization_Architecture.md:217:- `token-type = "sap-jwt"`  `SapJwtToSpmJwtGatewayFilterFactory`
./ai_docs/Token_Authorization_Architecture.md:218:- `token-type = "spm-token"`  `SpmTokenToSpmJwtFilterFactory`
./ai_docs/Token_Authorization_Architecture.md:219:- `token-type = "ugw-jwt"`  `UgwJwtToSpmJwtFilterFactory`
./ai_docs/Token_Authorization_Architecture.md-220-
./ai_docs/Token_Authorization_Architecture.md-221----
--
./ai_docs/Token_Authorization_Architecture.md-226-sequenceDiagram
./ai_docs/Token_Authorization_Architecture.md-227-    participant Client
./ai_docs/Token_Authorization_Architecture.md:228:    participant Security as Spring Security
./ai_docs/Token_Authorization_Architecture.md-229-    participant Detector as TokenTypeDetector
./ai_docs/Token_Authorization_Architecture.md-230-    participant Manager as TokenAuthorizationManager
./ai_docs/Token_Authorization_Architecture.md-231-    participant Strategy as ValidationStrategy
./ai_docs/Token_Authorization_Architecture.md-232-    participant Routes as Route Matcher
./ai_docs/Token_Authorization_Architecture.md:233:    participant Filter as UnifiedJwtConversionFilter
./ai_docs/Token_Authorization_Architecture.md-234-    participant Backend
./ai_docs/Token_Authorization_Architecture.md-235-
--
./ai_docs/Token_Authorization_Architecture.md-238-    Manager->>Detector: detectTokenType(exchange)
./ai_docs/Token_Authorization_Architecture.md-239-    Detector->>Detector: Analyze request<br/>(Bearer token? Headers?)<br/>Check issuer/claims
./ai_docs/Token_Authorization_Architecture.md:240:    Detector-->>Manager: TokenType (SAP_JWT/SPM_TOKEN/UGW_JWT)
./ai_docs/Token_Authorization_Architecture.md-241-
./ai_docs/Token_Authorization_Architecture.md-242-    Manager->>Manager: strategies.get(tokenType)
./ai_docs/Token_Authorization_Architecture.md-243-    Manager->>Strategy: validate(exchange)
./ai_docs/Token_Authorization_Architecture.md:244:    Strategy->>Strategy: Perform validation<br/>(JWT signature for SAP/UGW,<br/>pass-through for SPM)
./ai_docs/Token_Authorization_Architecture.md-245-    Strategy-->>Manager: TokenValidationResult
./ai_docs/Token_Authorization_Architecture.md-246-
--
./ai_docs/Token_Authorization_Architecture.md-250-        Security->>Routes: Proceed to route matching
./ai_docs/Token_Authorization_Architecture.md-251-        Routes->>Routes: Match unified route
./ai_docs/Token_Authorization_Architecture.md:252:        Routes->>Filter: Apply UnifiedJwtConversionFilter
./ai_docs/Token_Authorization_Architecture.md-253-        Filter->>Filter: Read token-type attribute
./ai_docs/Token_Authorization_Architecture.md-254-        Filter->>Filter: Lookup route config (YAML)
./ai_docs/Token_Authorization_Architecture.md-255-        Filter->>Filter: Delegate to converter<br/>(NO validation)
./ai_docs/Token_Authorization_Architecture.md:256:        Filter->>Filter: Generate SPM JWT
./ai_docs/Token_Authorization_Architecture.md:257:        Filter->>Backend: Forward with SPM JWT
./ai_docs/Token_Authorization_Architecture.md-258-        Backend-->>Client: Response
./ai_docs/Token_Authorization_Architecture.md-259-    else Validation Failure
--
./ai_docs/Token_Authorization_Architecture.md-265----
./ai_docs/Token_Authorization_Architecture.md-266-
./ai_docs/Token_Authorization_Architecture.md:267:## Design Patterns
./ai_docs/Token_Authorization_Architecture.md-268-
./ai_docs/Token_Authorization_Architecture.md-269-### 1. Strategy Pattern
--
./ai_docs/Token_Authorization_Architecture.md-272-- **Context:** `TokenAuthorizationManager`
./ai_docs/Token_Authorization_Architecture.md-273-- **Strategy Interface:** `TokenValidationStrategy`
./ai_docs/Token_Authorization_Architecture.md:274:- **Concrete Strategies:** `SapJwtValidationStrategy`, `SpmTokenValidationStrategy`, `UgwJwtValidationStrategy`
./ai_docs/Token_Authorization_Architecture.md-275-- **Benefit:** Open/Closed Principle - add new token types without modifying manager
./ai_docs/Token_Authorization_Architecture.md-276-
--
./ai_docs/Token_Authorization_Architecture.md-283-
./ai_docs/Token_Authorization_Architecture.md-284-### 3. Composite Pattern
./ai_docs/Token_Authorization_Architecture.md:285:**Applied to:** JWT verification (existing)
./ai_docs/Token_Authorization_Architecture.md-286-
./ai_docs/Token_Authorization_Architecture.md:287:- **Composite:** `JouleCompositeJwtVerifier`
./ai_docs/Token_Authorization_Architecture.md:288:- **Handles:** XSUAA and IAS JWT uniformly
./ai_docs/Token_Authorization_Architecture.md-289-- **Benefit:** Strategy doesn't need to know about XSUAA vs IAS
./ai_docs/Token_Authorization_Architecture.md-290-
./ai_docs/Token_Authorization_Architecture.md-291----
./ai_docs/Token_Authorization_Architecture.md-292-
./ai_docs/Token_Authorization_Architecture.md:293:## Integration with Spring Security
./ai_docs/Token_Authorization_Architecture.md-294-
./ai_docs/Token_Authorization_Architecture.md-295-### WebSecurityConfig Integration
--
./ai_docs/Token_Authorization_Architecture.md-301-    new OrServerWebExchangeMatcher(
./ai_docs/Token_Authorization_Architecture.md-302-        new PathPatternParserServerWebExchangeMatcher("/g/api/graphql"),
./ai_docs/Token_Authorization_Architecture.md:303:        new PathPatternParserServerWebExchangeMatcher("/g/api/graphql/active-features")))
./ai_docs/Token_Authorization_Architecture.md-304-.access(tokenAuthorizationManager)
./ai_docs/Token_Authorization_Architecture.md-305-```
--
./ai_docs/Token_Authorization_Architecture.md-312-
./ai_docs/Token_Authorization_Architecture.md-313-**Feature Flag Control:**
./ai_docs/Token_Authorization_Architecture.md:314:- TokenAuthorizationManager only active when `feature.unifiedJouleRoutes.enabled=true`
./ai_docs/Token_Authorization_Architecture.md-315-- When flag is OFF, uses legacy `JouleAuthorizationManager`
./ai_docs/Token_Authorization_Architecture.md-316-- Ensures zero regression and safe rollback
--
./ai_docs/Token_Authorization_Architecture.md-320-## Benefits
./ai_docs/Token_Authorization_Architecture.md-321-
./ai_docs/Token_Authorization_Architecture.md:322:### 1. Fail-Fast Security (for JWTs)
./ai_docs/Token_Authorization_Architecture.md:323:- Invalid JWT tokens (SAP JWT, UGW JWT) rejected at security boundary (before route matching)
./ai_docs/Token_Authorization_Architecture.md-324-- SPM tokens validated at filter layer (pass-through at security layer)
./ai_docs/Token_Authorization_Architecture.md:325:- No wasted processing on unauthorized JWT requests
./ai_docs/Token_Authorization_Architecture.md-326-- Clear security boundary
./ai_docs/Token_Authorization_Architecture.md-327-
--
./ai_docs/Token_Authorization_Architecture.md-337-
./ai_docs/Token_Authorization_Architecture.md-338-### 4. Maintainability
./ai_docs/Token_Authorization_Architecture.md:339:- JWT validation logic centralized in security layer
./ai_docs/Token_Authorization_Architecture.md-340-- SPM token validation centralized in FilterUtils (single source of truth)
./ai_docs/Token_Authorization_Architecture.md-341-- Filters convert tokens (single responsibility)
--
./ai_docs/Token_Authorization_Architecture.md-360----
./ai_docs/Token_Authorization_Architecture.md-361-
./ai_docs/Token_Authorization_Architecture.md:362:## Key Implementation Files
./ai_docs/Token_Authorization_Architecture.md-363-
./ai_docs/Token_Authorization_Architecture.md-364-| Component | Location |
./ai_docs/Token_Authorization_Architecture.md-365-|-----------|----------|
./ai_docs/Token_Authorization_Architecture.md:366:| TokenTypeDetector | `com.sap.bpi.api.gw.security.jwt.TokenTypeDetector` |
./ai_docs/Token_Authorization_Architecture.md:367:| TokenAuthorizationManager | `com.sap.bpi.api.gw.security.jwt.TokenAuthorizationManager` |
./ai_docs/Token_Authorization_Architecture.md:368:| TokenValidationStrategy | `com.sap.bpi.api.gw.security.jwt.strategy.TokenValidationStrategy` |
./ai_docs/Token_Authorization_Architecture.md:369:| SapJwtValidationStrategy | `com.sap.bpi.api.gw.security.jwt.strategy.SapJwtValidationStrategy` |
./ai_docs/Token_Authorization_Architecture.md:370:| SpmTokenValidationStrategy | `com.sap.bpi.api.gw.security.jwt.strategy.SpmTokenValidationStrategy` |
./ai_docs/Token_Authorization_Architecture.md:371:| UgwJwtValidationStrategy | `com.sap.bpi.api.gw.security.jwt.strategy.UgwJwtValidationStrategy` |
./ai_docs/Token_Authorization_Architecture.md:372:| TokenValidationResult | `com.sap.bpi.api.gw.security.jwt.strategy.TokenValidationResult` |
./ai_docs/Token_Authorization_Architecture.md:373:| UnifiedJwtConversionFilterFactory | `com.sap.bpi.api.gw.filters.UnifiedJwtConversionFilterFactory` |
./ai_docs/Token_Authorization_Architecture.md-374-| WebSecurityConfig | `com.sap.bpi.api.gw.security.WebSecurityConfig` |
./ai_docs/Token_Authorization_Architecture.md-375-
--
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml:1:apiVersion: canary.gateway.resource.api.sap/v1
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-2-type: GatewayRoutes
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-3-metadata:
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-4-  name: path-based-routing-test-routes
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml:5:  path: /sap/signavio/signavio-platform/path-based-routing-example/rg-path-based-routing-example
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-6-spec:
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-7-  gatewayRegistrationRef:
--
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-12-        path: /test
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-13-      target:
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml:14:        - domain: bpi-api-gw.eu-staging-cloud-os-eu.suite-saas-staging.signav.io
./unifiedGateway/path_routing_example/pbr_example_gatewayRoutes.yml-15-          path: /apigwservice/healthz
--
./scripts/als-v3-ca/generateCerts.sh-48-
./scripts/als-v3-ca/generateCerts.sh-49-# Prompt for confirmation
./scripts/als-v3-ca/generateCerts.sh:50:echo -e "The script will generate certificates for the following parameters: ${GREEN}${PARAMS[*]}${NC} in the $TARGET_ENV environment"
./scripts/als-v3-ca/generateCerts.sh-51-read -p "Do you want to continue? (y/n)" -n 1 -r
./scripts/als-v3-ca/generateCerts.sh-52-echo
--
./scripts/als-v3-ca/generateCerts.sh-57-
./scripts/als-v3-ca/generateCerts.sh-58-# Prompt for the root CA password
./scripts/als-v3-ca/generateCerts.sh:59:read -rsp "Enter the root CA password, it's only used during this script, will be deleted after:" ROOT_CA_PASSWORD
./scripts/als-v3-ca/generateCerts.sh-60-echo
./scripts/als-v3-ca/generateCerts.sh-61-
--
./scripts/als-v3-ca/generateCerts.sh-65-  mkdir -p "$TARGET_ENV/$param"
./scripts/als-v3-ca/generateCerts.sh-66-
./scripts/als-v3-ca/generateCerts.sh:67:  # Generate client.key
./scripts/als-v3-ca/generateCerts.sh:68:  openssl genrsa -out "$TARGET_ENV/$param/$param-client.key" 2048
./scripts/als-v3-ca/generateCerts.sh-69-
./scripts/als-v3-ca/generateCerts.sh:70:  # base64 the client.key file
./scripts/als-v3-ca/generateCerts.sh:71:  base64 -i "$TARGET_ENV/$param/$param-client.key" -o "$TARGET_ENV/$param/$param-client.key.b64"
./scripts/als-v3-ca/generateCerts.sh-72-
./scripts/als-v3-ca/generateCerts.sh:73:  # Generate client.csr, request file                                                                     
./scripts/als-v3-ca/generateCerts.sh:74:  openssl req -new -key "$TARGET_ENV/$param/$param-client.key" -out "$TARGET_ENV/$param/client.csr" -subj "/CN=ALSv3Client-$param/OU=APIGW/OU=Signavio/O=SAP/L=Walldorf/ST=Baden Wuerttemberg/C=DE"
./scripts/als-v3-ca/generateCerts.sh-75-
./scripts/als-v3-ca/generateCerts.sh:76:  # Generate client.crt (self-signed for simplicity)
./scripts/als-v3-ca/generateCerts.sh:77:  openssl x509 -req -in "$TARGET_ENV/$param/client.csr" -CA "$TARGET_ENV/root-ca.pem" -CAkey "$TARGET_ENV/root-ca.key" -out "$TARGET_ENV/$param/client.crt" -days 365 -extfile "$TARGET_ENV/client-ext.cnf" -extensions client_cert -passin pass:"$ROOT_CA_PASSWORD"
./scripts/als-v3-ca/generateCerts.sh-78-
./scripts/als-v3-ca/generateCerts.sh-79-  # base64 the client.crt file
./scripts/als-v3-ca/generateCerts.sh-80-  base64 -i "$TARGET_ENV/$param/client.crt" -o "$TARGET_ENV/$param/client.crt.b64"
./scripts/als-v3-ca/generateCerts.sh-81-
./scripts/als-v3-ca/generateCerts.sh:82:  echo -e "${GREEN}Generated${NC} files for ${GREEN}$param${NC} in ${GREEN}$TARGET_ENV/$param/${NC}\n"
./scripts/als-v3-ca/generateCerts.sh-83-done
./scripts/als-v3-ca/generateCerts.sh-84-
./scripts/als-v3-ca/generateCerts.sh:85:echo -e "${GREEN}Now you can put these key and cert in base64 encoding to secrets manager.${NC}"
./scripts/als-v3-ca/generateCerts.sh-86-
./scripts/als-v3-ca/generateCerts.sh-87-unset ROOT_CA_PASSWORD
--
./mock/mvnw-60-  Darwin*) darwin=true
./mock/mvnw-61-    # Use /usr/libexec/java_home if available, otherwise fall back to /Library/Java/Home
./mock/mvnw:62:    # See https://developer.apple.com/library/mac/qa/qa1170/_index.html
./mock/mvnw-63-    if [ -z "$JAVA_HOME" ]; then
./mock/mvnw-64-      if [ -x "/usr/libexec/java_home" ]; then
--
./mock/mvnw-81-  PRG="$0"
./mock/mvnw-82-
./mock/mvnw:83:  # need this for relative symlinks
./mock/mvnw-84-  while [ -h "$PRG" ] ; do
./mock/mvnw-85-    ls=`ls -ld "$PRG"`
--
./mock/mvnw-221-      jarUrl="https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
./mock/mvnw-222-    fi
./mock/mvnw:223:    while IFS="=" read key value; do
./mock/mvnw:224:      case "$key" in (wrapperUrl) jarUrl="$value"; break ;;
./mock/mvnw-225-      esac
./mock/mvnw-226-    done < "$BASE_DIR/.mvn/wrapper/maven-wrapper.properties"
--
./scripts/als-v3-ca/prod/client-ext.cnf-4-basicConstraints = CA:FALSE
./scripts/als-v3-ca/prod/client-ext.cnf-5-
./scripts/als-v3-ca/prod/client-ext.cnf:6:# Specify the allowed key usage: digital signature and key encipherment. Typical for mTLS usecase
./scripts/als-v3-ca/prod/client-ext.cnf:7:keyUsage = digitalSignature, keyEncipherment
./scripts/als-v3-ca/prod/client-ext.cnf-8-
./scripts/als-v3-ca/prod/client-ext.cnf:9:# Extended key usage: This makes the certificate valid for client authentication
./scripts/als-v3-ca/prod/client-ext.cnf:10:extendedKeyUsage = clientAuth
--
./ai_docs/development/development_core.md-9- **Wrong:**
./ai_docs/development/development_core.md-10-```java
./ai_docs/development/development_core.md:11:@org.springframework.boot.autoconfigure.condition.ConditionalOnProperty(
./ai_docs/development/development_core.md-12-    name = "feature.enabled",
./ai_docs/development/development_core.md-13-    havingValue = "true")
--
./ai_docs/development/development_core.md-17- **Correct:**
./ai_docs/development/development_core.md-18-```java
./ai_docs/development/development_core.md:19:import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
./ai_docs/development/development_core.md-20-
./ai_docs/development/development_core.md-21-@ConditionalOnProperty(name = "feature.enabled", havingValue = "true")
--
./ai_docs/development/development_core.md-26-- Maintains consistency with the rest of the codebase
./ai_docs/development/development_core.md-27-- Improves readability by reducing visual clutter
./ai_docs/development/development_core.md:28:- Simplifies refactoring when classes move to different packages
./ai_docs/development/development_core.md-29-- Follows standard Java conventions
./ai_docs/development/development_core.md-30-
./ai_docs/development/development_core.md-31-### Avoiding Code Duplication
./ai_docs/development/development_core.md-32-
./ai_docs/development/development_core.md:33:**Extract common logic into private helper methods or utility functions following the DRY (Don't Repeat Yourself) principle.**
./ai_docs/development/development_core.md-34-
./ai_docs/development/development_core.md-35-When multiple methods share similar logic or patterns, extract the common parts into well-named helper methods. This improves maintainability, reduces bugs, and makes the code more testable.
--
./ai_docs/development/development_core.md-39- **Wrong - Duplicated code:**
./ai_docs/development/development_core.md-40-```java
./ai_docs/development/development_core.md:41:public static boolean isUgwJwt(String token) {
./ai_docs/development/development_core.md-42-    if (token == null || token.trim().isEmpty()) {
./ai_docs/development/development_core.md-43-        return false;
--
./ai_docs/development/development_core.md-45-
./ai_docs/development/development_core.md-46-    try {
./ai_docs/development/development_core.md:47:        String payload = decodeJwtPayload(token);
./ai_docs/development/development_core.md-48-
./ai_docs/development/development_core.md-49-        // Extract issuer claim value - DUPLICATED LOGIC
--
./ai_docs/development/development_core.md-61-            return false;
./ai_docs/development/development_core.md-62-        }
./ai_docs/development/development_core.md:63:        String issuer = payload.substring(issValueStart, issValueEnd);
./ai_docs/development/development_core.md-64-
./ai_docs/development/development_core.md-65-        // Use issuer for UGW-specific check
./ai_docs/development/development_core.md:66:        return issuer.contains("bpi-api-gw") && issuer.endsWith("signav.io");
./ai_docs/development/development_core.md-67-    } catch (Exception e) {
./ai_docs/development/development_core.md-68-        return false;
--
./ai_docs/development/development_core.md-70-}
./ai_docs/development/development_core.md-71-
./ai_docs/development/development_core.md:72:public static boolean isIssuerFromBtp(String token) {
./ai_docs/development/development_core.md-73-    if (token == null || token.trim().isEmpty()) {
./ai_docs/development/development_core.md-74-        return false;
--
./ai_docs/development/development_core.md-76-
./ai_docs/development/development_core.md-77-    try {
./ai_docs/development/development_core.md:78:        String payload = decodeJwtPayload(token);
./ai_docs/development/development_core.md-79-
./ai_docs/development/development_core.md-80-        // Extract issuer claim value - SAME DUPLICATED LOGIC
--
./ai_docs/development/development_core.md-92-            return false;
./ai_docs/development/development_core.md-93-        }
./ai_docs/development/development_core.md:94:        String issuer = payload.substring(issValueStart, issValueEnd);
./ai_docs/development/development_core.md-95-
./ai_docs/development/development_core.md-96-        // Use issuer for BTP-specific check
--
./ai_docs/development/development_core.md-105-```java
./ai_docs/development/development_core.md-106-/**
./ai_docs/development/development_core.md:107: * Extracts the issuer claim ("iss") from a JWT token payload.
./ai_docs/development/development_core.md-108- *
./ai_docs/development/development_core.md:109: * @param payload The decoded JWT payload as a JSON string
./ai_docs/development/development_core.md-110- * @return Optional containing the issuer value if found, empty otherwise
./ai_docs/development/development_core.md-111- */
./ai_docs/development/development_core.md:112:private static Optional<String> extractIssuerFromPayload(String payload) {
./ai_docs/development/development_core.md-113-    try {
./ai_docs/development/development_core.md-114-        int issIndex = payload.indexOf("\"iss\"");
--
./ai_docs/development/development_core.md-128-        }
./ai_docs/development/development_core.md-129-
./ai_docs/development/development_core.md:130:        return Optional.of(payload.substring(issValueStart, issValueEnd));
./ai_docs/development/development_core.md-131-    } catch (Exception e) {
./ai_docs/development/development_core.md-132-        return Optional.empty();
--
./ai_docs/development/development_core.md-134-}
./ai_docs/development/development_core.md-135-
./ai_docs/development/development_core.md:136:public static boolean isUgwJwt(String token) {
./ai_docs/development/development_core.md-137-    if (token == null || token.trim().isEmpty()) {
./ai_docs/development/development_core.md-138-        return false;
--
./ai_docs/development/development_core.md-140-
./ai_docs/development/development_core.md-141-    try {
./ai_docs/development/development_core.md:142:        String payload = decodeJwtPayload(token);
./ai_docs/development/development_core.md:143:        Optional<String> issuerOpt = extractIssuerFromPayload(payload);
./ai_docs/development/development_core.md-144-
./ai_docs/development/development_core.md-145-        if (issuerOpt.isEmpty()) {
--
./ai_docs/development/development_core.md-147-        }
./ai_docs/development/development_core.md-148-
./ai_docs/development/development_core.md:149:        String issuer = issuerOpt.get();
./ai_docs/development/development_core.md:150:        String issuerWithoutProtocol = issuer.replaceFirst("^https?://", "");
./ai_docs/development/development_core.md:151:        return issuerWithoutProtocol.startsWith("bpi-api-gw") && issuer.endsWith("signav.io");
./ai_docs/development/development_core.md-152-    } catch (Exception e) {
./ai_docs/development/development_core.md-153-        return false;
--
./ai_docs/development/development_core.md-155-}
./ai_docs/development/development_core.md-156-
./ai_docs/development/development_core.md:157:public static boolean isIssuerFromBtp(String token) {
./ai_docs/development/development_core.md-158-    if (token == null || token.trim().isEmpty()) {
./ai_docs/development/development_core.md-159-        return false;
--
./ai_docs/development/development_core.md-161-
./ai_docs/development/development_core.md-162-    try {
./ai_docs/development/development_core.md:163:        String payload = decodeJwtPayload(token);
./ai_docs/development/development_core.md:164:        Optional<String> issuerOpt = extractIssuerFromPayload(payload);
./ai_docs/development/development_core.md-165-
./ai_docs/development/development_core.md-166-        if (issuerOpt.isEmpty()) {
--
./ai_docs/development/development_core.md-168-        }
./ai_docs/development/development_core.md-169-
./ai_docs/development/development_core.md:170:        String issuer = issuerOpt.get();
./ai_docs/development/development_core.md-171-        java.net.URL url = new java.net.URL(issuer);
./ai_docs/development/development_core.md-172-        return url.getHost().endsWith("ondemand.com");
--
./ai_docs/development/development_core.md-182-- **Improved Readability**: Each method focuses on its specific validation logic, making the intent clearer
./ai_docs/development/development_core.md-183-- **Reduced Maintenance**: Changes to the parsing logic only need to be made once
./ai_docs/development/development_core.md:184:- **Type Safety**: Using `Optional<String>` makes the absence of a value explicit and prevents null pointer exceptions
./ai_docs/development/development_core.md-185-
./ai_docs/development/development_core.md-186-**When to Extract:**
--
./ai_docs/development/development_core.md-191-
./ai_docs/development/development_core.md-192-**Real Example from Codebase:**
./ai_docs/development/development_core.md:193:See `JwtUtils.java:161-186` for the `extractIssuerFromPayload()` method that eliminated duplication between `isUgwJwt()` and `isIssuerFromBtp()` methods.
./ai_docs/development/development_core.md-194-
./ai_docs/development/development_core.md-195-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-3-## Overview
./ai_docs/Redis_Caching_Architecture_Guide.md-4-
./ai_docs/Redis_Caching_Architecture_Guide.md:5:This guide provides comprehensive documentation for the Redis caching architecture implemented in the BPI API Gateway. The system uses a generic, type-safe approach that replaced 3 specific Redis services with 1 extensible `GenericRedisService<T>` plus utility classes.
./ai_docs/Redis_Caching_Architecture_Guide.md-6-
./ai_docs/Redis_Caching_Architecture_Guide.md-7-## Architecture Components
--
./ai_docs/Redis_Caching_Architecture_Guide.md-10-**Location**: `com.sap.bpi.api.gw.caching.GenericRedisService`
./ai_docs/Redis_Caching_Architecture_Guide.md-11-
./ai_docs/Redis_Caching_Architecture_Guide.md:12:The core generic Redis service that provides type-safe operations for any data type.
./ai_docs/Redis_Caching_Architecture_Guide.md-13-
./ai_docs/Redis_Caching_Architecture_Guide.md-14-```java
./ai_docs/Redis_Caching_Architecture_Guide.md-15-@Service
./ai_docs/Redis_Caching_Architecture_Guide.md-16-public class GenericRedisService<T> {
./ai_docs/Redis_Caching_Architecture_Guide.md:17:    private final ReactiveRedisOperations<String, T> operations;
./ai_docs/Redis_Caching_Architecture_Guide.md-18-
./ai_docs/Redis_Caching_Architecture_Guide.md:19:    public Mono<T> get(String key)
./ai_docs/Redis_Caching_Architecture_Guide.md:20:    public Mono<Boolean> set(String key, T value, Duration ttl)
./ai_docs/Redis_Caching_Architecture_Guide.md-21-}
./ai_docs/Redis_Caching_Architecture_Guide.md-22-```
./ai_docs/Redis_Caching_Architecture_Guide.md-23-
./ai_docs/Redis_Caching_Architecture_Guide.md:24:**Key Features**:
./ai_docs/Redis_Caching_Architecture_Guide.md-25-- **Type Safety**: Generic type parameter ensures compile-time type checking
./ai_docs/Redis_Caching_Architecture_Guide.md:26:- **Reactive**: Uses Spring WebFlux reactive patterns with `Mono`
./ai_docs/Redis_Caching_Architecture_Guide.md-27-- **TTL Support**: Automatic expiration with `Duration`
./ai_docs/Redis_Caching_Architecture_Guide.md:28:- **Bulk Operations**: Delete multiple keys at once
./ai_docs/Redis_Caching_Architecture_Guide.md-29-
./ai_docs/Redis_Caching_Architecture_Guide.md:30:### 2. RedisKeyUtils
./ai_docs/Redis_Caching_Architecture_Guide.md:31:**Location**: `com.sap.bpi.api.gw.caching.RedisKeyUtils`
./ai_docs/Redis_Caching_Architecture_Guide.md-32-
./ai_docs/Redis_Caching_Architecture_Guide.md:33:Centralized key generation utilities with consistent naming and hashing.
./ai_docs/Redis_Caching_Architecture_Guide.md-34-
./ai_docs/Redis_Caching_Architecture_Guide.md-35-```java
./ai_docs/Redis_Caching_Architecture_Guide.md-36-@Component
./ai_docs/Redis_Caching_Architecture_Guide.md:37:public class RedisKeyUtils {
./ai_docs/Redis_Caching_Architecture_Guide.md:38:    // Key prefixes
./ai_docs/Redis_Caching_Architecture_Guide.md:39:    public static final String SPM_USER_PREFIX = "spm-user::";
./ai_docs/Redis_Caching_Architecture_Guide.md:40:    public static final String XSUAA_JWT_PREFIX = "xsuaa-jwt::";
./ai_docs/Redis_Caching_Architecture_Guide.md:41:    public static final String PUBLIC_KEYS_KEY = "publicKeys";
./ai_docs/Redis_Caching_Architecture_Guide.md-42-
./ai_docs/Redis_Caching_Architecture_Guide.md:43:    // Key generation methods
./ai_docs/Redis_Caching_Architecture_Guide.md:44:    public String createSpmUserKey(String xSignavioId, String jSessionId, String clientIp, String featureSets)
./ai_docs/Redis_Caching_Architecture_Guide.md:45:    public String createXsuaaJwtKey(String sessionId)
./ai_docs/Redis_Caching_Architecture_Guide.md:46:    public String hashString(String input) // SHA-256 hashing
./ai_docs/Redis_Caching_Architecture_Guide.md-47-}
./ai_docs/Redis_Caching_Architecture_Guide.md-48-```
./ai_docs/Redis_Caching_Architecture_Guide.md-49-
./ai_docs/Redis_Caching_Architecture_Guide.md:50:**Key Features**:
./ai_docs/Redis_Caching_Architecture_Guide.md-51-- **Consistent Naming**: Standardized prefixes and patterns
./ai_docs/Redis_Caching_Architecture_Guide.md:52:- **Secure Hashing**: SHA-256 for sensitive data
./ai_docs/Redis_Caching_Architecture_Guide.md:53:- **Collision Prevention**: Unique key generation for complex parameters
./ai_docs/Redis_Caching_Architecture_Guide.md-54-
./ai_docs/Redis_Caching_Architecture_Guide.md-55-### 3. GenericRedisConfiguration
./ai_docs/Redis_Caching_Architecture_Guide.md-56-**Location**: `com.sap.bpi.api.gw.configuration.GenericRedisConfiguration`
./ai_docs/Redis_Caching_Architecture_Guide.md-57-
./ai_docs/Redis_Caching_Architecture_Guide.md:58:Spring configuration that creates typed beans for different data types.
./ai_docs/Redis_Caching_Architecture_Guide.md-59-
./ai_docs/Redis_Caching_Architecture_Guide.md-60-```java
--
./ai_docs/Redis_Caching_Architecture_Guide.md-63-public class GenericRedisConfiguration {
./ai_docs/Redis_Caching_Architecture_Guide.md-64-    @Bean
./ai_docs/Redis_Caching_Architecture_Guide.md:65:    GenericRedisService<SpmUser> spmUserRedisService(ReactiveRedisOperations<String, SpmUser> ops)
./ai_docs/Redis_Caching_Architecture_Guide.md-66-
./ai_docs/Redis_Caching_Architecture_Guide.md-67-    @Bean
./ai_docs/Redis_Caching_Architecture_Guide.md:68:    GenericRedisService<PublicKeyListDto> publicKeyRedisService(ReactiveRedisOperations<String, PublicKeyListDto> ops)
./ai_docs/Redis_Caching_Architecture_Guide.md-69-
./ai_docs/Redis_Caching_Architecture_Guide.md-70-    @Bean
./ai_docs/Redis_Caching_Architecture_Guide.md:71:    GenericRedisService<String> stringRedisService(ReactiveRedisOperations<String, String> ops)
./ai_docs/Redis_Caching_Architecture_Guide.md-72-}
./ai_docs/Redis_Caching_Architecture_Guide.md-73-```
./ai_docs/Redis_Caching_Architecture_Guide.md-74-
./ai_docs/Redis_Caching_Architecture_Guide.md:75:**Key Features**:
./ai_docs/Redis_Caching_Architecture_Guide.md-76-- **Conditional Loading**: Only enabled when `redis.enabled=true`
./ai_docs/Redis_Caching_Architecture_Guide.md-77-- **Typed Beans**: Separate beans for each data type
./ai_docs/Redis_Caching_Architecture_Guide.md:78:- **Dependency Injection**: Automatic wiring based on type
./ai_docs/Redis_Caching_Architecture_Guide.md-79-
./ai_docs/Redis_Caching_Architecture_Guide.md-80-## How Caching Works
--
./ai_docs/Redis_Caching_Architecture_Guide.md-87-// 1. Try to get from cache
./ai_docs/Redis_Caching_Architecture_Guide.md-88-Mono<DataType> cachedData = Mono.empty();
./ai_docs/Redis_Caching_Architecture_Guide.md:89:if (redisService != null && redisKeyUtils != null) {
./ai_docs/Redis_Caching_Architecture_Guide.md:90:    String redisKey = redisKeyUtils.createKey(parameters...);
./ai_docs/Redis_Caching_Architecture_Guide.md:91:    cachedData = redisService.get(redisKey);
./ai_docs/Redis_Caching_Architecture_Guide.md-92-}
./ai_docs/Redis_Caching_Architecture_Guide.md-93-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-99-            .flatMap(data -> {
./ai_docs/Redis_Caching_Architecture_Guide.md-100-                // 3. Save to cache for next time
./ai_docs/Redis_Caching_Architecture_Guide.md:101:                if (redisService != null && redisKeyUtils != null) {
./ai_docs/Redis_Caching_Architecture_Guide.md:102:                    String redisKey = redisKeyUtils.createKey(parameters...);
./ai_docs/Redis_Caching_Architecture_Guide.md:103:                    return redisService.set(redisKey, data, ttl)
./ai_docs/Redis_Caching_Architecture_Guide.md-104-                        .thenReturn(data);
./ai_docs/Redis_Caching_Architecture_Guide.md-105-                }
--
./ai_docs/Redis_Caching_Architecture_Guide.md-116-```java
./ai_docs/Redis_Caching_Architecture_Guide.md-117-// Null checks ensure graceful degradation
./ai_docs/Redis_Caching_Architecture_Guide.md:118:if (redisService != null && redisKeyUtils != null) {
./ai_docs/Redis_Caching_Architecture_Guide.md-119-    // Redis operations
./ai_docs/Redis_Caching_Architecture_Guide.md-120-} else {
--
./ai_docs/Redis_Caching_Architecture_Guide.md-128-
./ai_docs/Redis_Caching_Architecture_Guide.md-129-- **SPM Users**: 30 minutes (configurable)
./ai_docs/Redis_Caching_Architecture_Guide.md:130:- **Public Keys**: 30 days
./ai_docs/Redis_Caching_Architecture_Guide.md:131:- **XSUAA JWTs**: Based on JWT expiry time
./ai_docs/Redis_Caching_Architecture_Guide.md-132-- **Custom Caches**: Application-specific TTL
./ai_docs/Redis_Caching_Architecture_Guide.md-133-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-141-@ExtendWith(MockitoExtension.class)
./ai_docs/Redis_Caching_Architecture_Guide.md-142-class ServiceTest {
./ai_docs/Redis_Caching_Architecture_Guide.md:143:    @Mock private GenericRedisService<DataType> redisService;
./ai_docs/Redis_Caching_Architecture_Guide.md:144:    @Mock private RedisKeyUtils redisKeyUtils;
./ai_docs/Redis_Caching_Architecture_Guide.md:145:    @Mock private DataSource dataSource;
./ai_docs/Redis_Caching_Architecture_Guide.md-146-
./ai_docs/Redis_Caching_Architecture_Guide.md:147:    private ServiceUnderTest service;
./ai_docs/Redis_Caching_Architecture_Guide.md-148-
./ai_docs/Redis_Caching_Architecture_Guide.md-149-    @BeforeEach
./ai_docs/Redis_Caching_Architecture_Guide.md-150-    void setUp() {
./ai_docs/Redis_Caching_Architecture_Guide.md:151:        service = new ServiceUnderTest(redisService, redisKeyUtils, dataSource);
./ai_docs/Redis_Caching_Architecture_Guide.md-152-    }
./ai_docs/Redis_Caching_Architecture_Guide.md-153-}
--
./ai_docs/Redis_Caching_Architecture_Guide.md-159-@Test
./ai_docs/Redis_Caching_Architecture_Guide.md-160-void whenCacheHit_usesCachedDataAndSkipsDataSource() {
./ai_docs/Redis_Caching_Architecture_Guide.md:161:    // Given - setup cache hit
./ai_docs/Redis_Caching_Architecture_Guide.md:162:    when(redisKeyUtils.createKey(anyString(), anyString()))
./ai_docs/Redis_Caching_Architecture_Guide.md:163:        .thenReturn("test-key");
./ai_docs/Redis_Caching_Architecture_Guide.md:164:    when(redisService.get("test-key"))
./ai_docs/Redis_Caching_Architecture_Guide.md-165-        .thenReturn(Mono.just(expectedData));
./ai_docs/Redis_Caching_Architecture_Guide.md-166-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-171-    StepVerifier.create(result)
./ai_docs/Redis_Caching_Architecture_Guide.md-172-        .expectNext(expectedData)
./ai_docs/Redis_Caching_Architecture_Guide.md:173:        .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-174-
./ai_docs/Redis_Caching_Architecture_Guide.md:175:    verify(redisKeyUtils).createKey(anyString(), anyString());
./ai_docs/Redis_Caching_Architecture_Guide.md:176:    verify(redisService).get("test-key");
./ai_docs/Redis_Caching_Architecture_Guide.md:177:    verify(dataSource, never()).fetchData(any());
./ai_docs/Redis_Caching_Architecture_Guide.md-178-}
./ai_docs/Redis_Caching_Architecture_Guide.md-179-```
--
./ai_docs/Redis_Caching_Architecture_Guide.md-184-@Test
./ai_docs/Redis_Caching_Architecture_Guide.md-185-void whenCacheMiss_fetchesFromDataSourceAndCaches() {
./ai_docs/Redis_Caching_Architecture_Guide.md:186:    // Given - setup cache miss
./ai_docs/Redis_Caching_Architecture_Guide.md:187:    when(redisKeyUtils.createKey(anyString(), anyString()))
./ai_docs/Redis_Caching_Architecture_Guide.md:188:        .thenReturn("test-key");
./ai_docs/Redis_Caching_Architecture_Guide.md:189:    when(redisService.get("test-key"))
./ai_docs/Redis_Caching_Architecture_Guide.md-190-        .thenReturn(Mono.empty()); // Cache miss
./ai_docs/Redis_Caching_Architecture_Guide.md-191-    when(dataSource.fetchData(parameters))
./ai_docs/Redis_Caching_Architecture_Guide.md-192-        .thenReturn(Mono.just(sourceData));
./ai_docs/Redis_Caching_Architecture_Guide.md:193:    when(redisService.set(anyString(), any(DataType.class), any(Duration.class)))
./ai_docs/Redis_Caching_Architecture_Guide.md-194-        .thenReturn(Mono.just(true));
./ai_docs/Redis_Caching_Architecture_Guide.md-195-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-200-    StepVerifier.create(result)
./ai_docs/Redis_Caching_Architecture_Guide.md-201-        .expectNext(sourceData)
./ai_docs/Redis_Caching_Architecture_Guide.md:202:        .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-203-
./ai_docs/Redis_Caching_Architecture_Guide.md:204:    verify(redisKeyUtils, times(2)).createKey(anyString(), anyString()); // get + set
./ai_docs/Redis_Caching_Architecture_Guide.md:205:    verify(redisService).get("test-key");
./ai_docs/Redis_Caching_Architecture_Guide.md:206:    verify(dataSource).fetchData(parameters);
./ai_docs/Redis_Caching_Architecture_Guide.md:207:    verify(redisService).set(anyString(), any(DataType.class), any(Duration.class));
./ai_docs/Redis_Caching_Architecture_Guide.md-208-}
./ai_docs/Redis_Caching_Architecture_Guide.md-209-```
--
./ai_docs/Redis_Caching_Architecture_Guide.md-214-@Test
./ai_docs/Redis_Caching_Architecture_Guide.md-215-void whenRedisDisabled_goesDirectlyToDataSource() {
./ai_docs/Redis_Caching_Architecture_Guide.md:216:    // Given - Redis disabled (null services)
./ai_docs/Redis_Caching_Architecture_Guide.md-217-    service = new ServiceUnderTest(null, null, dataSource);
./ai_docs/Redis_Caching_Architecture_Guide.md-218-    when(dataSource.fetchData(parameters))
--
./ai_docs/Redis_Caching_Architecture_Guide.md-225-    StepVerifier.create(result)
./ai_docs/Redis_Caching_Architecture_Guide.md-226-        .expectNext(sourceData)
./ai_docs/Redis_Caching_Architecture_Guide.md:227:        .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-228-
./ai_docs/Redis_Caching_Architecture_Guide.md:229:    verify(dataSource).fetchData(parameters);
./ai_docs/Redis_Caching_Architecture_Guide.md:230:    verifyNoInteractions(redisService, redisKeyUtils);
./ai_docs/Redis_Caching_Architecture_Guide.md-231-}
./ai_docs/Redis_Caching_Architecture_Guide.md-232-```
--
./ai_docs/Redis_Caching_Architecture_Guide.md-241-@JsonInclude(JsonInclude.Include.NON_NULL)
./ai_docs/Redis_Caching_Architecture_Guide.md-242-public record CustomerDto(
./ai_docs/Redis_Caching_Architecture_Guide.md:243:    String customerId,
./ai_docs/Redis_Caching_Architecture_Guide.md:244:    String name,
./ai_docs/Redis_Caching_Architecture_Guide.md:245:    String email,
./ai_docs/Redis_Caching_Architecture_Guide.md:246:    List<String> permissions,
./ai_docs/Redis_Caching_Architecture_Guide.md-247-    Instant lastLoginTime
./ai_docs/Redis_Caching_Architecture_Guide.md-248-) {}
--
./ai_docs/Redis_Caching_Architecture_Guide.md-257-@ConditionalOnProperty(name = "redis.enabled", havingValue = "true")
./ai_docs/Redis_Caching_Architecture_Guide.md-258-public GenericRedisService<CustomerDto> customerRedisService(
./ai_docs/Redis_Caching_Architecture_Guide.md:259:    ReactiveRedisOperations<String, CustomerDto> operations) {
./ai_docs/Redis_Caching_Architecture_Guide.md-260-    return new GenericRedisService<>(operations);
./ai_docs/Redis_Caching_Architecture_Guide.md-261-}
./ai_docs/Redis_Caching_Architecture_Guide.md-262-```
./ai_docs/Redis_Caching_Architecture_Guide.md-263-
./ai_docs/Redis_Caching_Architecture_Guide.md:264:### Step 3: Add Key Generation Method
./ai_docs/Redis_Caching_Architecture_Guide.md-265-
./ai_docs/Redis_Caching_Architecture_Guide.md:266:Add key generation logic to `RedisKeyUtils.java`:
./ai_docs/Redis_Caching_Architecture_Guide.md-267-
./ai_docs/Redis_Caching_Architecture_Guide.md-268-```java
./ai_docs/Redis_Caching_Architecture_Guide.md:269:public class RedisKeyUtils {
./ai_docs/Redis_Caching_Architecture_Guide.md:270:    public static final String CUSTOMER_PREFIX = "customer::";
./ai_docs/Redis_Caching_Architecture_Guide.md-271-
./ai_docs/Redis_Caching_Architecture_Guide.md:272:    public String createCustomerKey(String customerId, String tenantId) {
./ai_docs/Redis_Caching_Architecture_Guide.md:273:        String keyData = String.format("%s::%s", customerId, tenantId);
./ai_docs/Redis_Caching_Architecture_Guide.md:274:        return CUSTOMER_PREFIX + hashString(keyData);
./ai_docs/Redis_Caching_Architecture_Guide.md-275-    }
./ai_docs/Redis_Caching_Architecture_Guide.md-276-}
--
./ai_docs/Redis_Caching_Architecture_Guide.md-284-@Service
./ai_docs/Redis_Caching_Architecture_Guide.md-285-public class CustomerService {
./ai_docs/Redis_Caching_Architecture_Guide.md:286:    private final GenericRedisService<CustomerDto> customerRedisService;
./ai_docs/Redis_Caching_Architecture_Guide.md:287:    private final RedisKeyUtils redisKeyUtils;
./ai_docs/Redis_Caching_Architecture_Guide.md:288:    private final CustomerDataSource customerDataSource;
./ai_docs/Redis_Caching_Architecture_Guide.md-289-
./ai_docs/Redis_Caching_Architecture_Guide.md-290-    @Autowired
./ai_docs/Redis_Caching_Architecture_Guide.md-291-    public CustomerService(
./ai_docs/Redis_Caching_Architecture_Guide.md-292-        @Autowired(required = false) GenericRedisService<CustomerDto> customerRedisService,
./ai_docs/Redis_Caching_Architecture_Guide.md:293:        @Autowired(required = false) RedisKeyUtils redisKeyUtils,
./ai_docs/Redis_Caching_Architecture_Guide.md-294-        CustomerDataSource customerDataSource) {
./ai_docs/Redis_Caching_Architecture_Guide.md-295-        this.customerRedisService = customerRedisService;
./ai_docs/Redis_Caching_Architecture_Guide.md:296:        this.redisKeyUtils = redisKeyUtils;
./ai_docs/Redis_Caching_Architecture_Guide.md-297-        this.customerDataSource = customerDataSource;
./ai_docs/Redis_Caching_Architecture_Guide.md-298-    }
./ai_docs/Redis_Caching_Architecture_Guide.md-299-
./ai_docs/Redis_Caching_Architecture_Guide.md:300:    public Mono<CustomerDto> getCustomer(String customerId, String tenantId) {
./ai_docs/Redis_Caching_Architecture_Guide.md-301-        // Try cache first
./ai_docs/Redis_Caching_Architecture_Guide.md-302-        Mono<CustomerDto> cachedCustomer = Mono.empty();
./ai_docs/Redis_Caching_Architecture_Guide.md:303:        if (customerRedisService != null && redisKeyUtils != null) {
./ai_docs/Redis_Caching_Architecture_Guide.md:304:            String redisKey = redisKeyUtils.createCustomerKey(customerId, tenantId);
./ai_docs/Redis_Caching_Architecture_Guide.md:305:            cachedCustomer = customerRedisService.get(redisKey);
./ai_docs/Redis_Caching_Architecture_Guide.md-306-        }
./ai_docs/Redis_Caching_Architecture_Guide.md-307-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-313-                    .flatMap(customer -> {
./ai_docs/Redis_Caching_Architecture_Guide.md-314-                        // Cache the result
./ai_docs/Redis_Caching_Architecture_Guide.md:315:                        if (customerRedisService != null && redisKeyUtils != null) {
./ai_docs/Redis_Caching_Architecture_Guide.md:316:                            String redisKey = redisKeyUtils.createCustomerKey(customerId, tenantId);
./ai_docs/Redis_Caching_Architecture_Guide.md-317-                            Duration ttl = Duration.ofMinutes(15); // 15 minute TTL
./ai_docs/Redis_Caching_Architecture_Guide.md:318:                            return customerRedisService.set(redisKey, customer, ttl)
./ai_docs/Redis_Caching_Architecture_Guide.md-319-                                .thenReturn(customer);
./ai_docs/Redis_Caching_Architecture_Guide.md-320-                        }
--
./ai_docs/Redis_Caching_Architecture_Guide.md-325-    }
./ai_docs/Redis_Caching_Architecture_Guide.md-326-
./ai_docs/Redis_Caching_Architecture_Guide.md:327:    public Mono<Void> invalidateCustomer(String customerId, String tenantId) {
./ai_docs/Redis_Caching_Architecture_Guide.md:328:        if (customerRedisService != null && redisKeyUtils != null) {
./ai_docs/Redis_Caching_Architecture_Guide.md:329:            String redisKey = redisKeyUtils.createCustomerKey(customerId, tenantId);
./ai_docs/Redis_Caching_Architecture_Guide.md:330:            return customerRedisService.delete(redisKey).then();
./ai_docs/Redis_Caching_Architecture_Guide.md-331-        }
./ai_docs/Redis_Caching_Architecture_Guide.md-332-        return Mono.empty();
--
./ai_docs/Redis_Caching_Architecture_Guide.md-335-```
./ai_docs/Redis_Caching_Architecture_Guide.md-336-
./ai_docs/Redis_Caching_Architecture_Guide.md:337:### Step 5: Write Comprehensive Tests
./ai_docs/Redis_Caching_Architecture_Guide.md-338-
./ai_docs/Redis_Caching_Architecture_Guide.md-339-Create test class `CustomerServiceTest.java`:
--
./ai_docs/Redis_Caching_Architecture_Guide.md-344-class CustomerServiceTest {
./ai_docs/Redis_Caching_Architecture_Guide.md-345-
./ai_docs/Redis_Caching_Architecture_Guide.md:346:    private static final String CUSTOMER_ID = "cust-123";
./ai_docs/Redis_Caching_Architecture_Guide.md:347:    private static final String TENANT_ID = "tenant-456";
./ai_docs/Redis_Caching_Architecture_Guide.md:348:    private static final String REDIS_KEY = "customer::hashed-key";
./ai_docs/Redis_Caching_Architecture_Guide.md:349:    private static final CustomerDto EXPECTED_CUSTOMER = new CustomerDto(
./ai_docs/Redis_Caching_Architecture_Guide.md-350-        CUSTOMER_ID, "John Doe", "john@example.com",
./ai_docs/Redis_Caching_Architecture_Guide.md-351-        List.of("READ", "WRITE"), Instant.now()
./ai_docs/Redis_Caching_Architecture_Guide.md-352-    );
./ai_docs/Redis_Caching_Architecture_Guide.md-353-
./ai_docs/Redis_Caching_Architecture_Guide.md:354:    @Mock private GenericRedisService<CustomerDto> customerRedisService;
./ai_docs/Redis_Caching_Architecture_Guide.md:355:    @Mock private RedisKeyUtils redisKeyUtils;
./ai_docs/Redis_Caching_Architecture_Guide.md:356:    @Mock private CustomerDataSource customerDataSource;
./ai_docs/Redis_Caching_Architecture_Guide.md-357-
./ai_docs/Redis_Caching_Architecture_Guide.md:358:    private CustomerService customerService;
./ai_docs/Redis_Caching_Architecture_Guide.md-359-
./ai_docs/Redis_Caching_Architecture_Guide.md-360-    @BeforeEach
./ai_docs/Redis_Caching_Architecture_Guide.md-361-    void setUp() {
./ai_docs/Redis_Caching_Architecture_Guide.md-362-        customerService = new CustomerService(
./ai_docs/Redis_Caching_Architecture_Guide.md:363:            customerRedisService, redisKeyUtils, customerDataSource
./ai_docs/Redis_Caching_Architecture_Guide.md-364-        );
./ai_docs/Redis_Caching_Architecture_Guide.md-365-    }
--
./ai_docs/Redis_Caching_Architecture_Guide.md-371-        @Test
./ai_docs/Redis_Caching_Architecture_Guide.md-372-        @DisplayName("Should return cached customer and skip data source")
./ai_docs/Redis_Caching_Architecture_Guide.md:373:        void whenCacheHit_returnsCachedCustomerAndSkipsDataSource() {
./ai_docs/Redis_Caching_Architecture_Guide.md:374:            // Given
./ai_docs/Redis_Caching_Architecture_Guide.md-375-            setupCacheHitMocks();
./ai_docs/Redis_Caching_Architecture_Guide.md-376-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-381-            StepVerifier.create(result)
./ai_docs/Redis_Caching_Architecture_Guide.md-382-                .expectNext(EXPECTED_CUSTOMER)
./ai_docs/Redis_Caching_Architecture_Guide.md:383:                .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-384-
./ai_docs/Redis_Caching_Architecture_Guide.md:385:            verify(redisKeyUtils).createCustomerKey(CUSTOMER_ID, TENANT_ID);
./ai_docs/Redis_Caching_Architecture_Guide.md:386:            verify(customerRedisService).get(REDIS_KEY);
./ai_docs/Redis_Caching_Architecture_Guide.md:387:            verify(customerDataSource, never()).fetchCustomer(any(), any());
./ai_docs/Redis_Caching_Architecture_Guide.md-388-        }
./ai_docs/Redis_Caching_Architecture_Guide.md-389-    }
--
./ai_docs/Redis_Caching_Architecture_Guide.md-396-        @DisplayName("Should fetch from data source and cache result")
./ai_docs/Redis_Caching_Architecture_Guide.md-397-        void whenCacheMiss_fetchesFromDataSourceAndCaches() {
./ai_docs/Redis_Caching_Architecture_Guide.md:398:            // Given
./ai_docs/Redis_Caching_Architecture_Guide.md-399-            setupCacheMissMocks();
./ai_docs/Redis_Caching_Architecture_Guide.md-400-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-405-            StepVerifier.create(result)
./ai_docs/Redis_Caching_Architecture_Guide.md-406-                .expectNext(EXPECTED_CUSTOMER)
./ai_docs/Redis_Caching_Architecture_Guide.md:407:                .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-408-
./ai_docs/Redis_Caching_Architecture_Guide.md:409:            verify(redisKeyUtils, times(2)).createCustomerKey(CUSTOMER_ID, TENANT_ID);
./ai_docs/Redis_Caching_Architecture_Guide.md:410:            verify(customerRedisService).get(REDIS_KEY);
./ai_docs/Redis_Caching_Architecture_Guide.md:411:            verify(customerDataSource).fetchCustomer(CUSTOMER_ID, TENANT_ID);
./ai_docs/Redis_Caching_Architecture_Guide.md:412:            verify(customerRedisService).set(eq(REDIS_KEY), eq(EXPECTED_CUSTOMER), any(Duration.class));
./ai_docs/Redis_Caching_Architecture_Guide.md-413-        }
./ai_docs/Redis_Caching_Architecture_Guide.md-414-    }
--
./ai_docs/Redis_Caching_Architecture_Guide.md-421-        @DisplayName("Should work normally when Redis is disabled")
./ai_docs/Redis_Caching_Architecture_Guide.md-422-        void whenRedisDisabled_goesDirectlyToDataSource() {
./ai_docs/Redis_Caching_Architecture_Guide.md:423:            // Given - Redis disabled
./ai_docs/Redis_Caching_Architecture_Guide.md-424-            customerService = new CustomerService(null, null, customerDataSource);
./ai_docs/Redis_Caching_Architecture_Guide.md-425-            when(customerDataSource.fetchCustomer(CUSTOMER_ID, TENANT_ID))
--
./ai_docs/Redis_Caching_Architecture_Guide.md-432-            StepVerifier.create(result)
./ai_docs/Redis_Caching_Architecture_Guide.md-433-                .expectNext(EXPECTED_CUSTOMER)
./ai_docs/Redis_Caching_Architecture_Guide.md:434:                .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-435-
./ai_docs/Redis_Caching_Architecture_Guide.md:436:            verify(customerDataSource).fetchCustomer(CUSTOMER_ID, TENANT_ID);
./ai_docs/Redis_Caching_Architecture_Guide.md:437:            verifyNoInteractions(customerRedisService, redisKeyUtils);
./ai_docs/Redis_Caching_Architecture_Guide.md-438-        }
./ai_docs/Redis_Caching_Architecture_Guide.md-439-    }
--
./ai_docs/Redis_Caching_Architecture_Guide.md-446-        @DisplayName("Should invalidate customer cache")
./ai_docs/Redis_Caching_Architecture_Guide.md-447-        void shouldInvalidateCustomerCache() {
./ai_docs/Redis_Caching_Architecture_Guide.md:448:            // Given
./ai_docs/Redis_Caching_Architecture_Guide.md:449:            when(redisKeyUtils.createCustomerKey(CUSTOMER_ID, TENANT_ID))
./ai_docs/Redis_Caching_Architecture_Guide.md:450:                .thenReturn(REDIS_KEY);
./ai_docs/Redis_Caching_Architecture_Guide.md:451:            when(customerRedisService.delete(REDIS_KEY))
./ai_docs/Redis_Caching_Architecture_Guide.md-452-                .thenReturn(Mono.just(1L));
./ai_docs/Redis_Caching_Architecture_Guide.md-453-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-457-            // Then
./ai_docs/Redis_Caching_Architecture_Guide.md-458-            StepVerifier.create(result)
./ai_docs/Redis_Caching_Architecture_Guide.md:459:                .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-460-
./ai_docs/Redis_Caching_Architecture_Guide.md:461:            verify(redisKeyUtils).createCustomerKey(CUSTOMER_ID, TENANT_ID);
./ai_docs/Redis_Caching_Architecture_Guide.md:462:            verify(customerRedisService).delete(REDIS_KEY);
./ai_docs/Redis_Caching_Architecture_Guide.md-463-        }
./ai_docs/Redis_Caching_Architecture_Guide.md-464-    }
./ai_docs/Redis_Caching_Architecture_Guide.md-465-
./ai_docs/Redis_Caching_Architecture_Guide.md-466-    // Helper Methods
./ai_docs/Redis_Caching_Architecture_Guide.md:467:    private void setupCacheHitMocks() {
./ai_docs/Redis_Caching_Architecture_Guide.md:468:        when(redisKeyUtils.createCustomerKey(CUSTOMER_ID, TENANT_ID))
./ai_docs/Redis_Caching_Architecture_Guide.md:469:            .thenReturn(REDIS_KEY);
./ai_docs/Redis_Caching_Architecture_Guide.md:470:        when(customerRedisService.get(REDIS_KEY))
./ai_docs/Redis_Caching_Architecture_Guide.md-471-            .thenReturn(Mono.just(EXPECTED_CUSTOMER));
./ai_docs/Redis_Caching_Architecture_Guide.md-472-    }
./ai_docs/Redis_Caching_Architecture_Guide.md-473-
./ai_docs/Redis_Caching_Architecture_Guide.md:474:    private void setupCacheMissMocks() {
./ai_docs/Redis_Caching_Architecture_Guide.md:475:        when(redisKeyUtils.createCustomerKey(CUSTOMER_ID, TENANT_ID))
./ai_docs/Redis_Caching_Architecture_Guide.md:476:            .thenReturn(REDIS_KEY);
./ai_docs/Redis_Caching_Architecture_Guide.md:477:        when(customerRedisService.get(REDIS_KEY))
./ai_docs/Redis_Caching_Architecture_Guide.md-478-            .thenReturn(Mono.empty()); // Cache miss
./ai_docs/Redis_Caching_Architecture_Guide.md-479-        when(customerDataSource.fetchCustomer(CUSTOMER_ID, TENANT_ID))
./ai_docs/Redis_Caching_Architecture_Guide.md-480-            .thenReturn(Mono.just(EXPECTED_CUSTOMER));
./ai_docs/Redis_Caching_Architecture_Guide.md:481:        when(customerRedisService.set(eq(REDIS_KEY), any(CustomerDto.class), any(Duration.class)))
./ai_docs/Redis_Caching_Architecture_Guide.md-482-            .thenReturn(Mono.just(true));
./ai_docs/Redis_Caching_Architecture_Guide.md-483-    }
--
./ai_docs/Redis_Caching_Architecture_Guide.md-490-
./ai_docs/Redis_Caching_Architecture_Guide.md-491-```java
./ai_docs/Redis_Caching_Architecture_Guide.md:492:@SpringBootTest
./ai_docs/Redis_Caching_Architecture_Guide.md:493:@ActiveProfiles("test")
./ai_docs/Redis_Caching_Architecture_Guide.md-494-@DirtiesContext
./ai_docs/Redis_Caching_Architecture_Guide.md-495-class CustomerServiceIntegrationTest {
./ai_docs/Redis_Caching_Architecture_Guide.md-496-
./ai_docs/Redis_Caching_Architecture_Guide.md-497-    @Autowired
./ai_docs/Redis_Caching_Architecture_Guide.md:498:    private CustomerService customerService;
./ai_docs/Redis_Caching_Architecture_Guide.md-499-
./ai_docs/Redis_Caching_Architecture_Guide.md-500-    @Autowired
./ai_docs/Redis_Caching_Architecture_Guide.md:501:    private GenericRedisService<CustomerDto> customerRedisService;
./ai_docs/Redis_Caching_Architecture_Guide.md-502-
./ai_docs/Redis_Caching_Architecture_Guide.md-503-    @MockBean
./ai_docs/Redis_Caching_Architecture_Guide.md:504:    private CustomerDataSource customerDataSource;
./ai_docs/Redis_Caching_Architecture_Guide.md-505-
./ai_docs/Redis_Caching_Architecture_Guide.md-506-    @Test
./ai_docs/Redis_Caching_Architecture_Guide.md-507-    void integrationTest_cacheHitAndMiss() {
./ai_docs/Redis_Caching_Architecture_Guide.md:508:        // Given
./ai_docs/Redis_Caching_Architecture_Guide.md:509:        String customerId = "integration-test-customer";
./ai_docs/Redis_Caching_Architecture_Guide.md:510:        String tenantId = "integration-test-tenant";
./ai_docs/Redis_Caching_Architecture_Guide.md-511-        CustomerDto expectedCustomer = new CustomerDto(
./ai_docs/Redis_Caching_Architecture_Guide.md-512-            customerId, "Integration Test User", "test@integration.com",
--
./ai_docs/Redis_Caching_Architecture_Guide.md-520-        StepVerifier.create(customerService.getCustomer(customerId, tenantId))
./ai_docs/Redis_Caching_Architecture_Guide.md-521-            .expectNext(expectedCustomer)
./ai_docs/Redis_Caching_Architecture_Guide.md:522:            .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-523-
./ai_docs/Redis_Caching_Architecture_Guide.md-524-        // Then - Second call (cache hit)
./ai_docs/Redis_Caching_Architecture_Guide.md-525-        StepVerifier.create(customerService.getCustomer(customerId, tenantId))
./ai_docs/Redis_Caching_Architecture_Guide.md-526-            .expectNext(expectedCustomer)
./ai_docs/Redis_Caching_Architecture_Guide.md:527:            .verifyComplete();
./ai_docs/Redis_Caching_Architecture_Guide.md-528-
./ai_docs/Redis_Caching_Architecture_Guide.md:529:        // Verify data source was called only once (first call)
./ai_docs/Redis_Caching_Architecture_Guide.md:530:        verify(customerDataSource, times(1)).fetchCustomer(customerId, tenantId);
./ai_docs/Redis_Caching_Architecture_Guide.md-531-    }
./ai_docs/Redis_Caching_Architecture_Guide.md-532-}
--
./ai_docs/Redis_Caching_Architecture_Guide.md-535-## Best Practices
./ai_docs/Redis_Caching_Architecture_Guide.md-536-
./ai_docs/Redis_Caching_Architecture_Guide.md:537:### 1. Key Naming Conventions
./ai_docs/Redis_Caching_Architecture_Guide.md:538:- Use descriptive prefixes: `customer::`, `order::`, `inventory::`
./ai_docs/Redis_Caching_Architecture_Guide.md-539-- Include version info for breaking changes: `customer-v2::`
./ai_docs/Redis_Caching_Architecture_Guide.md:540:- Hash complex parameters to avoid key length issues
./ai_docs/Redis_Caching_Architecture_Guide.md:541:- Use consistent separators: `::` between prefix and hash
./ai_docs/Redis_Caching_Architecture_Guide.md-542-
./ai_docs/Redis_Caching_Architecture_Guide.md-543-### 2. TTL Strategy
./ai_docs/Redis_Caching_Architecture_Guide.md:544:- **Short-lived data** (user sessions): 5-30 minutes
./ai_docs/Redis_Caching_Architecture_Guide.md:545:- **Medium-lived data** (user profiles): 1-6 hours
./ai_docs/Redis_Caching_Architecture_Guide.md:546:- **Long-lived data** (public keys, configs): days/weeks
./ai_docs/Redis_Caching_Architecture_Guide.md:547:- **JWT tokens**: Based on token expiry time
./ai_docs/Redis_Caching_Architecture_Guide.md-548-
./ai_docs/Redis_Caching_Architecture_Guide.md-549-### 3. Error Handling
--
./ai_docs/Redis_Caching_Architecture_Guide.md-557-- Test cache hit, cache miss, and Redis disabled scenarios
./ai_docs/Redis_Caching_Architecture_Guide.md-558-- Use `times(2)` for operations that do get + set
./ai_docs/Redis_Caching_Architecture_Guide.md:559:- Mock key generation to return predictable values
./ai_docs/Redis_Caching_Architecture_Guide.md-560-- Use `@Nested` classes for test organization
./ai_docs/Redis_Caching_Architecture_Guide.md-561-- Include integration tests for end-to-end validation
--
./ai_docs/Redis_Caching_Architecture_Guide.md-571-
./ai_docs/Redis_Caching_Architecture_Guide.md-572-1. **Forgetting Null Checks**: Always check if Redis services are available
./ai_docs/Redis_Caching_Architecture_Guide.md:573:2. **Incorrect Verify Counts**: Remember that cache miss scenarios call key generation twice
./ai_docs/Redis_Caching_Architecture_Guide.md:574:3. **TTL Too Short**: Don't make TTL so short that cache becomes ineffective
./ai_docs/Redis_Caching_Architecture_Guide.md-575-4. **TTL Too Long**: Don't make TTL so long that stale data becomes a problem
./ai_docs/Redis_Caching_Architecture_Guide.md:576:5. **Key Collisions**: Ensure key generation includes enough context to avoid collisions
./ai_docs/Redis_Caching_Architecture_Guide.md-577-6. **Missing Integration Tests**: Unit tests alone don't catch serialization issues
./ai_docs/Redis_Caching_Architecture_Guide.md:578:7. **Blocking Operations**: Remember to use reactive patterns, not blocking Redis calls
./ai_docs/Redis_Caching_Architecture_Guide.md-579-
./ai_docs/Redis_Caching_Architecture_Guide.md:580:## Monitoring and Debugging
./ai_docs/Redis_Caching_Architecture_Guide.md-581-
./ai_docs/Redis_Caching_Architecture_Guide.md-582-### 1. Log Analysis
--
./ai_docs/Redis_Caching_Architecture_Guide.md-597-- Cache operation latency
./ai_docs/Redis_Caching_Architecture_Guide.md-598-- Cache size and memory usage
./ai_docs/Redis_Caching_Architecture_Guide.md:599:- TTL effectiveness
./ai_docs/Redis_Caching_Architecture_Guide.md-600-- Error rates
./ai_docs/Redis_Caching_Architecture_Guide.md-601-
--
./ai_docs/Redis_Caching_Architecture_Guide.md-605-redis-cli ping
./ai_docs/Redis_Caching_Architecture_Guide.md-606-
./ai_docs/Redis_Caching_Architecture_Guide.md:607:# View all keys with pattern
./ai_docs/Redis_Caching_Architecture_Guide.md:608:redis-cli keys "customer::*"
./ai_docs/Redis_Caching_Architecture_Guide.md-609-
./ai_docs/Redis_Caching_Architecture_Guide.md:610:# Check specific key
./ai_docs/Redis_Caching_Architecture_Guide.md:611:redis-cli get "customer::hash-value"
./ai_docs/Redis_Caching_Architecture_Guide.md-612-
./ai_docs/Redis_Caching_Architecture_Guide.md-613-# Check TTL
./ai_docs/Redis_Caching_Architecture_Guide.md:614:redis-cli ttl "customer::hash-value"
./ai_docs/Redis_Caching_Architecture_Guide.md-615-```
./ai_docs/Redis_Caching_Architecture_Guide.md-616-
--
./scripts/als-v3-ca/canary/client-ext.cnf-4-basicConstraints = CA:FALSE
./scripts/als-v3-ca/canary/client-ext.cnf-5-
./scripts/als-v3-ca/canary/client-ext.cnf:6:# Specify the allowed key usage: digital signature and key encipherment. Typical for mTLS usecase
./scripts/als-v3-ca/canary/client-ext.cnf:7:keyUsage = digitalSignature, keyEncipherment
./scripts/als-v3-ca/canary/client-ext.cnf-8-
./scripts/als-v3-ca/canary/client-ext.cnf:9:# Extended key usage: This makes the certificate valid for client authentication
./scripts/als-v3-ca/canary/client-ext.cnf:10:extendedKeyUsage = clientAuth
--
./scripts/als-v3-ca/canary/root-ca.pem-6-RTAeFw0yNTA1MDExNDMyMjBaFw0zNTA0MjkxNDMyMjBaMIGMMRwwGgYDVQQDDBNB
./scripts/als-v3-ca/canary/root-ca.pem-7-TFN2M0NsaWVudENhbmFyeVYxMQ4wDAYDVQQLDAVBUElHVzERMA8GA1UECwwIU2ln
./scripts/als-v3-ca/canary/root-ca.pem:8:bmF2aW8xDDAKBgNVBAoMA1NBUDERMA8GA1UEBwwIV2FsbGRvcmYxGzAZBgNVBAgM
./scripts/als-v3-ca/canary/root-ca.pem-9-EkJhZGVuIFd1ZXJ0dGVtYmVyZzELMAkGA1UEBhMCREUwggEiMA0GCSqGSIb3DQEB
./scripts/als-v3-ca/canary/root-ca.pem-10-AQUAA4IBDwAwggEKAoIBAQCXm/H1EnV5UrT4QNfeEWPuahkNEw384WRy4M/wXBD1
--
./unifiedGateway/README.md-3-This folder contains information and examples about the self-service approach for using Unified Gateway resources.
./unifiedGateway/README.md-4-
./unifiedGateway/README.md:5:- `path_routing_example`: sample files for a path based routing setup. Link to [Documentation](https://pages.github.tools.sap/SAP-Signavio-API-Gateway/signavio-api-gw/unifiedGatewayIntegration/ugwConfiguration/ugwPathRoutingConfig.html) 
--
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml:1:apiVersion: canary.gateway.resource.api.sap/v1
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml-2-type: GatewayRegistration
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml-3-metadata:
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml-4-  name: path-based-routing-test-registration
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml:5:  path: /sap/signavio/signavio-platform/path-based-routing-example/rg-path-based-routing-example
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml-6-spec:
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml:7:  lobName: Signavio                            # LoB name, for example, S/4, Fieldglass, Ariba, CX.
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml-8-  appName: path-based-routing-example-app      # Name of the service/application that uses Unified Gateway.
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml:9:  envName: Staging                      # Name of the environmnet, for example, dev, test, staging, ci, live. 
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml-10-  trafficType: test                     # Type of traffic that will be routed through Unified Gateway.
./unifiedGateway/path_routing_example/pbr_example_gatewayRegistration.yml-11-  contacts:                             # List of contacts responsible for Unified Gateway configuration.
--
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml:1:apiVersion: canary.gateway.resource.api.sap/v1
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-2-type: GatewayConfiguration
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-3-metadata:
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-4-  name: path-based-routing-test-configuration
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml:5:  path: /sap/signavio/signavio-platform/path-based-routing-example/rg-path-based-routing-example
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-6-spec:
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-7-  domain:
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-8-    certificate:
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-9-      validationType: OV
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml:10:    extHost: api.test.staging.eu.signavio.cloud.sap
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-11-  gatewayLocations:
./unifiedGateway/path_routing_example/pbr_example_gatewayConfiguration.yml-12-    - hyperscalerRegion: az/eastus
--
./bpi-api-gw/src/main/resources/bootstrap.yml:1:spring:
./bpi-api-gw/src/main/resources/bootstrap.yml-2-  cloud:
./bpi-api-gw/src/main/resources/bootstrap.yml-3-    kubernetes:
--
./bpi-api-gw/src/main/resources/application.yml-32-
./bpi-api-gw/src/main/resources/application.yml-33-csp:
./bpi-api-gw/src/main/resources/application.yml:34:  trusted-domains: "*.signavio.com,*.sharepoint.com,*.atlassian.net,*.inforcloudsuite.com,*.infor.com,*.force.com,*.salesforce.com"
./bpi-api-gw/src/main/resources/application.yml-35-
./bpi-api-gw/src/main/resources/application.yml-36-saml:
./bpi-api-gw/src/main/resources/application.yml:37:  spmSamlEndpoint: ${SPM_SAML_ENDPOINT:https://spm.eu-group-platform.group-platform.signav.io/api/v2/saml/v2/tenant}
./bpi-api-gw/src/main/resources/application.yml-38-
./bpi-api-gw/src/main/resources/application.yml:39:spring:
./bpi-api-gw/src/main/resources/application.yml-40-  application:
./bpi-api-gw/src/main/resources/application.yml-41-    name: ${API_GW_NAME:bpi-api-gw}
--
./bpi-api-gw/src/main/resources/application.yml-63-    default:
./bpi-api-gw/src/main/resources/application.yml-64-      - dev
./bpi-api-gw/src/main/resources/application.yml:65:    active:
./bpi-api-gw/src/main/resources/application.yml-66-      - dev
./bpi-api-gw/src/main/resources/application.yml-67-  lifecycle:
./bpi-api-gw/src/main/resources/application.yml:68:    timeout-per-shutdown-phase: ${GRACEFUL_SHUTDOWN_TIMEOUT_SPRING:1m}
./bpi-api-gw/src/main/resources/application.yml-69-  autoconfigure:
./bpi-api-gw/src/main/resources/application.yml:70:    #spring-boot tries to automatically configure redis connection, and we don't always need it, for example
./bpi-api-gw/src/main/resources/application.yml:71:    #when jwt.ugwJwtFilter is set to false. @see com.sap.bpi.api.gw.filters.RedisConfiguration
./bpi-api-gw/src/main/resources/application.yml-72-    exclude:
./bpi-api-gw/src/main/resources/application.yml:73:      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
./bpi-api-gw/src/main/resources/application.yml:74:      - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
./bpi-api-gw/src/main/resources/application.yml-75-
./bpi-api-gw/src/main/resources/application.yml-76-redis:
--
./bpi-api-gw/src/main/resources/application.yml-79-  port: ${REDIS_PORT:6379}
./bpi-api-gw/src/main/resources/application.yml-80-  password: ${REDIS_PASSWORD:dummy}
./bpi-api-gw/src/main/resources/application.yml:81:  sslEnabled: ${REDIS_SSL_ENABLED:false}
./bpi-api-gw/src/main/resources/application.yml-82-  spmCacheTimeoutMinutes: ${REDIS_SPM_CACHE_TIMEOUT_MINUTES:5}
./bpi-api-gw/src/main/resources/application.yml-83-  ipsTenantsCacheTimeoutMinutes: ${REDIS_IPS_TENANTS_CACHE_TIMEOUT_MINUTES:5}
--
./bpi-api-gw/src/main/resources/application.yml-90-    host: ${LOGGING_AUDIT_HOST:canary.als.services.cloud.sap}
./bpi-api-gw/src/main/resources/application.yml-91-    region: ${LOGGING_AUDIT_REGION:canary}
./bpi-api-gw/src/main/resources/application.yml:92:    namespace: ${LOGGING_AUDIT_NAMESPACE:sap.signavio}
./bpi-api-gw/src/main/resources/application.yml-93-    appId: "APIGW"
./bpi-api-gw/src/main/resources/application.yml-94-    clientCertificate: |
./bpi-api-gw/src/main/resources/application.yml:95:      ${LOGGING_AUDIT_CLIENT_CERTIFICATE:LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURxVENDQXBHZ0F3SUJBZ0lVQ3lYaVU0NGF4VkZ5dFg4MFZTUFpNTndYM1VJd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2ZURU5NQXNHQTFVRUF3d0VWRVZUVkRFT01Bd0dBMVVFQ3d3RlFWQkpSMWN4RVRBUEJnTlZCQXNNQ0ZOcApaMjVoZG1sdk1Rd3dDZ1lEVlFRS0RBTlRRVkF4RVRBUEJnTlZCQWNNQ0ZkaGJHeGtiM0ptTVJzd0dRWURWUVFJCkRCSkNZV1JsYmlCWGRXVnlkSFJsYldKbGNtY3hDekFKQmdOVkJBWVRBa1JGTUI0WERUSTFNRFV4TWpBM01qTXcKTmxvWERUSTJNRFV4TWpBM01qTXdObG93ZlRFTk1Bc0dBMVVFQXd3RVZFVlRWREVPTUF3R0ExVUVDd3dGUVZCSgpSMWN4RVRBUEJnTlZCQXNNQ0ZOcFoyNWhkbWx2TVF3d0NnWURWUVFLREFOVFFWQXhFVEFQQmdOVkJBY01DRmRoCmJHeGtiM0ptTVJzd0dRWURWUVFJREJKQ1lXUmxiaUJYZFdWeWRIUmxiV0psY21jeEN6QUpCZ05WQkFZVEFrUkYKTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF2RklCa1JIbmtVM2Zkak90anhFawpYWEU1Y3RKSmFkdVV6eit4LzhuQ3hFRTB6ZFJnTEJhbHJFdGFLN0UrUnNJOXNXd1c4akkxdzVSb29zTTdkTGQ5CjgvM1hkSFlodmU3VllSNUZOaWYzZFlRV0hIOVFHbjJlN09tOUQxRk83T1B1d1dIMEpZWDRBUHNhMTIxb0txN3AKR0c1S1NqUzJzSEl3TXFIRDZNZzVObXpxWjJNY3VVVnFpQUNPSjZJQWdQUWF1TTlkNzg0WWVPeEtDeDF5Ni9OOQpud0kyNDZIaEdMdTN0OTlsRWlXWUQzM0JGb2VGV1lDcUQwWGJjSHcvUUJmeEhrMXBsRTVuczk2TmgzWlBtV3drCnBkYnFNL1VmVk96by9NWGxLNlFiSGROTmFqQzF0cFZUd1dPWXIrNTN6Zlg3TUhKT1BVS2YycmNnbmhOZlJZZFkKQ1FJREFRQUJveUV3SHpBZEJnTlZIUTRFRmdRVW9ITVBmNUdrUmNuaUhuN2RhWm9Hb3o2d0prRXdEUVlKS29aSQpodmNOQVFFTEJRQURnZ0VCQUF5VWJpd1ZrSjNvWFBCczkySU5NNXZiSTZVdWsyQlIyQmpxS2Q0VGR1RzRKem92CmlQdFhZblFDR3gzTmJoemlpT25Cc2NGNjlmOU5yV1pObnZCMUFnd05EM29VUUtpOFBYaENGdHFkL1pyYnhpaUUKTkRoZjRqd1JNbEl2ZDlvVDNYVTllZnhibVovZ29JWG9SMXlEVUM4bldUTzhTeE95cW5XbW9NL21FbG5aSzlCMQovcjlFcHlIRXlFWWs3WjQxRWF3TXhwenBnTnl5YWJTRWZjbnZzbkNLY2JYV3N1dzZITVgrN1RheHVwWmJGUEl0CjJZR3FxdG5BR2NtV0ZRY2V5OUFsVi96djhML0E0c3loZ3o0a05LWnEzQmNTWVMwcWJiZG1mMHBDWWh4cFh3SUIKN0d0aWlTaVVXdlF0SFh4c3V3cWx0N2pyS2MzUmsyOVJRRWxJeTg4PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==}
./bpi-api-gw/src/main/resources/application.yml:96:    clientCertificateKey: |
./bpi-api-gw/src/main/resources/application.yml:97:      ${LOGGING_AUDIT_CLIENT_CERTIFICATE_KEY:LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRQzhVZ0dSRWVlUlRkOTIKTTYyUEVTUmRjVGx5MGtscDI1VFBQN0gveWNMRVFUVE4xR0FzRnFXc1Mxb3JzVDVHd2oyeGJCYnlNalhEbEdpaQp3enQwdDMzei9kZDBkaUc5N3RWaEhrVTJKL2QxaEJZY2YxQWFmWjdzNmIwUFVVN3M0KzdCWWZRbGhmZ0EreHJYCmJXZ3FydWtZYmtwS05MYXdjakF5b2NQb3lEazJiT3BuWXh5NVJXcUlBSTRub2dDQTlCcTR6MTN2emhoNDdFb0wKSFhMcjgzMmZBamJqb2VFWXU3ZTMzMlVTSlpnUGZjRVdoNFZaZ0tvUFJkdHdmRDlBRi9FZVRXbVVUbWV6M28ySApkaytaYkNTbDF1b3o5UjlVN09qOHhlVXJwQnNkMDAxcU1MVzJsVlBCWTVpdjduZk45ZnN3Y2s0OVFwL2F0eUNlCkUxOUZoMWdKQWdNQkFBRUNnZ0VBRWhnckVGNVJDclFaeVlpem4zQjlOd0UvRE5wSnRZTWtyRGtwaUROQnBJdkQKWUJlTTJnK2ZBWXdIOFBUSjBCQ3Z6dEZjN3c2Ri9mSFBqL3dFUlhXd0EzYWJjaFE3cjcwNEFXbmdLcER5aFBjWgpETW5xejNETWlXVDRCblhBaUtCcCsyakhCYWYycVZsM1BjWEVZWDJHNWhNS3psQjhVVDNYaGJYblZnR1BCYnlOCkZabkR1bE5XbzF4WjRuT3lxRmUxNEJiVi92cGpRcjNvd2Vid3lNbTVxSXlxQnhNdjB2MFY3M21teEE4MlBHb3kKSjJCeG9nYVgrbkw5L2FKV2NvbHdYTXZGUHdRWnV0bEd4aFhkMEhSYWY1aHNZVUpTb3pQcWh6b1d6bEV0dDlBaApRQWtZcy9pZk5RczgwSkFzOVBrejNBV1NSaDJmcVBiK0JLb2hzcFJpVVFLQmdRRG5BVUlZQlhtS2tLNGd0WTNICnljcnFxeU12TS8reGVCSHBRTThYaFhzRHp0QjhBOUJDTEF0czFyWm85dTgyMzNFbDJLRlJaN1FOWWJpNUJVWmsKWGJjdFN0c2thSTNKZmFqeXhmelpKVlJLbEM1bTFEblNwbHFqbUlXYnZhZzlNY3p6N1gwUFlUM0h3czB0SUszagp3VXQrQjdGOGY0S3hXamNWdjNGdmFmdGtGUUtCZ1FEUXNtY05aaEFOdHVLb3I5bU5qeTdLQlBHVGNSdld6QjRXCmUxNGt4Wjhlc2lNN3pMUGRzQWsvUlMrNVBlUTBrSUVaTk1TMEVWWjRkQWJWNGNrWi9CM2tpd2tpOHR6c2VTcXYKRVhUQU9sdDJPV0Z6VkJOeE5YQ1VZSWJIcjNBWWxpRGs3TEN4VHFsV0JPbGNVb1BoY3Z4KzBTQXVwaUkrS1JFagpaZXlGMTgyZEpRS0JnUURITmhHT2I2STUrYjBBWGpFdm12a1AySmdXQyt5MFdneHdMOENuMHllYnlBMkk5U3p5Cjg5TENnSU44RDMrSnZiVnc0dGx6UDFCSnZmMDBLYlZqdG1IU2dGeHRrSEM5MDAwUVYrZE9SOS9pRk5uVE9hL0gKMWtnU0R1VWh3clBFV2g4YU9MTUJ3V1VxMFBacHRXWGdKSUI2NWgyTWROWDdKZ2FkRGFUQVpSQXpaUUtCZ1FDSQpCb0FjdjVWZkd3RUpLZlVHeTNpWHZEa28vT1JFVUs2YndMVlFDbTc0TnV1NEltaHA2ajljdWQrdFFhWG9qUGRZClVvaVRSV216QVEwamd4THNtT055L3h4cFp4cVFGem0yK2cyNjdVNkg5RWFNUVJTYkNWWGpvRGE1R0tSYm9oNjIKbDM5alVmNFZUd1k3WXAwSzZVT2g5UFNnOHpBR2pBWGJxS2ROWmFkaThRS0JnRi9DTGFocFBCTXdPTEJtOVgwegpWR1l1NEpRN2FMTFBYckQxM1dOMzljY0xmNnEvZDgxTkNIVktXUm9zbG9NSjRVWGVCVkxtb0hPWm5LS0RKMzNnCnl3aHFrUGJwK3NHZUpBNzZpU0N1N2I0c1YvOGY4czU5U0lwQzV4NUhIUEhtbWlNbHlic1lxVVUrZHVuZ3lzNlgKUHY5dG1rMUN5YmpJVm5KUmljSEozN3RICi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K}
./bpi-api-gw/src/main/resources/application.yml-98-
./bpi-api-gw/src/main/resources/application.yml-99-
./bpi-api-gw/src/main/resources/application.yml-100-  level:
./bpi-api-gw/src/main/resources/application.yml-101-    com.sap.bpi.api.gw: ${API_GW_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml:102:    com.sap.bpi.api.gw.security.jwt.joule: ${JOULE_AUTH_MANAGER_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml:103:    com.sap.bpi.api.gw.security.jwt.joule.JouleXsuaaJwtVerifier: ${XSUAA_JWT_VERIFIER_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml:104:    com.sap.bpi.api.gw.filters.SapJwtToSpmJwtGatewayFilterFactory: ${XSUAA_JWT_VERIFIER_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml:105:    com.sap.bpi.api.gw.filters.SpmJwtToAsymmetricJwtGatewayFilterFactory: ${SPM_TO_ASYMMETRIC_JWT_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml:106:    com.sap.bpi.api.gw.services.DestinationService: ${SPM_TO_ASYMMETRIC_JWT_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml-107-    com.sap.bpi.api.gw.security.certificate: ${CERTIFICATE_MANAGERS_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml:108:    org.springframework.cloud.gateway.filter.factory.RetryGatewayFilterFactory: ${SPRING_RETRY_FILTER_LOG_LEVEL:INFO}
./bpi-api-gw/src/main/resources/application.yml-109-
./bpi-api-gw/src/main/resources/application.yml-110-app:
--
./bpi-api-gw/src/main/resources/application.yml-119-  insightsCentralEndpoint: ${INSIGHTS_CENTRAL_ENDPOINT:http://insights-central-api-service.suite-insights-central}
./bpi-api-gw/src/main/resources/application.yml-120-  piDataCopyEndpoint: ${PI_DATA_COPY_ENDPOINT:http://pi-customer-data-copy-service.pi-customer-data-copy-service.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:121:  piDatasphereEndpoint: ${PI_DATASPHERE_ENDPOINT:http://spi-etl-nginx-mtls-test.spi.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-122-  piGraphqlEndpoint: ${PI_GRAPHQL_ENDPOINT:http://spi-fluffy.spi}
./bpi-api-gw/src/main/resources/application.yml-123-  piGraphqlCanaryEndpoint: ${PI_GRAPHQL_CANARY_ENDPOINT:http://spi-fluffy-canary.spi}
--
./bpi-api-gw/src/main/resources/application.yml-129-  piJ2pClientEndpoint: ${PI_J2P_CLIENT_ENDPOINT:http://spi-j2p-client.spi}
./bpi-api-gw/src/main/resources/application.yml-130-  piRcaFrontendEndpoint: ${PI_RCA_FRONTEND_ENDPOINT:http://pi-rca-frontend.pi-rca.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:131:  piValueAnalysisClientEndpoint: ${PI_VALUE_ANALYSIS_CLIENT_ENDPOINT:http://spi-value-analysis-client.spi}
./bpi-api-gw/src/main/resources/application.yml-132-  globalServerEndpoint: ${GLOBAL_SERVER_ENDPOINT:http://suite-clients-global-server.sc}
./bpi-api-gw/src/main/resources/application.yml-133-  graphqlEndpoint: ${GRAPHQL_ENDPOINT:http://suite-clients-graphql.sc}
--
./bpi-api-gw/src/main/resources/application.yml-140-  spgApprovalsServiceEndpoint: ${SPG_APPROVALS_SERVICE_ENDPOINT:http://spg-approvals-service.swa.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-141-  spgReadConfirmationEndpoint: ${SPG_READ_CONFIRMATION_ENDPOINT:http://spg-read-confirmation-service.swa.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:142:  spiSignalEndpoint: ${SPI_SIGNAL_ENDPOINT:http://pi-datastore-service.datastore.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:143:  idmpsEndpoint: ${IDMPS_ENDPOINT:https://idmps-ci.eu-group-platform.group-platform.signav.io} #Placeholder - Subject to change!
./bpi-api-gw/src/main/resources/application.yml-144-  jmServerEndpoint: ${JM_SERVER_ENDPOINT:http://jm-server.jm.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-145-  vmEndpoint: ${VM_ENDPOINT:http://variant-management.spm.svc.cluster.local}
--
./bpi-api-gw/src/main/resources/application.yml-149-  suiteClientsHubEndpoint: ${SUITE_CLIENTS_HUB:http://suite-clients-hub.sc}
./bpi-api-gw/src/main/resources/application.yml-150-  userManagementEndpoint: ${USER_MANAGEMENT_ENDPOINT:http://user-mgmt-usermgmt-client.user-mgmt.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:151:  labsEndpoint: ${LABS_ENDPOINT:https://mtn-signavio-blue-client.eu-staging-cloud-os-eu.suite-saas-staging.signav.io}
./bpi-api-gw/src/main/resources/application.yml-152-  tenantServiceEndpoint: ${TENANT_SERVICE_ENDPOINT:http://tenant-service.tenants.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-153-  processAiRecommenderEndpoint: ${PROCESS_AI_RECOMMENDER_ENDPOINT:http://semantic-recommender.process-ai.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-154-  processAiCrafterEndpoint: ${PROCESS_AI_CRAFTER_ENDPOINT:http://process-ai-process-crafter.process-ai.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-155-  processAiReagentEndpoint: ${PROCESS_AI_REAGENT_ENDPOINT:http://reagent-backend.process-ai.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:156:  valEndpoint: ${VAL_ENDPOINT:https://val.eu-staging-cloud-os-eu.suite-saas-staging.signav.io}
./bpi-api-gw/src/main/resources/application.yml:157:  piArchimedesEndpoint: ${PI_ARCHIMEDES_ENDPOINT:http://pi-eureka-archimedes.pi-eureka.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:158:  piArchimedesHealthEndpoint: ${PI_ARCHIMEDES_HEALTH_ENDPOINT:http://pi-eureka-archimedes.pi-eureka.svc.cluster.local:8090} #health endpoint exposed via admin port 8090
./bpi-api-gw/src/main/resources/application.yml-159-  spmImpexEndpoint: ${SPM_IMPEX_ENDPOINT:http://spm-platform-impex.spm.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:160:  connectivityPlatformIntegrationEndpoint: ${CONNECTIVITY_PLATFORM_INTEGRATION_ENDPOINT:http://signavio-connectivity-platform-integration.dex.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:161:  connectivityPlatformIntegrationHealthEndpoint: ${CONNECTIVITY_PLATFORM_INTEGRATION_HEALTH_ENDPOINT:https://signavio-connectivity-platform-integration.eu-staging-cloud-os-eu.suite-saas-staging.signav.io}
./bpi-api-gw/src/main/resources/application.yml-162-  dmnXmlServiceEndpoint: ${DMN_XML_SERVICE_ENDPOINT:http://dmn-xml-service.spm.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-163-  benchmarkCentralEndpoint: ${BENCHMARK_CENTRAL_ENDPOINT:http://benchmark-central-api-service.suite-benchmark-central.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-164-  benchmarkFrontendEndpoint: ${BENCHMARK_FRONTEND_ENDPOINT:http://benchmark-central-frontend-mfe-service.suite-benchmark-central.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml:165:  suiteTasksManagementEndpoint: ${SUITE_TASKS_MANAGEMENT_ENDPOINT:http://signavio-connectivity-gateway.dex.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-166-  suiteAnalyticsSpmServiceEndpoint: ${SUITE_ANALYTICS_SPM_SERVICE_ENDPOINT:http://suite-analytics-spm-service.suite-analytics-spm.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-167-  processAiAssetsEndpoint: ${PROCESS_AI_ASSETS_ENDPOINT:http://prompting-panel.process-ai.svc.cluster.local}
--
./bpi-api-gw/src/main/resources/application.yml-182-  transformationAdvisorEndpoint: ${TRANSFORMATION_ADVISOR_ENDPOINT:http://transformation-advisor-api-service.suite-transformation-advisor.svc.cluster.local}
./bpi-api-gw/src/main/resources/application.yml-183-  transformationManagerEndpoint: ${TRANSFORMATION_MANAGER_ENDPOINT:http://insights-central-api-service.suite-insights-central}
./bpi-api-gw/src/main/resources/application.yml:184:  suiteRepositoryEndpoint: ${SUITE_REPOSITORY_ENDPOINT:http://suite-repository.int.eu-group-platform.group-platform.signav.io}
./bpi-api-gw/src/main/resources/application.yml-185-
./bpi-api-gw/src/main/resources/application.yml-186-
--
./bpi-api-gw/src/main/resources/application.yml-215-    region: ${AWS_S3_REGION:eu-central-1}
./bpi-api-gw/src/main/resources/application.yml-216-    bucketName: ${AWS_S3_BUCKET_NAME:eu-group-platform-cdm-s3-bucket}
./bpi-api-gw/src/main/resources/application.yml:217:    cdmObjectKey: ${AWS_S3_CDM_OBJECT_KEY:cdm.json}
./bpi-api-gw/src/main/resources/application.yml-218-
./bpi-api-gw/src/main/resources/application.yml-219-joule:
./bpi-api-gw/src/main/resources/application.yml:220:  patterns: ${JOULE_PATTERNS:/spm/v1/**,/spm/internal/v1/**,/process-ai-recommender/v1/**,/pi/v1/graphql,/pi/v1/signal,/val/**,/suite/search/v1/query,/jouleSkillsBackend/v1/**}
./bpi-api-gw/src/main/resources/application.yml-221-
./bpi-api-gw/src/main/resources/application.yml-222-certificates:
--
./bpi-api-gw/src/main/resources/application.yml-225-    subject: ${UCL_CERTIFICATE_SUBJECT:CN=cmp-dev,OU=SAP Cloud Platform Clients,OU=Staging,OU=cmp-cf-us10-staging,O=SAP SE,L=Dev,C=DE}
./bpi-api-gw/src/main/resources/application.yml-226-    issuer: ${UCL_CERTIFICATE_ISSUER:CN=SAP PKI Certificate Service Client CA,OU=SAP BTP Clients,O=SAP SE,L=cf-us10-staging,C=DE}
./bpi-api-gw/src/main/resources/application.yml:227:    skipShortLivedCertificateCheck: ${UCL_SKIP_SHORT_LIVED_CERTIFICATE_CHECK:false}
./bpi-api-gw/src/main/resources/application.yml-228-  tenantService: ${TENANT_SERVICE_CLD_CERTIFICATES:[{"cldSubject":"Subject1","cldIssuer":"Issuer1"},{"cldSubject":"Subject2","cldIssuer":"Issuer2"}]}
./bpi-api-gw/src/main/resources/application.yml:229:  mtlsClientFactory:
./bpi-api-gw/src/main/resources/application.yml-230-    trustStore:
./bpi-api-gw/src/main/resources/application.yml:231:      caCertificates: ${MTLS_CLIENT_FACTORY_TRUSTSTORE_CA_CERTIFICATES:}
./bpi-api-gw/src/main/resources/application.yml-232-
./bpi-api-gw/src/main/resources/application.yml-233-feature:
./bpi-api-gw/src/main/resources/application.yml-234-  launchDarkly:
./bpi-api-gw/src/main/resources/application.yml:235:    sdkKey: ${LAUNCH_DARKLY_SDK_KEY:""}
./bpi-api-gw/src/main/resources/application.yml-236-  reactorDebug:
./bpi-api-gw/src/main/resources/application.yml-237-    enabled: false
--
./bpi-api-gw/src/main/resources/application.yml-243-
./bpi-api-gw/src/main/resources/application.yml-244-
./bpi-api-gw/src/main/resources/application.yml:245:# "system" as JWT subject is a workaround for a system user
./bpi-api-gw/src/main/resources/application.yml:246:# a valid tenantId is also needed to create a JWT otherwise the Signal API will response with 401
./bpi-api-gw/src/main/resources/application.yml:247:jwt:
./bpi-api-gw/src/main/resources/application.yml-248-  ugw:
./bpi-api-gw/src/main/resources/application.yml:249:    privateKey: ${UGW_JWT_PRIVATE_KEY:""}
./bpi-api-gw/src/main/resources/application.yml:250:    publicKey: ${UGW_JWT_PUBLIC_KEY:""}
./bpi-api-gw/src/main/resources/application.yml-251-    clientId: ${CLIENT_ID:5ab90558-49b5-41fb-bfe6-47e283a52864}
./bpi-api-gw/src/main/resources/application.yml-252-
./bpi-api-gw/src/main/resources/application.yml:253:signavio:
./bpi-api-gw/src/main/resources/application.yml-254-  security:
./bpi-api-gw/src/main/resources/application.yml:255:    jwtSharedSecret: ${JWT_SIGNING_KEY:sup3r$ecr3T}
./bpi-api-gw/src/main/resources/application.yml:256:    destinationService:
./bpi-api-gw/src/main/resources/application.yml:257:      serviceUrl: ${DESTINATION_SERVICE_URL:""}
./bpi-api-gw/src/main/resources/application.yml:258:      clientId: ${DESTINATION_SERVICE_CLIENTID:""}
./bpi-api-gw/src/main/resources/application.yml:259:      clientSecret: ${DESTINATION_SERVICE_CLIENTSECRET:""}
./bpi-api-gw/src/main/resources/application.yml:260:      tokenUrl: ${DESTINATION_SERVICE_TOKENURL:""}
./bpi-api-gw/src/main/resources/application.yml-261-    credentialStore:
./bpi-api-gw/src/main/resources/application.yml-262-      url: ${CREDENTIAL_STORE_URL:""}
./bpi-api-gw/src/main/resources/application.yml-263-      certificate: ${CREDENTIAL_STORE_CERTIFICATE:""}
./bpi-api-gw/src/main/resources/application.yml:264:      key: ${CREDENTIAL_STORE_KEY:""}
./bpi-api-gw/src/main/resources/application.yml:265:      encryption: ${CREDENTIAL_STORE_ENCRYPTION:""}
./bpi-api-gw/src/main/resources/application.yml-266-
./bpi-api-gw/src/main/resources/application.yml-267-
./bpi-api-gw/src/main/resources/application.yml-268----
./bpi-api-gw/src/main/resources/application.yml:269:spring:
./bpi-api-gw/src/main/resources/application.yml-270-  config:
./bpi-api-gw/src/main/resources/application.yml:271:    activate:
./bpi-api-gw/src/main/resources/application.yml-272-      on-profile:
./bpi-api-gw/src/main/resources/application.yml-273-        - dev
--
./bpi-api-gw/src/main/resources/application.yml-277-    enabled: false
./bpi-api-gw/src/main/resources/application.yml-278-
./bpi-api-gw/src/main/resources/application.yml:279:springdoc:
./bpi-api-gw/src/main/resources/application.yml-280-  api-docs:
./bpi-api-gw/src/main/resources/application.yml-281-    path: "/api-docs"
--
./bpi-api-gw/src/main/resources/application.yml-315-
./bpi-api-gw/src/main/resources/application.yml-316----
./bpi-api-gw/src/main/resources/application.yml:317:spring:
./bpi-api-gw/src/main/resources/application.yml-318-  config:
./bpi-api-gw/src/main/resources/application.yml:319:    activate:
./bpi-api-gw/src/main/resources/application.yml-320-      on-profile:
./bpi-api-gw/src/main/resources/application.yml-321-        - performance
./bpi-api-gw/src/main/resources/application.yml-322-app:
./bpi-api-gw/src/main/resources/application.yml:323:  getPatterns: "/spm/**,/spg/**,/spi/**,/jm/**,/pi/signal/odata/**,/auth/v1/token"
./bpi-api-gw/src/main/resources/application.yml:324:  postPatterns: "/spm/**,/spg/**,/spi/**,/jm/**,/pi/signal/odata/**,/auth/v1/token"
./bpi-api-gw/src/main/resources/application.yml-325-
./bpi-api-gw/src/main/resources/application.yml-326----
./bpi-api-gw/src/main/resources/application.yml:327:spring:
./bpi-api-gw/src/main/resources/application.yml-328-  config:
./bpi-api-gw/src/main/resources/application.yml:329:    activate:
./bpi-api-gw/src/main/resources/application.yml-330-      on-profile:
./bpi-api-gw/src/main/resources/application.yml-331-        - staging
--
./bpi-api-gw/src/main/resources/application.yml-362-
./bpi-api-gw/src/main/resources/application.yml-363----
./bpi-api-gw/src/main/resources/application.yml:364:spring:
./bpi-api-gw/src/main/resources/application.yml-365-  config:
./bpi-api-gw/src/main/resources/application.yml:366:    activate:
./bpi-api-gw/src/main/resources/application.yml-367-      on-profile:
./bpi-api-gw/src/main/resources/application.yml-368-        - production
--
./mock/src/main/resources/application.yml-5-  shutdown: graceful
./mock/src/main/resources/application.yml-6-
./mock/src/main/resources/application.yml:7:spring:
./mock/src/main/resources/application.yml-8-  autoconfigure:
./mock/src/main/resources/application.yml:9:    #spring-boot tries to automatically configure redis connection, and we don't always need it, for example
./mock/src/main/resources/application.yml:10:    #when jwt.ugwJwtFilter is set to false. @see com.sap.bpi.api.gw.filters.RedisConfiguration
./mock/src/main/resources/application.yml-11-    exclude:
./mock/src/main/resources/application.yml:12:      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
./mock/src/main/resources/application.yml:13:      - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
./mock/src/main/resources/application.yml-14-
./mock/src/main/resources/application.yml-15-redis:
--
./scripts/als-v3-ca/prod/root-ca.pem-8-MQwwCgYDVQQKDANTQVAxETAPBgNVBAsMCFNpZ25hdmlvMQ4wDAYDVQQLDAVBUElH
./scripts/als-v3-ca/prod/root-ca.pem-9-VzEbMBkGA1UEAwwSQVBJR1cgUHJvZCBSb290IENBMIICIjANBgkqhkiG9w0BAQEF
./scripts/als-v3-ca/prod/root-ca.pem:10:AAOCAg8AMIICCgKCAgEAmfAgI+HUxEfyWvH5V48S9ADob5pSNkpQ0OejeYMD5aal
./scripts/als-v3-ca/prod/root-ca.pem-11-XNTzUbluookc0WF1Pbbq1s44HaodEHPBEPPNJsBHT9tQOpEUTlW3jQlnluV5HdEP
./scripts/als-v3-ca/prod/root-ca.pem-12-XonzMvf7VRd/Cc2stbkEhB0bqy7j8+5T2CLodSnKgKZ4l5+vXwiCENbh2fA3MgNs
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-3-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-4-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:5:import org.springframework.boot.SpringApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:6:import org.springframework.boot.autoconfigure.SpringBootApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:7:import org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:8:import org.springframework.context.ConfigurableApplicationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-9-import reactor.core.publisher.Hooks;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-11-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:13:Exclude ReactiveUserDetailsServiceAutoConfiguration to prevent default user and password creation
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-14-as we dont need them as of now
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-15- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:16:@SpringBootApplication(exclude = {ReactiveUserDetailsServiceAutoConfiguration.class})
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-17-public class GatewayApplication {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:19:  private static final Logger logger = LoggerFactory.getLogger(GatewayApplication.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:21:  public static void main(String[] args) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-23-    ConfigurableApplicationContext applicationContext =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java:24:        SpringApplication.run(GatewayApplication.class, args);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-25-    boolean reactorProperty =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/GatewayApplication.java-26-        applicationContext
--
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:1:package org.springframework.web.cors.reactive;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-2-
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-3-import java.net.URI;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:4:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:5:import org.springframework.lang.Nullable;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:6:import org.springframework.util.Assert;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:7:import org.springframework.web.util.UriComponents;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:8:import org.springframework.web.util.UriComponentsBuilder;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-9-
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-10-/*
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:11: * This class overwrites the original org.springframework.web.cors.reactive.CorsUtils
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:12: * We need it to handle the preflight requests properly, otherwise Spring Cloud Gateway won't allow them to pass through
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:13: * Here are the open issues related to this problem: {@link https://github.com/spring-cloud/spring-cloud-gateway/issues/830}
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:14: * and {@link https://github.com/spring-cloud/spring-cloud-gateway/issues/2472}.
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:15: * Once this issue is fixed in Spring Cloud Gateway, we can remove this class and use a solution by Spring Cloud Gateway.
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-16- *
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-17- * */
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:18:@SuppressWarnings({"PMD.AbstractClassWithoutAbstractMethod", "PMD.AvoidReassigningParameters"})
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-19-public abstract class CorsUtils {
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-20-  public CorsUtils() {}
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-21-
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-22-  public static boolean isCorsRequest(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:23:    return request.getHeaders().containsKey("Origin") && !isSameOrigin(request);
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-24-  }
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-25-
--
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-33-  @Deprecated
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-34-  public static boolean isSameOrigin(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:35:    String origin = request.getHeaders().getOrigin();
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-36-    if (origin == null) {
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-37-      return true;
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-38-    } else {
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-39-      URI uri = request.getURI();
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:40:      String actualScheme = uri.getScheme();
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:41:      String actualHost = uri.getHost();
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-42-      int actualPort = getPort(uri.getScheme(), uri.getPort());
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-43-      Assert.notNull(actualScheme, "Actual request scheme must not be null");
--
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-51-  }
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-52-
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java:53:  private static int getPort(@Nullable String scheme, int port) {
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-54-    if (port == -1) {
./bpi-api-gw/src/main/java/org/springframework/web/cors/reactive/CorsUtils.java-55-      if (!"http".equals(scheme) && !"ws".equals(scheme)) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-3-import static com.sap.bpi.api.gw.filters.JsonWebToken.SPM_SYSTEM_USER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-4-import static com.sap.bpi.api.gw.security.certificate.DatasphereAuthorizationManager.X_DATASPHERE_TENANT_ID_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:5:import static com.sap.bpi.api.gw.security.certificate.DatasphereAuthorizationManager.X_SIGNAVIO_TENANT_ID_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-7-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:8:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:12:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:13:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:14:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:15:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:16:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:17:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-18-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-20-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:21:public class DatasphereTenantIdToSpmJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:22:    extends AbstractGatewayFilterFactory<DatasphereTenantIdToSpmJwtFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:23:  private final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:24:      LoggerFactory.getLogger(DatasphereTenantIdToSpmJwtFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:26:  public static final String X_DATASPHERE_TENANT_ID_HEADER = "x-datasphere-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:27:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-29-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:30:  public DatasphereTenantIdToSpmJwtFilterFactory(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-31-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-32-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:33:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-34-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:35:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-36-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:37:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-38-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-39-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-44-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-45-              ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:46:              String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:47:              String signavioTenantId = getSignavioTenantId(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:48:              String jwtBearer = generateJwtBearer(signavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:50:              ServerHttpRequest requestBuild = buildRequest(exchange, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-51-              return chain.filter(exchange.mutate().request(requestBuild).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-52-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-53-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:55:  private String getSignavioTenantId(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:56:    String signavioTenantId = exchange.getAttribute(X_SIGNAVIO_TENANT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:57:    logger.info("Signavio tenant id is: {}", signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:58:    return signavioTenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-59-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:61:  private String generateJwtBearer(String signavioTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:62:    // TODO: userId with empty string is temporary solution, should be replaced with null when
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-63-    // SIGPEX-34421 is done
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:64:    JsonWebToken spmJwt =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:65:        new JsonWebToken(signavioTenantId, SPM_SYSTEM_USER, "", requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-66-            .withIsInternal(true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-67-            .withIsAdminUser(true);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:68:    return jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:71:  private ServerHttpRequest buildRequest(ServerWebExchange exchange, String jwtBearer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-72-    ServerHttpRequest.Builder builder = exchange.getRequest().mutate();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-73-    builder.headers(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-76-                X_DATASPHERE_TENANT_ID_HEADER,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-77-                exchange.getAttribute(X_DATASPHERE_TENANT_ID_ATTRIBUTE)));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:78:    builder.header(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java:79:    exchange.getAttributes().remove(X_SIGNAVIO_TENANT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-80-    exchange.getAttributes().remove(X_DATASPHERE_TENANT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/DatasphereTenantIdToSpmJwtFilterFactory.java-81-    return builder.build();
--
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-3-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-4-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:5:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:6:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:7:import org.springframework.web.bind.annotation.GetMapping;
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:8:import org.springframework.web.bind.annotation.RequestMapping;
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:9:import org.springframework.web.bind.annotation.RestController;
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-10-
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-11-@RestController
--
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-13-public class OpenIdProviderController {
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-14-
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:15:  private final Logger LOGGER =
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-16-      LoggerFactory.getLogger(com.sap.api.mock.controller.JMController.class);
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-17-
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-18-  @GetMapping("/.well-known/openid-configuration")
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:19:  public ResponseEntity<String> getWellKnownOpenIdConfiguration() {
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-20-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-21-        "Intercepted request from API GW in getWellKnownOpenIdConfiguration() for"
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-22-            + " /.well-known/openid-configuration endpoint");
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:23:    String body =
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-24-        """
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-25-              {
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:26:                "jwks_uri": "http://localhost:8088/token_keys",
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-27-                "issuer": "https://pai-joule.authentication.eu12.hana.ondemand.com/oauth/token"
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-28-              }
--
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-31-  }
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-32-
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:33:  @GetMapping("/token_keys")
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:34:  public ResponseEntity<String> getTokenKeys() {
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:35:    LOGGER.info("Intercepted request from API GW in getTokenKeys() for /token_keys endpoint");
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:36:    String jsonReponse =
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-37-        """
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-38-                  {
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:39:                    "keys": [
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-40-                        {
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java:41:                        "value": "-----BEGIN PUBLIC KEY-----\\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAluM6q/JE1eaEg5umuTDq\\n9J+H43u/TXhxFeUIz5gpnx6nmq+Edps8s88ZHFCa2Md5HKS36CwUmQUIEFVFSnVN\\nJuoRvDcYLI+wsNcmH9B0CBtk8kkcPCKRU3Jb2PoxKfFrLNU4WZJVfEpZ6VtKkalW\\nvluyTS7CybFNuZT0pgq9LhLreoysjcjnZn464TJbX08KvmKSJt/8+wTK8WuMlwcr\\ngEbxK5RTHpYTZkDl5Trb6kS9D/G2WfKr7CMSRKhb6XVpX1nn0TDSBbdVadxHUVzC\\nB8i8TZWkrUJ9beU3SKAu6hipKv8pLBcTsT7IOSrkrwZxNu+3VlZNol6g4DRqU0C6\\nPwIDAQAB\\n-----END PUBLIC KEY-----"
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-42-                        }
./mock/src/main/java/com/sap/api/mock/controller/OpenIdProviderController.java-43-                    ]
--
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-3-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-4-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/VMController.java:5:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/VMController.java:6:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/VMController.java:7:import org.springframework.web.bind.annotation.PostMapping;
./mock/src/main/java/com/sap/api/mock/controller/VMController.java:8:import org.springframework.web.bind.annotation.RequestMapping;
./mock/src/main/java/com/sap/api/mock/controller/VMController.java:9:import org.springframework.web.bind.annotation.RestController;
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-10-
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-11-@RestController
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-12-@RequestMapping(produces = MediaType.APPLICATION_JSON_VALUE)
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-13-public class VMController {
./mock/src/main/java/com/sap/api/mock/controller/VMController.java:14:  private final Logger LOGGER = LoggerFactory.getLogger(VMController.class);
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-15-
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-16-  @PostMapping("/v1/templates")
./mock/src/main/java/com/sap/api/mock/controller/VMController.java:17:  public ResponseEntity<String> postVMTemplates() {
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-18-    LOGGER.info("Intercepted request from API GW in for /variant-management/v1/templates endpoint");
./mock/src/main/java/com/sap/api/mock/controller/VMController.java-19-    return ResponseEntity.ok().body("{ \"message\": \"This is a mock response.\" }");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-8-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-9-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:10:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-11-import com.sap.bpi.api.gw.services.SpmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-12-import java.util.EnumSet;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-15-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-16-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:17:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:18:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:19:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:20:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:21:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:22:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:23:import org.springframework.http.server.reactive.ServerHttpResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:24:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:25:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-26-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-27-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-35-    extends AbstractGatewayFilterFactory<SpmResponseHeadersRewriteFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:37:  private final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-38-      LoggerFactory.getLogger(SpmResponseHeadersRewriteFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:39:  private final UgwJwtConfig jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:40:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:41:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-43-  @Value("${server.base-url}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:44:  private String baseUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-46-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-47-  public SpmResponseHeadersRewriteFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:48:      UgwJwtConfig jwtConfig, SpmService spmService, AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-49-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-50-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:51:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-52-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:53:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-54-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:55:    this.jwtConfig = jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-56-    this.spmService = spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-57-    this.auditLogClientManager = auditLogClientManager;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-60-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:61:   * This filter exchanges the SPM token with an UGW compatible JWT. The UGW JWT contains the SPM
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-62-   * token in claim "token". The HTTP response from SPM is checked for the presence of header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-63-   * "token" or "Set-Cookie". If either header is missing or empty it will bypass and continue with
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:64:   * the filter chain. Otherwise, it will call SPM for user details to populate the JWT claims and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:65:   * replace the SPM token in header "token" with a JWT.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-66-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-67-  @Override
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-82-                      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:84:                      List<String> cookieValues = httpHeaders.get(SET_COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:85:                      String xSignavioId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-86-                          getToken(cookieValues)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-87-                              .orElseThrow(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-88-                                  () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:89:                                    List<String> sourceIPs =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-90-                                        getSourceIpsFromHttpHeaders(httpHeaders);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-91-                                    logMissingToken(cookieValues, sourceIPs);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-94-                                        "Missing token in set-cookie headers");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-95-                                  });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:96:                      Optional<String> jSessionId = getJSessionId(cookieValues);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-97-                      if (jSessionId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-98-                        return Mono.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-99-                      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:100:                      String xForwardedFor =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-101-                          exchange.getRequest().getHeaders().getFirst(X_FORWARDED_FOR_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-102-                      Mono<SpmUser> userMono =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:103:                          getUserDetailsFromSpm(xSignavioId, jSessionId.get(), xForwardedFor);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-104-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-105-                      return userMono
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-106-                          .doOnNext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-107-                              user -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:108:                                String jwt = generateJwt(user, xSignavioId, jwtConfig, baseUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:109:                                addJwtToHeader(httpHeaders, cookieValues, jwt, logger);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-110-                              })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-111-                          .then()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-113-                              error ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-114-                                  logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:115:                                      "Error while replacing response token with UGW JWT: "
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-116-                                          + error.getMessage()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-117-                    }));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-119-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-120-  // Helper method to check if a header is empty
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:121:  private boolean isHeaderEmpty(HttpHeaders headers, String headerName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:122:    List<String> headerValues = headers.get(headerName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-123-    return headerValues == null || headerValues.isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-124-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-125-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:126:  private Mono<SpmUser> getUserDetailsFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:127:      String xSignavioId, String jSessionId, String xForwardedFor) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-128-    return spmService.getUserDetailsFromSpmWithTokenAndJSessionId(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:129:        xSignavioId, jSessionId, xForwardedFor, EnumSet.of(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-130-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-131-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:132:  private void logMissingToken(List<String> cookieValues, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:133:    Optional<String> tenantId = getTenant(cookieValues);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-134-    // Only log to ALS if tenant ID is available
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-135-    tenantId.ifPresent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java:136:        id -> auditLogClientManager.logUnauthenticatedAccess(id, sourceIps, UGW.toString()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-137-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmResponseHeadersRewriteFilterFactory.java-138-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-3-import com.fasterxml.jackson.core.JsonParseException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-4-import com.fasterxml.jackson.core.JsonParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:5:import com.fasterxml.jackson.databind.DeserializationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:6:import com.fasterxml.jackson.databind.JsonDeserializer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-7-import com.fasterxml.jackson.databind.JsonNode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:8:import com.sap.bpi.api.gw.dto.tenant.AssignedTenantConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-9-import java.io.IOException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-10-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-11-import java.net.URISyntaxException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:12:import org.apache.commons.lang3.StringUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-13-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-14-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-16-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:17: * Payload of the Tenant Service response containing the assigned tenant configuration has changed a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:18: * few times. This deserializer is used to handle different formats of the Tenant Service response.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-19- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-20- * @see <a href="https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=4418972853">Tenant
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-21- *     Mapping API</a>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-22- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:23:public class AssignedTenantConfigurationDeserializer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:24:    extends JsonDeserializer<AssignedTenantConfigurationDto> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:25:  private static final String NEW_TOKEN_SERVICE_URL = "tokenServiceURL";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:26:  private static final String OLD_TOKEN_SERVICE_URL = "token_service_url";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:27:  private static final String CERTIFICATE_CHAIN = "certificateChain";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:28:  private static final String SNAKE_CASE_CLIENT_ID = "client_id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:29:  private static final String CAMEL_CASE_CLIENT_ID = "clientId";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:30:  private final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:31:      LoggerFactory.getLogger(AssignedTenantConfigurationDeserializer.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-33-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:34:   * API Gateway needs to get an auth URL for Joule requests and certificate chain for Connectivity
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-35-   * platform requests. They might be directly under the "configuration" node or under the first
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:36:   * "destinations" node. If both of the fields are null, a JsonParseException is thrown.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-37-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-38-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:39:  public AssignedTenantConfigurationDto deserialize(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:40:      JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:41:    String url = null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:42:    String certificateChain = null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:43:    String clientId = null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-45-    JsonNode configNode = jsonParser.getCodec().readTree(jsonParser);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-46-    if (configNode != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:47:      JsonNode destinationsNode = configNode.get("destinations");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:48:      if (destinationsNode != null && destinationsNode.isArray() && !destinationsNode.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:49:        JsonNode firstDestination = destinationsNode.get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:50:        url = getUrl(firstDestination);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:51:        certificateChain = getNodeValueAsString(firstDestination, CERTIFICATE_CHAIN);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:52:        clientId = getClientId(firstDestination);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-53-      } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:54:        url = getNodeValueAsString(configNode, "url");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:55:        certificateChain = getNodeValueAsString(configNode, CERTIFICATE_CHAIN);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-56-        clientId = getClientId(configNode);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-57-      }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-60-    if (url == null && certificateChain == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-61-      logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:62:          "Failed to deserialize AssignedTenantConfiguration: both auth URL and certificate chain"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-63-              + " are null");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-64-      throw new JsonParseException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:65:          "Could not get UCL assigned tenant configuration from the tenants service");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-66-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-67-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:68:    return new AssignedTenantConfigurationDto(url, certificateChain, clientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:71:  private String getClientId(JsonNode node) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:72:    String clientId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-73-    if (node.has(CAMEL_CASE_CLIENT_ID)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:74:      clientId = getNodeValueAsString(node, CAMEL_CASE_CLIENT_ID);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-75-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:76:      clientId = getNodeValueAsString(node, SNAKE_CASE_CLIENT_ID);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-77-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-78-    return clientId;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-81-  @SuppressWarnings("PMD.PreserveStackTrace")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:82:  private String getUrl(JsonNode firstDestination) throws JsonParseException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:83:    String url;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:84:    String tokenUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:85:    if (firstDestination.has(NEW_TOKEN_SERVICE_URL)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:86:      tokenUrl = StringUtils.trim(getNodeValueAsString(firstDestination, NEW_TOKEN_SERVICE_URL));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-87-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:88:      tokenUrl = StringUtils.trim(getNodeValueAsString(firstDestination, OLD_TOKEN_SERVICE_URL));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-89-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-90-    try {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-93-    } catch (URISyntaxException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-94-      logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:95:          "Failed to deserialize AssignedTenantConfiguration: token service URL \"{}\" is not a"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-96-              + " valid URL",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-97-          tokenUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-98-          e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-99-      throw new JsonParseException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:100:          "Could not get UCL assigned tenant configuration from the tenants service");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-101-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-102-    return url;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-103-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-104-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:105:  private void assertTokenUrl(String tokenUrl) throws JsonParseException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-106-    if (tokenUrl == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:107:      logger.error("Failed to deserialize AssignedTenantConfiguration: token service URL is null");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-108-      throw new JsonParseException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:109:          "Could not get UCL assigned tenant configuration from the tenants service");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-110-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-111-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:113:  private String getNodeValueAsString(JsonNode node, String fieldName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-114-    JsonNode fieldNode = node.get(fieldName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-115-    return fieldNode != null ? fieldNode.asText() : null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-116-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:118:  private String getSchemaAndHostname(String url) throws URISyntaxException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-119-    URI uri = new URI(url);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java:120:    String baseUrl = uri.getScheme() + "://" + uri.getHost();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-121-    if (uri.getPort() != -1) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/adapters/AssignedTenantConfigurationDeserializer.java-122-      baseUrl += ":" + uri.getPort();
--
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-3-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-4-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:5:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:6:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:7:import org.springframework.web.bind.annotation.GetMapping;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:8:import org.springframework.web.bind.annotation.RequestMapping;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:9:import org.springframework.web.bind.annotation.RestController;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-10-
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-11-@RestController
--
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-13-public class SPIController {
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-14-
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:15:  private static final String SET_COOKIE_HEADER = "Set-Cookie";
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:16:  private static final String TOKEN_ID = "123456789123456789123456789123456789";
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:17:  private static final String SESSION_ID = "1234";
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-18-
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:19:  private final Logger LOGGER = LoggerFactory.getLogger(SPIController.class);
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-20-
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-21-  @GetMapping("/g/api/pidata/v2/subjects/test")
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:22:  public ResponseEntity<String> getSubjectsSubRequest() {
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:23:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-24-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-25-        "Intercepted request from API GW in getSubjectsSubRequest() for"
--
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-31-
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-32-  @GetMapping("/pi-odata/spitest")
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:33:  public ResponseEntity<String> getV1DataRequest() {
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:34:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-35-    LOGGER.info("Intercepted request from API GW in getV1DataRequest() for /spitest endpoint");
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-36-    return ResponseEntity.ok()
--
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-40-
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-41-  @GetMapping("/ingestion/data/test")
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:42:  public ResponseEntity<String> getSignalRequest() {
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:43:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-44-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:45:        "Intercepted request from API GW in getSignalRequest() for /ingestion/data/test endpoint");
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-46-    return ResponseEntity.ok()
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-47-        .header(SET_COOKIE_HEADER, cookieHeader)
--
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-50-
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-51-  @GetMapping("/ingestions/12345/status")
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:52:  public ResponseEntity<String> getSpiV1Request() {
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:53:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-54-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java:55:        "Intercepted request from API GW in getSpiV1Request() for /ingestions/12345/status"
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-56-            + " endpoint");
./mock/src/main/java/com/sap/api/mock/controller/SPIController.java-57-    return ResponseEntity.ok()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-3-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:4:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:5:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:6:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:7:import org.springframework.http.server.PathContainer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:8:import org.springframework.http.server.RequestPath;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:9:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:10:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:11:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-12-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-14-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:15:    This filter extracts the organization key from the request path and adds it to the exchange
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:16:    attributes. We need this, because we need to extract the organization key before rewriting the path.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:17:    The organization key is expected to be in the path of the request, specifically in one of
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-18-    the following formats:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-19-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-28-public class ApprovalsGatewayFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-29-    extends AbstractGatewayFilterFactory<ApprovalsGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:30:  public static final String APPROVALS_ORG_ID_ATTRIBUTE = "approvals-org-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-32-  @Override
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-35-        Mono.defer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-36-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:37:              String orgId = getOrgIdFromRequest(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-38-              exchange.getAttributes().put(APPROVALS_ORG_ID_ATTRIBUTE, orgId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-39-              return chain.filter(exchange);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:43:  private String getOrgIdFromRequest(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-44-    RequestPath path = request.getPath();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-45-    List<PathContainer.Element> elements = path.elements();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-49-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:51:    // Decide where the organization key starts by matching the first element to "/v1","/v2" etc.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-52-    int orgIndex =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-53-        (elements.size() > 5 && elements.get(5).value().matches("v\\d+"))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-57-    if (elements.size() <= orgIndex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-58-      throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java:59:          HttpStatus.BAD_REQUEST, "Missing organization key in the request path");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-60-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ApprovalsGatewayFilterFactory.java-61-    return path.subPath(orgIndex, orgIndex + 1).value();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-13-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-14-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:15:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:16:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:17:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:18:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:19:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:20:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:21:import org.springframework.web.reactive.function.client.ClientResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:22:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:23:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-24-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-25-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-29-  @Value("${app.spmEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:30:  private String spmHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:32:  private final Logger logger = LoggerFactory.getLogger(SpmService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:34:  public static final String X_SIGNAVIO_ID_HEADER = "x-signavio-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:35:  public static final String COOKIE_HEADER = "cookie";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:36:  public static final String AUTHORIZATION_HEADER = "Authorization";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:37:  private static final String J_SESSION_ID = "JSESSIONID";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:38:  private static final String SPM_ME_PATH = "/api/v2/me?includeGroups=true&includeLicenses=true";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:39:  private static final String SPM_EXTERNAL_USER_INFO_PATH = "/api/v2/users/externalUser/";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:40:  private static final String X_FORWARDED_FOR = "X-Forwarded-For";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:41:  private final WebClient webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:42:  private static final String SPM_TRUSTED_FRAME_ANCESTORS_PATH = "/api/v2/trusted-frame-ancestors";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-44-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-49-  public Mono<SpmUser> getUserDetailsFromSpmWithTokenAndJSessionId(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:50:      String xSignavioId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:51:      String jSessionId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:52:      String xForwardedFor,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-53-      Set<FeatureApplication> featuresOfApps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-54-    return requestUserFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-55-        createRequestToGetUserDetailsFromSpmWithJSessionIdCookie(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:56:            xSignavioId, jSessionId, xForwardedFor, featuresOfApps));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-59-  public Mono<SpmUser> getUserDetailsFromSpmWithTokenAndCookie(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:60:      String xSignavioId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:61:      String cookie,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:62:      String xForwardedFor,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-63-      Set<FeatureApplication> featuresOfApps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:64:    String[] featureSets = FilterUtils.splitFeatureSetsString(featuresOfApps);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-65-    return requestUserFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-66-        createRequestToGetUserDetailsFromSpmWithCookieHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:67:            xSignavioId, cookie, xForwardedFor, featureSets));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-68-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-70-  public Mono<SpmUser> getUserDetailsFromSpmWithTokenAndCookie(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:71:      String xSignavioId, String cookie, String xForwardedFor) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-72-    return requestUserFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:73:        createRequestToGetUserDetailsFromSpmWithCookieHeader(xSignavioId, cookie, xForwardedFor));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-74-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:76:  public Mono<SpmUser> getUserDetailsFromSpmWithSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:77:      String spmJwt, String xForwardedFor, Set<FeatureApplication> featuresOfApps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:78:    String[] featureSets = FilterUtils.splitFeatureSetsString(featuresOfApps);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-79-    return requestUserFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:80:        createRequestToGetUserDetailsFromSpmWithJwtHeader(spmJwt, xForwardedFor, featureSets));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-81-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-82-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:83:  public Mono<ExternalUserInfo> getExternalUserInfoFromSpmWithSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:84:      String spmJwt, String externalUserId, String xForwardedFor) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-85-    return requestExternalUserInfoFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:86:        createRequestToGetExternalUserInfoFromSpmWithJwtHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:87:            spmJwt, xForwardedFor, externalUserId));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-88-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-89-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:90:  private Mono<SpmUser> requestUserFromSpm(WebClient.RequestHeadersSpec<?> requestHeadersUriSpec) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-91-    return requestHeadersUriSpec
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-92-        .retrieve()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-98-                        response.statusCode(), "Error while requesting user details from SPM")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-99-        .bodyToMono(SpmUser.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:100:        // the onErrorMap will be used when we didn't receive a response from SPM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-101-        // for example when connection is reset
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-102-        .onErrorMap(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-117-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-118-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:119:  private Mono<ExternalUserInfo> requestExternalUserInfoFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-120-      WebClient.RequestHeadersSpec<?> requestHeadersUriSpec) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-121-    return requestHeadersUriSpec
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-127-              return response.bodyToMono(ExternalUserInfo.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-128-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:129:        // the onErrorMap will be used when we didn't receive a response from SPM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-130-        // for example when connection is reset
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-131-        .onErrorMap(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-149-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-150-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:151:  private Throwable handleSpmError(ClientResponse response) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:152:    String errorMsg = "Error while requesting external user info from SPM";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-153-    if (response.statusCode().equals(HttpStatus.NOT_FOUND)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-154-      logger.error("User not found in external user table in SPM database");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-155-      errorMsg =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-156-          "User not found in external user table in SPM database. Please ensure that the user is"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:157:              + " onboarded to SPM through Single Sign-On (SSO) before attempting this request.";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-158-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-159-    return new ResponseStatusException(response.statusCode(), errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-160-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-161-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:162:  private Predicate<? super Throwable> isNotSpmException() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-163-    return e -> !(e instanceof ResponseStatusException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-164-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-165-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:166:  private WebClient.RequestHeadersSpec<?> createRequestToGetUserDetailsFromSpmWithCookieHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:167:      String xSignavioId, String cookie, String xForwardedFor, String... featureSets) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:168:    String featureOfAppsQueryParams =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-169-        Arrays.stream(featureSets)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-170-            .map((featureSet) -> "&includeFeaturesOfApps=" + featureSet)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-173-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-174-        .uri(URI.create(spmHost + SPM_ME_PATH + featureOfAppsQueryParams))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:175:        .header(X_SIGNAVIO_ID_HEADER, xSignavioId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-176-        .header(X_FORWARDED_FOR, xForwardedFor)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-177-        .header(COOKIE_HEADER, cookie);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-178-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-179-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:180:  private WebClient.RequestHeadersSpec<?> createRequestToGetUserDetailsFromSpmWithJSessionIdCookie(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:181:      String xSignavioId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:182:      String jSessionId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:183:      String xForwardedFor,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-184-      Set<FeatureApplication> featuresOfApps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:185:    String featureOfAppsQueryParams =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-186-        featuresOfApps.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-187-            .map((featureSet) -> "&includeFeaturesOfApps=" + featureSet)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-190-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-191-        .uri(URI.create(spmHost + SPM_ME_PATH + featureOfAppsQueryParams))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:192:        .header(X_SIGNAVIO_ID_HEADER, xSignavioId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-193-        .header(X_FORWARDED_FOR, xForwardedFor)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-194-        .cookie(J_SESSION_ID, jSessionId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-195-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-196-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:197:  private WebClient.RequestHeadersSpec<?> createRequestToGetExternalUserInfoFromSpmWithJwtHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:198:      String spmJwt, String xForwardedFor, String externalUserId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-199-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-200-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-201-        .uri(URI.create(spmHost + SPM_EXTERNAL_USER_INFO_PATH + externalUserId))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:202:        .header(AUTHORIZATION_HEADER, spmJwt)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-203-        .header(X_FORWARDED_FOR, xForwardedFor);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-204-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-205-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:206:  private WebClient.RequestHeadersSpec<?> createRequestToGetUserDetailsFromSpmWithJwtHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:207:      String spmJwt, String xForwardedFor, String... featureSets) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:208:    String featureOfAppsQueryParams =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-209-        Arrays.stream(featureSets)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-210-            .map((featureSet) -> "&includeFeaturesOfApps=" + featureSet)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-213-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-214-        .uri(URI.create(spmHost + SPM_ME_PATH + featureOfAppsQueryParams))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:215:        .header(AUTHORIZATION_HEADER, spmJwt)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-216-        .header(X_FORWARDED_FOR, xForwardedFor);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-217-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-218-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-219-  public Mono<TrustedFrameAncestorsDto> getTrustedFrameAncestorsFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:220:      String spmJwt, String xForwardedFor) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-221-    return requestTrustedFrameAncestorsFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:222:        createRequestToGetTrustedFrameAncestorsFromSpm(spmJwt, xForwardedFor));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-223-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-224-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:225:  private Mono<TrustedFrameAncestorsDto> requestTrustedFrameAncestorsFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-226-      WebClient.RequestHeadersSpec<?> requestHeadersUriSpec) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-227-    return requestHeadersUriSpec
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-251-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-252-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:253:  private WebClient.RequestHeadersSpec<?> createRequestToGetTrustedFrameAncestorsFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:254:      String spmJwt, String xForwardedFor) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-255-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-256-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-257-        .uri(URI.create(spmHost + SPM_TRUSTED_FRAME_ANCESTORS_PATH))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java:258:        .header(AUTHORIZATION_HEADER, spmJwt)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-259-        .header(X_FORWARDED_FOR, xForwardedFor);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmService.java-260-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:3:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-4-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-5-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-6-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-7-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:8:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:9:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:10:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:11:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:12:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:13:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-15-@Component
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-17-    extends AbstractGatewayFilterFactory<TokenRequestGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:19:  private static final String X_SIGNAVIO_ID_HEADER = "x-signavio-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:20:  private static final String COOKIE_HEADER = "Cookie";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:21:  private final Logger logger = LoggerFactory.getLogger(TokenRequestGatewayFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:22:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-24-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:25:  public TokenRequestGatewayFilterFactory(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-26-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-27-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:28:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-29-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:30:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-31-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:32:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-33-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-34-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-42-              .headers(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-43-                  httpHeaders -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:44:                    List<String> tokenHeader = httpHeaders.get(X_SIGNAVIO_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-45-                    if (tokenHeader != null && !tokenHeader.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:46:                      Optional<String> xSignavioIdToken =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:47:                          jwtUtils.getTokenClaimValue(tokenHeader.get(0));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:48:                      xSignavioIdToken.ifPresent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-49-                          (token) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:50:                            httpHeaders.replace(X_SIGNAVIO_ID_HEADER, List.of(token));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-51-                            logger.info(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:52:                                "Replaced x-signavio-id header value with SPM access token");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-53-                            replaceCookieHeaderIfPresent(httpHeaders, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-54-                          });
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-60-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-61-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:62:  private void replaceCookieHeaderIfPresent(HttpHeaders httpHeaders, String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:63:    List<String> cookieHeaderValues = httpHeaders.get(COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-64-    if (cookieHeaderValues != null && !cookieHeaderValues.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:65:      String newCookieValue = modifyTokenValue(cookieHeaderValues, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-66-      httpHeaders.replace(COOKIE_HEADER, List.of(newCookieValue));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-67-      logger.info("Replaced cookie header value with SPM access token");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:71:  private String modifyTokenValue(List<String> cookieHeaderValues, String xSignavioIdToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-72-    return cookieHeaderValues
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-73-        .get(0)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-75-        // [^;] will match any character that is not ";"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-76-        // * will repeat previous match until ";" is found
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java:77:        .replaceFirst("(?<=token=)[^;]*", xSignavioIdToken);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-78-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenRequestGatewayFilterFactory.java-79-
--
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-4-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-5-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:6:import org.springframework.http.HttpHeaders;
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:7:import org.springframework.http.HttpStatus;
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:8:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:9:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:10:import org.springframework.web.bind.annotation.*;
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-11-
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-12-@RestController
--
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-14-public class TenantServiceController {
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-15-
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:16:  private final Logger LOGGER =
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-17-      LoggerFactory.getLogger(com.sap.api.mock.controller.JMController.class);
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-18-
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-19-  @PostMapping("/v1/tenants/tenant123/mappings/ucl")
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:20:  public ResponseEntity<String> postTenantMappingRequest(
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:21:      @RequestHeader Map<String, String> headers) {
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-22-
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-23-    HttpHeaders responseHeaders = new HttpHeaders();
--
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-32-
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-33-  @GetMapping("/v1/tenants/a346f1f4-6d1e-4566-a9fd-7d2cede1bb68/spii/mappings")
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:34:  public ResponseEntity<String> getTenantMapping(
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:35:      @RequestHeader Map<String, String> headers, @RequestParam("type") String type) {
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-36-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-37-        "Intercepted request from API GW in getTenantMapping() for"
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-38-            + " /v1/tenants/a346f1f4-6d1e-4566-a9fd-7d2cede1bb68/spii/mappings endpoint");
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:39:    String UCL_ASSIGNMENT_ID = "sb-das-designer!b478272|das-application-canary!b305237";
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:40:    String jsonReponse =
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:41:        String.format(
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-42-            """
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-43-          {
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:44:            "tenantId": "signavio-tenant-id-123-from-tenant-service",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:45:            "type": "string",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-46-            "externalTenantId": "btpsubaccountid123",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-47-            "additionalInfo": {
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:48:              "assignedTenant": {
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-49-                "state": "INITIAL",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:50:                "uclAssignmentId": "%s",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-51-                "deploymentRegion": "cf-eu10",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-52-                "applicationNamespace": "sap.ariba.ngsm",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-53-                "applicationUrl": "https://tenant1.myapplication-api.cfapps.com",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:54:                "applicationTenantId": "string",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-55-                "subaccountId": "btpsubaccountid123",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:56:                "subdomain": "string",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-57-                "uclSystemName": "myS4System",
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-58-                "uclSystemTenantId": "cbdd8a33-125f-48a8-b8d9-deebd0b3c168"
--
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-61-          }
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-62-         """,
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java:63:            UCL_ASSIGNMENT_ID);
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-64-    return ResponseEntity.ok().body(jsonReponse);
./mock/src/main/java/com/sap/api/mock/controller/TenantServiceController.java-65-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:3:import com.sap.bpi.api.gw.dto.destinationService.OauthTokenResponseDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:4:import java.security.PrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-5-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-6-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-7-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-8-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:9:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:10:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:11:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:12:import org.springframework.http.MediaType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:13:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:14:import org.springframework.web.reactive.function.BodyInserters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:15:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:16:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-19-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:20: * Service for interacting with BTP services using mTLS authentication. This service uses the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-21- * centralized WebClientConfiguration to ensure proper connection pooling, metrics, and resource
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-22- * management.
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-24-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-25-public class BtpService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:26:  private static final Logger logger = LoggerFactory.getLogger(BtpService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:28:  private final MtlsClientFactory mtlsClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-30-  @Value("${saml.spmSamlEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:31:  private String spmSamlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:33:  public BtpService(MtlsClientFactory mtlsClientFactory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:34:    this.mtlsClientFactory = mtlsClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-35-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:37:  public Mono<String> getIasJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:38:      String iasUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:39:      String iasClientId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-40-      List<X509Certificate> certificateChain,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:41:      PrivateKey privateKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:42:      String samlSessionIndex,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:43:      String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:44:    String resourceUrl = String.format("%s/%s/metadata", spmSamlEndpoint, tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:45:    String resourceUrn = String.format("urn:sap:identity:application:entityid:%s", resourceUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:47:    // Ensure IAS URL includes the token endpoint path
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:48:    String iasTokenUrl = ensureTokenEndpoint(iasUrl, "/oauth2/token");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:50:    WebClient mtlsWebClient = mtlsClientFactory.createMtlsWebClient(privateKey, certificateChain);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-51-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:52:    return mtlsWebClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-53-        .post()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-54-        .uri(iasTokenUrl)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-66-            response ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-67-                response
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:68:                    .bodyToMono(String.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-69-                    .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-70-                        errorBody -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-71-                          logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:72:                              "Failed to get IAS JWT with code {}. Response body: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-73-                              response.statusCode(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-74-                              errorBody);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-76-                              new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-77-                                  response.statusCode(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:78:                                  "Error while getting IAS JWT from IAS service: " + errorBody));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-79-                        }))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-80-        .bodyToMono(OauthTokenResponseDto.class)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-82-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:84:  public Mono<String> getXsuaaJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:85:      String xsuaaUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:86:      String xsuaaClientId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-87-      List<X509Certificate> certificateChain,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:88:      PrivateKey privateKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:89:      String iasJwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:91:    // Ensure XSUAA URL includes the token endpoint path
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:92:    String xsuaaTokenUrl = ensureTokenEndpoint(xsuaaUrl, "/oauth/token");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:94:    WebClient mtlsWebClient = mtlsClientFactory.createMtlsWebClient(privateKey, certificateChain);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-95-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:96:    return mtlsWebClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-97-        .post()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-98-        .uri(xsuaaTokenUrl)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-100-        .header(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_FORM_URLENCODED_VALUE)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-101-        .body(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:102:            BodyInserters.fromFormData("grant_type", "urn:ietf:params:oauth:grant-type:jwt-bearer")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-103-                .with("client_id", xsuaaClientId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:104:                .with("assertion", iasJwt))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-105-        .retrieve()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-106-        .onStatus(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-108-            response ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-109-                response
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:110:                    .bodyToMono(String.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-111-                    .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-112-                        errorBody -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-113-                          logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:114:                              "Failed to get XSUAA JWT with code {}. Response body: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-115-                              response.statusCode(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-116-                              errorBody);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-118-                              new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-119-                                  response.statusCode(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:120:                                  "Error while getting XSUAA JWT from XSUAA service: "
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-121-                                      + errorBody));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-122-                        }))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-127-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:128:   * Ensures that the URL includes the token endpoint path. "/oauth2/token" for IAS, "/oauth/token"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-129-   * for XSUAA If the URL already contains the path, it is returned as-is. Otherwise, the path is
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-130-   * appended.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-131-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:132:  private String ensureTokenEndpoint(String baseUrl, String tokenPath) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-133-    if (baseUrl == null || baseUrl.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-134-      throw new IllegalArgumentException("Base URL cannot be null or empty");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-136-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-137-    // Remove trailing slash from baseUrl if present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:138:    String normalizedBaseUrl =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java:139:        baseUrl.endsWith("/") ? baseUrl.substring(0, baseUrl.length() - 1) : baseUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-140-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/BtpService.java-141-    if (normalizedBaseUrl.endsWith(tokenPath)) {
--
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-3-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-4-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:5:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:6:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:7:import org.springframework.web.bind.annotation.GetMapping;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:8:import org.springframework.web.bind.annotation.RequestMapping;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:9:import org.springframework.web.bind.annotation.RestController;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-10-
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-11-@RestController
--
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-13-public class SPGController {
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-14-
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:15:  private static final String SET_COOKIE_HEADER = "Set-Cookie";
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:16:  private static final String TOKEN_ID = "123456789123456789123456789123456789";
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:17:  private static final String SESSION_ID = "1234";
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-18-
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:19:  private final Logger LOGGER = LoggerFactory.getLogger(SPGController.class);
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-20-
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-21-  @GetMapping("/v1/cases")
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:22:  public ResponseEntity<String> getReportCasesRequest() {
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java:23:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-24-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/SPGController.java-25-        "Intercepted request from API GW in getReportCasesRequest() for /v1/cases" + " endpoint");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-3-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:4:import org.springframework.beans.factory.ObjectProvider;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:5:import org.springframework.cloud.gateway.config.HttpClientProperties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:6:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:7:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:8:import org.springframework.cloud.gateway.filter.headers.HttpHeadersFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:9:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-11-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-12- * Gateway filter factory that creates a route-specific custom HTTP client filter. This filter
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:13: * allows routes to use custom HTTP clients (e.g., mTLS-configured clients) by setting the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-14- * ATTR_CUSTOM_HTTP_CLIENT exchange attribute. Uses the centralized default HttpClient from
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-15- * WebClientConfiguration with proper metrics and connection pooling.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-16- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-17-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:18:public class MtlsOnlyRoutingGatewayFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:19:    extends AbstractGatewayFilterFactory<MtlsOnlyRoutingGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:21:  private final ObjectProvider<List<HttpHeadersFilter>> headersFiltersProvider;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:22:  private final HttpClientProperties properties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:24:  public MtlsOnlyRoutingGatewayFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-25-      ObjectProvider<List<HttpHeadersFilter>> headersFiltersProvider,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-26-      HttpClientProperties properties) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-32-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-33-  public GatewayFilter apply(Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:34:    MtlsOnlyRoutingFilter customRoutingFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java:35:        new MtlsOnlyRoutingFilter(headersFiltersProvider, properties);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingGatewayFilterFactory.java-37-    return customRoutingFilter::filter;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-3-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:4: * Non-exhaustive list of applications as used for structuring features. See SPM GW implementation:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:5: * https://github.com/signavio/process-manager/blob/develop/identitymanagement/src/main/java/com/signavio/identitymanagement/domain/feature/FeatureApplication.java
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-6- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-7-public enum FeatureApplication {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-19-  STENCILSET("stencilset"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-20-  ANALYTICS_DATASTORE("analyticsdatastore"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:21:  SIGNAVIO_LABS("signaviolabs"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-22-  PROCESS_INTELLIGENCE("processintelligence"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-23-  PROCESS_INTELLIGENCE_CLIENT("processintelligence_client"),
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-33-  PROCESS_AI("processai");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:35:  private final String appString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:37:  FeatureApplication(String appString) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:38:    this.appString = appString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-39-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-41-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-42-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:43:   * @return the application string
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-44-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:45:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java:46:    return appString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-47-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/features/FeatureApplication.java-48-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-9-public class LaunchDarklyService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:11:  private final Logger logger = LoggerFactory.getLogger(LaunchDarklyService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:13:  private final LDClient ldClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-15-  public LaunchDarklyService(LDClient ldClient) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-19-  public boolean isFeatureEnabled(LaunchDarklyFeatureFlag flag) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:20:    // LaunchDarkly requires a context to work and a respective key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:21:    // Since we do not have a specific use case as of now we use a placeholder-(key).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:22:    LDContext context = LDContext.builder("placeholder-key").build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-23-    boolean isFeatureEnabled = getFeatureStatus(flag, context);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-24-    logFeatureStatus(flag, isFeatureEnabled);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-27-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:29:  private boolean getFeatureStatus(LaunchDarklyFeatureFlag flag, LDContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:30:    return ldClient.boolVariation(flag.getKey(), context, false);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:33:  private void logFeatureStatus(LaunchDarklyFeatureFlag flag, boolean isFeatureEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java:34:    String logMessage = flag.getFeaturePhrase();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-35-    logger.debug("{} enabled: {}", logMessage, isFeatureEnabled);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/LaunchDarklyService.java-36-  }
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-8-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-9-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:10:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:11:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:12:import org.springframework.web.bind.annotation.*;
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-13-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-14-@RestController
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-16-public class SPMController {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-17-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:18:  private static final String SET_COOKIE_HEADER = "Set-Cookie";
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:19:  private static final String TOKEN_HEADER = "token";
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:20:  private static final String TOKEN_ID = "123456789123456789123456789123456789";
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:21:  private static final String SESSION_ID = "1234";
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-22-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:23:  private final Logger LOGGER = LoggerFactory.getLogger(SPMController.class);
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-24-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-25-  @PostMapping("/p/login")
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:26:  public ResponseEntity<String> postPLogin() {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:27:    String cookieHeader = "token=" + TOKEN_ID + ";" + "JSESSIONID=" + SESSION_ID;
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-28-    LOGGER.info("Intercepted request from API GW in postPLogin() for /p/login endpoint");
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-29-    return ResponseEntity.ok()
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-34-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-35-  @GetMapping("/api/v2/me")
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:36:  public ResponseEntity<String> getMe(
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:37:      @RequestParam("includeGroups") String includeGroups,
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:38:      @RequestParam("includeLicenses") String includeLicenses,
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:39:      @RequestParam("includeFeaturesOfApps") String... includeFeaturesOfApps) {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:40:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-41-    LOGGER.info("Intercepted request from API GW in getMe() for" + " /api/v2/me" + " endpoint");
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-42-    boolean isVariantManagementFeatureSet =
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-74-                                 "featuresOfApps": {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-75-                                   "variantmanagement": [
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:76:                                     "Signavio.Vm.DetachAllVariantsFromTemplate",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:77:                                     "Signavio.Vm.CreateVariantFromTemplate",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:78:                                     "Signavio.Vm.CreateVariantFromVariant",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:79:                                     "Signavio.Vm.RevertTemplate",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:80:                                     "Signavio.Vm.PromoteVariantToTemplate",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:81:                                     "Signavio.Vm.CreateVariantFromNormalDiagram",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:82:                                     "Signavio.Vm.ReplaceTemplate",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:83:                                     "Signavio.Vm.DetachVariantFromTemplate",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:84:                                     "Signavio.Vm.AttachDiagramAsVariant",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:85:                                     "Signavio.Vm.SetAsTemplate",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:86:                                     "Signavio.Vm.ManageValuesForVariantGroups",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:87:                                     "Signavio.Vm.ManageExistingDimensions"
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-88-                                   ],
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-89-                                   "platform": [
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:90:                                     "Signavio.Plugins.EnableCustomSvg",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:91:                                     "Signavio.Plugins.Login",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:92:                                     "Signavio.Guideline.customGuidelines",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:93:                                     "Signavio.Plugins.GlossarySupport",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:94:                                     "Signavio.Plugins.QuickModel",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:95:                                     "Signavio.Plugins.ignoreSVGFromFrontend",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:96:                                     "Signavio.Guideline.bpmnmethodandstyle",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:97:                                     "Signavio.Plugins.WorkflowEnterprise",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:98:                                     "Signavio.Guideline.effektifbpmn",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:99:                                     "Signavio.Plugins.Notification",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:100:                                     "Signavio.Plugins.Modeling",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:101:                                     "Signavio.Plugins.PDF.unbranded",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:102:                                     "Signavio.Simulation.CompleteSimulation",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:103:                                     "Signavio.Plugins.ApprovalWF.AutoSyncUsers",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:104:                                     "Signavio.Plugins.Userinterface",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:105:                                     "Signavio.Plugins.EnableExceptionTracking",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:106:                                     "Signavio.Plugins.Languages.Allowed.Infinite",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:107:                                     "Signavio.Guideline.signaviobestpractice",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:108:                                     "Signavio.Plugins.EnableApiAuthToken",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:109:                                     "Signavio.Plugins.Templates.SignavioTemplateNew",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:110:                                     "Signavio.Guideline.eCH",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:111:                                     "Signavio.Plugins.Effektif.AutoAssignUser",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:112:                                     "Signavio.Plugins.DmnXml",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:113:                                     "Signavio.Plugins.autosave",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:114:                                     "Signavio.Plugins.UseRemoteBrowsePrivCache",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:115:                                     "Signavio.Plugins.Filequota.Included",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:116:                                     "Signavio.Plugins.DictionaryVisibilityRestriction",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:117:                                     "Signavio.Plugins.UseEaceAgnosticBrowsePrivComputation",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:118:                                     "Signavio.Plugins.Can.Be.Workspace.Admin",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:119:                                     "Signavio.Guideline.signaviobestpractice_dmn"
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-120-                                   ]
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-121-                                 }
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-131-                      "lastname": "ejyi19l",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-132-                      "name": "x2clq0n ejyi19l",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:133:                      "email": "x2clq0n.ejyi19l@signavio.com",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-134-                      "language": "en_us",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-135-                      "country": "Germany",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-136-                      "isAdmin": true,
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-137-                      "tenantId": "141c171fddf7448ca5614b35a398f36a",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:138:                      "tenantName": "Signavio",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-139-                      "licenses": [
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-140-                        "Enterprise Plus Edition",
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-152-                      "featuresOfApps": {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-153-                        "collaborationhub": [
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:154:                          "Signavio.CollaborationHub.CustomHeaderTheme",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:155:                          "Signavio.CollaborationHub.CustomHeaderLogo"
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-156-                        ],
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-157-                        "valueaccelerator": [ ],
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-162-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-163-  @GetMapping("/p/configuration/ffa9867e1b014e0993c93dc8cf809cbe")
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:164:  public ResponseEntity<String> getConfiguration() {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:165:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";";
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-166-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-167-        "Intercepted request from API GW in getConfiguration() for"
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-179-                  "name": "tenant_ips_scim_configuration",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-180-                  "category": "TENANT_CONFIGURATION",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:181:                  "type": "STRING",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-182-                  "value": "{\\"cn_record\\":\\"CN=ips_b05935db-1b55-4b58-8bf8-85875b0e96ca\\",\\"url\\":\\"https://testurl.test\\"}",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-183-                  "object": "ffa9867e1b014e0993c93dc8cf809cbe"
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-190-                  "name": "tenantName",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-191-                  "category": "ALL",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:192:                  "type": "STRING",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-193-                  "value": "abc",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-194-                  "object": "ffa9867e1b014e0993c93dc8cf809cbe"
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-201-                  "name": "tenantCompany",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-202-                  "category": "ALL",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:203:                  "type": "STRING",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-204-                  "value": "abc",
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-205-                  "object": "ffa9867e1b014e0993c93dc8cf809cbe"
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-210-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-211-  @GetMapping("/p/test")
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:212:  public ResponseEntity<String> getTest(@RequestHeader Map<String, String> headers) {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-213-    LOGGER.info("Intercepted request from API GW in getTest() for /test endpoint");
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:214:    String sanitizedAuthHeader =
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-215-        Optional.ofNullable(headers.get("Authorization"))
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-216-            .orElse("")
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-222-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-223-  @GetMapping("/p/joule")
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:224:  public ResponseEntity<String> getJoule(@RequestHeader Map<String, String> headers) {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-225-    LOGGER.info("Intercepted request from API GW in getJoule() for /joule endpoint");
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:226:    String sanitizedAuthHeader =
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-227-        Optional.ofNullable(headers.get("Authorization"))
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-228-            .orElse("")
--
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-234-
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-235-  @GetMapping("/mock/successful")
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java:236:  public ResponseEntity<String> getMockSuccessful() {
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-237-    LOGGER.info(
./mock/src/main/java/com/sap/api/mock/controller/SPMController.java-238-        "Intercepted request from API GW in getMockSuccessful() for /mock/successful endpoint");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:3:import static com.sap.bpi.api.gw.security.certificate.utils.MappingTypes.CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-5-import com.sap.bpi.api.gw.dto.tenant.AdditionalInfoDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:6:import com.sap.bpi.api.gw.dto.tenant.AssignedTenantDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:7:import com.sap.bpi.api.gw.dto.tenant.SignavioTenantMappingResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-8-import com.sap.bpi.api.gw.dto.tenant.TenantMappingDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-9-import com.sap.bpi.api.gw.filters.JsonWebToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:10:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-11-import com.sap.bpi.api.gw.security.certificate.utils.AuthorizationManagerUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-12-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:13:import java.util.HashMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-14-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-15-import java.util.Objects;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-16-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-17-import java.util.function.Consumer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:18:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:19:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:20:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:21:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:22:import org.springframework.http.MediaType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:23:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:24:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-25-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-26-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-28-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:29:public class ConnectivityPlatformTenantService extends TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:30:  public static final String CONNECTIVITY_TENANT_MAPPING_PATH = "/v1/tenants/%s/mappings?type=%s";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:31:  public static final String CONNECTIVITY_APPLICATION_NAMESPACE = "sap.signavio.connectivity";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:32:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:33:  private final String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-35-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:36:  public ConnectivityPlatformTenantService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-37-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:38:      @Value("${app.tenantServiceEndpoint}") String tenantServiceEndpoint,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:39:      JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-40-    super(webClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:41:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-42-    this.tenantServiceEndpoint = tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-43-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-45-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:46:   * Gets the leaf certificate from the tenant mapping response of the connectivity platform tenant
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-47-   * mapping type.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-48-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-49-  public Flux<X509Certificate> getLeafCertificates(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:50:      String signavioTenantId, String externalTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:51:    Mono<SignavioTenantMappingResponse> tenantMappings =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:52:        getTenantMapping(signavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-54-    return AuthorizationManagerUtils.getLeafCertificates(tenantMappings, externalTenantId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-57-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:58:  public String createTenantMappingEndpoint(String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-59-    return tenantServiceEndpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:60:        + String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:61:            CONNECTIVITY_TENANT_MAPPING_PATH,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:62:            signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:63:            CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-64-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:66:  public Mono<Optional<String>> getConnectivityPlatformServiceUrl(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:67:      String signavioTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:68:    Mono<SignavioTenantMappingResponse> tenantMappings =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:69:        this.getTenantMapping(signavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-71-    return tenantMappings.map(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-74-                .map(TenantMappingDto::additionalInfo)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-75-                .filter(Objects::nonNull)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:76:                .map(AdditionalInfoDto::assignedTenant)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-77-                .filter(Objects::nonNull)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-78-                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:79:                    assignedTenant ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:80:                        CONNECTIVITY_APPLICATION_NAMESPACE.equals(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:81:                            assignedTenant.applicationNamespace()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:82:                .map(AssignedTenantDto::applicationUrl)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-83-                .findFirst());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-84-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-85-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:86:  private Mono<SignavioTenantMappingResponse> getTenantMapping(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:87:      String signavioTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:88:    String url = createTenantMappingEndpoint(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-89-    Consumer<HttpHeaders> authAndContentTypeHeaders =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:90:        authAndContentTypeHeaders(signavioTenantId, requestId, jwtUtils);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:91:    return getTenantMapping(url, authAndContentTypeHeaders, SignavioTenantMappingResponse.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-92-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-94-  public static Consumer<HttpHeaders> authAndContentTypeHeaders(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:95:      String signavioTenantId, String requestId, JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:96:    Map<String, String> headerMap = new HashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:97:    JsonWebToken spmJwt = new JsonWebToken(signavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:98:    headerMap.put(HttpHeaders.AUTHORIZATION, jwtUtils.getAuthorizationHeader(spmJwt));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:99:    headerMap.put(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-100-    return createHeadersConsumer(headerMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-101-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-102-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java:103:  public static Consumer<HttpHeaders> createHeadersConsumer(Map<String, String> headerMap) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-104-    return headers -> headerMap.forEach(headers::add);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/ConnectivityPlatformTenantService.java-105-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-3-import static com.sap.bpi.api.gw.filters.JsonWebToken.SPM_SYSTEM_USER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:4:import static com.sap.bpi.api.gw.filters.SpmTokenToSpmJwtFilterFactory.COOKIE_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-5-import static com.sap.bpi.api.gw.filters.utils.FilterUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:6:import static com.sap.bpi.api.gw.filters.utils.csp.Keyword.SELF;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:7:import static com.sap.bpi.api.gw.filters.utils.csp.SourceList.Builder.keywords;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:8:import static com.sap.bpi.api.gw.services.SpmService.X_SIGNAVIO_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-9-import static org.apache.commons.lang3.ObjectUtils.defaultIfNull;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-11-import com.sap.bpi.api.gw.caching.GenericRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:12:import com.sap.bpi.api.gw.caching.RedisKeyUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-13-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-14-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:15:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-16-import com.sap.bpi.api.gw.filters.utils.csp.ContentSecurityPolicyBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-17-import com.sap.bpi.api.gw.filters.utils.csp.ContentSecurityPolicyCompatHeader;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:18:import com.sap.bpi.api.gw.filters.utils.csp.CspDirectiveType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-19-import com.sap.bpi.api.gw.filters.utils.csp.SourceList;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-20-import com.sap.bpi.api.gw.services.SpmService;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-27-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-28-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:29:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:30:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:31:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:32:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:33:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:34:import org.springframework.http.HttpMethod;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:35:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:36:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:37:import org.springframework.web.util.UriComponentsBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-38-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-39-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-41-NOTE: This response filter needs to be added to all UI routes to ensure that the Content Security Policy (CSP) is set correctly.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-42-This filter works as follows:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:43:   0. Checks if the tenant and user attributes are present in the exchange (if not, fetches user from the SPM service by using the x-signavio-id and cookie headers)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:44:   1. Generates an SPM admin JWT bearer token (with the tenant ID and request ID)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-45-   2. Fetches the trusted frame ancestors from the SPM service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-46-   3. Modifies the CSP builder with the trusted frame ancestors and sets the hard-coded trusted domains
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-53-    extends AbstractGatewayFilterFactory<CspResponseFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:55:  public static final String READABLE_VALUE_OF_NULL = "<null>";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:56:  public static final String CSP_REPORTING_URI = "/api/v2/cspreporting";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-58-  @Value("${csp.trusted-domains}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:59:  private String trustedDomains;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-61-  @Value("${redis.enabled}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:62:  private boolean isRedisEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-64-  @Value("${redis.spmCacheTimeoutMinutes}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:65:  private Integer spmCacheTimeoutMinutes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:67:  private final Logger logger = LoggerFactory.getLogger(CspResponseFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:68:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:69:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:70:  private final GenericRedisService<SpmUser> spmUserRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-72-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-74-      SpmService spmService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-75-      @Autowired(required = false) GenericRedisService<SpmUser> spmUserRedisService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:76:      JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-77-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-78-    this.spmService = spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:79:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-80-    this.spmUserRedisService = spmUserRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-81-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-84-  public GatewayFilter apply(Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-85-    return (exchange, chain) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:86:      String tenantAttr = exchange.getAttribute(X_SIGNAVIO_TENANT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:87:      String userAttr = exchange.getAttribute(X_SIGNAVIO_USER_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-88-      HttpHeaders headers = exchange.getRequest().getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-89-      HttpMethod method = exchange.getRequest().getMethod();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:90:      boolean hasXSignavioIdHeader = headers.containsKey(X_SIGNAVIO_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:91:      boolean hasCookieHeader = headers.containsKey(COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-92-      boolean isGetRequest = HttpMethod.GET.equals(method);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-93-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-103-                    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-104-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:105:                    // Case 2: Either tenant or user attribute missing, but both X_SIGNAVIO_ID and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-106-                    // COOKIE headers are present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:107:                    if (hasXSignavioIdHeader && hasCookieHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-108-                      return getUserFromSpmAndAddCspToResponse(exchange, headers, method);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-109-                    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-110-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:111:                    // Case 3: Either tenant or user attribute missing, X_SIGNAVIO_ID header is
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-112-                    // missing, but COOKIE header is present and a GET request
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-113-                    if (hasCookieHeader && isGetRequest) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-118-                    ContentSecurityPolicyBuilder cspBuilder =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-119-                        createCspBuilder(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:120:                            FilterUtils.getRequestIdFromHeaderOrGenerate(exchange.getRequest()),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-121-                            null,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-122-                            null);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-124-                        .getResponse()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-125-                        .getHeaders()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:126:                        .set("Content-Security-Policy", cspBuilder.build().getDirectives());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-127-                    return Mono.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-128-                  }));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-130-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-131-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:132:  private Mono<Void> getUserFromSpmAndAddCspToResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-133-      ServerWebExchange exchange, HttpHeaders headers, HttpMethod method) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-134-    return FilterUtils.getAuthenticationHeadersTuple3Mono(headers, method)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-137-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-138-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:139:  private Mono<Void> addCspToResponseHeaders(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:140:      ServerWebExchange exchange, String tenantId, String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:141:    String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-142-    ContentSecurityPolicyBuilder cspBuilder = createCspBuilder(requestId, tenantId, userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-143-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:144:    String jwtBearer = generateJwtBearer(tenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-145-    return spmService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:146:        .getTrustedFrameAncestorsFromSpm(jwtBearer, requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-147-        .doOnNext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-148-            trustedFrameAncestors -> {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-151-                      cspModifier.appendFrameAncestorsSrc(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-152-                          SourceList.Builder.urls(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:153:                              trustedFrameAncestors.getDomains().toArray(new String[0]))));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-154-              exchange
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-155-                  .getResponse()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-156-                  .getHeaders()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:157:                  .set("Content-Security-Policy", cspBuilder.build().getDirectives());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-158-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-159-        .then();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-160-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-161-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:162:  private ContentSecurityPolicyBuilder createCspBuilder(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:163:      String requestId, String tenantId, String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-164-    ContentSecurityPolicyBuilder cspBuilder = new ContentSecurityPolicyBuilder();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-165-    cspBuilder.frameAncestors(defaultTrustedDomains());
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-168-    cspBuilder.modify(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-169-        it ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:170:            it.appendMissingIfDirectiveExists(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:171:                CspDirectiveType.CONNECT_SRC,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:172:                keywords(SELF)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-173-                    .urls("https://app.launchdarkly.com", "https://events.launchdarkly.com")));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-174-    cspBuilder.modify(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-181-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-182-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:183:  private Mono<SpmUser> getCachedUserOrFetchFromSpm(String token, String cookie, String clientIp) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-184-    // Get cached user from Redis if enabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-185-    Mono<SpmUser> cachedUser =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-186-        isRedisEnabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:187:            ? spmUserRedisService.get(RedisKeyUtils.createSpmUserKey(token, cookie, clientIp))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-188-            : Mono.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-189-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-197-                          // Save to Redis if enabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-198-                          if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:199:                            String redisKey =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:200:                                RedisKeyUtils.createSpmUserKey(token, cookie, clientIp);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-201-                            return spmUserRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:202:                                .set(redisKey, user, Duration.ofMinutes(spmCacheTimeoutMinutes))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-203-                                .thenReturn(user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-204-                          }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-207-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-208-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:209:  private String generateJwtBearer(String tenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:210:    JsonWebToken spmJwt = createConfiguredJwt(tenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:211:    return jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-212-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-213-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:214:  private JsonWebToken createConfiguredJwt(String tenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:215:    JsonWebToken spmJwt = new JsonWebToken(tenantId, SPM_SYSTEM_USER, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:216:    spmJwt.withIsInternal(true);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:217:    spmJwt.withIsAdminUser(true);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:218:    return spmJwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-219-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-220-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:221:  private SourceList defaultTrustedDomains() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:222:    return keywords(SELF).urls(getTrustedDomainsAsList().toArray(new String[0]));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-223-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-224-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:225:  private String addIdentifierParameters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:226:      String oldUri, String requestId, String tenantId, String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:227:    String hashedUserId = defaultIfNull(hashIfNecessary(userId), READABLE_VALUE_OF_NULL);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:228:    String hashedTenantId = defaultIfNull(hashIfNecessary(tenantId), READABLE_VALUE_OF_NULL);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-229-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:230:      return UriComponentsBuilder.fromUriString(oldUri)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-231-          .queryParam("r", requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:232:          .queryParam("u", hashedUserId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:233:          .queryParam("t", hashedTenantId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-234-          .build()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:235:          .toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-236-    } catch (IllegalArgumentException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-237-      logger.info("Could not parse report-uri: {}", oldUri, e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:238:      return oldUri + "?r=" + requestId + "&u=" + hashedUserId + "&t=" + hashedTenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-239-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-240-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-241-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:242:  private static String hashIfNecessary(@Nullable String input) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-243-    if (input == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-244-      return null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-245-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:246:    return DigestUtils.sha512_256Hex(input);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-247-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-248-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:249:  private List<String> getTrustedDomainsAsList() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java:250:    return Arrays.stream(trustedDomains.split(",")).map(String::trim).collect(Collectors.toList());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-251-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/CspResponseFilterFactory.java-252-
--
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-3-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-4-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:5:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:6:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:7:import org.springframework.web.bind.annotation.GetMapping;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:8:import org.springframework.web.bind.annotation.RequestMapping;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:9:import org.springframework.web.bind.annotation.RestController;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-10-
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-11-@RestController
--
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-13-public class IDMPSController {
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-14-
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:15:  private static final String SET_COOKIE_HEADER = "Set-Cookie";
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:16:  private static final String TOKEN_ID = "123456789123456789123456789123456789";
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:17:  private static final String SESSION_ID = "1234";
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-18-
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:19:  private final Logger LOGGER = LoggerFactory.getLogger(IDMPSController.class);
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-20-
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-21-  @GetMapping("/ffa9867e1b014e0993c93dc8cf809cbe/scim/v2/Users")
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:22:  public ResponseEntity<String> getIdmpsRequest() {
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java:23:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-24-    LOGGER.info("Intercepted request from API GW in getIdmpsRequest()");
./mock/src/main/java/com/sap/api/mock/controller/IDMPSController.java-25-    return ResponseEntity.ok()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-6-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-7-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:8:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:9:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:10:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:11:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:12:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:13:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:14:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:15:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:16:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-18-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-20-public class SpgService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:22:  private final Logger logger = LoggerFactory.getLogger(SpgService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:24:  private static final String SPG_ME_PATH = "/api/v1/%s/me";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:25:  private final WebClient webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:26:  private final String spgHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-28-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-29-  public SpgService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-30-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:31:      @Value("${app.spgEndpoint}") String spgHost) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-32-    this.webClient = webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-33-    this.spgHost = spgHost;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-36-  // TODO cache successful response
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:37:  public Mono<SpgUser> getUserDetailsFromSpg(String spgToken, String organizationKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:38:    logger.debug("SPG organization key: {} ", organizationKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-39-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-40-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:41:        .uri(URI.create(spgHost + SPG_ME_PATH.formatted(organizationKey)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-42-        .header(HttpHeaders.AUTHORIZATION, spgToken)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-43-        .retrieve()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-49-                        response.statusCode(), "Error while requesting user details from SPG")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-50-        .bodyToMono(SpgUser.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:51:        // the onErrorMap will be used when we didn't receive a response from SPG,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-52-        // for example when connection is reset
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-53-        .onErrorMap(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-68-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java:70:  private Predicate<? super Throwable> isNotSpgException() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-71-    return e -> !(e instanceof ResponseStatusException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpgService.java-72-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-1-package com.sap.bpi.api.gw.errorhandling;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:3:import static org.springframework.http.HttpStatus.INTERNAL_SERVER_ERROR;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-5-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:6:import org.springframework.boot.web.error.ErrorAttributeOptions;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:7:import org.springframework.boot.web.reactive.error.DefaultErrorAttributes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:8:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:9:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:10:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:11:import org.springframework.web.bind.support.WebExchangeBindException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:12:import org.springframework.web.reactive.function.server.ServerRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:13:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-15-@Component
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-18-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:19:  public Map<String, Object> getErrorAttributes(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-20-      ServerRequest request, ErrorAttributeOptions options) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-21-    Throwable error = this.getError(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-22-    HttpStatus status = getHttpStatus(error);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:23:    Map<String, Object> errorAttributes = super.getErrorAttributes(request, options);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-24-    putErrorMessageAccordingToStatus(errorAttributes, status, error);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-25-    return errorAttributes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-26-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:28:  private HttpStatus getHttpStatus(Throwable error) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-29-    if (error instanceof ResponseStatusException) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-30-      HttpStatusCode statusCode = ((ResponseStatusException) error).getStatusCode();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-35-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:37:  private void putErrorMessageAccordingToStatus(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:38:      Map<String, Object> errorAttributes, HttpStatus status, Throwable error) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-39-    switch (status) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-40-      case NOT_FOUND -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:41:        String path = (String) errorAttributes.get("path");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-42-        errorAttributes.computeIfAbsent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:43:            "message", k -> String.format("The specified URL %s was not found", path));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-44-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-45-      case GATEWAY_TIMEOUT -> /*
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-54-        if (error instanceof WebExchangeBindException) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-55-          WebExchangeBindException ex = (WebExchangeBindException) error;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java:56:          String errorMsg = ex.getBindingResult().getFieldError().getDefaultMessage();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-57-          errorAttributes.put("message", errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorAttributes.java-58-          errorAttributes.remove("errors");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getRequestIdFromHeaderOrGenerate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-4-import static com.sap.bpi.api.gw.security.certificate.IpsAuthorizationManager.SPM_TENANT_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:6:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-7-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-8-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:9:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:10:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:11:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:12:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:13:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:14:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:15:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:16:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-18-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-24- *   <li>extracts the IPS tenant ID from the "spm-tenant" header that is set by {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-25- *       com.sap.bpi.api.gw.security.certificate.IpsAuthorizationManager}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:26: *   <li>generates a new SPM JWT token using the SPM tenant Id
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-27- *   <li>puts the token into the "Authorization: Bearer" header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-28- *   <li>removes the "spm-tenant" header from the request
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-29- * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-30- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:31: * <p>{@code @Component} annotation is used to mark this class as a Spring component. The instance
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:32: * of this class will be created by Spring during the component-scan process.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-33- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-34-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:35:public class SpmJwtWithIpsTenantIdFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:36:    extends AbstractGatewayFilterFactory<SpmJwtWithIpsTenantIdFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:37:  private final Logger logger = LoggerFactory.getLogger(SpmJwtWithIpsTenantIdFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-39-  /*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:40:   * we use system instead of the user email, because we don't receive it from IPS
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-41-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:42:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-44-  @Value("${feature.reactorDebug.enabled}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:45:  private boolean reactorDebugEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-47-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:48:  public SpmJwtWithIpsTenantIdFilterFactory(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-49-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-50-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:51:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-52-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:53:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-54-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:55:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-56-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-57-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-62-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-63-              ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:64:              String spmTenantId = getSpmTenantId(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:65:              String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:66:              JsonWebToken spmJwt = new JsonWebToken(spmTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:67:              String jwtBearer = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-68-              ServerHttpRequest.Builder builder = request.mutate();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:69:              builder.header(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-70-              ServerHttpRequest requestBuild = builder.build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:71:              logger.debug("IDMPS request is forwarded with SPM JWT token.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-72-              if (reactorDebugEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-73-                Mono<Void> result = chain.filter(exchange.mutate().request(requestBuild).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-74-                return result
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:75:                    .log("Log Mono.defer() - SpmJwtWithIpsTenantIdFilter")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:76:                    .checkpoint("Checkpoint Mono.defer() - SpmJwtWithIpsTenantIdFilter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-77-              } else return chain.filter(exchange.mutate().request(requestBuild).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-78-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:81:  private String getSpmTenantId(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java:82:    String spmTenantId = exchange.getAttribute(SPM_TENANT_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-83-    logger.info("SPM tenant ID extracted from header: {}", spmTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithIpsTenantIdFilterFactory.java-84-    exchange.getAttributes().remove(SPM_TENANT_ATTRIBUTE);
--
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-3-import org.slf4j.Logger;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-4-import org.slf4j.LoggerFactory;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:5:import org.springframework.http.MediaType;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:6:import org.springframework.http.ResponseEntity;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:7:import org.springframework.web.bind.annotation.GetMapping;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:8:import org.springframework.web.bind.annotation.RequestMapping;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:9:import org.springframework.web.bind.annotation.RestController;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-10-
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-11-@RestController
--
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-13-public class JMController {
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-14-
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:15:  private static final String SET_COOKIE_HEADER = "Set-Cookie";
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:16:  private static final String TOKEN_ID = "123456789123456789123456789123456789";
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:17:  private static final String SESSION_ID = "1234";
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-18-
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:19:  private final Logger LOGGER = LoggerFactory.getLogger(JMController.class);
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-20-
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-21-  @GetMapping("/api/testjm")
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:22:  public ResponseEntity<String> getJMRequest() {
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-23-
./mock/src/main/java/com/sap/api/mock/controller/JMController.java:24:    String cookieHeader = "JSESSIONID=" + SESSION_ID + ";" + "token=" + TOKEN_ID;
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-25-    LOGGER.info("Intercepted request from API GW in getJMRequest() for /testjm endpoint");
./mock/src/main/java/com/sap/api/mock/controller/JMController.java-26-    return ResponseEntity.ok()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-3-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:4:import org.springframework.beans.factory.ObjectProvider;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:5:import org.springframework.cloud.gateway.config.HttpClientProperties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:6:import org.springframework.cloud.gateway.filter.NettyRoutingFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:7:import org.springframework.cloud.gateway.filter.headers.HttpHeadersFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:8:import org.springframework.cloud.gateway.route.Route;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:9:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-10-import reactor.netty.http.client.HttpClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-12-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:13: * Custom routing filter that uses a route-specific HttpClient for mTLS connections. The HttpClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:14: * must be provided in the exchange attributes under the key ATTR_CUSTOM_HTTP_CLIENT. If the client
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-15- * is not found, an IllegalStateException is thrown.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-16- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:17:public class MtlsOnlyRoutingFilter extends NettyRoutingFilter {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:18:  public static final String ATTR_CUSTOM_HTTP_CLIENT = "CUSTOM_HTTP_CLIENT";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:20:  public MtlsOnlyRoutingFilter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-21-      ObjectProvider<List<HttpHeadersFilter>> headersFiltersProvider,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-22-      HttpClientProperties properties) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-31-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-32-    throw new IllegalStateException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java:33:        "Missing required mTLS HttpClient in exchange attributes: " + ATTR_CUSTOM_HTTP_CLIENT);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/MtlsOnlyRoutingFilter.java-35-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-3-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-4-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:5:import org.springframework.core.io.buffer.DataBuffer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:6:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:7:import org.springframework.http.MediaType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:8:import org.springframework.http.server.reactive.ServerHttpResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:9:import org.springframework.security.core.AuthenticationException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:10:import org.springframework.security.web.server.ServerAuthenticationEntryPoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:11:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-12-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-14-public class Custom403AuthenticationEntryPoint implements ServerAuthenticationEntryPoint {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:16:  private final Logger logger = LoggerFactory.getLogger(Custom403AuthenticationEntryPoint.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-18-  @Override
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-22-    response.getHeaders().setContentType(MediaType.APPLICATION_JSON);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:24:    String path = exchange.getRequest().getPath().value();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:25:    String responseBody =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java:26:        String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-27-            "{\"message\": \"You don't have permission to access this resource\", \"path\": \"%s\","
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/Custom403AuthenticationEntryPoint.java-28-                + " \"error\": \"%s\"}",
--
./mock/src/main/java/com/sap/api/mock/MockApplication.java-1-package com.sap.api.mock;
./mock/src/main/java/com/sap/api/mock/MockApplication.java-2-
./mock/src/main/java/com/sap/api/mock/MockApplication.java:3:import org.springframework.boot.SpringApplication;
./mock/src/main/java/com/sap/api/mock/MockApplication.java:4:import org.springframework.boot.autoconfigure.SpringBootApplication;
./mock/src/main/java/com/sap/api/mock/MockApplication.java-5-
./mock/src/main/java/com/sap/api/mock/MockApplication.java:6:@SpringBootApplication
./mock/src/main/java/com/sap/api/mock/MockApplication.java-7-public class MockApplication {
./mock/src/main/java/com/sap/api/mock/MockApplication.java:8:  public static void main(String[] args) {
./mock/src/main/java/com/sap/api/mock/MockApplication.java:9:    SpringApplication.run(MockApplication.class, args);
./mock/src/main/java/com/sap/api/mock/MockApplication.java-10-  }
./mock/src/main/java/com/sap/api/mock/MockApplication.java-11-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:3:import io.netty.handler.ssl.SslContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:4:import io.netty.handler.ssl.SslContextBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:5:import java.security.KeyStore;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:6:import java.security.PrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-7-import java.security.cert.Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-8-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-9-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-10-import java.util.function.Function;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:11:import javax.net.ssl.KeyManagerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:12:import javax.net.ssl.TrustManagerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-13-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-14-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:15:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:16:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:17:import org.springframework.http.client.reactive.ReactorClientHttpConnector;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:18:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:19:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-20-import reactor.netty.http.client.HttpClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-22-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:23: * Factory for creating HttpClient instances configured with mTLS (mutual TLS) authentication. This
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:24: * factory is responsible for SSL/certificate handling and delegates HTTP client configuration to a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:25: * single creator bean (mtlsHttpClientCreator) for proper connection pooling, metrics, and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:26: * monitoring support.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-27- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-28-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:29:public class MtlsClientFactory {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:31:  private static final Logger logger = LoggerFactory.getLogger(MtlsClientFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:33:  private final Function<SslContext, HttpClient> mtlsHttpClientCreator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:34:  private final KeyStore trustStore;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-36-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-42-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-43-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:44:  public MtlsClientFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:45:      @Qualifier("mtlsHttpClientCreator") Function<SslContext, HttpClient> mtlsHttpClientCreator,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:46:      @Qualifier("mtlsTrustStore") KeyStore trustStore) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:47:    this.mtlsHttpClientCreator = mtlsHttpClientCreator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-48-    this.trustStore = trustStore;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-49-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-51-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:52:   * Creates an HttpClient configured with mTLS using the provided certificate chain and private
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:53:   * key. This method creates the SSL context and delegates HTTP client configuration to the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:54:   * MtlsHttpClientProvider bean for proper connection pooling, metrics, and TCP keepalive settings.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-55-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-56-   * @param certificateChain The complete certificate chain (client cert + intermediates)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:57:   * @param privateKey The private key corresponding to the client certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:58:   * @return An HttpClient configured for mTLS connections with metrics and monitoring
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:59:   * @throws RuntimeException if SSL context creation fails
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-60-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:61:  public HttpClient createMtlsHttpClient(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:62:      List<X509Certificate> certificateChain, PrivateKey privateKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-63-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-64-      if (certificateChain == null || certificateChain.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-67-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-68-      logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:69:          "Creating SSL context for mTLS HttpClient with certificate chain (size: {})",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-70-          certificateChain.size());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:72:      SslContext sslContext = createSslContext(certificateChain, privateKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:74:      return mtlsHttpClientCreator.apply(sslContext);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-75-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:76:      logger.error("Failed to create mTLS HttpClient with certificate chain.", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:77:      throw new RuntimeException("Failed to create mTLS HttpClient", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-78-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-81-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:82:   * Creates an SSL context configured with a complete certificate chain and private key for mTLS.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-83-   * This method properly handles certificate chains including intermediate certificates to resolve
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:84:   * SSL handshake issues where servers require the complete chain.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-85-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-86-   * @param certificateChain The complete certificate chain (client cert first, then intermediates)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:87:   * @param privateKey The private key corresponding to the client certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:88:   * @return Configured SSL context
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:89:   * @throws Exception if SSL context creation fails
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-90-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:91:  private SslContext createSslContext(List<X509Certificate> certificateChain, PrivateKey privateKey)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-92-      throws Exception {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-93-    if (certificateChain == null || certificateChain.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-96-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-97-    logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:98:        "Creating SSL context for mTLS authentication with certificate chain of size: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-99-        certificateChain.size());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-100-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:101:    // Convert List to Certificate array for KeyStore
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-102-    Certificate[] chainArray = certificateChain.toArray(new Certificate[0]);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-103-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-111-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:113:    // Create KeyStore with complete certificate chain and private key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:114:    KeyStore keyStore = KeyStore.getInstance("PKCS12");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:115:    keyStore.load(null, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:116:    keyStore.setKeyEntry("client", privateKey, "".toCharArray(), chainArray);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:118:    // Create KeyManagerFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:119:    KeyManagerFactory kmf = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:120:    kmf.init(keyStore, "".toCharArray());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-121-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-122-    // Create TrustManagerFactory (using default trust store)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-124-        TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-125-    if (trustStore != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:126:      logger.debug("Using custom trust store for mTLS authentication");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-127-      tmf.init(trustStore);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-128-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:129:      logger.debug("Using system default trust store for mTLS authentication");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:130:      tmf.init((KeyStore) null); // Use system default trust store
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-131-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-132-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:133:    return SslContextBuilder.forClient().keyManager(kmf).trustManager(tmf).build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-134-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-135-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-136-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:137:   * Creates a WebClient configured with mTLS using the provided certificate chain and private key.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:138:   * This method creates an mTLS-enabled HttpClient and wraps it in a WebClient for reactive HTTP
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-139-   * operations.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-140-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:141:  public WebClient createMtlsWebClient(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:142:      PrivateKey privateKey, List<X509Certificate> certificateChain) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:143:    // Create properly configured mTLS HttpClient using centralized configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-144-    // This will validate certificateChain is not null or empty
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:145:    HttpClient mtlsHttpClient = createMtlsHttpClient(certificateChain, privateKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-146-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-147-    logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:148:        "Creating mTLS WebClient with certificate chain (size: {})", certificateChain.size());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-149-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:150:    // This reuses the connection pool from mtlsHttpClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-151-    return WebClient.builder()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java:152:        .clientConnector(new ReactorClientHttpConnector(mtlsHttpClient))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-153-        .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/MtlsClientFactory.java-154-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-3-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:4:import org.springframework.boot.autoconfigure.web.WebProperties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:5:import org.springframework.boot.autoconfigure.web.reactive.error.AbstractErrorWebExceptionHandler;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:6:import org.springframework.boot.web.error.ErrorAttributeOptions;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:7:import org.springframework.boot.web.reactive.error.ErrorAttributes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:8:import org.springframework.context.ApplicationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:9:import org.springframework.core.annotation.Order;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:10:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:11:import org.springframework.http.MediaType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:12:import org.springframework.http.codec.ServerCodecConfigurer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:13:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:14:import org.springframework.web.reactive.function.BodyInserters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:15:import org.springframework.web.reactive.function.server.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-16-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-17-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:36:  private Mono<ServerResponse> renderErrorResponse(ServerRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java:37:    Map<String, Object> errorPropertiesMap =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-38-        getErrorAttributes(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/errorhandling/GlobalErrorWebExceptionHandler.java-39-            request,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getRequestIdFromHeaderOrGenerate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:4:import static com.sap.bpi.api.gw.filters.utils.JwtUtils.BEARER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-5-import static com.sap.bpi.api.gw.filters.utils.SpmRequestResponseFilterUtils.X_FORWARDED_FOR_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-7-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:8:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-9-import com.sap.bpi.api.gw.services.SpmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-10-import java.util.Arrays;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-14-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-15-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:16:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:17:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:18:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:19:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:20:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:21:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:22:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:23:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-24-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-26-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:27: * This filter extracts the SPM opaque token from an incoming UgwJwt in the Authorization Header.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:28: * The filter uses the same enablement flag as the UgwJwtFilter.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-29- * If the filter is enabled and an incoming request contains an empty or malformed Authorization header with Bearer token,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-30- * a RuntimeException is thrown.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:31: * In addition, a RuntimeException is thrown when the JwtParser not able to parse the jwt correctly in method getXSignavioIdToken().
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-32- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-34-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:35:public class UgwJwtToSpmJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:36:    extends AbstractGatewayFilterFactory<UgwJwtToSpmJwtFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:38:  private final Logger logger = LoggerFactory.getLogger(UgwJwtToSpmJwtFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:40:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:41:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-43-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:44:  public UgwJwtToSpmJwtFilterFactory(JwtUtils jwtUtils, SpmService spmService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-45-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-46-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:47:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-48-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:49:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-50-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:51:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-52-    this.spmService = spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-53-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-60-                  ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-61-                  HttpHeaders headers = request.getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:62:                  List<String> authorizationHeader = headers.get(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-63-                  if (authorizationHeader == null || authorizationHeader.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-64-                    return chain.filter(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-65-                  } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:66:                    String headerValue = authorizationHeader.get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-67-                    if (!isAuthorizationHeaderValueValid(headerValue)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-68-                      // 401 as credentials not provided in expected format (Bearer token);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-72-                              HttpStatus.UNAUTHORIZED, "Authentication credentials are not valid"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-73-                    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:74:                      String ugwJwt = headerValue.substring(BEARER.length() + 1);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:75:                      String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-76-                      Set<FeatureApplication> featureSets = config.getFeatureApplications();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:77:                      String xForwardedFor = headers.getFirst(X_FORWARDED_FOR_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:78:                      JsonWebToken spmJwt = jwtUtils.convertUgwJwtToSpmJwt(ugwJwt, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:79:                      String spmJwtString = jwtUtils.getAuthorizationHeader(spmJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-80-                      return spmService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:81:                          .getUserDetailsFromSpmWithSpmJwt(spmJwtString, xForwardedFor, featureSets)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-82-                          .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-83-                              spmUser -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:84:                                JsonWebToken enrichedSpmJwt =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:85:                                    spmJwt.enrichJwtWithSpmUserDetails(spmUser);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-86-                                ServerHttpRequest.Builder builder =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-87-                                    request
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-89-                                        .header(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-90-                                            HttpHeaders.AUTHORIZATION,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:91:                                            jwtUtils
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-92-                                                .getSpmAuthorizationHeaderAsASingletonList(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:93:                                                    enrichedSpmJwt)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-94-                                                .get(0));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-95-                                ServerHttpRequest modifiedRequest = builder.build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-96-                                logger.info(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:97:                                    "Replaced Authorization Header bearer token with SPM JWT"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-98-                                        + " token");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-99-                                return chain.filter(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-108-  /*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:109:   * Check if the given token is a valid Bearer token of the format: "Bearer <token>"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-110-   * */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:111:  private boolean isAuthorizationHeaderValueValid(String headerValue) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-112-    return headerValue != null && headerValue.startsWith(BEARER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-113-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-114-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-115-  public static class Config {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java:116:    private final Set<FeatureApplication> featureApplications;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpmJwtFilterFactory.java-118-    public Config(FeatureApplication... featureApplications) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:3:import static com.sap.bpi.api.gw.security.certificate.utils.MappingTypes.SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_WORKZONE_INTEGRATION_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-5-import com.sap.bpi.api.gw.dto.tenant.workzone.WorkzoneTenantServiceResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:6:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:7:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:8:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:9:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:10:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-11-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-13-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-14-public class WorkzoneIasTenantService extends TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:15:  public static final String WORKZONE_TENANT_MAPPING_PATH = "/v1/tenants/%s/mappings?type=%s";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:16:  private final String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-18-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-19-  public WorkzoneIasTenantService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-20-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:21:      @Value("${app.tenantServiceEndpoint}") String tenantServiceEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-22-    super(webClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-23-    this.tenantServiceEndpoint = tenantServiceEndpoint;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-26-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:27:  public String createTenantMappingEndpoint(String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-28-    return tenantServiceEndpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:29:        + String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-30-            WORKZONE_TENANT_MAPPING_PATH,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:31:            signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:32:            SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_WORKZONE_INTEGRATION_MAPPING_TYPE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-33-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:35:  public Mono<WorkzoneTenantServiceResponse> getTenantMapping(String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java:36:    String url = createTenantMappingEndpoint(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-37-    return getTenantMapping(url, WorkzoneTenantServiceResponse.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/WorkzoneIasTenantService.java-38-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-5-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:6:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:7:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:8:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:9:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:10:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:11:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:12:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:13:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:14:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-15-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-17-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:18: * This filter moves the ingestion token from the sap-signavio-ingestion-entity-id header to the entity-id header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:19: * And set Authorization header as an SPM JWT as per https://wiki.one.int.sap/wiki/display/SIGEWS/IPD0008+-+IAS+%3C-%3E+API+Gateway+%3C-%3E+Ingestion+API+v2
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:20: * The x-signavio-tenant-id attribute which is set by the IasAuthorizationManager is also moved to the x-signavio-tenant-id header.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-21- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-22- */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-24-public class IngestionTokenToAuthHeaderFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-25-    extends AbstractGatewayFilterFactory<IngestionTokenToAuthHeaderFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:26:  /*Gets the value from sap-signavio-ingestion-entity-id header*/
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:27:  public static final String ENTITY_ID_HEADER = "entity-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:29:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-31-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:32:  public IngestionTokenToAuthHeaderFilterFactory(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-33-    super(IngestionTokenToAuthHeaderFilterFactory.Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:34:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-35-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-36-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-40-        Mono.defer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-41-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:42:              String xSignavioTenantId = getSignavioTenantIdFromExchange(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:43:              exchange.getAttributes().remove(X_SIGNAVIO_TENANT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-44-              ServerHttpRequest.Builder builder = exchange.getRequest().mutate();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:45:              String ingestionToken =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-46-                  exchange
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-47-                      .getRequest()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-48-                      .getHeaders()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:49:                      .getFirst(SAP_SIGNAVIO_INGESTION_ENTITY_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-51-              if (ingestionToken == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-52-                throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:53:                    HttpStatus.BAD_REQUEST, "Missing sap-signavio-ingestion-entity-id header");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-54-              }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:55:              String requestId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:56:                  FilterUtils.getRequestIdFromHeaderOrGenerate(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:57:              JsonWebToken spmJwt = new JsonWebToken(xSignavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:58:              String jwtBearer = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-59-              builder.headers(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-60-                  headers -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-61-                    headers.remove(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:62:                    headers.add(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-63-                    headers.add(ENTITY_ID_HEADER, ingestionToken);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java:64:                    headers.add(X_SIGNAVIO_TENANT_ID_HEADER, xSignavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-65-                  });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/IngestionTokenToAuthHeaderFilterFactory.java-66-              ServerHttpRequest request = builder.build();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:3:import static com.sap.bpi.api.gw.security.certificate.utils.MappingTypes.CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-5-import com.sap.bpi.api.gw.dto.tenant.datasphere.DatasphereTenantServiceResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:6:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:7:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:8:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:9:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:10:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-11-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-12-import reactor.core.publisher.Mono;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-14-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-15-public class DatasphereTenantService extends TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:16:  public static final String TENANT_MAPPING_BY_EXTERNAL_TENANT_ID_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-17-      "/v1/tenants/external/%s/mappings?type=%s";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:18:  private final String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-20-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-21-  public DatasphereTenantService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-22-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:23:      @Value("${app.tenantServiceEndpoint}") String tenantServiceEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-24-    super(webClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-25-    this.tenantServiceEndpoint = tenantServiceEndpoint;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-28-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:29:  public String createTenantMappingEndpoint(String datasphereTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:30:    // tenant mapping type was changed to connectivity platform as a part of
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-31-    // https://jira.tools.sap/browse/SIGPEX-33900
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-32-    return tenantServiceEndpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:33:        + String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-34-            TENANT_MAPPING_BY_EXTERNAL_TENANT_ID_PATH,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-35-            datasphereTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:36:            CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-37-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:39:  public Mono<DatasphereTenantServiceResponse> getTenantMapping(String datasphereTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:40:    String url = createTenantMappingEndpoint(datasphereTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-41-    return getTenantMapping(url, DatasphereTenantServiceResponse.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-42-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-46-   * type.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-47-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java:48:  public Flux<String> getTrustedSubjects(Mono<DatasphereTenantServiceResponse> tenantMappings) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DatasphereTenantService.java-50-    return tenantMappings
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-3-import com.sap.bpi.api.gw.caching.GenericRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:4:import com.sap.bpi.api.gw.dto.PublicKeyListDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-5-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:6:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:7:import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:8:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:9:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:10:import org.springframework.data.redis.core.ReactiveRedisOperations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-12-/**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-22-   * by RedisService.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-23-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:24:   * @param operations ReactiveRedisOperations for SpmUser
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-25-   * @return GenericRedisService for SpmUser
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-26-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-27-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-28-  public GenericRedisService<SpmUser> spmUserRedisService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:29:      ReactiveRedisOperations<String, SpmUser> operations) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-30-    return new GenericRedisService<>(operations);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-33-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:34:   * Generic Redis service for PublicKeyListDto objects. This replaces the functionality previously
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:35:   * handled by PublicKeyRedisService.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-36-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:37:   * @param operations ReactiveRedisOperations for PublicKeyListDto
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:38:   * @return GenericRedisService for PublicKeyListDto
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-39-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-40-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:41:  public GenericRedisService<PublicKeyListDto> publicKeyRedisService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:42:      ReactiveRedisOperations<String, PublicKeyListDto> operations) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-43-    return new GenericRedisService<>(operations);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-44-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-46-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:47:   * Generic Redis service for String objects (JWT tokens). This replaces the functionality
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:48:   * previously handled by XsuaaJwtRedisService.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-49-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:50:   * @param operations ReactiveRedisOperations for String
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:51:   * @return GenericRedisService for String
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-52-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-53-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:54:  public GenericRedisService<String> stringRedisService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java:55:      @Qualifier("xsuaaJwtRedisTemplate") ReactiveRedisOperations<String, String> operations) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-56-    return new GenericRedisService<>(operations);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/GenericRedisConfiguration.java-57-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:3:import static com.sap.bpi.api.gw.security.certificate.utils.MappingTypes.SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_SUBSCRIPTION_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:4:import static com.sap.bpi.api.gw.services.ConnectivityPlatformTenantService.authAndContentTypeHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:6:import com.sap.bpi.api.gw.dto.tenant.SignavioTenantMappingResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:7:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-8-import java.util.function.Consumer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:9:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:10:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:11:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:12:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:13:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:14:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-15-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-17-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-18-public class JouleIasTenantService extends TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:19:  public static final String JOULE_SIGNAVIO_TENANT_MAPPING_PATH = "/v1/tenants/%s/mappings?type=%s";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:20:  private final String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:21:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-23-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-24-  public JouleIasTenantService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-25-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:26:      @Value("${app.tenantServiceEndpoint}") String tenantServiceEndpoint,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:27:      JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-28-    super(webClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-29-    this.tenantServiceEndpoint = tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:30:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-33-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:34:  public String createTenantMappingEndpoint(String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-35-    return tenantServiceEndpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:36:        + String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:37:            JOULE_SIGNAVIO_TENANT_MAPPING_PATH,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:38:            signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:39:            SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_SUBSCRIPTION_MAPPING_TYPE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-40-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:42:  public Mono<SignavioTenantMappingResponse> getTenantMapping(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:43:      String signavioTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:44:    String url = createTenantMappingEndpoint(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-45-    Consumer<HttpHeaders> httpHeadersConsumer =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:46:        authAndContentTypeHeaders(signavioTenantId, requestId, jwtUtils);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java:47:    return getTenantMapping(url, httpHeadersConsumer, SignavioTenantMappingResponse.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-48-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleIasTenantService.java-49-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-5-import io.micrometer.core.instrument.config.MeterFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-6-import java.util.Set;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java:7:import org.springframework.boot.actuate.autoconfigure.metrics.MeterRegistryCustomizer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java:8:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java:9:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-11-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-12-public class MetricsConfiguration {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java:14:  /** Reactor Netty metric prefix for filtering. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java:15:  public static final String REACTOR_NETTY_METRIC_PREFIX = "reactor.netty";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-17-  /** Allowed connection provider metrics to collect. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java:18:  public static final Set<String> ALLOWED_CONNECTION_PROVIDER_METRICS =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-19-      Set.of(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-20-          "reactor.netty.connection.provider.total.connections",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-46-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-47-  public boolean shouldDenyMetric(Meter.Id id) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java:48:    String name = id.getName();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/MetricsConfiguration.java-50-    // Only filter Reactor Netty connection provider metrics
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-1-package com.sap.bpi.api.gw.security;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.X_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:4:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-6-import com.sap.bpi.api.gw.global.AuditLogClientManager;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-10-import java.util.stream.Collectors;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-11-import java.util.stream.Stream;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:12:import org.apache.commons.lang3.StringUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-13-import org.apache.commons.validator.routines.InetAddressValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-14-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-15-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:16:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:17:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:18:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:19:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:20:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:21:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:22:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:23:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:24:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:25:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-26-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-28-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-29-public class ForwardedIpAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:30:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:31:  public static final String HEADER_X_FORWARDED_FOR = "X-FORWARDED-FOR";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:32:  public static final String HEADER_USER_AGENT = "User-Agent";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:33:  private static final InetAddressValidator validator = InetAddressValidator.getInstance();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:34:  private static final int IPS_TO_CONSIDER = 5;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:35:  private final Logger logger = LoggerFactory.getLogger(ForwardedIpAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-37-  @Value("${app.ipAllowList}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:38:  private String allowListString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-40-  @Autowired AuditLogClientManager auditLogClientManager;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-44-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-45-    HttpHeaders headers = context.getExchange().getRequest().getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:46:    List<String> forwardedHeaders = headers.getOrEmpty(HEADER_X_FORWARDED_FOR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-47-    if (forwardedHeaders.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-48-      return authenticateOrThrow(authentication);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-49-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:51:    String[] providedIPs = extractProvidedIPs(forwardedHeaders);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:53:    // Extract tenant ID from x-signavio-tenant-id or sap-signavio-tenant-id headers
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:54:    String signavioTenantId = headers.getFirst(X_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:55:    if (signavioTenantId == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:56:      signavioTenantId = headers.getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-57-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:59:    String userAgent = headers.getFirst(HEADER_USER_AGENT);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-61-    return assertProvidedIPsToAuthenticate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:62:        providedIPs, authentication, signavioTenantId, userAgent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-63-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-64-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:65:  private Mono<AuthorizationDecision> authenticateOrThrow(Mono<Authentication> authentication) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:66:    String errorMessage = "X-Forwarded-For header not present";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-67-    logger.warn(errorMessage);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-68-    return authentication
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-73-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-74-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:75:  private Mono<AuthorizationDecision> assertProvidedIPsToAuthenticate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:76:      String[] ips,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-77-      Mono<Authentication> authentication,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:78:      String signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:79:      String userAgent) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:80:    String errorMessage = "No valid IP in X-Forwarded-For header found";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-81-    return authentication
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-82-        .map(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-87-            new AuthorizationDecision(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-88-                isIpAllowed(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:89:                    ips, signavioTenantId, userAgent))) // if auth mono is empty we check origin IPs
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-90-        .filter(AuthorizationDecision::isGranted)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-91-        .switchIfEmpty(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-93-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-94-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:95:  private String[] extractProvidedIPs(List<String> forwardedHeaders) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-96-    return forwardedHeaders.size() == 1
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-97-        ? forwardedHeaders.get(0).split(",")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-98-        :
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:99:        // in case multiple x-forwarded-for header fields are received (according to
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-100-        // https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:101:        String.join(",", forwardedHeaders).split(",");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-102-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-103-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:104:  private boolean isValidIpAddress(String ip) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-105-    return validator.isValid(ip); // IPv4 + IPv6
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-106-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:108:  private boolean isIpAllowed(String[] headerValues, String signavioTenantId, String userAgent) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:109:    Set<String> allowedIPs = Stream.of(allowListString.split(",")).collect(Collectors.toSet());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-110-    int skipEntries =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-111-        headerValues.length >= IPS_TO_CONSIDER ? headerValues.length - IPS_TO_CONSIDER : 0;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-114-        Arrays.stream(headerValues)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-115-            .skip(skipEntries)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:116:            .map(StringUtils::trimToEmpty)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-117-            .filter(this::isValidIpAddress)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-118-            .anyMatch(allowedIPs::contains);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-122-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-123-      // Only log to ALS if tenant ID is available
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:124:      if (signavioTenantId != null && !signavioTenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-125-        auditLogClientManager.logUnauthorizedAccess(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java:126:            signavioTenantId, Arrays.asList(headerValues), userAgent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-127-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/ForwardedIpAuthorizationManager.java-128-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-7-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-8-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:9:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:10:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:11:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:12:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:13:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-14-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-16-public abstract class TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:17:  private final WebClient webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:18:  private final Logger logger = LoggerFactory.getLogger(TenantService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-20-  public TenantService(WebClient webClient) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-22-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:24:  public abstract String createTenantMappingEndpoint(String id);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-26-  protected <T extends TenantServiceResponse> Mono<T> getTenantMapping(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:27:      String url, Class<T> responseType) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-28-    return getTenantMapping(url, headers -> {}, responseType);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-29-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-31-  protected <T extends TenantServiceResponse> Mono<T> getTenantMapping(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:32:      String url, Consumer<HttpHeaders> headers, Class<T> responseType) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-33-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-34-        .get()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-55-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java:57:  private Predicate<? super Throwable> isNotTenantServiceException() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-58-    return e -> !(e instanceof ResponseStatusException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/TenantService.java-59-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-8-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-9-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:10:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:11:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:12:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-14-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:15:This configuration provides a bean for the LaunchDarklyService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-16-When the bean is initiated, the state of all launch darkly flags is logged
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-17-**/
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-18-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-19-public class LaunchDarklyConfig {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:20:  private final Logger logger = LoggerFactory.getLogger(LaunchDarklyConfig.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:22:  @Value("${feature.launchDarkly.sdkKey}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:23:  private String sdkKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-25-  @Bean
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-31-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-32-  public LDClient ldClient() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:33:    return new LDClient(sdkKey, getLdConfig());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:36:  private void logLaunchDarklyFlags(LDClient ldClient) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:37:    LDContext context = LDContext.builder("placeholder-key").build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-38-    FeatureFlagsState allFlagsState = ldClient.allFlagsState(context);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-39-    if (allFlagsState.isValid()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-40-      allFlagsState
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-41-          .toValuesMap()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:42:          .forEach((key, value) -> logger.info("LD Flag: {} = {}", key, value));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-43-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-44-      logger.info("LaunchDarkly flags state can not be computed");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-46-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:48:  private LDConfig getLdConfig() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java:49:    return "offline-key".equals(sdkKey)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-50-        ? new LDConfig.Builder().offline(true).build()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyConfig.java-51-        : new LDConfig.Builder().build();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-3-import static io.jsonwebtoken.io.Encoders.BASE64URL;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:5:import com.sap.bpi.api.gw.dto.PublicKeyDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:6:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-7-import java.math.BigInteger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:8:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:9:import java.security.interfaces.DSAPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:10:import java.security.interfaces.ECPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:11:import java.security.interfaces.RSAPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-12-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-13-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-15-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:16: * Utility class for converting PublicKey objects to PublicKeyDto with algorithm selection based on
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:17: * key type and size.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-18- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:19:public class PublicKeyUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:21:  private static final Logger logger = LoggerFactory.getLogger(PublicKeyUtils.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-23-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:24:   * Converts a PublicKey to a PublicKeyDto with appropriate parameters based on key type.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-25-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:26:   * @param publicKey the public key to convert
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:27:   * @param ugwJwtConfig the UGW JWT configuration for key encoding
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:28:   * @return the PublicKeyDto representation
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-29-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:30:  public static PublicKeyDto convertToPublicKeyDto(PublicKey publicKey, UgwJwtConfig ugwJwtConfig) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:31:    String keyType = determinePublicKeyType(publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:32:    String keyId = ugwJwtConfig.getKeyId(publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:33:    String encodedPublicKey = ugwJwtConfig.getPublicKeyAsEncodedString(publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:35:    if (publicKey instanceof RSAPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:36:      RSAPublicKey rsaPublicKey = (RSAPublicKey) publicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:37:      BigInteger exponent = rsaPublicKey.getPublicExponent();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:38:      BigInteger modulus = rsaPublicKey.getModulus();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:40:      String encodedExponent = BASE64URL.encode(exponent.toByteArray());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:41:      String encodedModulus = BASE64URL.encode(modulus.toByteArray());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:42:      String algorithm = determineRsaAlgorithm(rsaPublicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:44:      return new PublicKeyDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:45:          keyId, keyType, algorithm, encodedPublicKey, encodedExponent, encodedModulus);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:46:    } else if (publicKey instanceof ECPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:47:      ECPublicKey ecPublicKey = (ECPublicKey) publicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:48:      String algorithm = determineEcAlgorithm(ecPublicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:50:      // For EC keys, we don't use e and n parameters (set to null or empty)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:51:      return new PublicKeyDto(keyId, keyType, algorithm, encodedPublicKey, null, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:52:    } else if (publicKey instanceof DSAPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:53:      DSAPublicKey dsaPublicKey = (DSAPublicKey) publicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:54:      String algorithm = determineDsaAlgorithm(dsaPublicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:56:      // For DSA keys, we don't use e and n parameters (set to null or empty)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:57:      return new PublicKeyDto(keyId, keyType, algorithm, encodedPublicKey, null, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-58-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:59:      // For other key types, use generic approach
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:60:      String algorithm = determineGenericAlgorithm(publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:61:      return new PublicKeyDto(keyId, keyType, algorithm, encodedPublicKey, null, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-62-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-63-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-64-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-65-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:66:   * Determines the public key type (kty) based on the PublicKey instance.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-67-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:68:   * @param publicKey the public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:69:   * @return the key type string (RSA, EC, etc.)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-70-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:71:  private static String determinePublicKeyType(PublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:72:    if (publicKey instanceof RSAPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:73:      return "RSA";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:74:    } else if (publicKey instanceof ECPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-75-      return "EC";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:76:    } else if (publicKey instanceof DSAPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-77-      return "DSA";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-78-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:79:      // For unknown key types, use the algorithm name as fallback
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:80:      String algorithm = publicKey.getAlgorithm();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:81:      logger.warn("Unknown public key type: {}, using algorithm name as kty", algorithm);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-82-      return algorithm;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-83-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-85-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-86-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:87:   * Determines the appropriate RSA signing algorithm based on the key size.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-88-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:89:   * @param rsaPublicKey the RSA public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:90:   * @return the RSA algorithm string (RS256, RS384, or RS512)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-91-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:92:  private static String determineRsaAlgorithm(RSAPublicKey rsaPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:93:    int keySize = rsaPublicKey.getModulus().bitLength();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-94-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:95:    // RSA algorithm selection based on key size and security recommendations
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:96:    if (keySize >= 4096) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:97:      return "RS512"; // SHA-512 with RSA for 4096+ bit keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:98:    } else if (keySize >= 3072) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:99:      return "RS384"; // SHA-384 with RSA for 3072+ bit keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:100:    } else if (keySize >= 2048) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:101:      return "RS256"; // SHA-256 with RSA for 2048+ bit keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-102-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:103:      // For keys smaller than 2048 bits, default to RS256 but log a warning
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:104:      logger.warn("RSA key size {} bits is below recommended minimum of 2048 bits", keySize);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-105-      return "RS256";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-106-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-108-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-109-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:110:   * Determines the appropriate EC signing algorithm based on the curve.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-111-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:112:   * @param ecPublicKey the EC public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:113:   * @return the EC algorithm string (ES256, ES384, or ES512)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-114-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:115:  private static String determineEcAlgorithm(ECPublicKey ecPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:116:    int fieldSize = ecPublicKey.getParams().getCurve().getField().getFieldSize();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-118-    // EC algorithm selection based on curve field size
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-119-    if (fieldSize >= 521) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:120:      return "ES512"; // SHA-512 with ECDSA using P-521 curve
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-121-    } else if (fieldSize >= 384) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:122:      return "ES384"; // SHA-384 with ECDSA using P-384 curve
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-123-    } else if (fieldSize >= 256) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:124:      return "ES256"; // SHA-256 with ECDSA using P-256 curve
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-125-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:126:      logger.warn("EC key field size {} bits is below recommended minimum", fieldSize);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-127-      return "ES256"; // Default to ES256 for smaller curves
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-128-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-130-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-131-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:132:   * Determines the appropriate DSA signing algorithm based on the key size.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-133-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:134:   * @param dsaPublicKey the DSA public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:135:   * @return the DSA algorithm string (DS256, DS384, or DS512)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-136-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:137:  private static String determineDsaAlgorithm(DSAPublicKey dsaPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:138:    int keySize = dsaPublicKey.getParams().getP().bitLength();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-139-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:140:    // DSA algorithm selection based on key size and security recommendations
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:141:    if (keySize >= 3072) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:142:      return "DS512"; // SHA-512 with DSA for 3072+ bit keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:143:    } else if (keySize >= 2048) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:144:      return "DS384"; // SHA-384 with DSA for 2048+ bit keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:145:    } else if (keySize >= 1024) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:146:      return "DS256"; // SHA-256 with DSA for 1024+ bit keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-147-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:148:      // For keys smaller than 1024 bits, default to DS256 but log a warning
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:149:      logger.warn("DSA key size {} bits is below recommended minimum of 1024 bits", keySize);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-150-      return "DS256";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-151-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-153-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-154-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:155:   * Determines the algorithm for generic/unknown key types.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-156-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:157:   * @param publicKey the public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:158:   * @return a generic algorithm string
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-159-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:160:  private static String determineGenericAlgorithm(PublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:161:    String algorithm = publicKey.getAlgorithm();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java:162:    logger.info("Using generic algorithm determination for key type: {}", algorithm);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-163-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/PublicKeyUtils.java-164-    // For other unknown types, construct a generic algorithm name
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getRequestIdFromHeaderOrGenerate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-4-import static com.sap.bpi.api.gw.routes.RoutesConfiguration.UCL_TENANT_PROVISIONING_REROUTING_PATH;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:6:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-7-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-8-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:9:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:10:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:11:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:12:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:13:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:14:import org.springframework.http.server.RequestPath;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:15:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:16:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:17:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-18-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-20-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:21:public class SpmJwtWithPathTenantIdFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:22:    extends AbstractGatewayFilterFactory<SpmJwtWithPathTenantIdFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-24-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-26-   * /v1/tenants/{tenantId}/spii/notifications
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-27-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:28:  private static final int TENANT_ID_PLACEHOLDER_INDEX_IN_UCL_TENANT_PROVISIONING_REROUTING_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-29-      3;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:31:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:32:  private final Logger logger = LoggerFactory.getLogger(SpmJwtWithPathTenantIdFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-34-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:35:  public SpmJwtWithPathTenantIdFilterFactory(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-36-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-37-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:38:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-39-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:40:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-41-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:42:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-43-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-45-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:46:  public GatewayFilter apply(SpmJwtWithPathTenantIdFilterFactory.Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-47-    return (exchange, chain) ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-48-        Mono.defer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-49-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-50-              ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:51:              String tenantId = getTenantId(request.getPath());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-52-              ServerHttpRequest requestBuild =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:53:                  replaceRequestAuthHeaderWithSpmJwt(tenantId, request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-54-              return chain.filter(exchange.mutate().request(requestBuild).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-55-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-56-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:58:  private ServerHttpRequest replaceRequestAuthHeaderWithSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:59:      String tenantId, ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:60:    String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:61:    JsonWebToken spmJwt = new JsonWebToken(tenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:62:    String jwtBearer = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-63-    ServerHttpRequest.Builder builder = request.mutate();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:64:    return builder.header(HttpHeaders.AUTHORIZATION, jwtBearer).build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-65-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:67:  private String getTenantId(RequestPath path) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:68:    String[] pathParts = path.value().split("/");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-69-    int numberOfPathPartsWithTenantId = UCL_TENANT_PROVISIONING_REROUTING_PATH.split("/").length;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-70-    if (pathParts.length < numberOfPathPartsWithTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-71-      throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "Missing tenantId in path");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-72-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java:73:    String tenantId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-74-        pathParts[TENANT_ID_PLACEHOLDER_INDEX_IN_UCL_TENANT_PROVISIONING_REROUTING_PATH];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtWithPathTenantIdFilterFactory.java-75-    logger.debug("Tenant ID extracted from the path: {}", tenantId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-5-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-6-import java.util.stream.Collectors;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:7:import org.springframework.security.web.server.util.matcher.OrServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:8:import org.springframework.security.web.server.util.matcher.PathPatternParserServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:9:import org.springframework.security.web.server.util.matcher.ServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:10:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-11-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-13-public class PathPatternAndHeaderValueMatcher implements ServerWebExchangeMatcher {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:14:  private final String headerName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:15:  private final String headerValue;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:16:  private final OrServerWebExchangeMatcher multiPathPatternMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-18-  public PathPatternAndHeaderValueMatcher(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:19:      String[] pathPattern, String headerName, String headerValue) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-20-    List<ServerWebExchangeMatcher> pathPatternMatchers =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-21-        Arrays.stream(pathPattern)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-34-            matchResult -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-35-              if (matchResult.isMatch()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java:36:                Optional<String> header =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-37-                    Optional.ofNullable(exchange.getRequest().getHeaders().getFirst(headerName));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeaderValueMatcher.java-38-                if (header.isPresent() && headerValue.equals(header.get().toLowerCase())) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-1-package com.sap.bpi.api.gw.security;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:3:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:4:import com.signavio.jwt.Token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:5:import com.signavio.jwt.exception.JwtServiceException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-6-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:7:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:8:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:9:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:10:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:11:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:12:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:13:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:14:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:15:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:16:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-18-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-23-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-24-public class SpmGatewayAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:25:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:27:  public static final String SPM_JWT = "spm-jwt";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:28:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-30-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:31:  public SpmGatewayAuthorizationManager(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:32:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-33-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-34-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-39-    ServerHttpRequest request = context.getExchange().getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:40:    String authorizationHeader = request.getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-42-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:43:      // Checks for Token validity happen in the jwtUtils.getSpmJwtFromHeader call
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:44:      Optional<Token> spmJwtFromHeader = jwtUtils.getAndValidateSpmJwt(authorizationHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:45:      if (spmJwtFromHeader.isPresent()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:46:        // Set SPM JWT for faster handling in filters
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:47:        context.getExchange().getAttributes().put(SPM_JWT, spmJwtFromHeader.get());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-48-        return Mono.just(new AuthorizationDecision(true));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-49-      } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-50-        return Mono.just(new AuthorizationDecision(false));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-51-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:52:    } catch (JwtServiceException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java:53:      return Mono.error(new ResponseStatusException(HttpStatus.UNAUTHORIZED, "JWT parsing failed"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-54-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/SpmGatewayAuthorizationManager.java-55-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.MtlsOnlyRoutingFilter.ATTR_CUSTOM_HTTP_CLIENT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:4:import static com.sap.bpi.api.gw.security.SpmGatewayAuthorizationManager.SPM_JWT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:5:import static org.springframework.cloud.gateway.support.ServerWebExchangeUtils.GATEWAY_REQUEST_URL_ATTR;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-7-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:8:import com.sap.bpi.api.gw.services.ConnectivityPlatformTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:9:import com.sap.bpi.api.gw.services.MtlsClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:10:import com.signavio.jwt.Token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-11-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:12:import java.security.PrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-13-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-14-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-15-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-16-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:17:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:18:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:19:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:20:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:21:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:22:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:23:import org.springframework.web.util.UriComponentsBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-24-import reactor.netty.http.client.HttpClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-26-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:27: * Gateway filter factory for establishing mTLS connections to the connectivity platform. This
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:28: * filter is responsible for: - Reading mTLS credentials from exchange attributes (set by previous
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:29: * filter) - Getting the connectivity platform URL (from configuration or tenant service) - Creating
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:30: * an mTLS-enabled WebClient - Making the actual call to the connectivity platform - Handling
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-31- * connection-specific errors
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-32- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-33- * <p>This filter expects the following attributes to be set by previous filters: -
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:34: * CONNECTIVITY_CERTIFICATES: List of X509Certificate objects - CONNECTIVITY_PRIVATE_KEY: PrivateKey
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:35: * for mTLS authentication - ASYMMETRIC_JWT: JWT token for authorization
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-36- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-37-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:38:public class ConnectivityPlatformMtlsGatewayFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:39:    extends AbstractGatewayFilterFactory<ConnectivityPlatformMtlsGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:40:  public static final String CONNECTIVITY_CERTIFICATES = "CONNECTIVITY_CERTIFICATES";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:41:  public static final String CONNECTIVITY_PRIVATE_KEY = "CONNECTIVITY_PRIVATE_KEY";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:42:  public static final String ASYMMETRIC_JWT = "ASYMMETRIC_JWT";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:43:  private static final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:44:      LoggerFactory.getLogger(ConnectivityPlatformMtlsGatewayFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:46:  private final MtlsClientFactory mtlsClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:48:  private final ConnectivityPlatformTenantService connectivityPlatformTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-50-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:51:  public ConnectivityPlatformMtlsGatewayFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:52:      MtlsClientFactory mtlsClientFactory,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:53:      ConnectivityPlatformTenantService connectivityPlatformTenantService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-54-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:55:    this.mtlsClientFactory = mtlsClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:56:    this.connectivityPlatformTenantService = connectivityPlatformTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-58-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-60-  public GatewayFilter apply(Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-61-    return (exchange, chain) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:62:      logger.debug("Processing connectivity platform mTLS filter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-64-      // Get data from previous filter
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:65:      List<X509Certificate> certificates = exchange.getAttribute(CONNECTIVITY_CERTIFICATES);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:66:      PrivateKey privateKey = exchange.getAttribute(CONNECTIVITY_PRIVATE_KEY);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:67:      String asymmetricJwt = exchange.getAttribute(ASYMMETRIC_JWT);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-69-      // Validate required attributes
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-74-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:76:      if (privateKey == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:77:        logger.error("Missing private key from previous filter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-78-        exchange.getResponse().setStatusCode(HttpStatus.INTERNAL_SERVER_ERROR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-79-        return exchange.getResponse().setComplete();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-80-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-81-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:82:      if (asymmetricJwt == null || asymmetricJwt.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:83:        logger.error("Missing asymmetric JWT from previous filter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-84-        exchange.getResponse().setStatusCode(HttpStatus.INTERNAL_SERVER_ERROR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-85-        return exchange.getResponse().setComplete();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-86-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:88:      Token spmJwt = (Token) exchange.getAttributes().get(SPM_JWT);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:89:      String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:91:      return connectivityPlatformTenantService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:92:          .getConnectivityPlatformServiceUrl(spmJwt.getTenantId(), requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-93-          .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-94-              urlOptional -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-95-                if (urlOptional.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-96-                  logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:97:                      "No connectivity platform URL found for tenant: {}", spmJwt.getTenantId());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-98-                  exchange.getResponse().setStatusCode(HttpStatus.BAD_GATEWAY);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-99-                  return exchange.getResponse().setComplete();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-100-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-101-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:102:                String connectivityPlatformUrl = urlOptional.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-103-                logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:104:                    "Retrieved connectivity platform URL for tenant {}: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:105:                    spmJwt.getTenantId(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:106:                    connectivityPlatformUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:108:                String transformedUrl =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:109:                    FilterUtils.transformConnectivityPlatformUrl(connectivityPlatformUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-110-                logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:111:                    "Establishing mTLS connection to connectivity platform: {} (transformed from:"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-112-                        + " {})",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-113-                    transformedUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:114:                    connectivityPlatformUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-115-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-116-                URI uri =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:117:                    UriComponentsBuilder.fromUriString(transformedUrl)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-118-                        .replacePath(exchange.getRequest().getURI().getPath())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-119-                        .replaceQuery(exchange.getRequest().getURI().getRawQuery())
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-123-                HttpClient httpClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-124-                try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:125:                  httpClient = mtlsClientFactory.createMtlsHttpClient(certificates, privateKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-126-                } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:127:                  logger.error("Failed to create mTLS client", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-128-                  exchange.getResponse().setStatusCode(HttpStatus.INTERNAL_SERVER_ERROR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-129-                  return exchange.getResponse().setComplete();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-139-                            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-140-                                r.uri(uri)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:141:                                    .header(HttpHeaders.AUTHORIZATION, "Bearer " + asymmetricJwt))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-142-                        .build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-143-              })
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-145-              e -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-146-                logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:147:                    "Error occurred while trying to retrieve Connectivity Platform target service"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-148-                        + " url from Tenants Service",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-149-                    e);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-154-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-155-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java:156:  /** Configuration class for the ConnectivityPlatformMtlsGatewayFilterFactory. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-157-  public static class Config {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/ConnectivityPlatformMtlsGatewayFilterFactory.java-158-    // Configuration properties can be added here if needed in the future
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:3:import static com.sap.bpi.api.gw.services.ConnectivityPlatformTenantService.authAndContentTypeHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-5-import com.sap.bpi.api.gw.dto.tenant.pam.TenantServicePamTypeResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:6:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-7-import java.util.function.Consumer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:8:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:9:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:10:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:11:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:12:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-13-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-15-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-16-public class PamTenantService extends TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:17:  public static final String PAM_TENANT_MAPPING_TYPE =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:18:      "signavio_to_btp_sub_account_id_process_analysis_and_mining";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:19:  public static final String PAM_TENANT_MAPPING_PATH = "/v1/tenants/%s/mappings?type=%s";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:20:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:21:  private final String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-23-  public PamTenantService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-24-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:25:      @Value("${app.tenantServiceEndpoint}") String tenantServiceEndpoint,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:26:      JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-27-    super(webClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:28:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-29-    this.tenantServiceEndpoint = tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-30-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-32-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:33:  public String createTenantMappingEndpoint(String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-34-    return tenantServiceEndpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:35:        + String.format(PAM_TENANT_MAPPING_PATH, signavioTenantId, PAM_TENANT_MAPPING_TYPE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-36-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-38-  public Mono<TenantServicePamTypeResponse> getTenantMapping(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:39:      String signavioTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:40:    String url = createTenantMappingEndpoint(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-41-    Consumer<HttpHeaders> authAndContentTypeHeaders =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java:42:        authAndContentTypeHeaders(signavioTenantId, requestId, jwtUtils);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-43-    return getTenantMapping(url, authAndContentTypeHeaders, TenantServicePamTypeResponse.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/PamTenantService.java-44-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-4-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-5-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:6:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:7:import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:8:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:9:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-10-import software.amazon.awssdk.auth.credentials.WebIdentityTokenFileCredentialsProvider;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-11-import software.amazon.awssdk.regions.Region;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-20-public class AwsS3Configuration {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:22:  private static final Logger logger = LoggerFactory.getLogger(AwsS3Configuration.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-24-  @Value("${aws.s3.region}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:25:  private String region;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-27-  @Value("${aws.s3.bucketName}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:28:  private String bucketName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:30:  /** S3 object key for CDM data */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:31:  @Value("${aws.s3.cdmObjectKey}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:32:  private String cdmObjectKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-34-  /** IAM role ARN for assuming credentials */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-35-  @Value("${aws.roleArn}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:36:  private String roleArn;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-38-  /** Path to web identity token file for authentication */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-39-  @Value("${aws.webIdentityTokenFile}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:40:  private String webIdentityTokenFile;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-42-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-50-  public S3Client s3Client() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-51-    logger.info(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:52:        "AWS S3 Configuration: region: {}, bucket: {}, cdmObjectKey: {}, roleArn: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-53-        region != null ? region : "not set",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-54-        bucketName != null ? bucketName : "not configured",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:55:        cdmObjectKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-56-        roleArn);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-57-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-70-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:72:  public String getRegion() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-73-    return region;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-74-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:76:  public void setRegion(String region) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-77-    this.region = region;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-78-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-79-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:80:  public String getBucketName() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-81-    return bucketName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-82-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:84:  public void setBucketName(String bucketName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-85-    this.bucketName = bucketName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-86-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:88:  public String getCdmObjectKey() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:89:    return cdmObjectKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-90-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-91-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:92:  public void setCdmObjectKey(String cdmObjectKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java:93:    this.cdmObjectKey = cdmObjectKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-94-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AwsS3Configuration.java-95-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-3-import com.fasterxml.jackson.core.JsonProcessingException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-4-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:5:import com.nimbusds.jose.EncryptionMethod;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:6:import com.nimbusds.jose.JWEAlgorithm;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:7:import com.nimbusds.jose.JWEHeader;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:8:import com.nimbusds.jose.JWEObject;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:9:import com.nimbusds.jose.Payload;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:10:import com.nimbusds.jose.crypto.RSAEncrypter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:11:import com.sap.bpi.api.gw.dto.credentialStore.CredentialStoreEncryptionKeys;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:12:import com.sap.bpi.api.gw.security.certificate.utils.DestinationServiceCertificateParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:13:import java.security.KeyFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:14:import java.security.PrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-15-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:16:import java.security.interfaces.RSAPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:17:import java.security.spec.X509EncodedKeySpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-18-import java.util.Base64;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:19:import java.util.LinkedHashMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-20-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-21-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-22-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-23-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:24:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:25:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:26:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:27:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-28-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-30-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-31-public class CredentialStoreService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:32:  private static final Logger logger = LoggerFactory.getLogger(CredentialStoreService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:33:  private static final String RSA_KEY_ALGORITHM = "RSA";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:35:  private final String credentialStoreUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:36:  private final String credentialStoreCertificateEncoded;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:37:  private final String credentialStoreKeyEncoded;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:38:  private final String credentialStoreEncryptionEncoded;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:39:  private final ObjectMapper objectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:40:  private final MtlsClientFactory mtlsClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-42-  public CredentialStoreService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:43:      @Value("${signavio.security.credentialStore.url}") String credentialStoreUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:44:      @Value("${signavio.security.credentialStore.certificate}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:45:          String credentialStoreCertificateEncoded,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:46:      @Value("${signavio.security.credentialStore.key}") String credentialStoreKeyEncoded,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:47:      @Value("${signavio.security.credentialStore.encryption}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:48:          String credentialStoreEncryptionEncoded,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-49-      ObjectMapper objectMapper,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:50:      MtlsClientFactory mtlsClientFactory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-51-    this.credentialStoreUrl = credentialStoreUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-52-    this.credentialStoreCertificateEncoded = credentialStoreCertificateEncoded;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:53:    this.credentialStoreKeyEncoded = credentialStoreKeyEncoded;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:54:    this.credentialStoreEncryptionEncoded = credentialStoreEncryptionEncoded;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-55-    this.objectMapper = objectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:56:    this.mtlsClientFactory = mtlsClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:59:  private String decodeBase64(String encodedValue) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-60-    if (encodedValue == null || encodedValue.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-61-      return encodedValue;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-62-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:63:    return DestinationServiceCertificateParser.decodePEMContent(encodedValue);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-64-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:66:  public Mono<Void> storeToken(String token, String callbackUrl, String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-67-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:68:      logger.debug("Storing token and callback URL at Credential Store for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:69:      String payload = createPayload(token, callbackUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:70:      String encryptedJwe = encryptPayload(payload);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:71:      return storeAtCredentialStore(encryptedJwe, tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-72-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-73-      logger.error("Failed to prepare credential storage for tenant: {}", tenantId, e);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-77-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-78-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:79:  private String createPayload(String token, String callbackUrl) throws JsonProcessingException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:80:    Map<String, Object> payloadMap = new LinkedHashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-81-    payloadMap.put("name", "token");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-82-    // Base64 encode the token value as required by Credential Store API
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:83:    String base64Token = Base64.getEncoder().encodeToString(token.getBytes());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-84-    payloadMap.put("value", base64Token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-85-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-88-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-89-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:90:    return objectMapper.writeValueAsString(payloadMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-91-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-92-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:93:  private String encryptPayload(String payload) throws Exception {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:94:    String decodedEncryption = decodeBase64(credentialStoreEncryptionEncoded);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:95:    CredentialStoreEncryptionKeys encryptionKeys =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:96:        objectMapper.readValue(decodedEncryption, CredentialStoreEncryptionKeys.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:98:    RSAPublicKey publicKey = parsePublicKey(encryptionKeys.getServerPublicKey());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:100:    // Create JWE object with RSA-OAEP-256 key encryption and A256GCM content encryption
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-101-    // Add custom 'iat' (issued at) header as required by Credential Store API
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-102-    long issuedAtTime = System.currentTimeMillis() / 1000; // Convert to seconds
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:103:    JWEHeader header =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:104:        new JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A256GCM)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-105-            .customParam("iat", issuedAtTime)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-106-            .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:107:    JWEObject jweObject = new JWEObject(header, new Payload(payload));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-108-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:109:    // Encrypt with RSA public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:110:    jweObject.encrypt(new RSAEncrypter(publicKey));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-111-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:112:    // Return JWE compact serialization format
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:113:    return jweObject.serialize();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-114-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-115-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:116:  private RSAPublicKey parsePublicKey(String base64PublicKey) throws Exception {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:117:    KeyFactory keyFactory = KeyFactory.getInstance(RSA_KEY_ALGORITHM);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:118:    byte[] binaryKey = Base64.getDecoder().decode(base64PublicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:119:    X509EncodedKeySpec keySpec = new X509EncodedKeySpec(binaryKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:120:    return (RSAPublicKey) keyFactory.generatePublic(keySpec);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-121-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-122-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:123:  private Mono<Void> storeAtCredentialStore(String encryptedJwe, String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-124-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:125:      WebClient credentialStoreClient = createMtlsWebClient();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:126:      String credentialStoreEndpoint = credentialStoreUrl + "/key";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-127-      logger.debug("Calling Credential Store at: {}", credentialStoreEndpoint);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-128-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-129-      logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:130:          "Sending JWE payload in compact serialization format (size: {} bytes)",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:131:          encryptedJwe.length());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-132-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-133-      return credentialStoreClient
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-137-          .header("sapcp-credstore-namespace", tenantId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-138-          .header("Cache-Control", "no-cache")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:139:          .bodyValue(encryptedJwe)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-140-          .retrieve()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-141-          .toBodilessEntity()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-155-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-156-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:157:  private WebClient createMtlsWebClient() throws Exception {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-158-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:159:      String decodedCertificate = decodeBase64(credentialStoreCertificateEncoded);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:160:      String decodedKey = decodeBase64(credentialStoreKeyEncoded);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-161-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-162-      logger.debug("Extracting certificates from credential store configuration");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-163-      List<X509Certificate> certificates =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:164:          DestinationServiceCertificateParser.extractCertificates(decodedCertificate);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-165-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:166:      logger.debug("Extracting private key from credential store configuration");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:167:      PrivateKey privateKey =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:168:          DestinationServiceCertificateParser.extractPrivateKeyPkcs1(decodedKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-169-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:170:      logger.debug("Successfully parsed mTLS credentials");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:171:      // Create mTLS WebClient using MtlsClientFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:172:      return mtlsClientFactory.createMtlsWebClient(privateKey, certificates);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-173-    } catch (IllegalArgumentException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:174:      logger.error("Failed to parse mTLS credentials: Invalid key or certificate format");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:175:      throw new IllegalArgumentException("Failed to parse mTLS credentials", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-176-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:177:      logger.error("Failed to create mTLS WebClient: {}", e.getClass().getSimpleName());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java:178:      throw new Exception("Failed to create mTLS WebClient", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-179-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/CredentialStoreService.java-180-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-3-import static com.sap.bpi.api.gw.filters.utils.FilterUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-4-import static com.sap.bpi.api.gw.routes.RoutesConfiguration.VARIANT_MANAGEMENT_UI_ROUTE_ID;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:5:import static com.sap.bpi.api.gw.routes.RoutesConfiguration.X_DESTINATION_SERVICE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-7-import com.sap.bpi.api.gw.caching.GenericRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:8:import com.sap.bpi.api.gw.caching.RedisKeyUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-9-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-10-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-11-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:12:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-13-import com.sap.bpi.api.gw.services.SpmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-14-import java.net.URI;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-17-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-18-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:19:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:20:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:21:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:22:import org.springframework.cloud.gateway.route.Route;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:23:import org.springframework.cloud.gateway.support.ServerWebExchangeUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:24:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:25:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:26:import org.springframework.http.server.reactive.ServerHttpResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:27:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:28:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:29:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-30-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-31-import reactor.util.function.Tuple3;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-33-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:34: * This filter adds an Authorization: Bearer <SPM JWT> header to the request.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:35: * To construct SPM JWT, the filter sends a request to SPM to get user details using x-signavio-id and cookie headers.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-36- * If one of the headers is missing, a 401 status code is set to the response.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:37: * After constructing SPM JWT, x-signavio-id and cookie headers are removed from the request.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-38- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-40-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:41:public class SpmTokenToSpmJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:42:    extends AbstractGatewayFilterFactory<SpmTokenToSpmJwtFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:43:  public static final String X_SIGNAVIO_ID_HEADER = "x-signavio-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:44:  public static final String COOKIE_HEADER = "cookie";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:45:  public static final String X_FORWARDED_FOR = "X-Forwarded-For";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:46:  public static final String SIGNAVIO_PLUGINS_MODELING = "Signavio.Plugins.Modeling";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:47:  public static final String PLATFORM_FEATURESET = "platform";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:48:  private static final int JWT_TTL_DEFAULT_IN_MINUTES = 30;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:50:  private final Logger logger = LoggerFactory.getLogger(SpmTokenToSpmJwtFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:51:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:52:  private final GenericRedisService<SpmUser> spmUserRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:53:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-55-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:56:  public SpmTokenToSpmJwtFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:57:      JwtUtils jwtUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-58-      @Autowired(required = false) GenericRedisService<SpmUser> spmUserRedisService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-59-      SpmService spmService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-60-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-61-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:62:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-63-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:64:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-65-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:66:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-67-    this.spmUserRedisService = spmUserRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-68-    this.spmService = spmService;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-84-                          user -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-85-                            modifyUserFeatureSetForVMRoute(exchange, user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:86:                            // this id is needed to correlate logs of Signavio services
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:87:                            String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:88:                            JsonWebToken spmJwt = new JsonWebToken(user, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-89-                            ServerHttpRequest.Builder builder = request.mutate();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-90-                            // we need to remove headers otherwise the downstream service may add
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-93-                            removeUnnecessaryHeaders(builder);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-94-                            removeUnnecessaryAttributes(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:95:                            addAuthorizationHeader(builder, spmJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-96-                            // For most of the UI routes, we need the userId and tenantId for the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-97-                            // report uri
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-115-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-116-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:117:  private void modifyUserFeatureSetForVMRoute(ServerWebExchange exchange, SpmUser user) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-118-    Route route = exchange.getAttribute(ServerWebExchangeUtils.GATEWAY_ROUTE_ATTR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:119:    String routeId = Objects.requireNonNull(route).getId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-120-    if (VARIANT_MANAGEMENT_UI_ROUTE_ID.equals(routeId)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-121-      reducePlatformFeatureSetForVM(user);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-123-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-124-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:125:  private Mono<SpmUser> getUserDetails(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:126:      Tuple3<String, String, String> tokenCookieClientIpTuple, Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-127-    Set<FeatureApplication> featureSets = config.getFeatureApplications();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:128:    String xSignavioId = tokenCookieClientIpTuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:129:    String cookie = tokenCookieClientIpTuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:130:    String clientIp = tokenCookieClientIpTuple.getT3();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:131:    String redisKey =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-132-        spmUserRedisService != null
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:133:            ? RedisKeyUtils.createSpmUserKey(xSignavioId, cookie, clientIp, featureSets.toString())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-134-            : null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-135-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-136-    // Try to get from cache if Redis is enabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-137-    Mono<SpmUser> cachedUser = Mono.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:138:    if (redisKey != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:139:      cachedUser = spmUserRedisService.get(redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-140-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-141-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-146-              return spmService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-147-                  .getUserDetailsFromSpmWithTokenAndCookie(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:148:                      xSignavioId, cookie, clientIp, featureSets)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-149-                  .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-150-                      user -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-151-                        // Save to cache if Redis is enabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:152:                        if (redisKey != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-153-                          // Use default TTL - could be made configurable
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-154-                          return spmUserRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:155:                              .set(redisKey, user, Duration.ofMinutes(JWT_TTL_DEFAULT_IN_MINUTES))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-156-                              .thenReturn(user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-157-                        }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-161-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-162-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:163:  private void removeUnnecessaryHeaders(ServerHttpRequest.Builder builder) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-164-    builder.headers(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-165-        headers -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:166:          headers.remove("X-Signavio-ID"); // Header names should ideally be constant fields
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-167-          headers.remove("Cookie"); // Header names should ideally be constant fields
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-168-        });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-169-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-170-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:171:  private void removeUnnecessaryAttributes(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:172:    // We need to remove the X_DESTINATION_SERVICE attribute, as it is only used internally for
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-173-    // tenant based routing
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:174:    exchange.getAttributes().remove(X_DESTINATION_SERVICE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-175-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-176-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:177:  private void addAuthorizationHeader(ServerHttpRequest.Builder builder, JsonWebToken spmJwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:178:    builder.header(HttpHeaders.AUTHORIZATION, jwtUtils.getAuthorizationHeader(spmJwt));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-179-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-180-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:181:  private Mono<Void> handleException(ResponseStatusException ex, ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-182-    logger.error(ex.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-183-    ServerHttpResponse response = exchange.getResponse();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-187-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-188-  public static class Config {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:189:    private final Set<FeatureApplication> featureApplications;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:190:    private final RateLimitAttributeType rateLimitAttributeType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-191-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-192-    public Config(FeatureApplication... featureApplications) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-209-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-210-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:211:  // If the platform feature set contains Signavio.Plugins.Modeling, then the platform feature set
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:212:  // should only contain Signavio.Plugins.Modeling.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-213-  // Otherwise return an empty set.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-214-  // This special logic is also used in the SPM GW Filter:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:215:  // https://github.com/signavio/process-manager/blob/develop/platform/src/main/java/com/signavio/infrastructure/gateway/filter/FeaturesGatewayRequestFilter.java#L86-L88
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:216:  private void reducePlatformFeatureSetForVM(SpmUser user) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-217-    user.featuresOfApps()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-218-        .computeIfPresent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-219-            PLATFORM_FEATURESET,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:220:            (key, platformFeatures) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:221:              if (platformFeatures.contains(SIGNAVIO_PLUGINS_MODELING)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:222:                return new HashSet<>(Collections.singletonList(SIGNAVIO_PLUGINS_MODELING));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-223-              } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-224-                return Collections.emptySet();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-227-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-228-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:229:  private void addUserIdToAttributes(ServerWebExchange exchange, String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:230:    exchange.getAttributes().put(X_SIGNAVIO_USER_ID_ATTRIBUTE, userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-231-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-232-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:233:  private void addTenantIdToAttributes(ServerWebExchange exchange, String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:234:    exchange.getAttributes().put(X_SIGNAVIO_TENANT_ID_ATTRIBUTE, tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-235-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-236-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:237:  private void addRateLimitHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-238-      ServerHttpRequest.Builder builder,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:239:      String tenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:240:      String userId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-241-      RateLimitAttributeType rateLimitAttributeType) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:242:    String rateLimitValue =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-243-        rateLimitAttributeType == RateLimitAttributeType.USER_ID ? userId : tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-244-    logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-245-        "Adding {}={} (type: {}) to the request",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:246:        SAP_SIGNAVIO_RATE_LIMIT_ATTRIBUTE_HEADER,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-247-        rateLimitValue,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-248-        rateLimitAttributeType);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:249:    builder.header(SAP_SIGNAVIO_RATE_LIMIT_ATTRIBUTE_HEADER, rateLimitValue);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-250-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-251-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:252:  private String getOriginalPath(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-253-    Set<URI> originalUris =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-254-        exchange.getAttributeOrDefault(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-260-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-261-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:262:  private void addOriginalPathHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-263-      ServerHttpRequest.Builder builder, ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:264:    String originalPath = getOriginalPath(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:265:    logger.debug("Adding {}={} to the request", SAP_SIGNAVIO_ORIGINAL_PATH_HEADER, originalPath);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java:266:    builder.header(SAP_SIGNAVIO_ORIGINAL_PATH_HEADER, originalPath);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-267-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmTokenToSpmJwtFilterFactory.java-268-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-1-package com.sap.bpi.api.gw.security;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:3:import static com.sap.bpi.api.gw.security.certificate.ConnectivityPlatformAuthorizationManager.X_SIGNAVIO_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-4-import static com.sap.bpi.api.gw.security.certificate.RequestWithCertificateHeader.CERTIFICATE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:5:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:6:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_USER_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:7:import static com.sap.bpi.api.gw.security.certificate.utils.MappingTypes.CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:8:import static org.springframework.security.config.Customizer.withDefaults;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-9-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-10-import com.sap.bpi.api.gw.errorhandling.Custom403AuthenticationEntryPoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-11-import com.sap.bpi.api.gw.security.certificate.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:12:import com.sap.bpi.api.gw.security.jwt.AuthenticationHeaderNotPresentMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:13:import com.sap.bpi.api.gw.security.jwt.TokenAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:14:import com.sap.bpi.api.gw.security.jwt.ias.IngestionAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:15:import com.sap.bpi.api.gw.security.jwt.ias.WorkzoneCdmAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:16:import com.sap.bpi.api.gw.security.jwt.insights_central.InsightsCentralAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:17:import com.sap.bpi.api.gw.security.jwt.joule.JouleAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:18:import com.sap.bpi.api.gw.security.jwt.joule.JouleRequestMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:19:import com.sap.bpi.api.gw.security.jwt.spm.SpmGatewayRequestMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-20-import com.sap.bpi.api.gw.services.LaunchDarklyService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-21-import java.util.stream.Stream;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:22:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:23:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:24:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:25:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:26:import org.springframework.core.annotation.Order;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:27:import org.springframework.http.HttpMethod;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:28:import org.springframework.security.config.annotation.web.reactive.EnableWebFluxSecurity;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:29:import org.springframework.security.config.web.server.ServerHttpSecurity;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:30:import org.springframework.security.core.userdetails.MapReactiveUserDetailsService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:31:import org.springframework.security.core.userdetails.User;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:32:import org.springframework.security.core.userdetails.UserDetails;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:33:import org.springframework.security.crypto.factory.PasswordEncoderFactories;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:34:import org.springframework.security.crypto.password.PasswordEncoder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:35:import org.springframework.security.web.server.SecurityWebFilterChain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:36:import org.springframework.security.web.server.authentication.HttpBasicServerAuthenticationEntryPoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:37:import org.springframework.security.web.server.authentication.logout.LogoutWebFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:38:import org.springframework.security.web.server.authorization.AuthorizationWebFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:39:import org.springframework.security.web.server.util.matcher.OrServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:40:import org.springframework.security.web.server.util.matcher.PathPatternParserServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:41:import org.springframework.security.web.server.util.matcher.ServerWebExchangeMatchers;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-43-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:44: * This security configuration includes 4 filter chains: 1. {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-45- * #gatewayInternalApiSecurity(ServerHttpSecurity)} (Order 1) is responsible for all API GW internal
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-46- * endpoints 2. {@link #uiServiceHttpSecurity(ServerHttpSecurity)} (Order 2) is responsible for
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-47- * browser traffic 3. {@link #spmGatewaySecurityFilterChain(ServerHttpSecurity)} (Order 3) is
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-48- * responsible for traffic forwarded by SPM Gateway 4. {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:49: * #springSecurityFilterChain(ServerHttpSecurity)} Order 4) is responsible for the public API
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-50- * traffic and all traffic not matching one of the previous filter chains In every filter chain
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:51: * there are implicit filters added by Spring Security, for example {@link LogoutWebFilter} and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-52- * {@link AuthorizationWebFilter}. In case of Authorization failure, the later one may lead to a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-53- * basic authentication prompt by calling {@link HttpBasicServerAuthenticationEntryPoint} To avoid
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-59-public class WebSecurityConfig {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-60-  @Value("${app.uiPatterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:61:  private String uiPatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-63-  @Value("${app.getPatterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:64:  private String getPatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-66-  @Value("${app.postPatterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:67:  private String postPatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-69-  @Value("${app.putPatterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:70:  private String putPatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-72-  @Value("${app.deletePatterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:73:  private String deletePatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-74-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-75-  @Value("${app.headPatterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:76:  private String headPatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-78-  @Value("${app.patchPatterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:79:  private String patchPatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-81-  @Value("${joule.patterns}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:82:  private String joulePatterns;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-84-  @Value("${management.endpoints.security.user.name}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:85:  private String username;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-87-  @Value("${management.endpoints.security.user.password}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:88:  private String password;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-89-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-90-  @Value("${feature.unifiedJouleRoutes.enabled:false}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:91:  private boolean unifiedJouleRoutesEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-92-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:93:  private final ForwardedIpAuthorizationManager forwardedIpAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:94:  private final IpsAuthorizationManager ipsAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:95:  private final DatasphereAuthorizationManager datasphereAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:96:  private final UclAuthorizationManager uclAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:97:  private final ConnectivityPlatformAuthorizationManager connectivityPlatformAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:98:  private final SPMAuthorizationManager spmAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:99:  private final JouleAuthorizationManager jouleAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:100:  private final IngestionAuthorizationManager ingestionAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:101:  private final WorkzoneCdmAuthorizationManager workzoneCdmAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:102:  private final InsightsCentralAuthorizationManager insightsCentralAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:103:  private final TenantServiceAuthorizationManager tenantServiceAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:104:  private final SpmGatewayAuthorizationManager spmGatewayAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:105:  private final TokenAuthorizationManager tokenAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:106:  private final LaunchDarklyService launchDarklyService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-108-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-112-      DatasphereAuthorizationManager datasphereAuthorizationManager,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-113-      UclAuthorizationManager uclAuthorizationManager,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:114:      ConnectivityPlatformAuthorizationManager connectivityPlatformAuthorizationManager,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-115-      SPMAuthorizationManager spmAuthorizationManager,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-116-      JouleAuthorizationManager jouleAuthorizationManager,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-126-    this.uclAuthorizationManager = uclAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-127-    this.datasphereAuthorizationManager = datasphereAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:128:    this.connectivityPlatformAuthorizationManager = connectivityPlatformAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-129-    this.spmAuthorizationManager = spmAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-130-    this.jouleAuthorizationManager = jouleAuthorizationManager;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-139-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-140-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:141:  public MapReactiveUserDetailsService userDetailsService(PasswordEncoder passwordEncoder) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-142-    UserDetails user =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-143-        User.withUsername(username)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-145-            .roles("ADMIN")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-146-            .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:147:    return new MapReactiveUserDetailsService(user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-148-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-149-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-172-                    .pathMatchers("/apigwservice/healthz")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-173-                    .permitAll()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:174:                    .pathMatchers(HttpMethod.GET, "/apigw/v1/keys", "/apigw/v1/keys/*")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-175-                    .permitAll()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-176-                    .pathMatchers(HttpMethod.GET, "/apigw/v1/certificates/*")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-185-                    .authenticated())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-186-        .csrf(ServerHttpSecurity.CsrfSpec::disable)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:187:        .httpBasic(withDefaults()); // enabled by default when using spring security;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-188-    return http.build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-189-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-190-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-191-  /*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:192:    This configuration of a filter chain covers UI endpoints (NOTE: We use x-signavio-header for csrf protection, so csrf is disabled here)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-193-  */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-194-  @Bean
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-228-                            new PathPatternParserServerWebExchangeMatcher("/g/api/graphql"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-229-                            new PathPatternParserServerWebExchangeMatcher(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:230:                                "/g/api/graphql/active-features"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-231-                            new PathPatternParserServerWebExchangeMatcher(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-232-                                "/g/api/variant-management/**"),
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-246-                  .matchers(new AuthenticationHeaderNotPresentMatcher(launchDarklyService))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-247-                  .permitAll()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:248:                  .pathMatchers(splitPatternString(uiPatterns))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-249-                  .permitAll()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-250-                  .pathMatchers(HttpMethod.OPTIONS, "/g/api/**", "/g/statics/**")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-251-                  .permitAll();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-252-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:253:        .csrf(ServerHttpSecurity.CsrfSpec::disable) // enabled by default when using spring security
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-254-        .exceptionHandling(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-255-            (exceptions) ->
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-281-                    .access(spmGatewayAuthorizationManager))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-282-        .csrf(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:283:            ServerHttpSecurity.CsrfSpec::disable); // enabled by default when using spring security
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-284-    return http.build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-285-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-287-  /*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-288-    This configuration of a filter chain covers api requests (internal and public) with origin IP check for specific URIs and http methods
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:289:    It also includes a fallback .securityMatcher(ServerWebExchangeMatchers.anyExchange()) to match any requests not matched by any other
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-290-    SecurityWebFilterChain.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-291-  */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-292-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-293-  @Order(4)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:294:  public SecurityWebFilterChain springSecurityFilterChain(ServerHttpSecurity http) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-295-    http.authorizeExchange(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-296-            (exchanges) -> {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-314-                            new PathPatternParserServerWebExchangeMatcher("/val/joule/**"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-315-                            new PathPatternParserServerWebExchangeMatcher("/pi/v1/graphql"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:316:                            new PathPatternParserServerWebExchangeMatcher("/pi/v1/signal"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-317-                            new PathPatternParserServerWebExchangeMatcher(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-318-                                "/suite/search/v1/query")))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-326-                  .matchers(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-327-                      new PathPatternAndHeaderValueMatcher(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:328:                          new String[] {"/spm/v1/**", "/pi/v1/**", "/spg/**"},
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:329:                          X_SIGNAVIO_MAPPING_TYPE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:330:                          CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE.toString()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:331:                  .access(connectivityPlatformAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-332-                  .matchers(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-333-                      new PathPatternAndHeadersPresentMatcher(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:334:                          new String[] {"/spm/v1/**"},
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-335-                          CERTIFICATE.getHeaderName(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:336:                          SAP_SIGNAVIO_TENANT_ID_HEADER,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:337:                          SAP_SIGNAVIO_USER_ID_HEADER))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-338-                  .access(spmAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:339:                  .matchers(new JouleRequestMatcher(splitPatternString(joulePatterns)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-340-                  .access(jouleAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-341-                  .matchers(new PathPatternParserServerWebExchangeMatcher("/idmps/**"))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-352-                          "/tenantservice/v1/dataCollector"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-353-                  .access(tenantServiceAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:354:                  .pathMatchers(HttpMethod.GET, splitPatternString(getPatterns))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-355-                  .access(forwardedIpAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:356:                  .pathMatchers(HttpMethod.POST, splitPatternString(postPatterns))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-357-                  .access(forwardedIpAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:358:                  .pathMatchers(HttpMethod.PUT, splitPatternString(putPatterns))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-359-                  .access(forwardedIpAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:360:                  .pathMatchers(HttpMethod.DELETE, splitPatternString(deletePatterns))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-361-                  .access(forwardedIpAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:362:                  .pathMatchers(HttpMethod.HEAD, splitPatternString(headPatterns))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-363-                  .access(forwardedIpAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:364:                  .pathMatchers(HttpMethod.PATCH, splitPatternString(patchPatterns))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-365-                  .access(forwardedIpAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:366:                  // Due to SEC-238 (verb tampering) requirement, we deny all TRACE requests and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-367-                  // only allow the known HTTP verbs
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-368-                  .pathMatchers(HttpMethod.TRACE)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-371-                  .permitAll();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-372-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:373:        .csrf(ServerHttpSecurity.CsrfSpec::disable) // enabled by default when using spring security
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-374-        .securityMatcher(ServerWebExchangeMatchers.anyExchange())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-375-        .exceptionHandling(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-380-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-381-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:382:  private String[] splitPatternString(String pattern) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java:383:    return Stream.of(pattern.split(",")).toArray(String[]::new);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-384-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/WebSecurityConfig.java-385-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-1-package com.sap.bpi.api.gw.predicates;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java:3:import static com.sap.bpi.api.gw.security.jwt.AuthenticationHeaderNotPresentMatcher.REDIRECT_TO_LOGIN;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-5-import java.util.Objects;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-6-import java.util.function.Predicate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java:7:import org.springframework.cloud.gateway.handler.predicate.AbstractRoutePredicateFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java:8:import org.springframework.cloud.gateway.handler.predicate.GatewayPredicate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java:9:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-11-/**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-40-      @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java:41:      public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java:42:        return String.format("Redirect to login page: %b", config.redirectToLogin());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-43-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-44-    };
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-47-  public static class Config {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java:49:    private boolean redirectToLogin = true;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/RedirectToLoginRoutePredicateFactory.java-51-    public boolean redirectToLogin() {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:3:import static com.sap.bpi.api.gw.security.certificate.utils.MappingTypes.SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_SUBSCRIPTION_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-5-import com.sap.bpi.api.gw.dto.tenant.ExternalTenantMappingResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:6:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:7:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:8:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:9:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:10:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-11-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-13-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-14-public class JouleXsuaaTenantService extends TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:15:  public static final String JOULE_EXTERNAL_TENANT_MAPPING_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-16-      "/v1/tenants/%s/spii/mappings?type=%s";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:17:  private final String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-19-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-20-  public JouleXsuaaTenantService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-21-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:22:      @Value("${app.tenantServiceEndpoint}") String tenantServiceEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-23-    super(webClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-24-    this.tenantServiceEndpoint = tenantServiceEndpoint;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-27-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:28:  public String createTenantMappingEndpoint(String btpSubaccountId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-29-    return tenantServiceEndpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:30:        + String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-31-            JOULE_EXTERNAL_TENANT_MAPPING_PATH,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-32-            btpSubaccountId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:33:            SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_SUBSCRIPTION_MAPPING_TYPE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:36:  public Mono<ExternalTenantMappingResponse> getTenantMapping(String btpSubaccountId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java:37:    String url = createTenantMappingEndpoint(btpSubaccountId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-38-    return getTenantMapping(url, ExternalTenantMappingResponse.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/JouleXsuaaTenantService.java-39-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-3-import com.sap.bpi.api.gw.dto.tenant.IpsConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-4-import com.sap.bpi.api.gw.filters.JsonWebToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:5:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-6-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-7-import java.time.Duration;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:12:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:13:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:14:import org.springframework.core.ParameterizedTypeReference;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:15:import org.springframework.data.redis.core.ReactiveRedisOperations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:16:import org.springframework.data.redis.core.ReactiveRedisTemplate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:17:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:18:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:19:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:20:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:21:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:22:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-23-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-24-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-31-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-32-public class IpsTenantConfigurationService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:33:  public static final String IPS_TENANT_MAPPING_TYPE = "ips_configuration";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:34:  public static final String IPS_TENANT_CONFIGURATION_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-35-      "/v1/tenants/%s/configurations?type=" + IPS_TENANT_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:36:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:37:  private final WebClient webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:38:  private final ReactiveRedisOperations<String, IpsConfigurationDto> reactiveRedisOperations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:39:  private final Logger logger = LoggerFactory.getLogger(IpsTenantConfigurationService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-41-  @Value("${app.tenantServiceEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:42:  private String tenantsHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-44-  @Value("${redis.enabled}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:45:  private boolean isRedisEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-47-  @Value("${redis.ipsTenantsCacheTimeoutMinutes}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:48:  private Integer ipsTenantsCacheTimeoutMinutes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-50-  public IpsTenantConfigurationService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-51-      @Qualifier("genericServiceClient") WebClient tenantsClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:52:      JwtUtils jwtUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-53-      @Autowired(required = false) @Qualifier("tenantsRedisTemplate")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:54:          ReactiveRedisTemplate<String, IpsConfigurationDto> reactiveRedisTemplate) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-55-    this.webClient = tenantsClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:56:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:57:    this.reactiveRedisOperations = reactiveRedisTemplate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-58-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:60:  public Mono<IpsConfigurationDto> getTenantConfiguration(String tenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-61-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-62-    Mono<IpsConfigurationDto> cachedConfigurationDto = getTenantConfigurationFromRedis(tenantId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-66-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-67-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:68:  private Mono<IpsConfigurationDto> getTenantConfigurationFromRedis(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:69:    String redisKey = tenantId + IPS_TENANT_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-70-    if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-71-      logger.info(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-72-          "Attempting redis cache tenants configuration retrieval for tenant id: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:73:      return reactiveRedisOperations.opsForValue().get(redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-74-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-75-      return Mono.empty();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-77-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-78-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:79:  private Mono<IpsConfigurationDto> getTenantConfigurationFromTenants(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:80:      String tenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-81-    ParameterizedTypeReference<IpsConfigurationDto> typeRef = new ParameterizedTypeReference<>() {};
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-82-    return createIpsTenantConfigurationRequest(tenantId, requestId, IPS_TENANT_CONFIGURATION_PATH)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-111-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:113:  private Mono<IpsConfigurationDto> cacheIpsConfigurationDtoIfRedisEnabled(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:114:      String tenantId, IpsConfigurationDto ipsConfigurationDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:115:    String redisKey = tenantId + IPS_TENANT_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-116-    if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-117-      Duration ipsCacheTimeoutMinutesDuration =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-119-              ? Duration.ofMinutes(ipsTenantsCacheTimeoutMinutes)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-120-              : Duration.ofMinutes(5L);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:121:      return reactiveRedisOperations
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-122-          .opsForValue()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:123:          .set(redisKey, ipsConfigurationDto, ipsCacheTimeoutMinutesDuration)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-124-          .thenReturn(ipsConfigurationDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-125-    } else {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-128-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-129-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:130:  private Predicate<? super Throwable> isNotIpsException() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-131-    return e -> !(e instanceof ResponseStatusException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-132-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-133-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:134:  private WebClient.RequestHeadersSpec<?> createIpsTenantConfigurationRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:135:      String tenantId, String requestId, String tenantConfigPath) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:136:    JsonWebToken spmJwt = new JsonWebToken(tenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:137:    String jwtBearer = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-138-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:139:    String tenantConfigurationPath = String.format(tenantConfigPath, tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-140-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-141-    logger.debug(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-146-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-147-        .uri(URI.create(tenantsHost + tenantConfigurationPath))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java:148:        .header(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-149-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IpsTenantConfigurationService.java-150-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-3-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:4: * Is the wrapper for all content security keywords. For more info check <a href:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-5- * "https://scotthelme.co.uk/csp-cheat-sheet"/> and <a href:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-6- * "https://content-security-policy.com"></a>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-7- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:8:public enum Keyword implements CspKeyword {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-9-  /** Wildcard, allows any URL except data: blob: filesystem: schemes. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-10-  ALL("*"),
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-25-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-26-  STRICT_DYNAMIC("'strict-dynamic'"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:27:  /** This will allow event handlers to whitelisted based on their hash. (Coming with CSP3) */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:28:  UNSAFE_HASHED_ATTRIBUTES("'unsafe-hashed-attributes'"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-29-  /** Allows loading resources via the data scheme (eg Base64 encoded images). */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-30-  DATA("data:"),
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-36-  FILESYSTEM("filesystem:");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:38:  private final String asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:40:  Keyword(String keywordAsString) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:41:    this.asString = keywordAsString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-42-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-44-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:45:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java:46:    return asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-47-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/Keyword.java-48-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-5-import com.sap.bpi.api.gw.caching.GenericRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:6:import com.sap.bpi.api.gw.caching.RedisKeyUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:7:import com.sap.bpi.api.gw.dto.PublicKeyDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:8:import com.sap.bpi.api.gw.dto.PublicKeyListDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:9:import com.sap.bpi.api.gw.filters.utils.PublicKeyUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:10:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-11-import java.math.BigInteger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:12:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:13:import java.security.interfaces.RSAPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-14-import java.time.Duration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-15-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-16-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:17:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:18:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:19:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-20-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-22-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:23:public class PublicKeyDtoService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:25:  private static final Logger logger = LoggerFactory.getLogger(PublicKeyDtoService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:26:  private static final Duration DEFAULT_TTL = Duration.ofDays(30);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:27:  private static final Duration DESTINATION_SERVICE_PUBLIC_KEY_TTL = Duration.ofMinutes(5);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-29-  @Value("${redis.enabled}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:30:  private boolean isRedisEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:32:  private final UgwJwtConfig jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:33:  private final GenericRedisService<PublicKeyListDto> publicKeyRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:35:  public PublicKeyDtoService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:36:      UgwJwtConfig jwtConfig,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-37-      // not injected if isRedisEnabled is false (check GenericRedisConfiguration)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:38:      @Autowired(required = false) GenericRedisService<PublicKeyListDto> publicKeyRedisService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:39:    this.jwtConfig = jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:40:    this.publicKeyRedisService = publicKeyRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-43-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:44:   * If redis is enabled, get the PublicKeyListDto from redis. Otherwise, create the public key.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-45-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:46:   * @return the public key list dto
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-47-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:48:  public Mono<PublicKeyListDto> getPublicKeyListDto() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-49-    if (isCachingEnabled()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:50:      return publicKeyRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:51:          .get(RedisKeyUtils.PUBLIC_KEYS_KEY)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:52:          .switchIfEmpty(getPublicKeyListDtoAndSetInRedis());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-53-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:54:      return Mono.just(createPublicKeyListDto());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-55-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-56-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:58:  private Mono<PublicKeyListDto> getPublicKeyListDtoAndSetInRedis() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-59-    return Mono.defer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-60-        () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:61:          PublicKeyListDto publicKeyListDto = createPublicKeyListDto();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:62:          if (publicKeyRedisService != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:63:            return publicKeyRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:64:                .set(RedisKeyUtils.PUBLIC_KEYS_KEY, publicKeyListDto, DEFAULT_TTL)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:65:                .thenReturn(publicKeyListDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-66-          }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:67:          return Mono.just(publicKeyListDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-68-        });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:71:  private PublicKeyListDto createPublicKeyListDto() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:72:    RSAPublicKey publicKey = (RSAPublicKey) jwtConfig.getPublicKeyFromInternalKeyPair();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:73:    PublicKeyDto dto = getPublicKeyDto(publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:74:    return new PublicKeyListDto(dto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-75-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-76-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:77:  private PublicKeyDto getPublicKeyDto(RSAPublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:78:    BigInteger exponent = publicKey.getPublicExponent();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:79:    BigInteger modulus = publicKey.getModulus();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:80:    String encodedExponent = BASE64URL.encode(exponent.toByteArray());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:81:    String encodedModulus = BASE64URL.encode(modulus.toByteArray());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:82:    String value = jwtConfig.getPublicKeyAsEncodedString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:83:    return new PublicKeyDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:84:        jwtConfig.getKeyIdFromInternalKeyPair(), value, encodedExponent, encodedModulus);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-85-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:87:  // ===== TENANT-SPECIFIC PUBLIC KEY CACHING METHODS =====
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-88-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-89-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:90:   * Caches a public key for the specified tenant with the default TTL (30 days).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-91-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-92-   * @param tenantId the tenant ID
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:93:   * @param publicKey the public key to cache
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:94:   * @return a Mono containing the PublicKeyListDto that was cached
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-95-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:96:  public Mono<PublicKeyListDto> cachePublicKey(String tenantId, PublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:97:    return cachePublicKey(tenantId, publicKey, DESTINATION_SERVICE_PUBLIC_KEY_TTL);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-98-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-100-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:101:   * Caches a public key for the specified tenant with a custom TTL.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-102-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-103-   * @param tenantId the tenant ID
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:104:   * @param publicKey the public key to cache
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:105:   * @param ttl the time-to-live for the cached key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:106:   * @return a Mono containing the PublicKeyListDto that was cached
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-107-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:108:  public Mono<PublicKeyListDto> cachePublicKey(String tenantId, PublicKey publicKey, Duration ttl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:109:    PublicKeyDto publicKeyDto = PublicKeyUtils.convertToPublicKeyDto(publicKey, jwtConfig);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:110:    PublicKeyListDto pkListDto = new PublicKeyListDto(publicKeyDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-111-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-112-    if (!isCachingEnabled()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-116-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:118:    String redisKey = RedisKeyUtils.createTenantPublicKeyRedisKey(tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:119:    logger.debug("Caching public key for tenant: {} for {} minutes", tenantId, ttl.toMinutes());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-120-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-121-    // Always return the DTO, regardless of caching success
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:122:    return publicKeyRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:123:        .set(redisKey, pkListDto, ttl)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-124-        .doOnNext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-125-            success -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-126-              if (Boolean.TRUE.equals(success)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:127:                logger.debug("Successfully cached public key for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-128-              } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:129:                logger.warn("Failed to cache public key for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-130-              }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-131-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:132:        .doOnError(e -> logger.error("Error caching public key for tenant: {}", tenantId, e))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-133-        .thenReturn(pkListDto)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-134-        .onErrorReturn(pkListDto)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-137-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-138-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:139:   * Retrieves a cached public key for the specified tenant.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-140-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-141-   * @param tenantId the tenant ID
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:142:   * @return a Mono containing the PublicKeyListDto if found, empty otherwise
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-143-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:144:  public Mono<PublicKeyListDto> getCachedPublicKey(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-145-    if (!isCachingEnabled()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-146-      logger.debug("Redis caching is disabled or dependencies not available");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-148-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-149-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:150:    String redisKey = RedisKeyUtils.createTenantPublicKeyRedisKey(tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:151:    logger.debug("About to call Redis GET for key: {}", redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:152:    return publicKeyRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:153:        .get(redisKey)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:154:        .doOnNext(result -> logger.debug("Retrieved cached public key for tenant: {}", tenantId))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-155-        .doOnError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:156:            e -> logger.error("Error retrieving cached public key for tenant: {}", tenantId, e))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-157-        .onErrorResume(e -> Mono.empty());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-158-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-159-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:160:  private boolean isCachingEnabled() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java:161:    return isRedisEnabled && publicKeyRedisService != null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-162-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PublicKeyDtoService.java-163-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.JOULE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:4:import static com.sap.bpi.api.gw.security.jwt.joule.JouleAuthorizationManager.X_CLIENT_ID_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-6-import java.util.function.Predicate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:7:import org.springframework.cloud.gateway.handler.predicate.AbstractRoutePredicateFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:8:import org.springframework.cloud.gateway.handler.predicate.GatewayPredicate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:9:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-11-/**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-28-      @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-29-      public boolean test(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:30:        String xClientIdAttribute =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:31:            (String) exchange.getRequest().getAttributes().get(X_CLIENT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-33-        if (xClientIdAttribute == null) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-35-        }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:37:        return JOULE.toString().equals(xClientIdAttribute);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-38-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-40-      @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:41:      public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:42:        return String.format("Joule Route: %b", config.isJouleRoute());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-43-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-44-    };
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-47-  public static class Config {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java:49:    private boolean jouleRoute = true;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/predicates/JouleRoutePredicateFactory.java-51-    public boolean isJouleRoute() {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-1-package com.sap.bpi.api.gw.services;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:3:import com.sap.bpi.api.gw.dto.destinationService.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-4-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-5-import java.util.function.Predicate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-6-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-7-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:8:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:9:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:10:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:11:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:12:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:13:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:14:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:15:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:16:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-19-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:20:public class DestinationService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:22:  private final Logger logger = LoggerFactory.getLogger(DestinationService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:24:  private static final String CERTIFICATE_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:25:      "/destination-configuration/v1/instanceCertificates/%s.pem";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:26:  private static final String CERTIFICATES_ENDPOINT =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:27:      "/destination-configuration/v1/instanceCertificates";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:28:  private static final String CERTIFICATE_VALIDITY_TIME_UNIT = "DAYS";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:29:  private static final int CERTIFICATE_VALIDITY_DAYS = 30;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:31:  private final WebClient webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:32:  private final String destinationServiceUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:33:  private final String destinationServiceClientId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:34:  private final String destinationServiceClientSecret;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:35:  private final String destinationServiceTokenUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-37-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:38:  public DestinationService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-39-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:40:      @Value("${signavio.security.destinationService.serviceUrl}") String destinationServiceUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:41:      @Value("${signavio.security.destinationService.clientId}") String destinationServiceClientId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:42:      @Value("${signavio.security.destinationService.clientSecret}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:43:          String destinationServiceClientSecret,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:44:      @Value("${signavio.security.destinationService.tokenUrl}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:45:          String destinationServiceTokenUrl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-46-    this.webClient = webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:47:    this.destinationServiceUrl = destinationServiceUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:48:    this.destinationServiceClientId = destinationServiceClientId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:49:    this.destinationServiceClientSecret = destinationServiceClientSecret;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:50:    this.destinationServiceTokenUrl = destinationServiceTokenUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-51-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:53:  public Mono<DestinationServiceCertificateDto> sendGetCertificateRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:54:      String tenantId, String bearerToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-55-    logger.debug("Fetching certificates array for tenant ID: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-57-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-58-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:59:        .uri(URI.create(destinationServiceUrl + String.format(CERTIFICATE_PATH, tenantId)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-60-        .header(HttpHeaders.AUTHORIZATION, "Bearer " + bearerToken)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-61-        .retrieve()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-66-                    new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-67-                        response.statusCode(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:68:                        "Error while requesting certificates from destination service")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:69:        .bodyToMono(DestinationServiceCertificateDto.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-70-        .onErrorMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:71:            isNotDestinationServiceException(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-72-            e -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:73:              logger.error("Error while requesting certificates from destination service", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-74-              return new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-75-                  HttpStatus.BAD_GATEWAY,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:76:                  "Could not call destination service: " + e.getMessage(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-77-                  e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-78-            })
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-83-                        new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-84-                            HttpStatus.INTERNAL_SERVER_ERROR,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:85:                            "Failed to load certificates from destination service"))));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-86-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:88:  public Mono<OauthTokenResponseDto> getXsuaaJwt() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:89:    logger.debug("Fetching XSUAA JWT token from destination service");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-91-    // Create basic auth header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:92:    String basicAuth =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-93-        java.util.Base64.getEncoder()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:94:            .encodeToString(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:95:                (destinationServiceClientId + ":" + destinationServiceClientSecret).getBytes());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-96-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-97-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-98-        .post()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:99:        .uri(URI.create(destinationServiceTokenUrl))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-100-        .header(HttpHeaders.AUTHORIZATION, "Basic " + basicAuth)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-101-        .header(HttpHeaders.CONTENT_TYPE, "application/x-www-form-urlencoded")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-102-        .bodyValue(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:103:            String.format("client_id=%s&grant_type=client_credentials", destinationServiceClientId))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-104-        .retrieve()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-105-        .onStatus(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-109-                    new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-110-                        response.statusCode(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:111:                        "Error while requesting OAuth token from destination service")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-112-        .bodyToMono(OauthTokenResponseDto.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-113-        .onErrorMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:114:            isNotDestinationServiceException(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-115-            e -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:116:              logger.error("Error while requesting OAuth token from destination service", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-117-              return new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-118-                  HttpStatus.BAD_GATEWAY,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:119:                  "Could not call destination service: " + e.getMessage(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-120-                  e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-121-            })
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-126-                        new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-127-                            HttpStatus.INTERNAL_SERVER_ERROR,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:128:                            "Failed to load OAuth token from destination service"))));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-129-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-130-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-131-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:132:   * Creates a new certificate in the Destination Service and retrieves it. Handles the race
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-133-   * condition where the certificate might already exist (409 Conflict).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-134-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:135:  public Mono<DestinationServiceCertificateDto> createAndGetCertificate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:136:      String tenantId, String bearerToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-137-    return sendCreateCertificateRequest(tenantId, bearerToken)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-138-        .doOnSuccess(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-160-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-161-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:162:   * Sends the HTTP POST request to create a certificate in the Destination Service. This is a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-163-   * low-level helper method that only performs the HTTP operation.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-164-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:165:  private Mono<Void> sendCreateCertificateRequest(String tenantId, String bearerToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-166-    logger.debug("Creating certificate for tenant ID: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-167-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-171-                webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-172-                    .post()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:173:                    .uri(URI.create(destinationServiceUrl + CERTIFICATES_ENDPOINT))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-174-                    .header(HttpHeaders.AUTHORIZATION, "Bearer " + bearerToken)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-175-                    .header(HttpHeaders.CONTENT_TYPE, "application/json")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-182-                                new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-183-                                    response.statusCode(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:184:                                    "Error while creating certificate in destination service")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-185-                    // Expect no content in response body:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:186:                    // https://api.sap.com/api/SAP_CP_CF_Connectivity_Destination/resource/get_v1_instanceCertificates__certificate_name_
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-187-                    .bodyToMono(Void.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-188-                    .onErrorMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:189:                        isNotDestinationServiceException(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-190-                        e -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-191-                          logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:192:                              "Error while creating certificate in destination service", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-193-                          return new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-194-                              HttpStatus.BAD_GATEWAY,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:195:                              "Could not call destination service: " + e.getMessage(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-196-                              e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-197-                        }));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-198-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-199-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:200:  private CertificateCreationRequest createCertificateRequestPayload(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-201-    if (tenantId == null || tenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-202-      throw new IllegalArgumentException("Tenant ID must not be null or empty");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-205-        new CertificateValidity(CERTIFICATE_VALIDITY_TIME_UNIT, CERTIFICATE_VALIDITY_DAYS);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-206-    CertificateAttributes attributes = new CertificateAttributes(true, tenantId, validity);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:207:    return new CertificateCreationRequest(tenantId + ".pem", attributes);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-208-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-209-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:210:  public Mono<String> getAccessToken() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:211:    logger.debug("Fetching access token from destination service");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-212-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:213:    return getXsuaaJwt()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:214:        .doOnNext(response -> logger.debug("Successfully retrieved XSUAA JWT token"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-215-        .map(OauthTokenResponseDto::accessToken)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:216:        .onErrorMap(e -> new RuntimeException("Failed to retrieve XSUAA JWT token", e));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-217-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-218-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:219:  public Mono<DestinationServiceCertificateDto> getCertificateWithAccessToken(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-220-    logger.debug("Fetching access token and certificate for tenant ID: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-221-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-230-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-231-   * Attempts to retrieve an existing certificate, or creates one if it doesn't exist. This is the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:232:   * primary method for ensuring a certificate exists for a tenant.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-233-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-234-   * <p>Flow: 1. Try to GET certificate 2. If GET fails, POST to create certificate 3. Handle 409
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-236-   * certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-237-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:238:   * <p>This implementation prevents infinite loops by ensuring the GET operation is only called
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-239-   * twice at most: once at the beginning, and once after creation.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-240-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:241:  public Mono<DestinationServiceCertificateDto> getCertificateOrCreate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:242:      String tenantId, String accessToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-243-    return sendGetCertificateRequest(tenantId, accessToken)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-244-        .doOnNext(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-252-                  "No certificate found for tenant ID: {}. Creating new certificate.", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-253-              // Directly call the creation logic, then get the certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:254:              // This prevents infinite loops by not recursively calling getCertificateOrCreate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-255-              return createAndGetCertificate(tenantId, accessToken);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-256-            })
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-261-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-262-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:263:  private boolean isConflictError(Throwable throwable) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-264-    return throwable instanceof ResponseStatusException
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-265-        && ((ResponseStatusException) throwable).getStatusCode().equals(HttpStatus.CONFLICT);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-266-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-267-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java:268:  private Predicate<? super Throwable> isNotDestinationServiceException() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-269-    return e -> !(e instanceof ResponseStatusException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/DestinationService.java-270-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-1-package com.sap.bpi.api.gw.security.certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getRequestIdFromHeaderOrGenerate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-4-import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getSourceIpsFromHttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-5-import static com.sap.bpi.api.gw.security.certificate.RequestWithCertificateHeader.SUBJECT;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-23-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-24-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:25:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:26:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:27:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:28:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:29:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:30:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:31:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:32:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:33:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-34-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-35-import reactor.core.publisher.Mono;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-45- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-46- * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:47: *   <li>Extract common name (CN) from x-client-ssl-cn {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-48- *       com.sap.bpi.api.gw.security.certificate.RequestWithCertificateHeader} http header. The
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-49- *       header is set in K8S Virtual Service.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-50- *   <li>Retrieve Tenant Configuration from Redis Cache if stored, else call SPM using the spm
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-51- *       tenant id from the url path.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:52: *   <li>Compare CN from Tenant Configuration with CN from x-client-ssl-cn header. If the CNs match
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-53- *       authorize the request.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-54- * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-55- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:56: * <p>The class is marked as a Spring component using the `@Component` annotation, which allows
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:57: * Spring to manage its lifecycle and dependencies.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-58- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-59-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:60:public class IpsAuthorizationManager implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:61:  public static final String SPM_TENANT_ATTRIBUTE = "spm-tenant";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:62:  private final SpmTenantConfigurationService spmTenantConfigurationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:63:  private final IpsTenantConfigurationService ipsTenantConfigurationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:64:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:65:  private final LaunchDarklyService ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:67:  private final Logger logger = LoggerFactory.getLogger(IpsAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-69-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-83-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-84-    ServerHttpRequest request = context.getExchange().getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:85:    Map<String, List<String>> lowerCaseHttpHeadersMap =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:86:        AuthorizationManagerUtils.createHeadersMapWithLowercaseKeys(request.getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-87-    ValidationResult validationResult = new ValidationResult(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-88-    if (validationResult.errorsExist()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-90-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-91-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:92:    String subject = lowerCaseHttpHeadersMap.get(SUBJECT.getHeaderName()).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:93:    Optional<String> commonNameOptional = getCommonName(subject);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-94-    if (commonNameOptional.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:95:      String errorMsg =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:96:          String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-97-              "Header %s does not contain a Common Name (CN) value", SUBJECT.getHeaderName());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-98-      logger.error(errorMsg);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-100-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-101-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:102:    String path = request.getURI().getPath();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:103:    String spmTenantId = getSpmTenantIdFromPath(path);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:104:    String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:105:    Mono<String> ipsTrustedCommonNames;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-106-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-107-    boolean isIpsConfigurationFromTenantsServiceEnabled =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-149-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-150-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:151:  public Mono<String> getIpsTrustedCommonNamesFromIpsConfiguration(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-152-      Mono<IpsConfigurationDto> monoIpsConfigDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-153-    return monoIpsConfigDto.flatMap(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-155-          List<CertificateDto> certificates = ipsConfigDto.configuration().certificates();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-156-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:157:          String cnValues = AuthorizationManagerUtils.getCnValuesFromCertificates(certificates);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-158-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-159-          logger.debug(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-168-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-169-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:170:  private BiConsumer<String, SynchronousSink<String>> addIpsTenantToHeadersOrRejectRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:171:      AuthorizationContext context, String commonName, String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-172-    return (trustedCommonNames, sink) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-173-      if (!isCommonNameTrusted(commonName, trustedCommonNames)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:174:        String errorMsg = "Certificate does not contain expected IPS Common Name (CN)";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-175-        logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-176-        var sourceIps =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-177-            getSourceIpsFromHttpHeaders(context.getExchange().getRequest().getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-178-        auditLogClientManager.logUnauthorizedAccess(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:179:            tenantId, sourceIps, RequestOrigin.IPS.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-180-        sink.error(new ResponseStatusException(HttpStatus.UNAUTHORIZED, errorMsg));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-181-      } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:182:        // since Spring Webflux 6.2.0 it's not possible to modify the headers in the ServerExchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:183:        // therefore we use attributes. Upstream filter SpmJwtWithIpsTenantIdFilterFactory relies on
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-184-        // this attribute
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-185-        context.getExchange().getAttributes().put(SPM_TENANT_ATTRIBUTE, tenantId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-189-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-190-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:191:  private Mono<String> getIpsTrustedCommonNames(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-192-      Mono<List<SpmConfigurationDto>> tenantConfigurationMono) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-193-    return tenantConfigurationMono
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-201-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-202-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:203:  private Mono<CnRecordDto> getCnRecord(String value) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-204-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-205-      CnRecordDto cnRecordDto = new ObjectMapper().readValue(value, CnRecordDto.class);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-213-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-214-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:215:  private String getSpmTenantIdFromPath(String path) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-216-    // example path pattern: /idmps/{tenantId}/scim/v2/User
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-217-    return path.split("/")[2];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-218-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-219-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:220:  private Optional<String> getCommonName(String subject) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-221-    return Arrays.stream(subject.split(",")).filter(s -> s.trim().startsWith("CN")).findFirst();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-222-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-223-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:224:  private boolean isCommonNameTrusted(String commonName, String ipsTrustedCommonNames) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:225:    // Convert to lowercase to make the check case-insensitive
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:226:    String lowerCaseCommonName = commonName.toLowerCase();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:227:    String lowerCaseIpsTrustedCommonNames = ipsTrustedCommonNames.toLowerCase();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-228-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-229-    // remove all whitespaces
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:230:    String formattedCN = lowerCaseCommonName.replaceAll("\\s", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java:231:    String formattedTrustedCN = lowerCaseIpsTrustedCommonNames.replaceAll("\\s", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-232-    return formattedTrustedCN.contains(formattedCN);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/IpsAuthorizationManager.java-233-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-4-import com.sap.bpi.api.gw.dto.tenant.spm.SpmConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-5-import com.sap.bpi.api.gw.filters.JsonWebToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:6:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-7-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-8-import java.time.Duration;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-11-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-12-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:13:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:14:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:15:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:16:import org.springframework.core.ParameterizedTypeReference;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:17:import org.springframework.data.redis.core.ReactiveRedisOperations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:18:import org.springframework.data.redis.core.ReactiveRedisTemplate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:19:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:20:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:21:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:22:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:23:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:24:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-25-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-26-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-32-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-33-public class SpmTenantConfigurationService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:34:  public static final String SPM_TENANT_CONFIGURATION_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-35-      "/p/configuration/%s?category=TENANT_CONFIGURATION";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:36:  public static final String INSIGHTS_CENTRAL_TENANT_MAPPING_NAME =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:37:      "tenant_signavio_to_insights_mapping";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:38:  public static final String INSIGHTS_CENTRAL_TENANT_CONFIGURATION_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-39-      "/p/configuration/%s?category=TENANT_CONFIGURATION&name="
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-40-          + INSIGHTS_CENTRAL_TENANT_MAPPING_NAME;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:41:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:42:  private final WebClient webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:43:  private final ReactiveRedisOperations<String, List<SpmConfigurationDto>> reactiveRedisOperations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:44:  private final ReactiveRedisOperations<String, List<InsightsCentralConfigurationDto>>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:45:      reactiveRedisOperationsInsightsCentral;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:46:  private final Logger logger = LoggerFactory.getLogger(SpmTenantConfigurationService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-48-  @Value("${app.spmEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:49:  private String spmHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-51-  @Value("${redis.enabled}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:52:  private boolean isRedisEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-54-  @Value("${redis.spmCacheTimeoutMinutes}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:55:  private Integer spmCacheTimeoutMinutes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-57-  public SpmTenantConfigurationService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-58-      @Qualifier("spmClient") WebClient spmClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:59:      JwtUtils jwtUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-60-      @Autowired(required = false) @Qualifier("spmRedisTemplate")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:61:          ReactiveRedisTemplate<String, List<SpmConfigurationDto>> reactiveRedisTemplate,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-62-      @Autowired(required = false) @Qualifier("insightsCentralRedisTemplate")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:63:          ReactiveRedisTemplate<String, List<InsightsCentralConfigurationDto>>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:64:              reactiveRedisOperationsInsightsCentral) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-65-    this.webClient = spmClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:66:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:67:    this.reactiveRedisOperations = reactiveRedisTemplate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:68:    this.reactiveRedisOperationsInsightsCentral = reactiveRedisOperationsInsightsCentral;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-71-  public Mono<List<SpmConfigurationDto>> getTenantConfiguration(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:72:      String spmTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-74-    Mono<List<SpmConfigurationDto>> cachedConfigurationDto =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-81-  public Mono<List<InsightsCentralConfigurationDto>> getInsightsCentralTenantConfiguration(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:82:      String spmTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:84:    String redisKey = spmTenantId + INSIGHTS_CENTRAL_TENANT_MAPPING_NAME;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-85-    Mono<List<InsightsCentralConfigurationDto>> cachedConfigurationDto =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:86:        getInsightsCentralTenantConfigurationFromRedis(redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-88-    return cachedConfigurationDto.switchIfEmpty(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-89-        Mono.defer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:90:            () -> getInsightsCentralTenantConfigurationFromSpm(spmTenantId, redisKey, requestId)));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-91-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-92-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:93:  private Mono<List<SpmConfigurationDto>> getTenantConfigurationFromRedis(String redisKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:94:    Mono<String> keyMono = Mono.just(redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-95-    if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:96:      logger.info("Attempting redis cache spm configuration retrieval for tenant id: {}", redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:97:      return keyMono.flatMap(key -> reactiveRedisOperations.opsForValue().get(key));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-98-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-99-      return Mono.empty();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-101-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-102-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:103:  private Mono<List<InsightsCentralConfigurationDto>>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:104:      getInsightsCentralTenantConfigurationFromRedis(String redisKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:105:    Mono<String> keyMono = Mono.just(redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-106-    if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-107-      logger.info(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-108-          "Attempting redis cache insights central configuration retrieval for tenant id: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:109:          redisKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:110:      return keyMono.flatMap(key -> reactiveRedisOperationsInsightsCentral.opsForValue().get(key));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-111-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-112-      return Mono.empty();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-114-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-115-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:116:  private Mono<List<SpmConfigurationDto>> getTenantConfigurationFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:117:      String spmTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-118-    ParameterizedTypeReference<List<SpmConfigurationDto>> typeRef =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-119-        new ParameterizedTypeReference<>() {};
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-129-                        "Error while requesting tenant configuration from SPM")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-130-        .bodyToMono(typeRef)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:131:        // the onErrorMap will be used when we didn't receive a response from SPM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-132-        // for example when connection is reset
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-133-        .onErrorMap(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-152-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-153-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:154:  private Mono<List<SpmConfigurationDto>> getSpmConfigurationDtoAndCacheIfRedisEnabled(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:155:      String spmTenantId, List<SpmConfigurationDto> spmConfigurationDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-156-    if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-157-      Duration spmCacheTimeoutMinutesDuration =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-159-              ? Duration.ofMinutes(spmCacheTimeoutMinutes)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-160-              : Duration.ofMinutes(5L);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:161:      return reactiveRedisOperations
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-162-          .opsForValue()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-163-          .set(spmTenantId, spmConfigurationDto, spmCacheTimeoutMinutesDuration)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-168-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-169-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:170:  private Predicate<? super Throwable> isNotSpmException() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-171-    return e -> !(e instanceof ResponseStatusException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-172-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-173-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:174:  private Mono<List<InsightsCentralConfigurationDto>> getInsightsCentralTenantConfigurationFromSpm(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:175:      String spmTenantId, String redisKey, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-176-    ParameterizedTypeReference<List<InsightsCentralConfigurationDto>> typeRef =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-177-        new ParameterizedTypeReference<>() {};
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-187-                        "Error while requesting insights central tenant configuration from SPM")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-188-        .bodyToMono(typeRef)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:189:        // the onErrorMap will be used when we didn't receive a response from SPM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-190-        // for example when connection is reset
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-191-        .onErrorMap(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-209-            insightsCentralConfigurationDto ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-210-                getInsightsCentralConfigurationDtoAndCacheIfRedisEnabled(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:211:                    redisKey, insightsCentralConfigurationDto));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-212-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-213-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:214:  private Mono<List<InsightsCentralConfigurationDto>>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-215-      getInsightsCentralConfigurationDtoAndCacheIfRedisEnabled(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:216:          String redisKey, List<InsightsCentralConfigurationDto> insightsCentralConfigurationDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-217-    if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-218-      Duration spmCacheTimeoutMinutesDuration =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-220-              ? Duration.ofMinutes(spmCacheTimeoutMinutes)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-221-              : Duration.ofMinutes(5L);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:222:      return reactiveRedisOperationsInsightsCentral
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-223-          .opsForValue()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:224:          .set(redisKey, insightsCentralConfigurationDto, spmCacheTimeoutMinutesDuration)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-225-          .thenReturn(insightsCentralConfigurationDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-226-    } else {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-229-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-230-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:231:  private WebClient.RequestHeadersSpec<?> createSpmTenantConfigurationRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:232:      String spmTenantId, String requestId, String tenantConfigPath) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:233:    JsonWebToken spmJwt = new JsonWebToken(spmTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:234:    String jwtBearer = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-235-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:236:    String tenantConfigurationPath = String.format(tenantConfigPath, spmTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-237-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-238-    logger.debug(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-241-        .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-242-        .uri(URI.create(spmHost + tenantConfigurationPath))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java:243:        .header(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-244-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/SpmTenantConfigurationService.java-245-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-1-package com.sap.bpi.api.gw.filters.utils.csp;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java:3:public enum CspDirectiveType {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-4-  DEFAULT_SRC("default-src"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-5-  SCRIPT_SRC("script-src"),
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-17-  PLUGIN_TYPES("plugin-types"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java:19:  // deprecated directives needed for edge14 and below
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-20-  FRAME_SRC("frame-src");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java:22:  private final String asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java:24:  CspDirectiveType(String asString) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java:25:    this.asString = asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-26-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-28-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java:29:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java:30:    return asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirectiveType.java-32-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-3-import static com.sap.bpi.api.gw.security.certificate.RequestWithCertificateHeader.CERTIFICATE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:4:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:5:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_USER_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-7-import java.util.Arrays;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-10-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-11-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:12:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:13:import org.springframework.security.web.server.util.matcher.OrServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:14:import org.springframework.security.web.server.util.matcher.PathPatternParserServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:15:import org.springframework.security.web.server.util.matcher.ServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:16:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-19-public class PathPatternAndHeadersPresentMatcher implements ServerWebExchangeMatcher {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:21:  private final String certificateHeaderName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:22:  private final String sapTenantIdHeaderName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:23:  private final String sapSignavioUserIdHeaderName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:25:  private final OrServerWebExchangeMatcher multiPathPatternMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:27:  private final Logger logger = LoggerFactory.getLogger(PathPatternAndHeadersPresentMatcher.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-29-  public PathPatternAndHeadersPresentMatcher(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:30:      String[] pathPattern,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:31:      String certificateHeaderName,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:32:      String sapTenantIdHeaderName,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:33:      String sapSignavioUserIdHeaderName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-34-    List<ServerWebExchangeMatcher> pathPatternMatchers =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-35-        Arrays.stream(pathPattern)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-38-    multiPathPatternMatcher = new OrServerWebExchangeMatcher(pathPatternMatchers);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-39-    this.certificateHeaderName = certificateHeaderName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:40:    this.sapSignavioUserIdHeaderName = sapSignavioUserIdHeaderName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-41-    this.sapTenantIdHeaderName = sapTenantIdHeaderName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-42-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-47-    ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:49:    String certificate = request.getHeaders().getFirst(CERTIFICATE.getHeaderName());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:50:    String sapSignavioUserId = request.getHeaders().getFirst(SAP_SIGNAVIO_USER_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:51:    String sapTenantId = request.getHeaders().getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-52-    logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:53:        "Certificate, tenantId and userId headers found with respective values: {} {} {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-54-        certificate,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-55-        sapTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:56:        sapSignavioUserId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-58-    return multiPathPatternMatcher
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-62-              if (matchResult.isMatch()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-63-                Boolean isCertificateHeaderPresent =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:64:                    exchange.getRequest().getHeaders().containsKey(certificateHeaderName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-65-                Boolean isUserIdHeaderPresent =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:66:                    exchange.getRequest().getHeaders().containsKey(sapSignavioUserIdHeaderName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-67-                Boolean isTenantIdHeaderPresent =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java:68:                    exchange.getRequest().getHeaders().containsKey(sapTenantIdHeaderName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-69-                if (isCertificateHeaderPresent
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/PathPatternAndHeadersPresentMatcher.java-70-                    && isUserIdHeaderPresent
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-3-import com.sap.bpi.api.gw.dto.tenant.ias.TenantServiceIasTypeResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-4-import com.sap.bpi.api.gw.filters.JsonWebToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:5:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-6-import com.sap.bpi.api.gw.security.certificate.utils.MappingTypes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:7:import com.sap.bpi.api.gw.security.jwt.ias.IngestionIasJwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:8:import java.util.HashMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-9-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-10-import java.util.UUID;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-11-import java.util.function.Consumer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:12:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:13:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:14:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:15:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:16:import org.springframework.http.MediaType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:17:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:18:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-19-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-21-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-22-public class IasTenantService extends TenantService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:23:  private final String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:24:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-26-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-27-  public IasTenantService(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-28-      @Qualifier("genericServiceClient") WebClient webClient,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:29:      @Value("${app.tenantServiceEndpoint}") String tenantServiceEndpoint,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:30:      JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-31-    super(webClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-32-    this.tenantServiceEndpoint = tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:33:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-36-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:37:  public String createTenantMappingEndpoint(String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-38-    return tenantServiceEndpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:39:        + String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:40:            IngestionIasJwtVerifier.TENANT_CONFIGURATION_PATH,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:41:            signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:42:            MappingTypes.IAS_JWT_CONFIGURATION_TYPE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-43-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:45:  public Mono<TenantServiceIasTypeResponse> getTenantMapping(String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:46:    String url = createTenantMappingEndpoint(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-47-    return getTenantMapping(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:48:        url, createHeaders(signavioTenantId), TenantServiceIasTypeResponse.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-49-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:51:  private Consumer<HttpHeaders> createHeaders(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:53:    String requestId = UUID.randomUUID().toString().replace("-", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:54:    JsonWebToken spmJwt = new JsonWebToken(tenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:55:    String jwtBearer = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:57:    Map<String, String> headerMap = new HashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:58:    headerMap.put(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java:59:    headerMap.put(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/services/IasTenantService.java-61-    return headers -> headerMap.forEach(headers::add);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-6-import java.io.IOException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-7-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:8:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:9:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-11-/**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-14- * <p>This class reads the tenant service certificate information from the application.yaml,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-15- * injected via property {@code certificates.tenantService}. The data is expected to be a JSON
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:16: * string representing a list of issuer and subject combinations.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-17- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:18: * <p>The class provides a method to parse this JSON into a list of {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-19- * TenantServiceCldSubjectAndIssuer} objects, supporting both unquoted and single-quoted field names
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-20- * to accommodate infrastructure-specific formatting.
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-25-  @Value("${certificates.tenantService}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:26:  private String tenantServiceData;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-28-  /*
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-31-    variable in the ConfigMap. Therefore, the mapper is configured to allow unquoted and single quoted fields.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-32-  */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:33:  private final ObjectMapper objectMapper =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-34-      new ObjectMapper()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-35-          .enable(JsonParser.Feature.ALLOW_UNQUOTED_FIELD_NAMES)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-38-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:39:   * Parses the tenantService JSON string into a list of TenantServiceCldSubjectAndIssuer objects.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-40-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-41-   * @return List of TenantServiceCldSubjectAndIssuer objects parsed from JSON.
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-49-  public static class TenantServiceCldSubjectAndIssuer {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:50:    private String cldIssuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:51:    private List<String> cldSubjects;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-53-    // Getters and Setters
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:54:    public String getCldIssuer() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-55-      return cldIssuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-56-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:58:    public void setCldIssuer(String cldIssuer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-59-      this.cldIssuer = cldIssuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-60-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-61-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:62:    public List<String> getCldSubjects() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-63-      return cldSubjects;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-64-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java:66:    public void setCldSubjects(List<String> cldSubjects) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-67-      this.cldSubjects = cldSubjects;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TenantServiceConfig.java-68-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-11-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-12-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:13:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:14:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:15:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:16:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:17:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:18:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:19:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-20-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-22-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-23-public class TenantServiceAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:24:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:26:  private final Logger logger = LoggerFactory.getLogger(TenantServiceAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:28:  private final CertificateValidator certificateValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:29:  private final LaunchDarklyService ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:30:  private final TenantServiceConfig tenantServiceConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-32-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-49-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:51:    Map<String, List<String>> lowerCaseHttpHeadersMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-52-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-53-      lowerCaseHttpHeadersMap = AuthorizationManagerUtils.extractAndValidateHeaders(context);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-56-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:58:    String subjectFromHeader =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-59-        lowerCaseHttpHeadersMap.get(RequestWithCertificateHeader.SUBJECT.getHeaderName()).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:61:    String issuerFromHeader =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-62-        lowerCaseHttpHeadersMap.get(RequestWithCertificateHeader.ISSUER.getHeaderName()).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-63-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-69-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-70-    boolean areSubjectAndIssuerValid =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:71:        certificateValidator.areTenantServiceIssuerAndSubjectValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-72-            issuerFromHeader, subjectFromHeader, tenantServiceDataCertificates);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-74-    if (!areSubjectAndIssuerValid) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:75:      String errorMsg = "Subject and/or Issuer are not valid";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-76-      logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-77-      return Mono.error(new ResponseStatusException(HttpStatus.UNAUTHORIZED, errorMsg));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-79-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-80-    if (ldService.isFeatureEnabled(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:81:        LaunchDarklyFeatureFlag.TENANT_SERVICE_SHORT_LIVED_CERTIFICATE)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:82:      String certificate =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-83-          lowerCaseHttpHeadersMap
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-84-              .get(RequestWithCertificateHeader.CERTIFICATE.getHeaderName())
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-87-      return Mono.just(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java:88:          new AuthorizationDecision(certificateValidator.isShortLivedCertificate(certificate)));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-89-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/TenantServiceAuthorizationManager.java-90-      return Mono.just(new AuthorizationDecision(true));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.utils.JwtUtils.BEARER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:5:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-6-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-7-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-8-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:9:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:10:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:11:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:12:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:13:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:14:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:15:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:16:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-19-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:20:public class UgwJwtToSpgTokenFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:21:    extends AbstractGatewayFilterFactory<UgwJwtToSpgTokenFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:23:  private final Logger logger = LoggerFactory.getLogger(UgwJwtToSpgTokenFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:25:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-27-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:28:  public UgwJwtToSpgTokenFilterFactory(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-29-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-30-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:31:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-32-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:33:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-34-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:35:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-36-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-37-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-42-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-43-              ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:44:              String ugwJwt = getJwtFromRequest(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:45:              Optional<String> spgToken =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:46:                  jwtUtils.getTokenClaimValue(ugwJwt.substring(BEARER.length() + 1));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-47-              return spgToken
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-48-                  .map(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-51-                            "Found authorization header with UGW Token. Replacing it with SPG"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-52-                                + " token");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:53:                        String tokenHeader = String.format("Bearer %s", token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-54-                        ServerHttpRequest.Builder builder =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-55-                            request.mutate().header(HttpHeaders.AUTHORIZATION, tokenHeader);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-59-                  .orElseGet(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-60-                      () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:61:                        logger.error("No SPG Token found in the JWT Claims for key: tok!");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-62-                        return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-63-                            new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-64-                                HttpStatus.BAD_REQUEST,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:65:                                "No SPG Token found in the JWT Claims for key: tok!"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-66-                      });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-67-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-68-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:70:  private String getJwtFromRequest(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-71-    return Optional.ofNullable(request.getHeaders().getFirst(HttpHeaders.AUTHORIZATION))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java:72:        .filter(jwt -> jwt.startsWith(BEARER))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-73-        .orElseThrow(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToSpgTokenFilterFactory.java-74-            () -> {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.ConnectivityPlatformMtlsGatewayFilterFactory.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:4:import static com.sap.bpi.api.gw.security.SpmGatewayAuthorizationManager.SPM_JWT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:6:import com.sap.bpi.api.gw.dto.destinationService.DestinationServiceCertificateDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:7:import com.sap.bpi.api.gw.security.PublicKeyDtoService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:8:import com.sap.bpi.api.gw.security.certificate.utils.DestinationServiceCertificateParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:9:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:10:import com.sap.bpi.api.gw.services.DestinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:11:import com.signavio.jwt.Token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:12:import java.security.KeyPair;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-13-import java.security.NoSuchAlgorithmException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:14:import java.security.PrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:15:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-16-import java.security.cert.CertificateException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-17-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:18:import java.security.spec.InvalidKeySpecException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-19-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-20-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-21-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:22:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:23:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:24:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:25:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:26:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:27:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:28:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-29-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-31-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:32:public class SpmJwtToAsymmetricJwtGatewayFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:33:    extends AbstractGatewayFilterFactory<SpmJwtToAsymmetricJwtGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:35:  private static final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:36:      LoggerFactory.getLogger(SpmJwtToAsymmetricJwtGatewayFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:38:  private final DestinationService destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:39:  private final UgwJwtService ugwJwtService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:40:  private final PublicKeyDtoService publicKeyDtoService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-42-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:43:  public SpmJwtToAsymmetricJwtGatewayFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:44:      UgwJwtService ugwJwtService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:45:      DestinationService destinationService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:46:      PublicKeyDtoService publicKeyDtoService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-47-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:48:    this.ugwJwtService = ugwJwtService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:49:    this.destinationService = destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:50:    this.publicKeyDtoService = publicKeyDtoService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-51-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-53-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:54:  public GatewayFilter apply(SpmJwtToAsymmetricJwtGatewayFilterFactory.Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-55-    return (exchange, chain) ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-56-        Mono.defer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-57-                () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-58-                  // Set by SpmGatewayAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:59:                  Token spmJwt = (Token) exchange.getAttributes().get(SPM_JWT);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:61:                  if (spmJwt == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-62-                    return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:63:                        new IllegalArgumentException("SPM JWT not found in exchange attributes"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-64-                  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:66:                  return destinationService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:67:                      .getCertificateWithAccessToken(spmJwt.getTenantId())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-68-                      .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-69-                          certificate -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-70-                            try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-71-                              ProcessedCertificateData processedData =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:72:                                  processCertificate(certificate, spmJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-73-                              putAttributesToExchange(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-74-                                  exchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-75-                                  processedData.certificates(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:76:                                  processedData.privateKey(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:77:                                  processedData.asymmetricJwt());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-78-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:79:                              return publicKeyDtoService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:80:                                  .cachePublicKey(spmJwt.getTenantId(), processedData.publicKey())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-81-                                  .then(chain.filter(exchange));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-82-                            } catch (Exception e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-88-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-89-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:90:  private ProcessedCertificateData processCertificate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:91:      DestinationServiceCertificateDto certificateDto, Token spmJwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-92-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-93-      CertificateComponents components = extractCertificateComponents(certificateDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-94-      X509Certificate leafCertificate = components.certificates().get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:95:      PublicKey publicKey = leafCertificate.getPublicKey();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:96:      KeyPair keyPair = new KeyPair(publicKey, components.privateKey());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:97:      String asymmetricJwt = ugwJwtService.generateSignedAsymmetricJwtFromSpmJwt(spmJwt, keyPair);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-98-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-99-      return new ProcessedCertificateData(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:100:          components.certificates(), components.privateKey(), asymmetricJwt, publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-101-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:102:      throw new RuntimeException("Failed to process certificate and generate JWT", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-103-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-104-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-105-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:106:  private CertificateComponents extractCertificateComponents(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:107:      DestinationServiceCertificateDto certificateDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-108-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:109:      String pemContent =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:110:          DestinationServiceCertificateParser.decodePEMContent(certificateDto.content());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:111:      PrivateKey privateKey =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:112:          DestinationServiceCertificateParser.extractPrivateKeyPkcs8(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-113-      List<X509Certificate> certificates =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:114:          DestinationServiceCertificateParser.extractCertificates(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-115-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:116:      return new CertificateComponents(privateKey, certificates);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:117:    } catch (InvalidKeySpecException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:118:      throw new RuntimeException("Failed to parse private key from certificate content", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-119-    } catch (NoSuchAlgorithmException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:120:      throw new RuntimeException("RSA algorithm not available for private key parsing", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-121-    } catch (CertificateException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:122:      throw new RuntimeException("Failed to parse X.509 certificates from PEM content", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-123-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-124-      throw new RuntimeException("Failed to process certificate components", e);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-126-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-127-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:128:  private Mono<Void> handleError(Throwable error) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-129-    if (error instanceof IllegalArgumentException) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:130:      logger.warn("SPM to Connectivity Platform route - {}", error.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-131-      return Mono.error(new ResponseStatusException(HttpStatus.UNAUTHORIZED, error.getMessage()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-132-    } else {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-137-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-138-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:139:  private void putAttributesToExchange(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-140-      ServerWebExchange exchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-141-      List<X509Certificate> x509CertificateList,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:142:      PrivateKey privateKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:143:      String asymmetricJwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:144:    exchange.getAttributes().put(CONNECTIVITY_CERTIFICATES, x509CertificateList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:145:    exchange.getAttributes().put(CONNECTIVITY_PRIVATE_KEY, privateKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:146:    exchange.getAttributes().put(ASYMMETRIC_JWT, asymmetricJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-147-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-148-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-151-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-152-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:153:  private record CertificateComponents(PrivateKey privateKey, List<X509Certificate> certificates) {}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-154-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:155:  private record ProcessedCertificateData(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-156-      List<X509Certificate> certificates,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:157:      PrivateKey privateKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:158:      String asymmetricJwt,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java:159:      PublicKey publicKey) {}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmJwtToAsymmetricJwtGatewayFilterFactory.java-160-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-7-public enum RequestWithCertificateHeader {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java:8:  SUBJECT("x-client-ssl-cn"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java:9:  ISSUER("x-client-ssl-issuer"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-10-  CERTIFICATE("x-forwarded-client-cert");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java:12:  private final String headerName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java:14:  RequestWithCertificateHeader(String headerName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-15-    this.headerName = headerName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-16-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java:18:  public String getHeaderName() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-19-    return headerName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-20-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-24-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java:26:  public static Set<String> getAllHeaderNames() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-27-    return getAllCertificateHeaders().stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/RequestWithCertificateHeader.java-28-        .map(RequestWithCertificateHeader::getHeaderName)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-7-import java.util.stream.Stream;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:9:public class ContentSecurityPolicy implements Iterable<CspDirective> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:11:  private final CspMode mode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:12:  private final Set<CspDirective> directives;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:13:  private final CspStatus status;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:15:  private final List<ContentSecurityPolicyCompatHeader> compatHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:17:  public ContentSecurityPolicy(CspMode mode, Set<CspDirective> directives, CspStatus status) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:18:    this(mode, directives, status, Collections.emptyList());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-19-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-21-  public ContentSecurityPolicy(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-22-      CspMode mode,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:23:      Set<CspDirective> directives,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-24-      CspStatus status,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-25-      List<ContentSecurityPolicyCompatHeader> compatHeaders) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-26-    this.mode = mode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:27:    this.directives =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:28:        directives.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:29:            .filter(CspDirective::hasType)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:30:            .filter(CspDirective::isEffective)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:31:            .collect(toCollection(LinkedHashSet::new));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-32-    this.status = status;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-33-    this.compatHeaders = compatHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:36:  public static ContentSecurityPolicy emptyActivated(CspMode csp) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:37:    return new ContentSecurityPolicy(csp, new HashSet<>(), CspStatus.ON);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-38-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:40:  public boolean hasDirectives() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:41:    return !directives.isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-42-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:44:  public String getHeaderName() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-45-    return mode.getHeaderName();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-46-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:48:  public String getDirectives() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:49:    return directives.stream().map(CspDirective::toHeaderValue).collect(Collectors.joining(" "));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-50-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-51-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:52:  public boolean isIgnored() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-53-    return status == CspStatus.IGNORE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-54-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-72-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:73:  public Iterator<CspDirective> iterator() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:74:    return directives.iterator();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-75-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-76-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:77:  public Stream<CspDirective> stream() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java:78:    return directives.stream();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicy.java-80-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.X_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-5-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-6-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-7-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:8:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-9-import com.sap.bpi.api.gw.services.SpmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-10-import java.util.Collections;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-11-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-12-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:13:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:14:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:15:import org.springframework.cloud.gateway.filter.GatewayFilterChain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:16:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:17:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:18:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:19:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:20:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:21:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:22:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-23-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-25-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:26:public class XSignavioTenantIdToSpmJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:27:    extends AbstractGatewayFilterFactory<XSignavioTenantIdToSpmJwtFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:28:  private final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:29:      LoggerFactory.getLogger(XSignavioTenantIdToSpmJwtFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:31:  public static final String X_SIGNAVIO_SUBJECT_HEADER = "x-signavio-subject";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:32:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:33:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-35-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:36:  public XSignavioTenantIdToSpmJwtFilterFactory(JwtUtils jwtUtils, SpmService spmService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-37-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-38-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:39:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-40-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:41:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-42-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:43:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-44-    this.spmService = spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-45-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-51-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-52-              ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:53:              String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:54:              String signavioTenantId = getSignavioTenantId(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:55:              String subject = getSubject(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-57-              // Check if this is an SPG request
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-58-              if (isSpgRequest(request)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:59:                return handleSpgRequest(exchange, chain, signavioTenantId, subject, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-60-              } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-61-                // Original SPM handling
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:62:                String jwtBearer = generateJwtBearer(signavioTenantId, subject, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:63:                ServerHttpRequest requestBuild = buildRequest(exchange, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-64-                return chain.filter(exchange.mutate().request(requestBuild).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-65-              }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-67-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:69:  private boolean isSpgRequest(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:70:    String path = request.getPath().value();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-71-    return path.startsWith("/spg/");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-72-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:74:  private Mono<Void> handleSpgRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-75-      ServerWebExchange exchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-76-      GatewayFilterChain chain,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:77:      String signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:78:      String subject,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:79:      String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-80-    if (subject == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-81-      throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:82:          HttpStatus.BAD_REQUEST, "Missing x-signavio-subject header for SPG request");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-83-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:84:    return getSpmUserFromSpgUser(signavioTenantId, subject, requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-85-        .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-86-            spmUser -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:87:              // Generate JWT with SPM user details
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:88:              JsonWebToken spmJwt =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-89-                  new JsonWebToken(spmUser.tenantId(), spmUser.email(), requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:90:              String jwtBearer = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-91-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:92:              ServerHttpRequest requestBuild = buildRequest(exchange, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-93-              return chain.filter(exchange.mutate().request(requestBuild).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-94-            })
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-98-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:100:  private Mono<SpmUser> getSpmUserFromSpgUser(String tenantId, String email, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:101:    JsonWebToken spmJwt = new JsonWebToken(tenantId, email, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:102:    String smpJwtString = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:103:    return spmService.getUserDetailsFromSpmWithSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:104:        smpJwtString, null, Collections.singleton(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-105-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-106-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:107:  private String getSignavioTenantId(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:108:    String signavioTenantId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:109:        exchange.getRequest().getHeaders().getFirst(X_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:110:    if (signavioTenantId == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-111-      throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:112:          HttpStatus.BAD_REQUEST, "Missing x-signavio-tenant-id header");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-113-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:114:    logger.info("x-signavio-tenant-id extracted from the headers: {}", signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:115:    return signavioTenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-116-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:118:  private String getSubject(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:119:    String subject = exchange.getRequest().getHeaders().getFirst(X_SIGNAVIO_SUBJECT_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-120-    if (subject == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-121-      return null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-122-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:123:    logger.info("x-signavio-subject extracted from the headers: {}", subject);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-124-    return subject;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-125-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:127:  private String generateJwtBearer(String xSignavioTenantId, String subject, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:128:    JsonWebToken spmJwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-129-    if (subject == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:130:      spmJwt = new JsonWebToken(xSignavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-131-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:132:      spmJwt = new JsonWebToken(xSignavioTenantId, subject, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-133-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:134:    return jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-135-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-136-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:137:  private ServerHttpRequest buildRequest(ServerWebExchange exchange, String jwtBearer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-138-    ServerHttpRequest.Builder builder = exchange.getRequest().mutate();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:139:    builder.headers(headers -> headers.remove(X_SIGNAVIO_TENANT_ID_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:140:    builder.headers(headers -> headers.remove(X_SIGNAVIO_SUBJECT_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java:141:    builder.header(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-142-    return builder.build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/XSignavioTenantIdToSpmJwtFilterFactory.java-143-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-1-package com.sap.bpi.api.gw.controllers;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:3:import com.sap.bpi.api.gw.dto.PublicKeyListDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:4:import com.sap.bpi.api.gw.dto.destinationService.DestinationServiceCertificateDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:5:import com.sap.bpi.api.gw.security.PublicKeyDtoService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:6:import com.sap.bpi.api.gw.security.certificate.utils.DestinationServiceCertificateParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:7:import com.sap.bpi.api.gw.services.DestinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:8:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-9-import java.security.cert.CertificateException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-10-import java.security.cert.X509Certificate;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-12-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-13-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:14:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:15:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:16:import org.springframework.http.ResponseEntity;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:17:import org.springframework.web.bind.annotation.GetMapping;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:18:import org.springframework.web.bind.annotation.PathVariable;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:19:import org.springframework.web.bind.annotation.RestController;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:20:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-21-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-23-@RestController
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:24:public class PublicKeyController {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:26:  private static final Logger logger = LoggerFactory.getLogger(PublicKeyController.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:28:  private final PublicKeyDtoService keyDtoService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:29:  private final DestinationService destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:31:  public static final String APIGW_V1_KEYS_PATH = "/apigw/v1/keys";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:33:  PublicKeyController(PublicKeyDtoService keyDtoService, DestinationService destinationService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:34:    this.keyDtoService = keyDtoService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:35:    this.destinationService = destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-36-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:38:  @GetMapping(APIGW_V1_KEYS_PATH)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:39:  public Mono<ResponseEntity<PublicKeyListDto>> getPublicKeys() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:41:    return keyDtoService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:42:        .getPublicKeyListDto()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-43-        .map(ResponseEntity::ok)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-44-        .defaultIfEmpty(ResponseEntity.notFound().build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-45-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:47:  @GetMapping(APIGW_V1_KEYS_PATH + "/{tenantId}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:48:  public Mono<ResponseEntity<PublicKeyListDto>> getPublicKeysByTenantId(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:49:      @PathVariable String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:50:    logger.debug("Fetching public key for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-51-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:52:    return keyDtoService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:53:        .getCachedPublicKey(tenantId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-54-        .map(ResponseEntity::ok)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-55-        .switchIfEmpty(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-57-                () ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-58-                    // If cache is empty, try to fetch and process certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:59:                    fetchAndCachePublicKeyFromCertificate(tenantId)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-60-        .doOnNext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-61-            response -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-62-              if (response.getStatusCode().is2xxSuccessful()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:63:                logger.debug("Successfully retrieved public key for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-64-              }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-65-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-66-        .onErrorResume(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-67-            e -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:68:              logger.error("Error retrieving public key for tenant: {}", tenantId, e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-69-              return Mono.just(ResponseEntity.notFound().build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-70-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-71-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-72-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:73:  private Mono<ResponseEntity<PublicKeyListDto>> fetchAndCachePublicKeyFromCertificate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:74:      String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:75:    logger.debug("No cached public key found for tenant: {}, fetching certificate", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-76-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:77:    return destinationService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-78-        .getCertificateWithAccessToken(tenantId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-79-        .flatMap(certificateDto -> processCertificateAndCache(tenantId, certificateDto))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-108-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-109-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:110:  private Mono<ResponseEntity<PublicKeyListDto>> processCertificateAndCache(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:111:      String tenantId, DestinationServiceCertificateDto certificateDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-112-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:113:      PublicKey publicKey = extractPublicKeyFromCertificate(certificateDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:114:      return keyDtoService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:115:          .cachePublicKey(tenantId, publicKey)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-116-          .map(ResponseEntity::ok)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-117-          .switchIfEmpty(Mono.just(ResponseEntity.notFound().build()));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-122-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-123-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:124:  private PublicKey extractPublicKeyFromCertificate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:125:      DestinationServiceCertificateDto certificateDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-126-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:127:      String pemContent =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:128:          DestinationServiceCertificateParser.decodePEMContent(certificateDto.content());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-129-      List<X509Certificate> certificates =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:130:          DestinationServiceCertificateParser.extractCertificates(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-131-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-132-      if (certificates.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:133:        throw new RuntimeException("No certificates found in PEM content");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-134-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-135-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-136-      X509Certificate leafCertificate = certificates.get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:137:      return leafCertificate.getPublicKey();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-138-    } catch (CertificateException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java:139:      throw new RuntimeException("Failed to parse X.509 certificates from PEM content", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-140-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicKeyController.java-141-      throw new RuntimeException("Failed to process certificate components", e);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-1-package com.sap.bpi.api.gw.global;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:3:import org.springframework.cloud.gateway.filter.GatewayFilterChain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:4:import org.springframework.cloud.gateway.filter.GlobalFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:5:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:6:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:7:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-8-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-9-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-11- * This global filter adds REFERER header with the value of HOST header The HOST header is later
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-12- * removed by the {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:13: * org.springframework.cloud.gateway.filter.NettyRoutingFilter#filter(ServerWebExchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-14- * GatewayFilterChain)} If the HOST header is not removed, it may cause connection issues due to the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:15: * Istio setup at the Signavio cluster
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-16- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-17-@Component
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-21-  public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-22-    HttpHeaders headers = exchange.getRequest().getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java:23:    String host = headers.getFirst(HttpHeaders.HOST);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-24-    if (host != null && headers.getFirst(HttpHeaders.REFERER) == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AddRefererHeaderFilter.java-25-      ServerWebExchange mutatedExchange =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-7-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-8-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:9:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:10:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:11:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:12:import org.springframework.cloud.gateway.support.ServerWebExchangeUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:13:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:14:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:15:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:16:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:17:import org.springframework.web.util.UriComponentsBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-18-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-19-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-48-    extends AbstractGatewayFilterFactory<PinsDynamicRoutingGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:50:  private static final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-51-      LoggerFactory.getLogger(PinsDynamicRoutingGatewayFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:53:  private final PamTenantService pamTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-55-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-62-  public GatewayFilter apply(Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-63-    return (exchange, chain) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:64:      String tenantId = FilterUtils.getSignavioTenantIdFromExchange(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:65:      String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-67-      if (tenantId == null || tenantId.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-79-          .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-80-              tenantMapping -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:81:                String pinsEndpoint = extractPinsEndpoint(tenantMapping);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-82-                if (pinsEndpoint == null || pinsEndpoint.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-83-                  logger.error(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-103-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-104-                logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:105:                    "Error during pins dynamic routing for tenant: {}", tenantId, throwable);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-106-                return new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-107-                    HttpStatus.BAD_GATEWAY,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-113-  // Build the full target URI by combining the base endpoint with the request path and query
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:114:  private static URI getTargetUri(ServerWebExchange exchange, String pinsEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:115:    return UriComponentsBuilder.fromUriString(pinsEndpoint)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-116-        .replacePath(exchange.getRequest().getURI().getPath())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-117-        .replaceQuery(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-127-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-128-   * @param tenantMapping the tenant service response containing configuration data
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:129:   * @return the PINS endpoint URL as a string, or {@code null} if not found or if any part of the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-130-   *     configuration hierarchy is null
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-131-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java:132:  private String extractPinsEndpoint(TenantServicePamTypeResponse tenantMapping) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-133-    if (tenantMapping == null
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/PinsDynamicRoutingGatewayFilterFactory.java-134-        || tenantMapping.getConfiguration() == null
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:1:package com.sap.bpi.api.gw.security.jwt.insights_central;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.AuthorizationManagerUtils.constructXsuaaUrlFromAppRoute;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.WELL_KNOWN_PATH;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-6-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:7:import com.sap.bpi.api.gw.dto.SapJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-8-import com.sap.bpi.api.gw.dto.WellKnownConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-9-import com.sap.bpi.api.gw.dto.tenant.insights.InsightsCentralConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-10-import com.sap.bpi.api.gw.dto.tenant.insights.InsightsCentralTenantConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:11:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:12:import com.sap.bpi.api.gw.filters.utils.JwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:13:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:14:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-15-import com.sap.bpi.api.gw.services.SpmTenantConfigurationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-16-import io.jsonwebtoken.Claims;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-20-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-21-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:22:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:23:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:24:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:25:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:26:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-27-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-28-import reactor.core.publisher.Mono;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-32-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:33: * In order to verify the content of the XSUAA JWT, we need to get the public key first. Even though
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:34: * the link to the key is provided in the jku claim of the JWT, it is unsafe to use it directly.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-35- * Instead, we should fetch the jwks_uri from the issuer's well-known configuration endpoint and use
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:36: * it to get the public key. In order to get the well-known configuration, we need to get the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-37- * authentication url from the tenant configuration which is stored at SPM along with the client ID,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:38: * that is used to verify the audience of the JWT.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-39- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:40:@Service("insightsCentralXsuaaJwtVerifier")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:41:public class InsightsCentralXsuaaJwtVerifier implements JwtVerifierStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:42:  public static final String INSIGHTS_CENTRAL_APP_ROUTER_NAME = "process-insights";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:43:  public static final String OAUTH_TOKEN_SUFFIX = "/oauth/token";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:45:  private final Logger logger = LoggerFactory.getLogger(InsightsCentralXsuaaJwtVerifier.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:46:  private final SpmTenantConfigurationService spmTenantConfigurationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:47:  private final JwtVerifierUtils jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:48:  private final ObjectMapper objectMapper = new ObjectMapper();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-50-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:51:  public InsightsCentralXsuaaJwtVerifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-52-      SpmTenantConfigurationService spmTenantConfigurationService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:53:      JwtVerifierUtils jwtVerifierUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-54-    this.spmTenantConfigurationService = spmTenantConfigurationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:55:    this.jwtVerifierUtils = jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-56-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-58-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:59:   * Gets the well-know OpenID configuration (issuer and a jwks_uri) Checks if the JWT valid by
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:60:   * verifying the signature with the public key, and checking the issuer, audience, and Signavio
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-61-   * tenant ID. Expiry date is checked by the {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:62:   * io.jsonwebtoken.impl.DefaultJwtParser#parse(Reader)} method.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-63-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-64-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:65:  public Mono<Tuple2<AuthorizationDecision, String>> isJwtValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:66:      String token, JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-67-    AuthorizationDecision notGranted = new AuthorizationDecision(false);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:68:    Tuple2<AuthorizationDecision, String> notGrantedAuthDecisionTuple = Tuples.of(notGranted, "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-69-    // get tenant mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:70:    String signavioTenantId = jwtValidationContext.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-71-    Mono<List<InsightsCentralConfigurationDto>> tenantConfigurationMono =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-72-        spmTenantConfigurationService.getInsightsCentralTenantConfiguration(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:73:            signavioTenantId, jwtValidationContext.getRequestId());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:74:    // get JWT issuer without public key validation, will be later checked when the public key is
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-75-    // fetched with XSUAA URL
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:76:    Optional<String> jwtIssuer = getXsuaaJwtIssuer(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:78:    // if the JWT issuer is not present, respond with 401
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:79:    if (jwtIssuer.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:80:      logger.error("JWT issuer is not present in XSUAA JWT");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-81-      return Mono.just(notGrantedAuthDecisionTuple);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-82-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:83:    Mono<String> xsuaaUrl = getXsuaaUrl(tenantConfigurationMono, jwtIssuer.get());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-85-    // validate token
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-87-        .zipWhen(this::getTokenConfiguration, Tuples::of)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-88-        .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:89:            tuple -> jwtVerifierUtils.fetchPublicKey(tuple.getT2()),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:90:            (tuple, publicKey) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-91-              try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:92:                WellKnownConfigurationDto jwtConfiguration = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:94:                Claims claims = jwtVerifierUtils.getClaims(publicKey, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-95-                //                 Check issuer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:96:                String actualIssuer = claims.getIssuer();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:97:                if (!jwtConfiguration.getIssuer().equals(actualIssuer)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-98-                  logger.error("Token issuer \"{}\" is not valid", actualIssuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-99-                  return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-100-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:101:                return Tuples.of(new AuthorizationDecision(true), signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-102-              } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-103-                logger.error("Failed to validate the token:", e);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-108-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-109-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:110:  private Optional<String> getXsuaaJwtIssuer(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:111:    SapJwtDto xsuaaJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-112-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:113:      String payload = JwtUtils.decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:114:      xsuaaJwtDto = objectMapper.readValue(payload, SapJwtDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-115-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:116:      logger.error("Failed to deserialize XSUAA JWT", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-117-      return Optional.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-118-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:119:    return Optional.of(xsuaaJwtDto.issuer());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-120-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-121-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:122:  private Mono<WellKnownConfigurationDto> getTokenConfiguration(String xsuaaUrl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:123:    String wellKnownConfigurationUrl = xsuaaUrl + WELL_KNOWN_PATH;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:124:    return jwtVerifierUtils.getTokenConfiguration(wellKnownConfigurationUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-125-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:127:  public Mono<String> getXsuaaUrl(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:128:      Mono<List<InsightsCentralConfigurationDto>> tenantConfigurationMono, String jwtIssuer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-129-    return tenantConfigurationMono
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-130-        .flatMapMany(Flux::fromIterable)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:131:        .filter(spmConfig -> spmConfig.href().contains("tenant_signavio_to_insights_mapping"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-132-        .switchIfEmpty(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-133-            Mono.defer(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-143-        .map(InsightsCentralTenantConfigurationDto::value)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-144-        .flatMapMany(Flux::fromIterable)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:145:        // Construct XsuaaUrl and compare with the iss host in the JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-146-        .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-147-            value -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:148:              // find the correct URL by comparing the issuer in the JWT with the XSUAA URL
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-149-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:150:              // construct for each route value the xsuaa URL with JWT issuer matching for cloud.sap
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-151-              // routes
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-152-              // append /oauth/token to the xsuaa URL
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:153:              // compare it with the JWT issuer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:154:              String xsuaaOauthTokenUrl =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-155-                  constructXsuaaUrlFromAppRoute(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:156:                          value.route(), INSIGHTS_CENTRAL_APP_ROUTER_NAME, jwtIssuer)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-157-                      + OAUTH_TOKEN_SUFFIX;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:158:              return xsuaaOauthTokenUrl.equals(jwtIssuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-159-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-160-        .switchIfEmpty(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-162-                () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-163-                  logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:164:                      "No matching JWT issuer found with Insights Central tenant configuration");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-165-                  return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-166-                      new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:167:                          HttpStatus.UNAUTHORIZED, "Token issuer " + jwtIssuer + " not valid"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-168-                }))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-169-        .next()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-171-            value ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-172-                constructXsuaaUrlFromAppRoute(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java:173:                    value.route(), INSIGHTS_CENTRAL_APP_ROUTER_NAME, jwtIssuer));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-174-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralXsuaaJwtVerifier.java-175-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-3-import com.sap.bpi.api.gw.global.AuditLogClientLocalFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:4:import com.signavio.als.AuditLogClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:5:import com.signavio.als.ClientCredentials;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-6-import java.nio.charset.StandardCharsets;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-7-import java.util.Base64;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-8-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-9-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:10:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:11:import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:12:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:13:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-15-/*
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-22-  @Value("${logging.audit.clientCertificate}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:23:  private String clientCertificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:25:  @Value("${logging.audit.clientCertificateKey}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:26:  private String clientCertificateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:28:  private static final Logger LOGGER = LoggerFactory.getLogger(AuditLogClientConfiguration.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-30-  /* For ALL environments minus dev, it returns ALS API client library factory from "als-logging" */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-48-  public ClientCredentials getClientCredentials() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-49-    return new ClientCredentials(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:50:        decodeBase64Certificate(clientCertificateKey), decodeBase64Certificate(clientCertificate));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-51-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:53:  public static String decodeBase64Certificate(String base64EncodedCertificate) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:54:    String decodedCertificate = "";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-55-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-56-      byte[] decodedBytesCertificate =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-57-          Base64.getDecoder().decode(base64EncodedCertificate.replaceAll("\\s+", ""));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java:58:      decodedCertificate = new String(decodedBytesCertificate, StandardCharsets.UTF_8);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/AuditLogClientConfiguration.java-60-    } catch (Exception e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-3-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:4:import org.springframework.beans.factory.ObjectProvider;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:5:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:6:import org.springframework.cloud.gateway.config.HttpClientProperties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:7:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:8:import org.springframework.cloud.gateway.filter.NettyRoutingFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:9:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:10:import org.springframework.cloud.gateway.filter.headers.HttpHeadersFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:11:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-12-import reactor.netty.http.client.HttpClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-14-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-15- * Standard routing filter factory for routes that use dynamic URI routing (like no://op). This
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:16: * filter uses the default shared HttpClient for routing, unlike MtlsOnlyRoutingFilter which
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:17: * requires a custom mTLS HttpClient.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-18- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-19- * <p>Use this filter when:
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-22- *   <li>The route uses no://op as a placeholder URI
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-23- *   <li>A preceding filter sets GATEWAY_REQUEST_URL_ATTR with the actual target URL
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:24: *   <li>mTLS is not required (use MtlsOnlyRoutingFilter for mTLS)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-25- * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-26- */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-29-    extends AbstractGatewayFilterFactory<StandardRoutingGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:31:  private final HttpClient httpClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:32:  private final ObjectProvider<List<HttpHeadersFilter>> headersFiltersProvider;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java:33:  private final HttpClientProperties properties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/StandardRoutingGatewayFilterFactory.java-35-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:3:import static com.sap.bpi.api.gw.filters.SpmTokenToSpmJwtFilterFactory.X_FORWARDED_FOR;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-4-import static com.sap.bpi.api.gw.filters.utils.SpmRequestResponseFilterUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-6-import com.sap.bpi.api.gw.caching.GenericRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:7:import com.sap.bpi.api.gw.caching.RedisKeyUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-8-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-9-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:10:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-11-import com.sap.bpi.api.gw.services.SpmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-12-import java.time.Duration;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-16-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-17-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:18:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:19:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:20:import org.springframework.cloud.gateway.filter.factory.rewrite.RewriteFunction;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:21:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:22:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:23:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:24:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:25:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-26-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-27-import reactor.util.function.Tuple2;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-32-public class TokenResponseRewriteFunction {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:34:  private final Logger logger = LoggerFactory.getLogger(TokenResponseRewriteFunction.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:35:  private final UgwJwtConfig jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:36:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:37:  private final GenericRedisService<SpmUser> spmUserRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-39-  @Value("${server.base-url}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:40:  private String baseUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-42-  @Value("${redis.enabled}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:43:  private boolean isRedisEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-45-  @Value("${redis.spmCacheTimeoutMinutes}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:46:  private Integer spmCacheTimeoutMinutes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-48-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-49-  public TokenResponseRewriteFunction(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:50:      UgwJwtConfig jwtConfig,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-51-      SpmService spmService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-52-      @Autowired(required = false) GenericRedisService<SpmUser> spmUserRedisService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:53:    this.jwtConfig = jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-54-    this.spmService = spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-55-    this.spmUserRedisService = spmUserRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-56-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:58:  public RewriteFunction<String, String> apply() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-59-    return (exchange, responseValue) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-60-      if (exchange.getResponse().getStatusCode().isError()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-64-        return validateHeaders(exchange)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-65-            .zipWhen(this::getUserDetails)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:66:            .flatMap(headersAndUser -> replaceTokenWithJwt(exchange, headersAndUser))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-67-            .switchIfEmpty(Mono.justOrEmpty(responseValue))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-68-            .doOnError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-69-                error ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-70-                    logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:71:                        "Error while replacing response token with UGW JWT: "
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-72-                            + error.getMessage()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-73-      }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-78-  // If the user details are not found in the cache, it fetches the user details from SPM and saves
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-79-  // them in the cache.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:80:  private Mono<SpmUser> getUserDetails(Tuple3<String, String, String> tuple) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:81:    String xSignavioId = tuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:82:    String jSessionId = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:83:    String clientIp = tuple.getT3();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-84-    var featureSet = Set.of(FeatureApplication.PLATFORM);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-85-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-88-        isRedisEnabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-89-            ? spmUserRedisService.get(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:90:                RedisKeyUtils.createSpmUserKey(xSignavioId, jSessionId, clientIp, featureSet))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-91-            : Mono.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-92-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-94-        spmService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-95-            .getUserDetailsFromSpmWithTokenAndJSessionId(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:96:                xSignavioId, jSessionId, clientIp, featureSet)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-97-            .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-98-                user -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-99-                  // Save to Redis if enabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-100-                  if (isRedisEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:101:                    String redisKey =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:102:                        RedisKeyUtils.createSpmUserKey(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:103:                            xSignavioId, jSessionId, clientIp, featureSet);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-104-                    return spmUserRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:105:                        .set(redisKey, user, Duration.ofMinutes(spmCacheTimeoutMinutes))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-106-                        .thenReturn(user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-107-                  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-110-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-111-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:112:  private Mono<String> replaceTokenWithJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:113:      ServerWebExchange exchange, Tuple2<Tuple3<String, String, String>, SpmUser> headersAndUser) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-114-    HttpHeaders headers = exchange.getResponse().getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:115:    List<String> setCookieValues = headers.get(SET_COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:116:    String xSignavioId = headersAndUser.getT1().getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:117:    SpmUser user = headersAndUser.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-118-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:119:    String jwt = generateJwt(user, xSignavioId, jwtConfig, baseUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:120:    addJwtToHeader(headers, setCookieValues, jwt, logger);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:121:    return Mono.just(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-122-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-123-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:124:  public Mono<Tuple3<String, String, String>> validateHeaders(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-125-    HttpHeaders httpHeaders = exchange.getResponse().getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-126-    if (isHeaderNullOrEmpty(httpHeaders, TOKEN_HEADER)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-132-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-133-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:134:    List<String> setCookieValues = httpHeaders.get(SET_COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:135:    Optional<String> xSignavioId = getToken(setCookieValues);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:136:    if (xSignavioId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-137-      return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-138-          new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-139-              HttpStatus.UNAUTHORIZED, "Missing token in set-cookie headers"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-140-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:141:    Optional<String> jSessionId = getJSessionId(setCookieValues);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-142-    if (jSessionId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-143-      return Mono.error(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-146-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-147-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:148:    List<String> xForwardedForHeader = exchange.getRequest().getHeaders().get(X_FORWARDED_FOR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-149-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-150-    if (xForwardedForHeader == null || xForwardedForHeader.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-155-    return Mono.just(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-156-        Tuples.of(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:157:            xSignavioId.get(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-158-            jSessionId.get(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-159-            getClientIpFromXForwardedForHeader(xForwardedForHeader)));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-160-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-161-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:162:  private boolean isHeaderNullOrEmpty(HttpHeaders headers, String headerName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:163:    List<String> headerValues = headers.get(headerName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-164-    return headerValues == null || headerValues.isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-165-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-166-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java:167:  private String getClientIpFromXForwardedForHeader(List<String> xForwardedForHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-168-    return xForwardedForHeader.get(0).split(",")[0];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/TokenResponseRewriteFunction.java-169-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java-8- * <pre>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java-9- * {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java:10: *   "name": "e06e903a51a64e09bf7e7112d77fced1.pem",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java:11: *   "content": "LS0tLS1CRUdJTi..."
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java-12- * }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java-13- * </pre>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java-14- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java:15: * @param name the name of the certificate (e.g., "tenantId.pem")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java-16- * @param content the base64-encoded full certificate chain
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java-17- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CertificateChainDto.java:18:public record CertificateChainDto(String name, String content) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-3-import com.sap.bpi.api.gw.dto.SpgUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-4-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:5:import com.signavio.jwt.Token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-6-import java.util.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-7-import java.util.stream.Collectors;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-9-public class JsonWebToken implements Token {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:10:  public static final String SPM_SYSTEM_USER = "system";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:12:  private final String email;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:13:  private final String tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:14:  private final String userId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:15:  private Boolean isAdminUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:16:  private Set<String> userGroupIds;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:17:  private Set<String> features;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:18:  private List<String> licenses;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:19:  private final String requestId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:20:  private Boolean isInternal;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:21:  private Map<String, String> oauthClaims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:23:  public JsonWebToken(String tenantId, String email, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-24-    this(tenantId, email, null, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-25-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:27:  public JsonWebToken(String tenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-28-    this(tenantId, SPM_SYSTEM_USER, null, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-29-    this.isInternal = true;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-30-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:32:  public JsonWebToken(String tenantId, String email, String userId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-33-    this.email = email;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-34-    this.tenantId = tenantId;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-37-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:39:  public JsonWebToken(SpmUser user, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-40-    this(user.tenantId(), user.email(), user.id(), requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-41-    addUserGroupsLicencesFeatures(user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-42-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:44:  public JsonWebToken(SpgUser user, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-45-    // can't use user.id(), because SPG's id is not the same as SPM's id
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-46-    this(user.tenantId(), user.email(), requestId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-48-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:50:  public JsonWebToken enrichJwtWithSpmUserDetails(SpmUser user) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-51-    addUserGroupsLicencesFeatures(user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-52-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-53-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:55:  private void addUserGroupsLicencesFeatures(SpmUser user) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-56-    this.isAdminUser = user.isAdmin();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-57-    if (user.groupIds() != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:58:      this.userGroupIds = new HashSet<>(user.groupIds());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-59-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-60-    this.features = flattenFeaturesOfAppsToFeaturesSet(user.featuresOfApps());
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:64:  private Set<String> flattenFeaturesOfAppsToFeaturesSet(Map<String, Set<String>> featuresOfApps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-65-    return Optional.ofNullable(featuresOfApps)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-66-        .map(Map::values)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-81-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-82-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:83:  public JsonWebToken withOauthClaims(Map<String, String> oauthClaims) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:84:    this.oauthClaims = oauthClaims != null ? new HashMap<>(oauthClaims) : Collections.emptyMap();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-85-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-86-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-88-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:89:  public String getSubject() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-90-    return email;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-91-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-92-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-93-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:94:  public String getTenantId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-95-    return tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-96-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-108-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:109:  public Optional<String> getExternalUserId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-110-    return Optional.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-111-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-113-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:114:  public Optional<String> getUserId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-115-    return Optional.ofNullable(userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-116-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-118-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:119:  public Set<String> getUserGroupIds() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-120-    return userGroupIds != null ? userGroupIds : Collections.emptySet();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-121-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-122-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-123-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:124:  public Set<String> getExternalUserGroupIds() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-125-    return Collections.emptySet();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-126-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-127-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-128-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:129:  public Optional<String> getRequestId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-130-    return Optional.ofNullable(requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-131-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-132-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-133-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:134:  public Set<String> getOauthScopes() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-135-    return Collections.emptySet();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-136-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-137-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-138-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:139:  public Map<String, String> getOauthClaims() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:140:    return oauthClaims != null ? new HashMap<>(oauthClaims) : Collections.emptyMap();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-141-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-142-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-147-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-148-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:149:  public Set<String> getFeatures() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-150-    return features != null ? features : Collections.emptySet();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-151-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-152-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java:153:  public List<String> getLicenses() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-154-    return licenses != null ? licenses : Collections.emptyList();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/JsonWebToken.java-155-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.X_SIGNAVIO_TENANT_ID_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:4:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getRequestIdFromHeaderOrGenerate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-5-import static com.sap.bpi.api.gw.filters.utils.FilterUtils.hasAuthorizationHeader;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-6-import static com.sap.bpi.api.gw.services.SpmService.AUTHORIZATION_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-8-import com.sap.bpi.api.gw.caching.GenericRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:9:import com.sap.bpi.api.gw.caching.RedisKeyUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:10:import com.sap.bpi.api.gw.dto.destinationService.DestinationServiceCertificateDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-11-import com.sap.bpi.api.gw.dto.tenant.ias.IasCredentialDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-12-import com.sap.bpi.api.gw.dto.tenant.pam.TenantServicePamTypeResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-13-import com.sap.bpi.api.gw.dto.tenant.pam.XsuaaCredentialDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:14:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:15:import com.sap.bpi.api.gw.security.certificate.utils.DestinationServiceCertificateParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-16-import com.sap.bpi.api.gw.services.BtpService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:17:import com.sap.bpi.api.gw.services.DestinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-18-import com.sap.bpi.api.gw.services.PamTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:19:import com.signavio.jwt.Token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:20:import java.security.PrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-21-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-22-import java.time.Duration;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-28-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-29-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:30:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:31:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:32:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:33:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:34:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:35:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:36:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:37:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-38-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-39-import reactor.util.function.Tuple3;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-42-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:43:public class SamlSessionToXsuaaJwtGatewayFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:44:    extends AbstractGatewayFilterFactory<SamlSessionToXsuaaJwtGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:46:  private static final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:47:      LoggerFactory.getLogger(SamlSessionToXsuaaJwtGatewayFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:49:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:50:  private final PamTenantService pamTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:51:  private final BtpService btpService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:52:  private final DestinationService destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:53:  private final GenericRedisService<String> stringRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-54-  // Code reference for claim value
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:55:  // https://github.com/signavio/cross-product-integration-poc/blob/main/packages/spm-app/approuter.js#L50-L53
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:56:  public static final String SAML_SESSION_ID_CLAIM = "ssi";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:57:  private static final int JWT_TTL_DEFAULT_IN_MINUTES = 5;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-59-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:60:  public SamlSessionToXsuaaJwtGatewayFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:61:      JwtUtils jwtUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-62-      PamTenantService pamTenantService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-63-      BtpService btpService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:64:      DestinationService destinationService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:65:      @Autowired(required = false) GenericRedisService<String> stringRedisService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:66:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-67-    this.pamTenantService = pamTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-68-    this.btpService = btpService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:69:    this.destinationService = destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:70:    this.stringRedisService = stringRedisService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-71-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-72-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-74-  public GatewayFilter apply(Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-75-    return (exchange, chain) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:76:      // Read SAML Session ID from SPM JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-78-      ServerHttpRequest request = exchange.getRequest();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-81-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-82-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:83:      String tenantId = getTenantIdFromRequest(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:84:      String samlSessionIndex = getSamlSessionIndexFromHeader(jwtUtils, request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:85:      String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-87-      // Set the tenant ID attribute for subsequent filters
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:88:      exchange.getAttributes().put(X_SIGNAVIO_TENANT_ID_ATTRIBUTE, tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-89-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:90:      // First try to get cached XSUAA JWT if Redis is enabled
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:91:      Mono<String> cachedJwtMono =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:92:          (stringRedisService != null)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:93:              ? stringRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:94:                  .get(RedisKeyUtils.createXsuaaJwtKey(samlSessionIndex))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:95:                  .filter(this::isJwtValidWithMargin)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-96-              : Mono.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:98:      return cachedJwtMono
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-99-          .hasElement()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-100-          .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-101-              hasCache -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-102-                if (hasCache) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:103:                  // Use cached JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:104:                  return cachedJwtMono.flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:105:                      cachedXsuaaJwt -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-106-                        ServerHttpRequest mutatedRequest =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-107-                            request
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-108-                                .mutate()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:109:                                .header(HttpHeaders.AUTHORIZATION, "Bearer " + cachedXsuaaJwt)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-110-                                .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-111-                        return chain.filter(exchange.mutate().request(mutatedRequest).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-112-                      });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-113-                } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:114:                  // If no cached JWT, get tenant mapping, destination certificate, and fetch new
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:115:                  // JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-116-                  return pamTenantService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-117-                      .getTenantMapping(tenantId, requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-118-                      .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-119-                          tenantServiceResponse ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:120:                              destinationService.getCertificateWithAccessToken(tenantId),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-121-                          Tuples::of)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-122-                      .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-123-                          tuple ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:124:                              getIasJwt(tuple.getT1(), tuple.getT2(), samlSessionIndex, tenantId),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:125:                          (tuple, iasJwt) -> Tuples.of(tuple.getT1(), tuple.getT2(), iasJwt))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:126:                      .zipWhen(tuple -> getXsuaaJwt(tuple))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-127-                      .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-128-                          tuple -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:129:                            String xsuaaJwt = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-130-                            ServerHttpRequest mutatedRequest =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-131-                                request
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-132-                                    .mutate()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:133:                                    .header(HttpHeaders.AUTHORIZATION, "Bearer " + xsuaaJwt)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-134-                                    .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-135-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:136:                            // Cache the JWT if Redis is enabled (non-blocking)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:137:                            if (stringRedisService != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:138:                              String redisKey = RedisKeyUtils.createXsuaaJwtKey(samlSessionIndex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:139:                              Duration ttl = calculateJwtTtl(xsuaaJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:140:                              stringRedisService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:141:                                  .set(redisKey, xsuaaJwt, ttl)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-142-                                  .doOnError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-143-                                      error ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-144-                                          logger.warn(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:145:                                              "Failed to cache XSUAA JWT for session {}: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-146-                                              samlSessionIndex,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-147-                                              error.getMessage()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-156-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-157-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:158:  private Mono<String> getIasJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-159-      TenantServicePamTypeResponse tenantServiceResponse,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:160:      DestinationServiceCertificateDto certificateDto,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:161:      String samlSessionIndex,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:162:      String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-163-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-164-      IasCredentialDto iasCredentialDto =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-165-          tenantServiceResponse.getConfiguration().credentials().ias();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:166:      String iasClientId = iasCredentialDto.clientId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:167:      String iasUrl = iasCredentialDto.tenantUrl();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-168-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:169:      // Decode and extract private key and certificate chain from Destination Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:170:      String pemContent = new String(Base64.getDecoder().decode(certificateDto.content()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:171:      PrivateKey privateKey =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:172:          DestinationServiceCertificateParser.extractPrivateKeyPkcs8(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-173-      List<X509Certificate> certificates =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:174:          DestinationServiceCertificateParser.extractCertificates(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-175-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:176:      return btpService.getIasJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:177:          iasUrl, iasClientId, certificates, privateKey, samlSessionIndex, tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-178-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:179:      logger.error("Failed to extract certificates for IAS JWT", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-180-      return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-181-          new RuntimeException("Failed to process certificates for IAS authentication", e));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-183-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-184-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:185:  private Mono<String> getXsuaaJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:186:      Tuple3<TenantServicePamTypeResponse, DestinationServiceCertificateDto, String> tuple) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-187-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:188:      String iasJwt = tuple.getT3();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-189-      TenantServicePamTypeResponse tenantServiceResponse = tuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:190:      DestinationServiceCertificateDto certificateDto = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-191-      XsuaaCredentialDto xsuaaCredentialDto =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-192-          tenantServiceResponse.getConfiguration().credentials().xsuaa();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:193:      String xsuaaClientId = xsuaaCredentialDto.clientId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:194:      String xsuaaUrl = xsuaaCredentialDto.tokenEndpoint();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-195-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:196:      // Decode and extract private key and certificate chain from Destination Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:197:      String pemContent = new String(Base64.getDecoder().decode(certificateDto.content()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:198:      PrivateKey privateKey =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:199:          DestinationServiceCertificateParser.extractPrivateKeyPkcs8(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-200-      List<X509Certificate> certificates =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:201:          DestinationServiceCertificateParser.extractCertificates(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-202-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:203:      return btpService.getXsuaaJwt(xsuaaUrl, xsuaaClientId, certificates, privateKey, iasJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-204-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:205:      logger.error("Failed to extract certificates for XSUAA JWT", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-206-      return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-207-          new RuntimeException("Failed to process certificates for XSUAA authentication", e));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-209-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-210-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:211:  public static String getSamlSessionIndexFromHeader(JwtUtils jwtUtils, ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:212:    List<String> authorizationHeader = request.getHeaders().get(AUTHORIZATION_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:213:    String authorizationHeaderValue =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-214-        (authorizationHeader != null) ? authorizationHeader.get(0) : null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:215:    Optional<Map<String, String>> oauthClaimsOptional = Optional.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-216-    if (authorizationHeaderValue != null)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-217-      oauthClaimsOptional =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:218:          jwtUtils.getAndValidateSpmJwt(authorizationHeaderValue).map(Token::getOauthClaims);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-219-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-220-    if (oauthClaimsOptional.isPresent() && isSamlSessionIndexInOauthClaim(oauthClaimsOptional)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:221:      throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, "Missing SAML session ID in JWT");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-222-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-223-    return oauthClaimsOptional
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:224:        .map(stringStringMap -> stringStringMap.get(SAML_SESSION_ID_CLAIM))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-225-        .orElse(null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-226-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-227-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:228:  private static boolean isSamlSessionIndexInOauthClaim(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:229:      Optional<Map<String, String>> oauthClaimsOptional) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-230-    return oauthClaimsOptional.isEmpty()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-231-        || oauthClaimsOptional.get().isEmpty()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-233-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-234-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:235:  private String getTenantIdFromRequest(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:236:    List<String> authorizationHeader = request.getHeaders().get(AUTHORIZATION_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-237-    if (authorizationHeader == null || authorizationHeader.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-238-      throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, "Missing Authorization header");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-239-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:240:    return jwtUtils
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:241:        .getAndValidateSpmJwt(authorizationHeader.get(0))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-242-        .map(Token::getTenantId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-243-        .orElseThrow(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:244:            () -> new ResponseStatusException(HttpStatus.UNAUTHORIZED, "Missing tenant ID in JWT"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-245-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-246-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-247-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:248:   * Check if JWT is valid with a safety margin. Migrated from
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:249:   * XsuaaJwtRedisService.isJwtValidWithMargin()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-250-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:251:  private boolean isJwtValidWithMargin(String jwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-252-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:253:      Instant expiryTime = jwtUtils.getJwtExpiryTime(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:254:      // Check if JWT expires within the next minute (safety margin)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-255-      return Instant.now().plusSeconds(60).isBefore(expiryTime);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-256-    } catch (IllegalArgumentException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:257:      logger.debug("JWT validation failed: {}", e.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-258-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-259-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-261-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-262-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:263:   * Calculate JWT TTL based on expiry time. Migrated from XsuaaJwtRedisService.calculateJwtTtl()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-264-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:265:  private Duration calculateJwtTtl(String jwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-266-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:267:      Instant expiryTime = jwtUtils.getJwtExpiryTime(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-268-      return Duration.between(Instant.now(), expiryTime);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-269-    } catch (IllegalArgumentException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:270:      logger.warn("Failed to parse JWT expiry, using fallback TTL: {}", e.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java:271:      return Duration.ofMinutes(JWT_TTL_DEFAULT_IN_MINUTES);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-272-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SamlSessionToXsuaaJwtGatewayFilterFactory.java-273-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:1:package com.sap.bpi.api.gw.jwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-3-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:4: * Enum representing the target JWT format for route conversion.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-5- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:6: * <p>This enum defines the supported JWT types that can be produced by the gateway's conversion
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:7: * filters. Currently, all backends consume SPM JWT, but this design allows for future extensibility
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:8: * to support other JWT formats.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-9- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:10:public enum JwtTargetType {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:11:  /** SPM JWT format - Standard internal format used by SAP Signavio backends. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:12:  SPM_JWT("spm-jwt");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:14:  private final String type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:16:  JwtTargetType(String type) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-17-    this.type = type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-18-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-20-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:21:   * Returns the string representation of the JWT target type.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-22-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:23:   * @return The type identifier (e.g., "spm-jwt")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-24-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:25:  public String getType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-26-    return type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-27-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-29-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java:30:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-31-    return type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/jwt/JwtTargetType.java-32-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-1-package com.sap.bpi.api.gw.global;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java:3:import com.signavio.als.AuditLogBasicClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java:4:import com.signavio.als.AuditLogErrorHandlingClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java:5:import com.signavio.als.event.AuditLogEvent;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-6-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-7-import org.slf4j.LoggerFactory;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-9-public class AuditLogErrorHandlingLocalClient extends AuditLogErrorHandlingClient {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java:11:  private final Logger logger = LoggerFactory.getLogger(AuditLogErrorHandlingLocalClient.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogErrorHandlingLocalClient.java-13-  public AuditLogErrorHandlingLocalClient(AuditLogBasicClient delegate) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-1-package com.sap.bpi.api.gw.filters.utils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:3:import static com.sap.bpi.api.gw.filters.SpmTokenToSpmJwtFilterFactory.X_FORWARDED_FOR;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-4-import static com.sap.bpi.api.gw.filters.utils.SpmRequestResponseFilterUtils.X_FORWARDED_FOR_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-5-import static com.sap.bpi.api.gw.services.SpmService.*;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:11:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:12:import org.springframework.http.HttpMethod;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:13:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:14:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:15:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:16:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-18-import reactor.util.function.Tuple3;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-21-public final class FilterUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:22:  private static final String REQUEST_ID_HEADER = "Request-Id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:23:  private static final Logger logger = LoggerFactory.getLogger(FilterUtils.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:24:  public static final String X_SIGNAVIO_TENANT_ID_ATTRIBUTE = "x-signavio-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:25:  public static final String X_SIGNAVIO_TENANT_ID_HEADER = "x-signavio-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:26:  public static final String SAP_SIGNAVIO_RATE_LIMIT_ATTRIBUTE_HEADER =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:27:      "sap-signavio-rate-limit-attribute";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:28:  public static final String SAP_SIGNAVIO_ORIGINAL_PATH_HEADER = "sap-signavio-original-path";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:29:  public static final String X_CONNECTIVITY_PLATFORM_TENANT_ID_HEADER =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:30:      "x-connectivity-platform-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:31:  public static final String X_SIGNAVIO_USER_ID_ATTRIBUTE = "x-signavio-user-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:32:  public static final String SAP_SIGNAVIO_INGESTION_ENTITY_ID_HEADER =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:33:      "sap-signavio-ingestion-entity-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:34:  public static final String SAP_SIGNAVIO_TENANT_ID_HEADER = "sap-signavio-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:36:  // private constructor to avoid unnecessary instantiation of the class
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:37:  private FilterUtils() {}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:39:  public static String[] splitFeatureSetsString(Set<FeatureApplication> featureSets) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:40:    return featureSets.stream().map(Enum::toString).toArray(String[]::new);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:43:  public static String getRequestIdFromHeaderOrGenerate(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:44:    String requestId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:45:    if (request.getHeaders().containsKey((REQUEST_ID_HEADER))) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-46-      requestId = request.getHeaders().getFirst(REQUEST_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-47-      logger.debug("Request ID {} found in the header", requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-48-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:49:      requestId = UUID.randomUUID().toString().replace("-", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:50:      logger.debug("Request ID {} was generated by API Gateway", requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-51-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-52-    return requestId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-53-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:55:  public static String getSignavioTenantIdFromExchange(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:56:    return exchange.getAttribute(X_SIGNAVIO_TENANT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-59-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:60:   * Validates if required authentication headers are present in the given {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-61-   * ServerHttpRequest}.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-62-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:63:   * <p>The method checks for the presence of the {@code x-signavio-id}, {@code cookie}, and {@code
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-64-   * x-forwarded-for} headers.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-65-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-66-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:67:   *   <li>For non-GET requests, both {@code x-signavio-id} and {@code cookie} headers must be
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-68-   *       present.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-69-   *   <li>For GET requests, only the {@code cookie} header is required.
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-81-   *     ResponseStatusException}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-82-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:83:  public static Mono<Tuple3<String, String, String>> getAuthenticationHeadersTuple3Mono(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-84-      HttpHeaders headers, HttpMethod method) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:85:    List<String> tokenHeader = headers.get(X_SIGNAVIO_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:86:    List<String> cookieHeader = headers.get(COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:87:    List<String> xForwardedForHeader = headers.get(X_FORWARDED_FOR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-88-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-89-    boolean isTokenHeaderPresent = isHeaderPresent(tokenHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-90-    boolean isCookieHeaderPresent = isHeaderPresent(cookieHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:91:    boolean isGetRequest = "GET".equalsIgnoreCase(method.name());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-92-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-93-    if (!areRequiredHeadersPresent(isTokenHeaderPresent, isCookieHeaderPresent, isGetRequest)) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-95-          new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-96-              HttpStatus.UNAUTHORIZED,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:97:              "Missing required authentication headers: x-signavio-id and/or cookie"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-98-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-99-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-103-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-104-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:105:    String token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-106-    if (isTokenHeaderPresent) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-107-      token = tokenHeader.get(0);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-119-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-120-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:121:  public static String transformConnectivityPlatformUrl(String inputUrl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-122-    // Regex and replacement pattern is defined by client convention, more details at
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-123-    // https://jira.tools.sap/browse/SIGAPIGW-1345
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-124-    // Define the regular expression pattern to capture the necessary parts of the URL
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:125:    String regex = "https://[^.]+\\.jupiter\\.(.+)";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-127-    // Define the replacement pattern
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:128:    String replacement = "https://heimdall.mtls.$1/sigc";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-129-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-130-    // Use replaceAll to perform the transformation based on regex
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-137-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-138-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:139:  public static boolean isHeaderPresent(List<String> header) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-140-    return header != null && !header.isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-141-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-142-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:143:  private static String getClientIpFromXForwardedForHeader(List<String> xForwardedForHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-144-    return xForwardedForHeader.get(0).split(",")[0];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-145-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-146-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:147:  private static String extractTokenFromCookie(String cookie) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-148-    if (cookie == null) return "";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-149-    return java.util.Arrays.stream(cookie.split(";"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:150:        .map(String::trim)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-151-        .filter(part -> part.startsWith("token="))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:152:        .map(part -> part.substring("token=".length()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-153-        .findFirst()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-154-        .orElse("");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-156-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-157-  public static boolean hasAuthorizationHeader(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:158:    List<String> authorizationHeader = request.getHeaders().get(AUTHORIZATION_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-159-    return authorizationHeader != null && !authorizationHeader.isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-160-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-161-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:162:  public static List<String> getSourceIpsFromLowerCaseHeadersMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:163:      Map<String, List<String>> lowerCaseHttpHeadersMap) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-164-    return getSourceIps(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-165-        Optional.ofNullable(lowerCaseHttpHeadersMap.get(X_FORWARDED_FOR_HEADER.toLowerCase())));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-166-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-167-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:168:  public static List<String> getSourceIpsFromHttpHeaders(HttpHeaders headers) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-169-    return getSourceIps(Optional.ofNullable(headers.get(X_FORWARDED_FOR_HEADER)));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-170-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-171-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:172:  private static List<String> getSourceIps(Optional<List<String>> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-173-    return sourceIps.orElse(List.of()).stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-174-        .flatMap(header -> Arrays.stream(header.split(",")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java:175:        .map(String::trim)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-176-        .toList();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/FilterUtils.java-177-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:3:import static com.sap.bpi.api.gw.filters.utils.JwtUtils.BEARER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:5:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-6-import com.sap.bpi.api.gw.services.LaunchDarklyService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-7-import java.util.List;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:12:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:13:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:14:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:15:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:16:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:17:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:18:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-19-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-21-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:22: * This filter extracts the tok claim from an incoming UgwJwt in the Authorization Header.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:23: * The filter uses the same enablement flag as the UgwJwtFilter.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-24- * If the filter is enabled and an incoming request contains an empty or malformed Authorization header with Bearer token,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-25- * a RuntimeException is thrown.
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-28-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:29:public class UgwJwtToPiDataCopyTokenFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:30:    extends AbstractGatewayFilterFactory<UgwJwtToPiDataCopyTokenFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-32-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:33:  public UgwJwtToPiDataCopyTokenFilterFactory(JwtUtils jwtUtils, LaunchDarklyService ldService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-34-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-35-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:36:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-37-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:38:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-39-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:40:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-41-    this.ldService = ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-42-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:44:  private final Logger logger = LoggerFactory.getLogger(UgwJwtToPiDataCopyTokenFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:46:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:47:  private final LaunchDarklyService ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-49-  @Override
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-58-                        .headers(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-59-                            httpHeaders -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:60:                              List<String> authHeader = httpHeaders.get(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-61-                              if (isAuthHeaderPresent(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:62:                                String headerValue = authHeader.get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-63-                                if (!isAuthHeaderFormatValid(headerValue))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-64-                                  throw new ResponseStatusException(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-66-                                      "Authentication credentials are not valid");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-67-                                else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:68:                                  String ugwJwt = headerValue.substring(BEARER.length() + 1);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:69:                                  // Extract 'tok' claim from ugwJwt and replace authorization
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-70-                                  // header with this claim as "Basic " + token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:71:                                  Optional<String> basicAuthToken =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:72:                                      jwtUtils.getTokenClaimValue(ugwJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-73-                                  httpHeaders.replace(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-74-                                      HttpHeaders.AUTHORIZATION,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-88-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-89-  /*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:90:   * Check if the given token is a valid Bearer token of the format: "Bearer <token>"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-91-   * */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:92:  private boolean isAuthHeaderFormatValid(String headerValue) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-93-    return headerValue != null && headerValue.startsWith("Bearer ");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-94-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-95-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:96:  private boolean isAuthHeaderPresent(List<String> authHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-97-    return authHeader != null && !authHeader.isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-98-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java:100:  private String getBasicAuthTokenValue(Optional<String> basicAuthToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-101-    if (basicAuthToken.isPresent()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UgwJwtToPiDataCopyTokenFilterFactory.java-102-      return basicAuthToken.get();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-5-import io.netty.channel.nio.NioIoHandler;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-6-import io.netty.channel.socket.nio.NioChannelOption;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:7:import io.netty.handler.ssl.SslContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-8-import java.time.Duration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-9-import java.util.function.Function;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-11-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-12-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:13:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:14:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:15:import org.springframework.cloud.gateway.config.HttpClientCustomizer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:16:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:17:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:18:import org.springframework.http.client.ReactorResourceFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:19:import org.springframework.http.client.reactive.ReactorClientHttpConnector;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:20:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-21-import reactor.netty.http.client.HttpClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-22-import reactor.netty.resources.ConnectionProvider;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-25- * Central configuration for WebClient instances used in the application.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-26- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:27: * Key Design Decisions:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-28- * - Single shared MultiThreadIoEventLoopGroup (event loop group, not thread pool) for all HTTP clients
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-29- * - Event loop group handles I/O events using non-blocking NIO (one thread per CPU core)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-33-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-34-public class WebClientConfiguration {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:35:  private static final Logger logger = LoggerFactory.getLogger(WebClientConfiguration.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:36:  private static final String SPM_CONNECTION_PROVIDER_NAME = "spm_client_connection_provider";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:37:  private static final String TENANT_SERVICE_CONNECTION_PROVIDER_NAME =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-38-      "generic_client_connection_provider";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:39:  private static final String DEFAULT_CONNECTION_PROVIDER_NAME =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-40-      "default_client_connection_provider";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:41:  private static final String MTLS_CONNECTION_PROVIDER_NAME = "mtls_client_connection_provider";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:42:  private static final int IDLE_TIMEOUT_MIN = 10;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:43:  private static final int SPM_IDLE_TIMEOUT_MIN = 10;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:44:  private static final int EVICT_IN_BACKGROUND_MIN = 5;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:45:  private static final int SPM_EVICT_IN_BACKGROUND_MIN = 5;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:46:  private static final int LIFETIME_MIN = 30;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:47:  private static final int AQUIRE_TIMEOUT_SEC = 45;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-49-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-50-   * Maximum number of connections in the connection pool for each WebClient. This value is set
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:51:   * based on the following calculation: the load is 50 000 requests per minute (834/sec) during
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-52-   * peak times, each request takes 200 ms to process, so we neeed 0.2 * 834 ~ 167 connections to
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-53-   * handle the load. To allow some margin, we set the max connections to 300. This value has
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-55-   * handle multiple connections.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-56-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:57:  private static final int MAX_CONNECTIONS =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-58-      300; // default is 2 * available number of processors (but with a minimum value of 16)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:60:  private static final int PENDING_ACQUIRE_CONNECTIONS_MAX_COUNT =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-61-      300; // default is 4 * number of CPUs
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:62:  private static final int TCP_KEEPIDLE_SEC = 350; // default is 2 hours
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-64-  @Value("${app.spmEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:65:  private String spmHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-67-  @Value("${app.tenantServiceEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:68:  private String tenantServiceHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-70-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-87-   * This is a web client for requests to SPM, such as /api/v2/me or /p/configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-88-   * This client is used by the graphql route which has a high load (>10k requests per minute),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:89:   * that's why we give it 80% of the available active connections.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-90-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-91-  @Bean("spmClient")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-101-   * This is a web client for various requests where spmClient is not used, such as to get the token configuration or
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-102-   * to call tenant service. These requests are not as frequent as the ones to SPM (<100 requests per minute),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:103:   * that's why we give it 10% of the available active connections.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-104-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-105-  @Bean("genericServiceClient")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-115-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-116-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:117:   * Customizes the Spring Cloud Gateway's HttpClient to use the shared event loop group and apply
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:118:   * TCP keepalive settings. This is critical for memory efficiency - without this, the gateway
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-119-   * would create its own separate event loop group, leading to duplicate direct buffer allocations.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-120-   *
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-130-   * component that silently drops the idle connections without sending a response. From the Reactor
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-131-   * Netty point of view, in this use case, the remote peer just does not respond. To be able to
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:132:   * handle such a use case you may consider configuring SO_KEEPALIVE.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-133-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-134-  @Bean
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-136-      MultiThreadIoEventLoopGroup sharedEventLoopGroup) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-137-    logger.info(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:138:        "Configuring Gateway HttpClient to use shared event loop group with {} threads",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-139-        sharedEventLoopGroup.executorCount());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-140-    return httpClient ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-141-        httpClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-142-            .runOn(sharedEventLoopGroup)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:143:            .option(ChannelOption.SO_KEEPALIVE, true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-144-            // setting TCP_KEEPIDLE to 350 secs as per AWS recommendations
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:145:            // https://aws.amazon.com/blogs/networking-and-content-delivery/best-practices-for-deploying-gateway-load-balancer/
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-146-            .option(NioChannelOption.of(ExtendedSocketOptions.TCP_KEEPIDLE), TCP_KEEPIDLE_SEC);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-147-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-185-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-186-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:187:  @Bean("mtlsConnection")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:188:  public ConnectionProvider mtlsConnectionProvider() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:189:    return ConnectionProvider.builder(MTLS_CONNECTION_PROVIDER_NAME)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-190-        .maxConnections(MAX_CONNECTIONS)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-191-        .maxIdleTime(Duration.ofMinutes(IDLE_TIMEOUT_MIN))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-206-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-207-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:208:  private WebClient createWebClient(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-209-      HttpClientCustomizer httpClientCustomizer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:210:      String baseUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-211-      ConnectionProvider provider,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-212-      MultiThreadIoEventLoopGroup sharedEventLoopGroup) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-221-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-222-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:223:   * Creates a base HttpClient with standard configuration including TCP keepalive settings and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-224-   * connection pooling. This is a helper method to centralize HTTP client creation logic.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-225-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:226:  private HttpClient createBaseHttpClient(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-227-      ConnectionProvider connectionProvider, MultiThreadIoEventLoopGroup sharedEventLoopGroup) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-228-    return HttpClient.create(connectionProvider)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-229-        .runOn(sharedEventLoopGroup)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:230:        .option(ChannelOption.SO_KEEPALIVE, true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-231-        .option(NioChannelOption.of(ExtendedSocketOptions.TCP_KEEPIDLE), TCP_KEEPIDLE_SEC);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-232-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-233-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-234-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:235:   * Creates an HttpClient configured with mTLS using the provided SSL context. This method applies
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:236:   * centralized HTTP client configuration including metrics monitoring, connection pooling, and TCP
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:237:   * keepalive settings.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-238-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:239:  public HttpClient createMtlsHttpClient(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:240:      SslContext sslContext,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-241-      CustomHttpClientConfiguration customHttpClientConfiguration,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-242-      ConnectionProvider connectionProvider,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-243-      MultiThreadIoEventLoopGroup sharedEventLoopGroup) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:244:    if (sslContext == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:245:      throw new IllegalArgumentException("SSL context cannot be null");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-246-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-247-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-249-    HttpClient baseClient =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-250-        createBaseHttpClient(connectionProvider, sharedEventLoopGroup)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:251:            .secure(sslContextSpec -> sslContextSpec.sslContext(sslContext));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-252-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-253-    return metricsCustomizer.customize(baseClient);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-254-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-255-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:256:  @Bean("mtlsHttpClientCreator")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:257:  public Function<SslContext, HttpClient> mtlsHttpClientCreator(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-258-      CustomHttpClientConfiguration customHttpClientConfiguration,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:259:      @Qualifier("mtlsConnection") ConnectionProvider connectionProvider,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-260-      MultiThreadIoEventLoopGroup sharedEventLoopGroup) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:261:    return sslContext ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:262:        createMtlsHttpClient(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java:263:            sslContext, customHttpClientConfiguration, connectionProvider, sharedEventLoopGroup);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-264-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/WebClientConfiguration.java-265-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-12-@Constraint(validatedBy = ISO8601Validator.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-13-public @interface ValidISO8601Timestamp {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java:14:  String INVALID_ISO_8601_FORMAT_ERROR_MESSAGE =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-15-      "Invalid expiration time format. Please provide timestamp in ISO 8601 format.";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-16-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-18-   * @return the error message template for errors that weren't expected
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-19-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java:20:  String message() default INVALID_ISO_8601_FORMAT_ERROR_MESSAGE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ValidISO8601Timestamp.java-22-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-1-package com.sap.bpi.api.gw.dto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:3:import static io.jsonwebtoken.SignatureAlgorithm.RS256;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:5:public class PublicKeyDto {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:6:  private String kty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:7:  private String e;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:8:  private String use;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:9:  private String kid;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:10:  private String alg;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:11:  private String value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:12:  private String n;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:14:  public PublicKeyDto() {}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:16:  public PublicKeyDto(String kid, String value, String e, String n) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-17-    this.kty = RS256.getFamilyName();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-18-    this.alg = RS256.name();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-24-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:26:  public PublicKeyDto(String kid, String kty, String alg, String value, String e, String n) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-27-    this.kty = kty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-28-    this.alg = alg;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:36:  public String getKty() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-37-    return kty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-38-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:40:  public String getUse() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-41-    return use;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-42-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:44:  public String getKid() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-45-    return kid;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-46-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:48:  public String getAlg() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-49-    return alg;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-50-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-51-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:52:  public String getValue() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-53-    return value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-54-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:56:  public String getN() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-57-    return n;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-58-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java:60:  public String getE() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-61-    return e;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyDto.java-62-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-1-package com.sap.bpi.api.gw.filters.utils.csp;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:3:public class CspDirective {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:5:  private CspDirectiveType type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:6:  private SourceList sourceList;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:8:  public CspDirective(CspDirectiveType type, SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-9-    this.type = type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-10-    this.sourceList = sourceList;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-11-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:13:  public CspDirectiveType getType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-14-    return type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-15-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-19-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:21:  public String toHeaderValue() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:22:    return type + " " + sourceList.toString() + ";";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-23-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-25-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:26:   * @return Whether a directive has source list items or it is of type sandbox. Sandbox directive
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-27-   *     does not need any items to be applied.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-28-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:29:  public boolean isEffective() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java:30:    return sourceList.hasContent() || type == CspDirectiveType.SANDBOX;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspDirective.java-32-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-5-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-6-import com.sap.bpi.api.gw.dto.tenant.CertificateDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:7:import com.sap.bpi.api.gw.dto.tenant.SignavioTenantMappingResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-8-import com.sap.bpi.api.gw.security.certificate.ValidationResult;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-9-import java.io.ByteArrayInputStream;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-16-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-17-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:18:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:19:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:20:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:21:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:22:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:23:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-24-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-25-import reactor.core.publisher.Mono;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-27-public final class AuthorizationManagerUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:29:  private static final Logger logger = LoggerFactory.getLogger(AuthorizationManagerUtils.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:31:  private static final List<String> AUTHENTICATION_DOMAINS =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-32-      List.of(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-33-          "us10.hana.ondemand.com",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-42-          "eu20.hana.ondemand.com");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:44:  public static Map<String, List<String>> createHeadersMapWithLowercaseKeys(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-45-      HttpHeaders httpHeaders) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-46-    return httpHeaders.entrySet().stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:47:        .collect(Collectors.toMap(entry -> entry.getKey().toLowerCase(), Map.Entry::getValue));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-48-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-50-  public static Mono<AuthorizationDecision> handleValidationError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-51-      ValidationResult validationResult) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:52:    String errorMsg = validationResult.createHeaderErrorMessage();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-53-    logger.error("Invalid request: {}", errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-54-    return Mono.error(new ResponseStatusException(HttpStatus.BAD_REQUEST, errorMsg));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-55-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:57:  public static Set<String> splitTrimInput(String input) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:58:    return Arrays.stream(input.split(",")).map(String::trim).collect(Collectors.toSet());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-59-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-61-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:62:   * Trim and split the input string by semicolon and then split each part by comma and trim each
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-63-   * part. Example: "CN=1, OU=1;CN=2, OU=2" -> [["CN=1", "OU=1"], ["CN=2", "OU=2"]]
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-64-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:65:  public static List<Set<String>> splitMultipleSubjectsOrIssuersToSeparateParts(String input) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-66-    return Arrays.stream(input.split(";"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:67:        .map(String::trim)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-68-        .map(AuthorizationManagerUtils::splitTrimInput)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-69-        .toList();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-70-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:72:  public static List<String> convertToList(String arrayJson) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-73-    logger.debug("Converting JSON array to List: {}", arrayJson);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-74-    if (arrayJson == null || arrayJson.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-85-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:87:  public static Map<String, String> convertToMap(String jsonArray) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-88-    logger.debug("Converting JSON array to Map: {}", jsonArray);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-89-    if (jsonArray == null || jsonArray.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-102-  /** Gets the leaf certificate from the tenant mapping response */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-103-  public static Flux<X509Certificate> getLeafCertificates(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:104:      Mono<SignavioTenantMappingResponse> tenantMappings, String externalTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-105-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-106-    return tenantMappings
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-113-                        .map(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-114-                            mapping -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:115:                              String certificateChain =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-116-                                  mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-117-                                      .additionalInfo()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:118:                                      .assignedTenant()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-119-                                      .configuration()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-120-                                      .certificateChain();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-134-   * http://process-insights-discovery-e2e-testing-dev.authentication.eu12.hana.ondemand.com/
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-135-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:136:  public static String constructXsuaaUrlFromAppRoute(String route, String appRouterName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-137-    return constructXsuaaUrlFromAppRoute(route, appRouterName, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-138-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-139-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-140-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:141:   * Constructs the XSUAA URL from the application route and app router name, with JWT issuer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:142:   * matching for cloud.sap routes. For cloud.sap routes, attempts to match the JWT issuer ending
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-143-   * with known authentication domains.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-144-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:145:  public static String constructXsuaaUrlFromAppRoute(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:146:      String route, String appRouterName, String jwtIssuer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-147-    // Remove protocol if present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:148:    String url = route.replaceFirst("^https?://", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:149:    String host = url.split("/")[0];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:150:    String httpsPrefix = "https://";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-151-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-152-    if (host.contains("localhost:")) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-155-    if (host.endsWith("cloud.sap")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-156-      // Prod: use the full subdomain before the first dot
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:157:      String[] hostParts = host.split("\\.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:158:      String subdomain = hostParts[0];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-159-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:160:      // If JWT issuer is provided, try to match with authentication domains
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:161:      if (jwtIssuer != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:162:        String matchingDomain = findMatchingAuthenticationDomain(jwtIssuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-163-        if (matchingDomain != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-164-          return httpsPrefix + subdomain + ".authentication." + matchingDomain;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-166-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-167-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:168:      // Fallback to original logic if no JWT issuer match found
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:169:      String domain = host.substring(subdomain.length() + 1);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-170-      return httpsPrefix + subdomain + ".authentication." + domain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-171-    } else {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-173-      int cfappsIdx = host.indexOf(".cfapps");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-174-      if (cfappsIdx == -1) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:175:        String errorMsg = "Route does not contain .cfapps: " + route;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-176-        logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-177-        throw new IllegalArgumentException(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-178-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:179:      String beforeCfapps = host.substring(0, cfappsIdx);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:180:      String afterCfapps = host.substring(cfappsIdx + ".cfapps".length());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:181:      String[] beforeParts = beforeCfapps.split("\\.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:182:      String subdomain = beforeParts[0];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:183:      String tenantSubdomain = extractFromSubdomain(subdomain, appRouterName)[0];
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-184-      // Compose the new host
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:185:      String xsuaaHost = tenantSubdomain + ".authentication" + afterCfapps;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-186-      return httpsPrefix + xsuaaHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-187-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-188-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-189-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:190:  public static String getCnValuesFromCertificates(List<CertificateDto> certificates) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-191-    return certificates.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-192-        .map(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-193-            certificateDto -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:194:              String base64CertWithoutPEMHeaders = certificateDto.cert();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-195-              try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-196-                X509Certificate x509Cert =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:197:                    decodeBase64CertificateWithoutPEMHeaders(base64CertWithoutPEMHeaders);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:198:                String subjectDN = x509Cert.getSubjectX500Principal().getName();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-199-                return extractCN(subjectDN);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-200-              } catch (Exception e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-209-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-210-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:211:  public static Map<String, List<String>> extractAndValidateHeaders(AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-212-    ServerHttpRequest request = context.getExchange().getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:213:    Map<String, List<String>> lowerCaseHttpHeadersMap =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:214:        AuthorizationManagerUtils.createHeadersMapWithLowercaseKeys(request.getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-215-    ValidationResult validationResult = new ValidationResult(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-216-    if (validationResult.errorsExist()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-220-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-221-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:222:  private static X509Certificate decodeLeafCertificate(String certificateChain) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-223-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-224-      InputStream targetStream = new ByteArrayInputStream(certificateChain.getBytes());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-225-      X509Certificate x509 =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-226-          (X509Certificate)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:227:              CertificateFactory.getInstance("X509").generateCertificate(targetStream);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-228-      return x509;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-229-    } catch (CertificateException e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-232-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-233-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:234:  private static X509Certificate decodeBase64CertificateWithoutPEMHeaders(String certificateChain) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-235-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-236-      InputStream targetStream =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-238-      X509Certificate x509 =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-239-          (X509Certificate)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:240:              CertificateFactory.getInstance("X509").generateCertificate(targetStream);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-241-      return x509;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-242-    } catch (CertificateException e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-245-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-246-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:247:  private static String extractCN(String subjectDN) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:248:    String cnPrefix = "CN=";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:249:    String trimmedAttribute;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:250:    String[] attributes = subjectDN.split(",");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:251:    for (String attribute : attributes) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-252-      trimmedAttribute = attribute.trim();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-253-      if (trimmedAttribute.startsWith(cnPrefix)) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-260-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-261-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:262:  private static String[] extractFromSubdomain(String subdomain, String appRouterName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-263-    int lastIndexOfAppRouterName = subdomain.lastIndexOf(appRouterName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-264-    if (lastIndexOfAppRouterName == -1) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:265:      String errorMsg =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-266-          "App router name: " + appRouterName + " not found in subdomain: " + subdomain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-267-      logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-268-      throw new IllegalArgumentException(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-269-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:270:    String tenantSubDomain = subdomain.substring(0, lastIndexOfAppRouterName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-271-    // Remove trailing dash if present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-272-    if (tenantSubDomain.endsWith("-")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:273:      tenantSubDomain = tenantSubDomain.substring(0, tenantSubDomain.length() - 1);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-274-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-275-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:276:    String landscapeSuffix = subdomain.substring(lastIndexOfAppRouterName + appRouterName.length());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-277-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:278:    return new String[] {tenantSubDomain, appRouterName, landscapeSuffix};
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-279-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-280-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-281-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:282:   * Finds the matching authentication domain for a given JWT issuer ending. Used for cloud.sap
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-283-   * routes to match with the correct authentication domain.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-284-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:285:   * @param jwtIssuer The JWT issuer (e.g.,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-286-   *     "https://tenant.authentication.eu10.hana.ondemand.com/oauth/token")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-287-   * @return The matching authentication domain or null if not found
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-288-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:289:  private static String findMatchingAuthenticationDomain(String jwtIssuer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java:290:    return AUTHENTICATION_DOMAINS.stream().filter(jwtIssuer::contains).findFirst().orElse(null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-291-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/AuthorizationManagerUtils.java-292-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-1-package com.sap.bpi.api.gw.global;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:3:import static org.springframework.cloud.gateway.support.ServerWebExchangeUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-5-import java.net.URI;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:11:import org.springframework.cloud.gateway.filter.GatewayFilterChain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:12:import org.springframework.cloud.gateway.filter.GlobalFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:13:import org.springframework.cloud.gateway.route.Route;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:14:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:15:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:16:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:17:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:18:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-19-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-20-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-35-        exchange.getAttributeOrDefault(GATEWAY_ORIGINAL_REQUEST_URL_ATTR, Collections.emptySet());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-36-    URI routeUri = exchange.getAttribute(GATEWAY_REQUEST_URL_ATTR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:37:    String originalUri = uris.isEmpty() ? "Unknown" : uris.iterator().next().toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-39-    logTotalRequestHeaderSizeWhenReachingLimit(exchange.getRequest());
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-65-  In case the default limit is reached, we log the size for further analysis.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-66-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:67:  private void logTotalRequestHeaderSizeWhenReachingLimit(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-69-    int totalRequestHeaderSize = 0;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-70-    for (var entry : request.getHeaders().entrySet()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:71:      totalRequestHeaderSize += entry.getKey().getBytes(StandardCharsets.UTF_8).length;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java:72:      for (String value : entry.getValue()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-73-        totalRequestHeaderSize += value.getBytes(StandardCharsets.UTF_8).length;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/LoggingFilter.java-74-      }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-3-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:4:import com.sap.bpi.api.gw.jwt.JwtTargetType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:5:import com.sap.bpi.api.gw.security.jwt.TokenAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:6:import com.sap.bpi.api.gw.security.jwt.strategy.TokenType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-7-import java.util.EnumSet;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-8-import java.util.Set;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:12:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:13:import org.springframework.cloud.gateway.filter.GatewayFilterChain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:14:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:15:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:16:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-19-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:20: * Unified JWT Conversion Filter Factory.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-21- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-22- * <p>This filter delegates to appropriate conversion filters based on the "token-type" attribute
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:23: * set by TokenAuthorizationManager during authentication.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-24- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-25- * <p>Architecture: - TokenAuthorizationManager validates tokens and sets "token-type" exchange
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-26- * attribute - This filter reads "token-type" and delegates to the appropriate converter: -
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:27: * "sap-jwt" -> SapJwtToSpmJwtGatewayFilterFactory - "spm-token" -> SpmTokenToSpmJwtFilterFactory -
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:28: * "ugw-jwt" -> UgwJwtToSpmJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-29- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-30-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:31:public class UnifiedJwtConversionFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:32:    extends AbstractGatewayFilterFactory<UnifiedJwtConversionFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:34:  private static final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:35:      LoggerFactory.getLogger(UnifiedJwtConversionFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:37:  private final SapJwtToSpmJwtGatewayFilterFactory sapJwtConverter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:38:  private final SpmTokenToSpmJwtFilterFactory spmTokenConverter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:39:  private final UgwJwtToSpmJwtFilterFactory ugwJwtConverter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-41-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:42:  public UnifiedJwtConversionFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:43:      SapJwtToSpmJwtGatewayFilterFactory sapJwtConverter,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:44:      SpmTokenToSpmJwtFilterFactory spmTokenConverter,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:45:      UgwJwtToSpmJwtFilterFactory ugwJwtConverter) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-46-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:47:    this.sapJwtConverter = sapJwtConverter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-48-    this.spmTokenConverter = spmTokenConverter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:49:    this.ugwJwtConverter = ugwJwtConverter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-50-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-51-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-55-    if (config == null || !config.hasConfiguration()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-56-      throw new IllegalArgumentException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:57:          "UnifiedJwtConversionFilterFactory requires inline configuration. "
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:58:              + "Please provide JwtTargetType and FeatureApplication[] via Config constructor.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-59-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-61-    return (exchange, chain) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-62-      // Read token-type from exchange attributes (set by TokenAuthorizationManager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:63:      String tokenType = exchange.getAttribute(TokenAuthorizationManager.TOKEN_TYPE_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-64-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-65-      if (tokenType == null) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-67-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:69:      // Bypass filter if token is already SPM JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:70:      if (TokenType.SPM_JWT.getTokenTypeValue().equals(tokenType)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:71:        logger.debug("Token is already SPM JWT, bypassing conversion filter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-72-        return chain.filter(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-73-      }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-81-   * Delegates to the appropriate converter based on token type and target type.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-82-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:83:   * @param tokenType The token type (sap-jwt, spm-token, ugw-jwt)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-84-   * @param config The inline route configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-85-   * @param exchange The server web exchange
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-87-   * @return Mono for async processing
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-88-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:89:  private Mono<Void> delegateToConverter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:90:      String tokenType, Config config, ServerWebExchange exchange, GatewayFilterChain chain) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-91-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:92:    JwtTargetType targetType = config.getTargetType();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:94:    // Validate target type is supported (currently only SPM_JWT)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:95:    if (targetType != JwtTargetType.SPM_JWT) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-96-      logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:97:          "Unsupported JWT target type: {}. Only SPM_JWT is currently supported.", targetType);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-98-      return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-99-          new UnsupportedOperationException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:100:              "JWT target type " + targetType + " is not yet supported"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-101-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-102-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-105-    // Delegate to appropriate converter based on token-type
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-106-    return switch (tokenType) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:107:      case "sap-jwt" ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:108:          sapJwtConverter
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:109:              .apply(new SapJwtToSpmJwtGatewayFilterFactory.Config(featuresArray))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-110-              .filter(exchange, chain);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-111-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-112-      case "spm-token" ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-113-          spmTokenConverter
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:114:              .apply(new SpmTokenToSpmJwtFilterFactory.Config(featuresArray))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-115-              .filter(exchange, chain);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-116-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:117:      case "ugw-jwt" ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:118:          ugwJwtConverter
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:119:              .apply(new UgwJwtToSpmJwtFilterFactory.Config(featuresArray))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-120-              .filter(exchange, chain);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-121-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-124-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-125-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:126:  private FeatureApplication[] prepareFeaturesArray(Set<FeatureApplication> features) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-127-    return features.isEmpty()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-128-        ? new FeatureApplication[] {FeatureApplication.PLATFORM}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-131-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-132-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:133:   * Configuration class for UnifiedJwtConversionFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-134-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:135:   * <p>All unified routes MUST provide both JwtTargetType and FeatureApplication[] via constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-136-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-137-  public static class Config {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:138:    private final JwtTargetType targetType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:139:    private final Set<FeatureApplication> features;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-140-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-141-    /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-142-     * Constructor for inline configuration (REQUIRED).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-143-     *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:144:     * @param targetType The target JWT type (must not be null)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-145-     * @param features The feature applications to include (must not be null or empty)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-146-     */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:147:    public Config(JwtTargetType targetType, FeatureApplication... features) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-148-      if (targetType == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-149-        throw new IllegalArgumentException("targetType must not be null");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-168-    // Getters (no setters - immutable configuration)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-169-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java:170:    public JwtTargetType getTargetType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-171-      return targetType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/UnifiedJwtConversionFilterFactory.java-172-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-3-import static com.sap.bpi.api.gw.filters.utils.FilterUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:4:import static com.sap.bpi.api.gw.filters.utils.JwtUtils.BEARER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-5-import static com.sap.bpi.api.gw.filters.utils.SpmRequestResponseFilterUtils.X_FORWARDED_FOR_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-6-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.JOULE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:7:import static org.springframework.cloud.gateway.support.GatewayToStringStyler.filterToStringCreator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-9-import com.sap.bpi.api.gw.dto.ExternalUserInfo;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-10-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-11-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:12:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-13-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-14-import com.sap.bpi.api.gw.services.SpmService;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-16-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-17-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:18:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:19:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:20:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:21:import org.springframework.cloud.gateway.filter.GatewayFilterChain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:22:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:23:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:24:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:25:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:26:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:27:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:28:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-29-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-31-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:32: * This FilterFactory converts an incoming XSUAA JWT (BTP) or IAS JWT to an SPM JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-33- * -----------------------------------------------------------------------------------------------
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:34: * The XSUAA JWT contains the user id (IAS Tenant's Global User ID) in claim user_uuid, while the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:35: * IAS JWT contains it in claim uid. First, the user_uuid/uid is used to query the users email from
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:36: * the externalUserInfo endpoint by using a system user SPM JWT. Second, the users email + tenantId
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:37: * are used to create a user specific SPM JWT to query the /me endpoint to get user details like
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:38: * featureOfApps. Third, a final user specific SPM JWT including the user details is generated and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-39- * set as Bearer token for the Authorization Header.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-40- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-41-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:42:public class SapJwtToSpmJwtGatewayFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:43:    extends AbstractGatewayFilterFactory<SapJwtToSpmJwtGatewayFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-45-  // comma separated list of tenant IDs, for which no call to lookup email in SPM should be done
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-46-  @Value("${app.trafomanager.tenants.without.sso}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:47:  private String tenantsWithoutSso;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:49:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:50:  private final Logger logger = LoggerFactory.getLogger(SapJwtToSpmJwtGatewayFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:51:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:52:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-54-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:55:  public SapJwtToSpmJwtGatewayFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:56:      JwtUtils jwtUtils, SpmService spmService, AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-57-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-58-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:59:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-60-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:61:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-62-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:63:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-64-    this.spmService = spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-65-    this.auditLogClientManager = auditLogClientManager;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-76-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-77-              ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:78:              String xSignavioTenantId = getSignavioTenantIdFromExchange(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:79:              exchange.getAttributes().remove(X_SIGNAVIO_TENANT_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:80:              String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-81-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-82-              // Route to appropriate authentication flow based on tenant configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:83:              if (isTenantWithoutSso(xSignavioTenantId)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-84-                return processTenantWithoutSso(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:85:                        exchange, chain, config, xSignavioTenantId, requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-86-                    .onErrorResume(ResponseStatusException.class, this::handleException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-87-              } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:88:                return processStandardSsoFlow(exchange, chain, config, xSignavioTenantId, requestId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-89-                    .onErrorResume(ResponseStatusException.class, this::handleException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-90-              }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-94-      @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:95:      public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:96:        return filterToStringCreator(SapJwtToSpmJwtGatewayFilterFactory.this)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-97-            .append("featureApplications", config.getFeatureApplications())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:98:            .toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-99-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-100-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:101:      private Mono<Void> handleException(ResponseStatusException ex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:102:        String errorMsg = ex.getMessage();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-103-        logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-104-        if (ex.getStatusCode() == HttpStatus.BAD_GATEWAY) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-112-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-113-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:114:  private String getUserUUIDFromExchange(ServerWebExchange exchange, String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-115-    HttpHeaders headers = exchange.getRequest().getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:116:    String jwt =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-117-        Optional.ofNullable(headers.getFirst(HttpHeaders.AUTHORIZATION))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:118:            .map(authHeader -> authHeader.substring(BEARER.length() + 1))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-119-            .orElseThrow(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-120-                () ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-121-                    new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-122-                        HttpStatus.UNAUTHORIZED, "Authorization header is missing"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:123:    Optional<String> userId = jwtUtils.getExternalUserIdClaimValueFromJwt(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-124-    userId.ifPresentOrElse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-125-        uuid -> logger.debug("External user ID (user_uuid or uid) is: {}", uuid),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:126:        () -> logger.error("External user ID (user_uuid or uid) is missing in JWT"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-127-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-128-    if (userId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:129:      logMissingUserDetails(headers, signavioTenantId, JOULE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-130-      throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:131:          HttpStatus.UNAUTHORIZED, "Failed to get user ID from JWT (user_uuid or uid claim)");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-132-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-133-    return userId.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-134-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-135-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:136:  private String generateJwtBearer(String xSignavioTenantId, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:137:    JsonWebToken spmJwt = new JsonWebToken(xSignavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:138:    return jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-139-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-140-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-141-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-142-   * Processes authentication flow for tenants without SSO configuration. Extracts email directly
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:143:   * from XSUAA JWT and creates SPM JWT.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-144-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:145:  private Mono<Void> processTenantWithoutSso(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-146-      ServerWebExchange exchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-147-      GatewayFilterChain chain,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-148-      Config config,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:149:      String xSignavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:150:      String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-151-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-152-    logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:153:        "Tenant {} is configured without SSO, using email from XSUAA JWT directly",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:154:        xSignavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-155-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:156:    // Get email directly from XSUAA JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:157:    String xsuaaJwt = extractXsuaaJwtFromHeaders(exchange.getRequest().getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:158:    String externalUserEmail = getEmailFromXsuaaJwt(xsuaaJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-159-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:160:    JsonWebToken spmJwt = new JsonWebToken(xSignavioTenantId, externalUserEmail, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:161:    String userSpmJwt = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-162-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:163:    return getUserDetailsAndCreateSpmJwt(exchange, chain, config, requestId, userSpmJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-164-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-165-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-166-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-167-   * Processes standard authentication flow for tenants with SSO configuration. Fetches external
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:168:   * user info first, then creates SPM JWT.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-169-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:170:  private Mono<Void> processStandardSsoFlow(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-171-      ServerWebExchange exchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-172-      GatewayFilterChain chain,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-173-      Config config,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:174:      String xSignavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:175:      String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-176-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:177:    String externalId = getUserUUIDFromExchange(exchange, xSignavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-178-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:179:    // Create system user SPM JWT to call externalUserInfo endpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:180:    String systemUserSpmJwtBearer = generateJwtBearer(xSignavioTenantId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-181-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-182-    // Call external user info endpoint to get email
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-183-    Mono<ExternalUserInfo> externalUserInfoMono =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:184:        spmService.getExternalUserInfoFromSpmWithSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:185:            systemUserSpmJwtBearer, externalId, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-186-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-187-    /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-197-        .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-198-            externalUserInfo -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:199:              String externalUserEmail = externalUserInfo.email();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:200:              JsonWebToken spmJwt =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:201:                  new JsonWebToken(xSignavioTenantId, externalUserEmail, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:202:              String userSpmJwt = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-203-              Set<FeatureApplication> featureSets = config.getFeatureApplications();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:204:              String xForwardedFor =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-205-                  exchange.getRequest().getHeaders().getFirst(X_FORWARDED_FOR_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:206:              return spmService.getUserDetailsFromSpmWithSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:207:                  userSpmJwt, xForwardedFor, featureSets);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-208-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-209-        .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-210-            tuple -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-211-              SpmUser user = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:212:              return createSpmJwtAndContinueChain(exchange, chain, requestId, user);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-213-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-214-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-215-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:216:  /** Extracts XSUAA JWT from Authorization header. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:217:  private String extractXsuaaJwtFromHeaders(HttpHeaders headers) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-218-    return Optional.ofNullable(headers.getFirst(HttpHeaders.AUTHORIZATION))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:219:        .map(authHeader -> authHeader.substring(BEARER.length() + 1))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-220-        .orElseThrow(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-221-            () ->
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-224-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-225-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:226:  /** Extracts email from XSUAA JWT for tenants without SSO. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:227:  private String getEmailFromXsuaaJwt(String xsuaaJwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:228:    Optional<String> emailFromJwt = jwtUtils.getEmailClaimValueFromJwt(xsuaaJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:229:    if (emailFromJwt.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:230:      logger.error("Email claim is missing in XSUAA JWT for tenant without SSO");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-231-      throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:232:          HttpStatus.UNAUTHORIZED, "Failed to get email from XSUAA JWT");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-233-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:234:    return emailFromJwt.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-235-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-236-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:237:  /** Gets user details from SPM and creates final SPM JWT for tenants without SSO. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:238:  private Mono<Void> getUserDetailsAndCreateSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-239-      ServerWebExchange exchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-240-      GatewayFilterChain chain,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-241-      Config config,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:242:      String requestId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:243:      String userSpmJwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-244-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-245-    Set<FeatureApplication> featureSets = config.getFeatureApplications();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:246:    String xForwardedFor = exchange.getRequest().getHeaders().getFirst(X_FORWARDED_FOR_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-247-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-248-    return spmService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:249:        .getUserDetailsFromSpmWithSpmJwt(userSpmJwt, xForwardedFor, featureSets)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:250:        .flatMap(user -> createSpmJwtAndContinueChain(exchange, chain, requestId, user));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-251-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-252-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:253:  /** Creates the final enriched SPM JWT and continues the filter chain. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:254:  private Mono<Void> createSpmJwtAndContinueChain(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:255:      ServerWebExchange exchange, GatewayFilterChain chain, String requestId, SpmUser user) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-256-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:257:    JsonWebToken enrichedUserSpmJwt = new JsonWebToken(user, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:258:    String jwtBearer =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:259:        jwtUtils.getSpmAuthorizationHeaderAsASingletonList(enrichedUserSpmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-260-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-261-    ServerHttpRequest mutatedRequest =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:262:        exchange.getRequest().mutate().header(HttpHeaders.AUTHORIZATION, jwtBearer).build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-263-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-264-    return chain.filter(exchange.mutate().request(mutatedRequest).build());
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-266-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-267-  public static class Config {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:268:    private final Set<FeatureApplication> featureApplications;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-269-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-270-    public Config(FeatureApplication... featureApplications) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-281-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-282-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:283:  private void logMissingUserDetails(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:284:      HttpHeaders headers, String signavioTenantId, String requestOrigin) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:285:    List<String> sourceIps = getSourceIpsFromHttpHeaders(headers);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:286:    auditLogClientManager.logUnauthenticatedAccess(signavioTenantId, sourceIps, requestOrigin);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-287-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-288-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:289:  private boolean isTenantWithoutSso(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-290-    if (tenantId == null || tenantsWithoutSso == null || tenantsWithoutSso.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-291-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-292-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:293:    List<String> tenantList = Arrays.asList(tenantsWithoutSso.split(","));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java:294:    return tenantList.stream().map(String::trim).anyMatch(tenantId::equals);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-295-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SapJwtToSpmJwtGatewayFilterFactory.java-296-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-1-package com.sap.bpi.api.gw.filters.utils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:3:import org.springframework.cloud.gateway.filter.GatewayFilterChain;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:4:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:5:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-7-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-8- * This record is used to encapsulate the context of the request to reduce the number of arguments
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:9: * at the [filter]{@link com.sap.bpi.api.gw.filters.SpgTokenToUgwJwtFilterFactory}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-10- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-11-public record SpgRequestContext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:12:    String spgToken,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-13-    ServerHttpRequest request,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-14-    ServerWebExchange exchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java-15-    GatewayFilterChain chain,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:16:    String organizationKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:17:    String xForwardedFor,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpgRequestContext.java:18:    String requestId) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java:3:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java:4:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java:5:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java:6:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/RedirectToLoginGatewayFilterFactory.java-8-/** This Filter adds a "redirect" header to the request, containing the original request path. */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-3-public enum MappingTypes {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:4:  CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:5:      "signavio_to_btp_sub_account_id_connectivity_platform_subscription"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:6:  SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_SUBSCRIPTION_MAPPING_TYPE(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:7:      "signavio_to_btp_sub_account_id_joule_subscription"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:8:  SIGNAVIO_TO_BTP_SUB_ACCOUNT_ID_JOULE_WORKZONE_INTEGRATION_MAPPING_TYPE(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:9:      "signavio_to_btp_sub_account_id_joule_workzone_integration"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:10:  IAS_JWT_CONFIGURATION_TYPE("spi_ingestion_api_oauth2_clients");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:12:  private final String mappingTypeString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:14:  MappingTypes(String mappingTypeString) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:15:    this.mappingTypeString = mappingTypeString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-16-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-18-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:19:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java:20:    return mappingTypeString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-21-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/MappingTypes.java-22-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmJwtDto.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmJwtDto.java-6-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmJwtDto.java:7:public record SpmJwtDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmJwtDto.java:8:    @JsonProperty("iss") String issuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmJwtDto.java:9:    @JsonProperty("sub") String subject,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmJwtDto.java:10:    @JsonProperty("tem") String tenantId) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-7-import java.time.format.DateTimeParseException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java:9:public class ISO8601Validator implements ConstraintValidator<ValidISO8601Timestamp, String> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-11-  @Override
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-14-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java:15:  public boolean isValid(String timestamp, ConstraintValidatorContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-16-    if (timestamp == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-17-      return true;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-35-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java:37:  private static void setConstraintViolationText(ConstraintValidatorContext context, String s) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-38-    context.disableDefaultConstraintViolation();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/validation/ISO8601Validator.java-39-    context.buildConstraintViolationWithTemplate(s).addConstraintViolation();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:1:package com.sap.bpi.api.gw.security.jwt.insights_central;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getRequestIdFromHeaderOrGenerate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-4-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.BTP;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:5:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:7:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:8:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:12:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:13:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:14:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:15:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:16:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:17:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:18:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:19:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:20:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:21:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-22-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-24-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-25-public class InsightsCentralAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:26:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:27:  private final JwtVerifierStrategy jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:28:  private final Logger logger = LoggerFactory.getLogger(InsightsCentralAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-30-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-31-  public InsightsCentralAuthorizationManager(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:32:      @Qualifier("insightsCentralXsuaaJwtVerifier") JwtVerifierStrategy jwtVerifier) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:33:    this.jwtVerifier = jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-35-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-38-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-39-    ServerWebExchange exchange = context.getExchange();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:40:    String authHeader = exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-41-    if (isBearerToken(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:42:      String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:43:      String requestId = getRequestIdFromHeaderOrGenerate(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:44:      JwtValidationContext jwtValidationContext =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:45:          JwtValidationContext.from(exchange.getRequest().getHeaders(), requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:46:      return getSignavioTenantId(jwtValidationContext)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:47:          .flatMap(signavioTenantId -> jwtVerifier.isJwtValid(token, jwtValidationContext))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:48:          .flatMap(result -> handleJwtValidationResult(context, result, BTP.toString()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-49-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-50-    return Mono.just(new AuthorizationDecision(false));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-51-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:53:  private Mono<String> getSignavioTenantId(JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:54:    String signavioTenantId = jwtValidationContext.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:55:    if (signavioTenantId == null || signavioTenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:56:      logger.error("Signavio tenant id header is missing");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-57-      return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-58-          new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:59:              HttpStatus.UNAUTHORIZED, "Missing sap-signavio-tenant-id header"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-60-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java:61:    return Mono.just(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/insights_central/InsightsCentralAuthorizationManager.java-63-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-1-package com.sap.bpi.api.gw.filters;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:3:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:4:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_USER_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-6-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:7:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-8-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-9-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:10:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:11:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:12:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:13:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:14:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:15:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:16:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:17:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:18:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-19-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-21-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:22:public class SpmUserIdAndTenantIdToSpmJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:23:    extends AbstractGatewayFilterFactory<SpmUserIdAndTenantIdToSpmJwtFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:24:  private final Logger logger =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:25:      LoggerFactory.getLogger(SpmUserIdAndTenantIdToSpmJwtFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:27:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-29-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:30:  public SpmUserIdAndTenantIdToSpmJwtFilterFactory(JwtUtils jwtUtils) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-31-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-32-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:33:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-34-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:35:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:36:    super(SpmUserIdAndTenantIdToSpmJwtFilterFactory.Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:37:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-38-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-40-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:41:  public GatewayFilter apply(SpmUserIdAndTenantIdToSpmJwtFilterFactory.Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-42-    return (exchange, chain) ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-43-        Mono.defer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-44-            () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-45-              ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:46:              String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:47:              String signavioTenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:48:              String email;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:49:              String jwtBearer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-50-              if (areMandatoryHeadersPresent(request)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:51:                email = exchange.getRequest().getHeaders().getFirst(SAP_SIGNAVIO_USER_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:52:                signavioTenantId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:53:                    exchange.getRequest().getHeaders().getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-54-                logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:55:                    "Extracted sap-signavio-user-id as {} and sap-signavio-tenant-id as {} from"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-56-                        + " headers",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-57-                    email,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:58:                    signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:59:                jwtBearer = generateJwtBearerWithUserEmail(signavioTenantId, email, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:60:                logger.debug("Generated SPM JWT with provided headers: {}", jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-61-              } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-62-                throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-63-                    HttpStatus.BAD_REQUEST,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:64:                    "Missing sap-signavio-user-id or sap-signavio-tenant-id header");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-65-              }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:66:              ServerHttpRequest requestBuild = buildRequest(exchange, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-67-              return chain.filter(exchange.mutate().request(requestBuild).build());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-68-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:71:  String generateJwtBearerWithUserEmail(String signavioTenantId, String email, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:72:    JsonWebToken spmJwt = new JsonWebToken(signavioTenantId, email, null, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:73:    return jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-74-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:76:  private ServerHttpRequest buildRequest(ServerWebExchange exchange, String jwtBearer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-77-    ServerHttpRequest.Builder builder = exchange.getRequest().mutate();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:78:    builder.headers(headers -> headers.remove(SAP_SIGNAVIO_TENANT_ID_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:79:    builder.headers(headers -> headers.remove(SAP_SIGNAVIO_USER_ID_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:80:    builder.header(HttpHeaders.AUTHORIZATION, jwtBearer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-81-    return builder.build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-82-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:84:  private boolean areMandatoryHeadersPresent(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:85:    String sapSignavioUserId = request.getHeaders().getFirst(SAP_SIGNAVIO_USER_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:86:    String sapTenantId = request.getHeaders().getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:87:    return (sapSignavioUserId != null
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java:88:        && !sapSignavioUserId.isBlank()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-89-        && sapTenantId != null
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpmUserIdAndTenantIdToSpmJwtFilterFactory.java-90-        && !sapTenantId.isBlank());
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-5-  REPORT_ONLY("Content-Security-Policy-Report-Only");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java:7:  private String headerName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java:9:  CspMode(String headerName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-10-    this.headerName = headerName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-11-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java:13:  public String getHeaderName() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-14-    return headerName;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspMode.java-15-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomPredicateConfiguration.java-3-import com.sap.bpi.api.gw.predicates.JouleRoutePredicateFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomPredicateConfiguration.java-4-import com.sap.bpi.api.gw.predicates.RedirectToLoginRoutePredicateFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomPredicateConfiguration.java:5:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomPredicateConfiguration.java:6:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomPredicateConfiguration.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomPredicateConfiguration.java-8-/** A configuration class for custom Predicates. */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-3-import com.fasterxml.jackson.core.JsonProcessingException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-4-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:5:import com.sap.bpi.api.gw.dto.destinationService.DestinationServiceCertificateDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-6-import java.io.ByteArrayInputStream;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:7:import java.io.StringReader;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:8:import java.security.KeyFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-9-import java.security.NoSuchAlgorithmException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:10:import java.security.PrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-11-import java.security.cert.CertificateException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-12-import java.security.cert.CertificateFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-13-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:14:import java.security.spec.InvalidKeySpecException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:15:import java.security.spec.PKCS8EncodedKeySpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-16-import java.util.ArrayList;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-17-import java.util.Base64;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-19-import java.util.regex.Matcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-20-import java.util.regex.Pattern;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:21:import org.bouncycastle.openssl.PEMKeyPair;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:22:import org.bouncycastle.openssl.PEMParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:23:import org.bouncycastle.openssl.jcajce.JcaPEMKeyConverter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:25:public class DestinationServiceCertificateParser {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:27:  private DestinationServiceCertificateParser() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-28-    throw new IllegalStateException("Utility class");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-29-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:31:  public static DestinationServiceCertificateDto parseResponse(String jsonResponse)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-32-      throws JsonProcessingException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-33-    ObjectMapper mapper = new ObjectMapper();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:34:    return mapper.readValue(jsonResponse, DestinationServiceCertificateDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-35-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:37:  public static String decodePEMContent(String base64Content) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-38-    byte[] decoded = Base64.getDecoder().decode(base64Content);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:39:    return new String(decoded);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-40-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:42:  public static PrivateKey extractPrivateKeyPkcs8(String pemContent)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:43:      throws IllegalArgumentException, InvalidKeySpecException, NoSuchAlgorithmException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:44:    Pattern privateKeyPattern =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-45-        Pattern.compile(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:46:            "-----BEGIN PRIVATE KEY-----[\\r"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-47-                + "\\n"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-48-                + "]*+([A-Za-z0-9+/=\\r"
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-50-                + "]++)[\\r"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-51-                + "\\n"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:52:                + "]*+-----END PRIVATE KEY-----");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:54:    Matcher matcher = privateKeyPattern.matcher(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-55-    if (!matcher.find()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:56:      throw new IllegalArgumentException("No private key found in PEM content");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-57-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:59:    String base64Key = matcher.group(1).replaceAll("[\\r\\n]", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:60:    byte[] keyBytes = Base64.getDecoder().decode(base64Key);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-61-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:62:    PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(keyBytes);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:63:    KeyFactory keyFactory = KeyFactory.getInstance("RSA");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:64:    return keyFactory.generatePrivate(keySpec);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-65-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:67:  public static PrivateKey extractPrivateKeyPkcs1(String pemContent)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-68-      throws IllegalArgumentException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:69:    Pattern pkcs1Pattern =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-70-        Pattern.compile(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:71:            "-----BEGIN RSA PRIVATE KEY-----[\\r"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-72-                + "\\n"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-73-                + "]*+([A-Za-z0-9+/=\\r"
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-75-                + "]++)[\\r"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-76-                + "\\n"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:77:                + "]*+-----END RSA PRIVATE KEY-----");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-78-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:79:    Matcher matcher = pkcs1Pattern.matcher(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-80-    if (!matcher.find()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:81:      throw new IllegalArgumentException("No private key found in PEM content");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-82-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:84:    try (PEMParser pemParser = new PEMParser(new StringReader(pemContent))) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:85:      // Use BouncyCastle's PEM parser to handle PKCS#1 format
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:86:      Object object = pemParser.readObject();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:88:      JcaPEMKeyConverter converter = new JcaPEMKeyConverter();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:89:      if (object instanceof PEMKeyPair) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:90:        PEMKeyPair keyPair = (PEMKeyPair) object;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:91:        return converter.getPrivateKey(keyPair.getPrivateKeyInfo());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-92-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:93:      throw new IllegalArgumentException("Invalid PKCS#1 private key format");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-94-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:95:      throw new IllegalArgumentException("Failed to parse PKCS#1 private key", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-96-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-97-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-98-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:99:  public static List<X509Certificate> extractCertificates(String pemContent)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-100-      throws CertificateException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-101-    List<X509Certificate> certificates = new ArrayList<>();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-112-                + "]*+-----END CERTIFICATE-----");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-113-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:114:    Matcher matcher = certPattern.matcher(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-115-    while (matcher.find()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:116:      String base64Cert = matcher.group(1).replaceAll("[\\r\\n]", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-117-      byte[] certBytes = Base64.getDecoder().decode(base64Cert);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-118-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-119-      ByteArrayInputStream bis = new ByteArrayInputStream(certBytes);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:120:      X509Certificate cert = (X509Certificate) cf.generateCertificate(bis);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-121-      certificates.add(cert);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-122-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-125-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:127:  public static String rebuildPemWithoutPrivateKey(List<X509Certificate> certificates)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-128-      throws CertificateException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:129:    StringBuilder certificatesOnlyPem = new StringBuilder();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-130-    for (X509Certificate cert : certificates) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:131:      certificatesOnlyPem.append("-----BEGIN CERTIFICATE-----\n");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:132:      certificatesOnlyPem.append(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:133:          Base64.getMimeEncoder(64, "\n".getBytes()).encodeToString(cert.getEncoded()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:134:      certificatesOnlyPem.append("\n-----END CERTIFICATE-----\n");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-135-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java:136:    return certificatesOnlyPem.toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-137-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/DestinationServiceCertificateParser.java-138-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-1-package com.sap.bpi.api.gw.global;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:3:import com.signavio.als.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:4:import com.signavio.als.event.AuditLogEvent;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:5:import com.signavio.als.event.TenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:6:import com.signavio.als.event.User;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-7-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-8-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-9-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:10:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:11:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-13-@Component
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-16-  @Value("${logging.audit.host}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:17:  private String host;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-19-  @Value("${logging.audit.region}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:20:  private String region;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-22-  @Value("${logging.audit.namespace}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:23:  private String namespace;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-25-  @Value("${logging.audit.appId}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:26:  private String appId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-28-  AuditLogClientFactory auditLogClientFactory;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-30-  ClientCredentials clientCredentials;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:32:  private static final Logger LOGGER = LoggerFactory.getLogger(AuditLogClientManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-34-  public AuditLogClientManager(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-40-  public AuditLogClientConfig createAuditLogClientConfig(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:41:      String userId, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-42-    return new AuditLogClientConfig.Builder()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-43-        .auditLogServiceHost(host)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-48-        .appId(appId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-49-        .userSupplier(() -> new User.System(userId))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:50:        .tenantIdSupplier(() -> new TenantId.FromString(tenantId))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-51-        .sourceIPsSupplier(() -> sourceIps)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-52-        .withDefaultRetry()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-54-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:56:  public void logUnauthorizedAccess(String tenantId, List<String> sourceIps, String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-57-    if (tenantId == null || tenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-58-      LOGGER.warn("Cannot log unauthorized access: tenantId is null or empty");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-63-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-64-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:65:  public void logUnauthenticatedAccess(String tenantId, List<String> sourceIps, String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-66-    if (tenantId == null || tenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-67-      LOGGER.warn("Cannot log unauthenticated access: tenantId is null or empty");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-72-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:74:  private void logAuditEvent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java:75:      String userId, String tenantId, List<String> sourceIps, AuditLogEvent auditLogEvent) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-76-    AuditLogClient auditLogClient =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientManager.java-77-        auditLogClientFactory.createErrorHandlingClient(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-10-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-11-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:12:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:13:import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:14:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:15:import org.springframework.http.ResponseEntity;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:16:import org.springframework.web.bind.annotation.GetMapping;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:17:import org.springframework.web.bind.annotation.RequestHeader;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:18:import org.springframework.web.bind.annotation.RequestParam;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:19:import org.springframework.web.bind.annotation.RestController;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-20-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-21-import reactor.core.scheduler.Schedulers;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-25-import software.amazon.awssdk.services.s3.model.GetObjectResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-26-import software.amazon.awssdk.services.s3.model.NoSuchBucketException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:27:import software.amazon.awssdk.services.s3.model.NoSuchKeyException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-28-import software.amazon.awssdk.services.s3.model.S3Exception;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-29-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-31-@ConditionalOnProperty(name = "aws.s3.enabled", havingValue = "true")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-32-public class CommonDataModelController {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:33:  private static final Logger logger = LoggerFactory.getLogger(CommonDataModelController.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:35:  private final S3Client s3Client;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:36:  private final AwsS3Configuration s3Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:37:  private final ObjectMapper objectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:38:  private final LaunchDarklyService launchDarklyService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:39:  private final CredentialStoreService credentialStoreService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-41-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-55-  @GetMapping(value = "/apigw/v1/cdm", produces = "application/json")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:56:  public Mono<ResponseEntity<String>> getCommonDataModel(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:57:      @RequestParam(value = "t") String tenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:58:      @RequestHeader(value = "Prefer") String preferHeader,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:59:      @RequestHeader(value = "sap-cflp-callback-token") String callbackToken,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-60-      @RequestParam(value = "$top", required = false) Integer top) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-61-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-79-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-80-    logger.info(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:81:        "Retrieving CDM data from S3 bucket: {}, key: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-82-        s3Configuration.getBucketName(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:83:        s3Configuration.getCdmObjectKey());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-85-    return Mono.fromCallable(this::fetchCdmFromS3)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-92-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:94:  private String fetchCdmFromS3() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-95-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-96-      GetObjectRequest getObjectRequest =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-97-          GetObjectRequest.builder()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-98-              .bucket(s3Configuration.getBucketName())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:99:              .key(s3Configuration.getCdmObjectKey())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-100-              .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-101-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-102-      try (ResponseInputStream<GetObjectResponse> s3Object = s3Client.getObject(getObjectRequest)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:103:        return new String(s3Object.readAllBytes());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-104-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-105-    } catch (Exception e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-109-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-110-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:111:  private Mono<ResponseEntity<String>> validateAndReturnJson(String content) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-112-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-113-      objectMapper.readTree(content);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-120-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-121-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:122:  private Mono<ResponseEntity<String>> handleTokenRotation(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:123:      String tenantId, String preferHeader, String callbackToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:124:    String emptyResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-125-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-126-      emptyResponse = createEmptyODataResponse();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-133-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-134-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:135:  private String createEmptyODataResponse() throws JsonProcessingException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-136-    ODataResponseDto emptyResponse = new ODataResponseDto();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:137:    return objectMapper.writeValueAsString(emptyResponse);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-138-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-139-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:140:  private Mono<ResponseEntity<String>> sendTokenAndCallbackUrlToCredStore(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:141:      ResponseEntity<String> response, String tenantId, String preferHeader, String callbackToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-142-    return storeTokenAndReturnResponse(response.getBody(), tenantId, preferHeader, callbackToken);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-143-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-144-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:145:  private Mono<ResponseEntity<String>> storeTokenAndReturnResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:146:      String responseBody, String tenantId, String preferHeader, String callbackToken) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-147-    // Extract callback URL from Prefer header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:148:    String callbackUrl = extractCallbackUrl(preferHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-149-    if (callbackUrl == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-150-      logger.debug("No valid callback URL found in Prefer header");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-164-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-165-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:166:  private String extractCallbackUrl(String preferHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-167-    if (!preferHeader.contains("url=")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-168-      return null;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-171-    int urlIndex = preferHeader.indexOf("url=");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-172-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:173:    String urlPart = preferHeader.substring(urlIndex + 4);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-174-    // Remove quotes if present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-175-    if (urlPart.startsWith("\"") && urlPart.contains("\"")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-176-      int endQuote = urlPart.indexOf("\"", 1);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-177-      if (endQuote > 0) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:178:        return urlPart.substring(1, endQuote);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-179-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-180-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-182-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-183-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:184:  private Mono<ResponseEntity<String>> handleError(Throwable e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-185-    if (e.getCause() instanceof NoSuchBucketException) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-186-      logger.error("S3 bucket not found: {}", s3Configuration.getBucketName(), e);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-188-          ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-189-              .body("CDM S3 bucket not found: " + e.getMessage()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:190:    } else if (e.getCause() instanceof NoSuchKeyException) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-191-      logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-192-          "CDM file not found in S3: {}/{}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-193-          s3Configuration.getBucketName(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java:194:          s3Configuration.getCdmObjectKey(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-195-          e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/CommonDataModelController.java-196-      return Mono.just(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-1-package com.sap.bpi.api.gw.filters.utils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:3:import static com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtClaims.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-5-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:6:import com.sap.bpi.api.gw.dto.SapJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-7-import com.sap.bpi.api.gw.filters.JsonWebToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:8:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:9:import com.signavio.jwt.JwtService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:10:import com.signavio.jwt.Token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-11-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:12:import io.jsonwebtoken.JwtException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:13:import io.jsonwebtoken.Jwts;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:14:import java.security.KeyPair;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-15-import java.time.Instant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-16-import java.util.Base64;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-19-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-20-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:21:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:22:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:23:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:24:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:25:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-27-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:28:public class JwtUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:29:  public static final String BEARER = "Bearer";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:30:  private final UgwJwtConfig jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:31:  private final Logger logger = LoggerFactory.getLogger(JwtUtils.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:32:  private final JwtService jwtService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:33:  private final ObjectMapper objectMapper = new ObjectMapper();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-35-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:36:  public JwtUtils(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:37:      @Value("${signavio.security.jwtSharedSecret}") String secret, UgwJwtConfig jwtConfig) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:38:    this.jwtConfig = jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:39:    this.jwtService = new JwtService(() -> secret);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-40-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:42:  public Optional<String> getTokenClaimValue(String jwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:43:    Claims jwtClaims = getUgwJwtClaims(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:44:    return Optional.ofNullable(jwtClaims.get(TOKEN_CLAIM)).map(Object::toString);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-45-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:47:  public Claims getUgwJwtClaims(String jwsString) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:48:    KeyPair keyPair = jwtConfig.getKeyPair();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:49:    Claims jws;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-50-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:51:      jws =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:52:          Jwts.parser()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:53:              .verifyWith(keyPair.getPublic())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-54-              .build()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:55:              .parseSignedClaims(jwsString)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-56-              .getPayload();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:57:    } catch (JwtException ex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:58:      logger.error("Parsing JWT claims failed: " + ex.getLocalizedMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-59-      throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, ex.getLocalizedMessage(), ex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-60-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:61:    return jws;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:64:  public JsonWebToken convertUgwJwtToSpmJwt(String ugwJwt, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:65:    Claims claims = getUgwJwtClaims(ugwJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:66:    JsonWebToken spmJwt =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-67-        new JsonWebToken(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:68:            (String) claims.get(TENANT_ID_CLAIM),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-69-            claims.getSubject(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:70:            (String) claims.get(USER_ID_CLAIM),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-71-            requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-72-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:73:    return spmJwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-74-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:76:  public List<String> getSpmAuthorizationHeaderAsASingletonList(JsonWebToken jwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:77:    String authHeader = jwtService.asAuthorizationHeader(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-78-    logger.debug("Created Authorization header with value: {}", authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-79-    return List.of(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-80-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-81-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:82:  public Optional<Token> getAndValidateSpmJwt(String authorizationHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:83:    return jwtService.fromAuthorizationHeader(authorizationHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-84-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-85-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:86:  public String getAuthorizationHeader(JsonWebToken jwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:87:    return jwtService.asAuthorizationHeader(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-88-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-89-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:90:  public static String decodeJwtPayload(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:91:    String[] chunks = token.split("\\.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-92-    Base64.Decoder decoder = Base64.getUrlDecoder();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:93:    return new String(decoder.decode(chunks[1]));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-94-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-95-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-96-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:97:   * Extract expiry time from JWT token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-98-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:99:   * @param jwt The JWT token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:100:   * @return Instant when the JWT expires
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:101:   * @throws IllegalArgumentException if the JWT format is invalid or missing expiry claim
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-102-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:103:  public static Instant getJwtExpiryTime(String jwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:104:    if (jwt == null || jwt.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:105:      throw new IllegalArgumentException("JWT cannot be null or empty");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-106-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-108-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:109:      String payload = decodeJwtPayload(jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-110-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-111-      // Simple extraction of exp claim
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-112-      if (payload.contains("\"exp\":")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:113:        String expString = payload.substring(payload.indexOf("\"exp\":") + 6);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:114:        int endIndex = expString.indexOf(',');
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:115:        if (endIndex < 0) endIndex = expString.indexOf('}');
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:116:        expString = expString.substring(0, endIndex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:117:        long expTimestamp = Long.parseLong(expString.trim());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-118-        return Instant.ofEpochSecond(expTimestamp);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-119-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-120-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:121:      throw new IllegalArgumentException("JWT does not contain an expiry claim");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-122-    } catch (IllegalArgumentException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-123-      // Re-throw with original message
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-124-      throw e;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-125-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:126:      throw new IllegalArgumentException("JWT payload has unexpected format", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-127-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-128-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-129-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-130-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:131:   * Check if a JWT token is an XSUAA JWT by looking for ext_attr.enhancer claim with value "XSUAA"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-132-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:133:   * @param token The JWT token to check
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:134:   * @return true if the token is an XSUAA JWT, false otherwise
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-135-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:136:  public static boolean isXsuaaJwt(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-137-    if (token == null || token.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-138-      return false;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-140-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-141-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:142:      String payload = decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-143-      // Check for ext_attr.enhancer claim with value "XSUAA"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-144-      return payload.contains("\"ext_attr\"")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-146-          && payload.contains("\"XSUAA\"");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-147-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:148:      // If we can't decode the JWT, it's not a valid XSUAA JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-149-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-150-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-152-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-153-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:154:   * Extracts the issuer claim ("iss") from a JWT token payload.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-155-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:156:   * <p>This method parses the JWT payload string to find and extract the issuer claim value.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-157-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:158:   * @param payload The decoded JWT payload as a JSON string
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-159-   * @return Optional containing the issuer value if found, empty otherwise
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-160-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:161:  private static Optional<String> extractIssuerFromPayload(String payload) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-162-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-163-      // Look for "iss":"<value>" pattern
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-180-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-181-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:182:      return Optional.of(payload.substring(issValueStart, issValueEnd));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-183-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-184-      return Optional.empty();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-187-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-188-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:189:   * Check if a JWT token is a UGW JWT by examining the issuer claim ("iss").
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-190-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:191:   * <p>UGW JWT is identified by an issuer that contains "bpi-api-gw" at the beginning (after
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:192:   * protocol) and ends with "signav.io".
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-193-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:194:   * <p>Example UGW issuer: "https://bpi-api-gw.eu-staging-cloud-os-eu.suite-saas-staging.signav.io"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-195-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:196:   * @param token The JWT token to check
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:197:   * @return true if the token is a UGW JWT, false otherwise
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-198-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:199:  public static boolean isUgwJwt(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-200-    if (token == null || token.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-201-      return false;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-203-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-204-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:205:      String payload = decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:206:      Optional<String> issuerOpt = extractIssuerFromPayload(payload);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-207-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-208-      if (issuerOpt.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-210-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-211-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:212:      String issuer = issuerOpt.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-213-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:214:      // Check if issuer contains "bpi-api-gw" after protocol and ends with "signav.io"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-215-      // Remove protocol prefix (http:// or https://)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:216:      String issuerWithoutProtocol = issuer.replaceFirst("^https?://", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-217-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:218:      return issuerWithoutProtocol.startsWith("bpi-api-gw") && issuer.endsWith("signav.io");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-219-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:220:      // If we can't decode the JWT payload, it's not a valid UGW JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-221-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-222-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-224-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-225-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:226:   * Checks if the JWT issuer is from BTP by verifying the issuer host ends with "ondemand.com".
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-227-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:228:   * <p>This is used to identify BTP-issued JWTs (e.g., IAS, XSUAA) by checking if the issuer URL
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-229-   * contains a host ending with "ondemand.com".
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-230-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:231:   * @param token The JWT token to check
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-232-   * @return true if the issuer is from BTP, false otherwise
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-233-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:234:  public static boolean isIssuerFromBtp(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-235-    if (token == null || token.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-236-      return false;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-238-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-239-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:240:      String payload = decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:241:      Optional<String> issuerOpt = extractIssuerFromPayload(payload);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-242-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-243-      if (issuerOpt.isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-245-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-246-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:247:      String issuer = issuerOpt.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-248-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-249-      // Check if issuer host ends with "ondemand.com" (BTP)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-250-      java.net.URL url = new java.net.URL(issuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:251:      String host = url.getHost();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-252-      return host.endsWith("ondemand.com");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-253-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:254:      // If we can't decode or parse the JWT, it's not a valid BTP JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-255-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-256-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-257-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-258-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:259:  public Optional<String> getExternalUserIdClaimValueFromJwt(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-260-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:261:      String payload = JwtUtils.decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:262:      SapJwtDto jwtDto = objectMapper.readValue(payload, SapJwtDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:263:      // Determine JWT type based on ext_attr field
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:264:      if (jwtDto.extraAttributes() != null && "XSUAA".equals(jwtDto.extraAttributes().enhancer())) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:265:        // XSUAA JWT - use user_uuid claim
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:266:        logger.debug("Detected XSUAA JWT, using user_uuid claim");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:267:        return Optional.ofNullable(jwtDto.userUuid());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-268-      } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:269:        // IAS JWT - use uid claim, fallback to user_uuid if uid is null
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:270:        if (jwtDto.uid() != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:271:          logger.debug("Detected IAS JWT, using uid claim");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:272:          return Optional.of(jwtDto.uid());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-273-        }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:274:        logger.debug("Detected IAS JWT, uid is null, using user_uuid claim as fallback");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:275:        return Optional.ofNullable(jwtDto.userUuid());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-276-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-277-    } catch (Exception ex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:278:      String errorMessage = "Failed to deserialize JWT";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-279-      logger.error(errorMessage, ex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-280-      throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, errorMessage, ex);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-282-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-283-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:284:  public Optional<String> getEmailClaimValueFromJwt(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-285-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:286:      String payload = JwtUtils.decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:287:      SapJwtDto xsuaaJwtDto = objectMapper.readValue(payload, SapJwtDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:288:      return Optional.ofNullable(xsuaaJwtDto.email());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-289-    } catch (Exception ex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java:290:      String errorMessage = "Failed to deserialize Xsuaa JWT";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-291-      logger.error(errorMessage, ex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtUtils.java-292-      throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, errorMessage, ex);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateCreationRequest.java:1:package com.sap.bpi.api.gw.dto.destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateCreationRequest.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateCreationRequest.java-3-import com.fasterxml.jackson.annotation.JsonInclude;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateCreationRequest.java-6-@JsonInclude(JsonInclude.Include.NON_NULL)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateCreationRequest.java-7-public record CertificateCreationRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateCreationRequest.java:8:    @JsonProperty("Name") String name,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateCreationRequest.java-9-    @JsonProperty("Attributes") CertificateAttributes attributes) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-3-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:4:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtClaims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:5:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-6-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-7-import java.util.ArrayList;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-9-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-10-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:11:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:12:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:13:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-14-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-15-import reactor.core.publisher.Mono;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-17-public class SpmRequestResponseFilterUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:19:  public static final String SET_COOKIE_HEADER = "Set-Cookie";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:20:  public static final String J_SESSION_ID = "JSESSIONID";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:21:  public static final String TOKEN_HEADER = "token";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:22:  private static final int TOKEN_START_INDEX = "token=".length();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:23:  private static final int TENANT_START_INDEX = "tenant=".length();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:24:  private static final int TOKEN_LENGTH = 38;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:25:  private static final int TENANT_LENGTH = 32;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:26:  public static final String TOKEN_VALUE_REGEX = "token=[A-Za-z0-9]+;.*";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:27:  // Signavio tenant ID is always a UUID without dashes, e.g. c05cea47f62244e0bf8335a73ebbcd4a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:28:  public static final String TENANT_VALUE_REGEX = "tenant=[A-Za-z0-9]+;.*";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:29:  public static final String X_FORWARDED_FOR_HEADER = "X-Forwarded-For";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:31:  @SuppressWarnings("PMD.AvoidReassigningLoopVariables")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:32:  public static List<String> modifySetCookieHeaders(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:33:      List<String> setCookieHeaders, String jws, String tokenValueRegex, Logger logger) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:34:    List<String> modifiedValues = new ArrayList<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:35:    for (String headerValue : setCookieHeaders) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-36-      if (headerValue.contains("token=")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:37:        headerValue = headerValue.replaceFirst(tokenValueRegex, "token=" + jws + ";");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:38:        logger.info("Replaced Set-Cookie header value with JWT");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-39-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-40-      modifiedValues.add(headerValue);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-43-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:45:  public static String generateJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:46:      SpmUser user, String opaqueToken, UgwJwtConfig jwtConfig, String baseUrl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-47-    Claims claims =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:48:        new UgwJwtClaims()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:49:            .withAudience(jwtConfig.getAudience())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-50-            .withSubject(user.email())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-51-            .withIssuer(baseUrl)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-54-            .withToken(opaqueToken)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-55-            .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:56:    return jwtConfig.generateSignedJwt(claims, baseUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:59:  public static void addJwtToHeader(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:60:      HttpHeaders headers, List<String> setCookieValues, String jwt, Logger logger) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:61:    List<String> modifiedSetCookieValues =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:62:        modifySetCookieHeaders(setCookieValues, jwt, TOKEN_VALUE_REGEX, logger);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-63-    headers.replace(SET_COOKIE_HEADER, modifiedSetCookieValues);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:64:    headers.replace(TOKEN_HEADER, List.of(jwt));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-65-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:67:  public static Optional<String> getToken(List<String> setCookieValues) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-68-    return setCookieValues.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-69-        .filter(value -> value.matches(TOKEN_VALUE_REGEX))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-70-        .findFirst()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:71:        .map(token -> token.substring(TOKEN_START_INDEX, TOKEN_LENGTH));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-72-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:74:  public static Optional<String> getTenant(List<String> setCookieValues) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-75-    return setCookieValues.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-76-        .filter(value -> value.matches(TENANT_VALUE_REGEX))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-77-        .findFirst()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:78:        .map(tenant -> tenant.substring(TENANT_START_INDEX, TENANT_START_INDEX + TENANT_LENGTH));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-80-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-83-   * [JSESSIONID=8DB67C241E899924BB449E8B18F2F446; Path=/; HttpOnly,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-84-   * token=d0d0ab2673744aa0aad6595d61fa6056; Path=/, identifier=Super+User; Path=/,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:85:   * login=admin%40signavio.com; Path=/]
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-86-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-87-   * @param setCookieValues cookie header as list
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-88-   * @return JSessionId
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-89-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:90:  public static Optional<String> getJSessionId(List<String> setCookieValues) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-91-    return setCookieValues.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-92-        .filter(value -> value.contains(J_SESSION_ID))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-95-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-96-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:97:  public static Mono<String> getXSignavioIdReactive(Mono<List<String>> setCookieValues) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-98-    return setCookieValues
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-99-        .flatMapMany(Flux::fromIterable)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-100-        .filter(value -> value.matches(TOKEN_VALUE_REGEX))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-101-        .next()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:102:        .map(token -> token.substring(TOKEN_START_INDEX, TOKEN_LENGTH))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-103-        .switchIfEmpty(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-104-            Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-105-                new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:106:                    HttpStatus.UNAUTHORIZED, "Missing X-Signavio-Id in header")));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-107-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-108-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java:109:  public static Mono<String> getJSessionIdReactive(Mono<List<String>> setCookieHeaders) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-110-    return setCookieHeaders
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/SpmRequestResponseFilterUtils.java-111-        .flatMapMany(Flux::fromIterable)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-3-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:4: * Is the wrapper for all content security policy sandbox keywords.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-5- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-6- * <p>Documentation taken from <a
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-8- * web docs</a>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-9- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:10:public enum SandboxKeyword implements CspKeyword {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-11-  /** Allows to set an empty sandbox */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-12-  ALL(""),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-13-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:14:   * Allows the embedded browsing context to submit forms. If this keyword is not used, this
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-15-   * operation is not allowed.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-16-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-23-  ALLOW_POINTER_LOCK("allow-pointer-lock"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-24-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:25:   * Allows popups (like from window.open, target="_blank", showModalDialog). If this keyword is not
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-26-   * used, that functionality will silently fail.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-27-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-36-  ALLOW_PRESENTATION("allow-presentation"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-37-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:38:   * Allows the content to be treated as being from its normal origin. If this keyword is not used,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-39-   * the embedded content is treated as being from a unique origin.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-40-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-42-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-43-   * Allows the embedded browsing context to run scripts (but not create pop-up windows). If this
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:44:   * keyword is not used, this operation is not allowed.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-45-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-46-  ALLOW_SCRIPTS("allow-scripts"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-47-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-48-   * Allows the embedded browsing context to navigate (load) content to the top-level browsing
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:49:   * context. If this keyword is not used, this operation is not allowed.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-50-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-51-  ALLOW_TOP_NAVIGATION("allow-top-navigation");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:53:  private final String asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:55:  SandboxKeyword(String asString) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:56:    this.asString = asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-59-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:60:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java:61:    return asString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SandboxKeyword.java-63-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-1-package com.sap.bpi.api.gw.filters.utils.csp;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:3:import static com.sap.bpi.api.gw.filters.utils.csp.CspDirectiveType.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-5-import java.util.Map;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-8-public class CspModifier {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-9-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:10:  private Map<CspDirectiveType, SourceList> directives;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:11:  private ContentSecurityPolicyBuilder builder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-13-  public CspModifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:14:      Map<CspDirectiveType, SourceList> directives, ContentSecurityPolicyBuilder builder) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:15:    this.directives = directives;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-16-    this.builder = builder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-17-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-19-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:20:   * Moves the source list from {@code source} to {@code destination} directive. If the {@code
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:21:   * destination} does already contain source list items, they are kept and the items from {@code
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-22-   * source} are added.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-23-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-24-   * @param source Takes the source list items from here
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:25:   * @param directiveTo Moves the source list items to here
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-26-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:27:  public CspModifier move(CspDirectiveType source, CspDirectiveType directiveTo) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:28:    SourceList sourceSourceList = directives.remove(source);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-29-    if (sourceSourceList == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-30-      return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-31-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:33:    SourceList destinationSourceList = directives.get(directiveTo);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:34:    if (destinationSourceList == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:35:      directives.put(directiveTo, sourceSourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-36-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:37:      destinationSourceList.add(sourceSourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-38-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-39-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-44-   * Modifies the report uri if it exists.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-45-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:46:   * <p>Pass in a function that takes a string (the old value of report-uri) and returns the new
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-47-   * value. In case the new value is null, the report-uri will be removed.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-48-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-49-   * @param reportUriModifier A function that defines the modification of the report-uri
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-50-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:51:  public CspModifier adjustReportUriIfExists(Function<String, String> reportUriModifier) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:52:    SourceList report = directives.get(CspDirectiveType.REPORT_URI);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-53-    if (report != null && report.hasContent()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:54:      String newUri = reportUriModifier.apply(report.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-55-      builder.reportUri(newUri);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-56-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-60-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:61:   * Adds new entries to the script-src directive.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-62-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-63-   * @param appendingSourceList new entries to add
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-64-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-65-  public CspModifier appendScriptSrc(SourceList appendingSourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:66:    appendToDirective(SCRIPT_SRC, appendingSourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-67-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-68-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-70-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:71:   * Adds new entries to the frame-src directive.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-72-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-73-   * @param appendingSourceList new entries to add
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-74-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-75-  public CspModifier appendFrameSrc(SourceList appendingSourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:76:    appendToDirective(FRAME_SRC, appendingSourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-77-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-78-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-79-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:80:  public CspModifier appendMissingIfDirectiveExists(CspDirectiveType type, SourceList list) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:81:    directives.computeIfPresent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-82-        type,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:83:        (key, sources) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:84:          var sourcesStr = sources.toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-85-          list.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-86-              .filter(entry -> !sourcesStr.contains(entry))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-92-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-93-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:94:   * Adds new entries to the child-src directive.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-95-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-96-   * @param appendingSourceList new entries to add
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-97-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-98-  public CspModifier appendChildSrc(SourceList appendingSourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:99:    appendToDirective(CHILD_SRC, appendingSourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-100-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-101-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-102-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-103-  public CspModifier appendFrameAncestorsSrc(SourceList appendingSourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:104:    appendToDirective(FRAME_ANCESTORS, appendingSourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-105-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-106-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:108:  private void appendToDirective(CspDirectiveType directive, SourceList appendingSourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-109-    if (appendingSourceList == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-110-      return;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-111-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:113:    SourceList oldSrcList = directives.get(directive);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-114-    if (oldSrcList == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-115-      oldSrcList = new SourceList();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:116:      directives.put(directive, oldSrcList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-117-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-118-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-124-      return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-125-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:126:    SourceList scriptSource = directives.get(SCRIPT_SRC);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-127-    scriptSource.remove(sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-128-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-129-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-130-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:131:  public CspModifier remove(CspDirectiveType type) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java:132:    directives.remove(type);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-133-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspModifier.java-134-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-3-import static com.sap.bpi.api.gw.filters.ApprovalsGatewayFilterFactory.APPROVALS_ORG_ID_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:4:import static com.sap.bpi.api.gw.filters.SpmTokenToSpmJwtFilterFactory.X_FORWARDED_FOR;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:5:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getRequestIdFromHeaderOrGenerate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-7-import com.sap.bpi.api.gw.dto.SpgUser;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-9-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-10-import com.sap.bpi.api.gw.filters.utils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:11:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-12-import com.sap.bpi.api.gw.services.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-13-import java.util.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-14-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-15-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:16:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:17:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:18:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:19:import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:20:import org.springframework.http.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:21:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:22:import org.springframework.http.server.reactive.ServerHttpResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:23:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:24:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:25:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-26-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-27-import reactor.util.function.Tuple2;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-29-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:30:public class SpgTokenToUgwJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:31:    extends AbstractGatewayFilterFactory<SpgTokenToUgwJwtFilterFactory.Config> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:33:  private final Logger logger = LoggerFactory.getLogger(SpgTokenToUgwJwtFilterFactory.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:35:  private final UgwJwtConfig jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:36:  private final JwtUtils jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:37:  private final SpgService spgService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:38:  private final SpmService spmService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-40-  @Value("${server.base-url}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:41:  private String baseUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-43-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:44:  public SpgTokenToUgwJwtFilterFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:45:      UgwJwtConfig jwtConfig, JwtUtils jwtUtils, SpgService spgService, SpmService spmService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-46-    // In order to initialize the factory, we need to pass the Config class to the super
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-47-    // constructor.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:48:    // This allows Spring to automatically convert the configuration provided in YAML format into
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-49-    // the appropriate Config object and use it with the filter. ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:50:    // https://medium.com/@jayaramanan.kumar/getting-started-with-spring-cloud-gateway-part-two-c611c5877a08
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-51-    super(Config.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:52:    this.jwtConfig = jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:53:    this.jwtUtils = jwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-54-    this.spgService = spgService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-55-    this.spmService = spmService;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-63-          .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-64-              token -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:65:                String organizationKey = getAttribute(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:66:                String xForwardedFor = request.getHeaders().getFirst(X_FORWARDED_FOR);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:67:                String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-68-                SpgRequestContext context =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-69-                    new SpgRequestContext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:70:                        token, request, exchange, chain, organizationKey, xForwardedFor, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-71-                return processSpgRequest(context);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-72-              })
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-75-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-76-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:77:  private String getAttribute(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-78-    if (exchange.getAttribute(APPROVALS_ORG_ID_ATTRIBUTE) == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-79-      throw new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:80:          HttpStatus.BAD_REQUEST, "Missing organization key in the request path");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-81-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:82:    String orgId = exchange.getAttribute(APPROVALS_ORG_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-83-    exchange.getAttributes().remove(APPROVALS_ORG_ID_ATTRIBUTE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-84-    return orgId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-85-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:87:  private Mono<Void> processSpgRequest(SpgRequestContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-88-    Mono<SpgUser> userMono =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:89:        spgService.getUserDetailsFromSpg(context.spgToken(), context.organizationKey());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:90:    return sendRequestWithUgwJwtContainingSpmUserId(userMono, context);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-91-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-92-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:93:  private Mono<Void> sendRequestWithUgwJwtContainingSpmUserId(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-94-      Mono<SpgUser> userMono, SpgRequestContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-95-    return userMono
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-96-        .zipWhen(spgUser -> getSpmUser(spgUser, context.xForwardedFor(), context.requestId()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:97:        .flatMap(tuple -> sendRequestWithUgwJwtContainingSpmUserId(tuple, context))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-98-        .doOnError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-99-            error ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-100-                logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:101:                    "Error while replacing response token with SPM JWT: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-102-                    error.getMessage(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-103-                    error));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-104-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-105-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:106:  private Mono<Void> sendRequestWithUgwJwtContainingSpmUserId(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-107-      Tuple2<SpgUser, SpmUser> tuple, SpgRequestContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-108-    SpmUser spmUser = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:109:    String ugwJwt =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:110:        SpmRequestResponseFilterUtils.generateJwt(spmUser, context.spgToken(), jwtConfig, baseUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-111-    ServerHttpRequest.Builder requestBuild =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:112:        context.request().mutate().header(HttpHeaders.AUTHORIZATION, "Bearer " + ugwJwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-113-    return context
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-114-        .chain()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-116-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:118:  private Mono<SpmUser> getSpmUser(SpgUser spgUser, String xForwardedFor, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-119-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:120:    JsonWebToken spmJwt = new JsonWebToken(spgUser.tenantId(), spgUser.email(), requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:121:    String smpJwtString = jwtUtils.getSpmAuthorizationHeaderAsASingletonList(spmJwt).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:122:    return spmService.getUserDetailsFromSpmWithSpmJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:123:        smpJwtString, xForwardedFor, Collections.singleton(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-124-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-125-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:126:  private Mono<String> getSpgTokenIfPresent(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:127:    final Optional<String> cookie =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-128-        request
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-129-            .getCookies()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-136-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-137-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:138:    final Optional<String> header =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-139-        request
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-140-            .getHeaders()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-150-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-151-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java:152:  private Mono<Void> handleException(ResponseStatusException ex, ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-153-    logger.error(ex.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/SpgTokenToUgwJwtFilterFactory.java-154-    ServerHttpResponse response = exchange.getResponse();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-7-  DATASPEHERE_SUBJECT_AND_TENANT_LOGGING(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-8-      "config-enable-datasphere-logging", "Log incoming Datasphere subject and tenant ID"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:9:  XSUAA_JWT_AUDIENCE_VALIDATION(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:10:      "config-enable-xsuaa-jwt-audience-validation", "XSUAA JWT Audience Validation"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:11:  TENANT_SERVICE_SHORT_LIVED_CERTIFICATE(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:12:      "config-enable-certficate-short-lived-check-in-tenant-service-authorization-manager",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:13:      "Tenant Service short-lived check"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-14-  REDIRECT_TO_LOGIN(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-15-      "config-enable-authentication-header-not-present-matcher",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-19-      "config-enable-ips-tenants-service-configuration",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-20-      "Enable IPS Tenants service configuration");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:21:  private final String key;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:22:  private final String featurePhrase;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:24:  LaunchDarklyFeatureFlag(String flagKey, String featurePhrase) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:25:    this.key = flagKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-26-    this.featurePhrase = featurePhrase;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-27-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:29:  public String getKey() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:30:    return key;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java:33:  public String getFeaturePhrase() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-34-    return featurePhrase;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/LaunchDarklyFeatureFlag.java-35-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-4-import java.util.stream.Collectors;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-5-import java.util.stream.Stream;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:6:import org.apache.commons.lang3.StringUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-8-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:9: * Builder for source lists. Accepts {@link Keyword} as well as String sources. For more info about
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-10- * source lists and content security policies check {@link ContentSecurityPolicyBuilder}.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-11- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:12:public class SourceList implements Iterable<String> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:14:  private List<String> sources = new ArrayList<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:16:  private SourceList(List<String> sources) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-17-    this.sources = sources;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-18-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-23-   * Accepts urls to build {@link ContentSecurityPolicy}.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-24-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:25:   * @param urls any urls as string
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-26-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:27:  public SourceList urls(String... urls) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-28-    sources.addAll(Arrays.asList(urls));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-29-    return this;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-32-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:33:   * Accepts a nonce to build {@link ContentSecurityPolicy} Will result in {@code
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:34:   * 'nonce-<base64-encoded-string>'} when given null, will not add a nonce tag.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-35-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:36:   * @param nonce your nonce should be a Base64 encoded String.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-37-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:38:  public SourceList nonce(String nonce) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:39:    Optional.ofNullable(nonce).ifPresent(nonceString -> sources.add("'nonce-" + nonceString + "'"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-40-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-41-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-48-  SourceList remove(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:49:    for (String source : sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-50-      sources.remove(source);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-51-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-59-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:60:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:61:    return String.join(" ", sources);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-64-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:65:  public Iterator<String> iterator() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-66-    return sources.iterator();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-67-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:69:  public Stream<String> stream() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-70-    return sources.stream();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-71-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-72-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-73-  public boolean hasContent() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:74:    return sources.stream().anyMatch(StringUtils::isNotBlank);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-75-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-76-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-77-  public static class Builder {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-78-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:79:    public static SourceList nonce(String nonce) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:80:      return new SourceList().nonce(nonce);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-81-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-82-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:83:    public static SourceList urls(String... urls) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-84-      return new SourceList(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-85-          Arrays.stream(urls)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:86:              .filter(StringUtils::isNotBlank)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:87:              .map(String::trim)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-88-              .collect(Collectors.toList()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-89-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:91:    public static SourceList keywords(CspKeyword... keywords) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-92-      return new SourceList(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java:93:          Arrays.stream(keywords).map(CspKeyword::toString).collect(Collectors.toList()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-94-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/SourceList.java-95-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-7-public enum RequestOrigin {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-8-  DATASPHERE("datasphere"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java:9:  CONNECTIVITY_PLATFORM("connectivityPlatform"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-10-  IPS("ips"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-11-  JOULE("joule"),
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-14-  UGW("ugw");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java:16:  private final String callingService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java:18:  RequestOrigin(String callingService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-19-    this.callingService = callingService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-20-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-22-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java:23:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-24-    return callingService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/RequestOrigin.java-25-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientLocalFactory.java-1-package com.sap.bpi.api.gw.global;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientLocalFactory.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientLocalFactory.java:3:import com.signavio.als.AuditLogClientConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientLocalFactory.java:4:import com.signavio.als.AuditLogClientFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientLocalFactory.java:5:import com.signavio.als.AuditLogErrorHandlingClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientLocalFactory.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/global/AuditLogClientLocalFactory.java-7-public class AuditLogClientLocalFactory extends AuditLogClientFactory {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-6-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-7-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:8:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:9:import org.springframework.cloud.circuitbreaker.resilience4j.ReactiveResilience4JCircuitBreakerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:10:import org.springframework.cloud.circuitbreaker.resilience4j.Resilience4JConfigBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:11:import org.springframework.cloud.client.circuitbreaker.Customizer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:12:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:13:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-15-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-16-public class CircuitBreakerConfiguration {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:18:  private final Logger logger = LoggerFactory.getLogger(CircuitBreakerConfiguration.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-20-  @Value("${feature.circuitBreaker.timeoutInSeconds}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:21:  private Long timeOutDurationInSeconds;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-23-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java:24:  public Customizer<ReactiveResilience4JCircuitBreakerFactory> defaultCustomizer() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-25-    logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CircuitBreakerConfiguration.java-26-        "Circuit Breaker Default Customizer: TimeOutDurationInSeconds={}",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java:1:package com.sap.bpi.api.gw.dto.destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java-3-import com.fasterxml.jackson.annotation.JsonProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java-5-public record OauthTokenResponseDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java:6:    @JsonProperty("access_token") String accessToken,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java:7:    @JsonProperty("id_token") String idToken,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java:8:    @JsonProperty("token_type") String tokenType,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java-9-    @JsonProperty("expires_in") Integer expiresIn,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java:10:    @JsonProperty("scope") String scope,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/OauthTokenResponseDto.java:11:    @JsonProperty("jti") String jti) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-1-package com.sap.bpi.api.gw.configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:3:import static com.fasterxml.jackson.databind.DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-5-import com.fasterxml.jackson.databind.JavaType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-6-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-7-import com.fasterxml.jackson.databind.type.TypeFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:8:import com.sap.bpi.api.gw.dto.PublicKeyListDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-9-import com.sap.bpi.api.gw.dto.SpmUser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-10-import com.sap.bpi.api.gw.dto.tenant.IpsConfigurationDto;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-12-import com.sap.bpi.api.gw.dto.tenant.spm.SpmConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-13-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:14:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:15:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:16:import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:17:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:18:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:19:import org.springframework.data.redis.connection.ReactiveRedisConnectionFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:20:import org.springframework.data.redis.connection.RedisStandaloneConfiguration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:21:import org.springframework.data.redis.connection.lettuce.LettuceClientConfiguration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:22:import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:23:import org.springframework.data.redis.core.ReactiveRedisOperations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:24:import org.springframework.data.redis.core.ReactiveRedisTemplate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:25:import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:26:import org.springframework.data.redis.serializer.RedisSerializationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:27:import org.springframework.data.redis.serializer.StringRedisSerializer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-29-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-30- * Establishes a connection to SPM Redis to retrieve previously cached SPM user information, /token,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:31: * or /keys responses
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-32- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-33-@Configuration
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-37-  @Value("${redis.host}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:38:  private String redisHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-40-  @Value("${redis.port}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:41:  private Integer redisPort;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-43-  @Value("${redis.password}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:44:  private String redisPassword;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:46:  @Value("${redis.sslEnabled}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:47:  private boolean isSslEnabled;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-49-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:50:  public ReactiveRedisConnectionFactory redisConnectionFactory() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-51-    RedisStandaloneConfiguration redisStandaloneConfiguration = new RedisStandaloneConfiguration();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-52-    redisStandaloneConfiguration.setHostName(redisHost);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-53-    redisStandaloneConfiguration.setPort(redisPort);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:54:    if (isSslEnabled) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-55-      redisStandaloneConfiguration.setPassword(redisPassword);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:56:      return buildSslRedisConnectionFactory(redisStandaloneConfiguration);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-57-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-58-    return new LettuceConnectionFactory(redisStandaloneConfiguration);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-59-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:61:  private LettuceConnectionFactory buildSslRedisConnectionFactory(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-62-      RedisStandaloneConfiguration redisStandaloneConfiguration) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-63-    LettuceClientConfiguration lettuceClientConfiguration =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:64:        LettuceClientConfiguration.builder().useSsl().build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-65-    return new LettuceConnectionFactory(redisStandaloneConfiguration, lettuceClientConfiguration);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-66-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-67-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:68:  private <T> ReactiveRedisTemplate<String, List<T>> createReactiveRedisTemplate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:69:      ReactiveRedisConnectionFactory factory, Class<T> dtoClass) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-71-    ObjectMapper objectMapper = new ObjectMapper().configure(FAIL_ON_UNKNOWN_PROPERTIES, false);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-76-        new Jackson2JsonRedisSerializer<>(objectMapper, javaType);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:78:    return reactiveRedisTemplate(factory, valueSerializer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:81:  private <T> ReactiveRedisTemplate<String, T> createReactiveRedisTemplateForIps(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:82:      ReactiveRedisConnectionFactory factory, Class<T> dtoClass) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-84-    ObjectMapper objectMapper = new ObjectMapper().configure(FAIL_ON_UNKNOWN_PROPERTIES, false);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-86-        new Jackson2JsonRedisSerializer<>(objectMapper, dtoClass);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:88:    return reactiveRedisTemplate(factory, valueSerializer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-89-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-91-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-92-  @Qualifier("spmRedisTemplate")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:93:  public ReactiveRedisTemplate<String, List<SpmConfigurationDto>>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:94:      reactiveRedisTemplateForSpmConfiguration(ReactiveRedisConnectionFactory factory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:95:    return createReactiveRedisTemplate(factory, SpmConfigurationDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-96-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-98-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-99-  @Qualifier("tenantsRedisTemplate")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:100:  public ReactiveRedisTemplate<String, IpsConfigurationDto>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:101:      reactiveRedisTemplateForIpsConfiguration(ReactiveRedisConnectionFactory factory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:102:    return createReactiveRedisTemplateForIps(factory, IpsConfigurationDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-103-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-104-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-105-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-106-  @Qualifier("insightsCentralRedisTemplate")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:107:  public ReactiveRedisTemplate<String, List<InsightsCentralConfigurationDto>>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:108:      reactiveRedisTemplateForInsightsCentralConfiguration(ReactiveRedisConnectionFactory factory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:109:    return createReactiveRedisTemplate(factory, InsightsCentralConfigurationDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-110-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-111-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-112-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:113:  public ReactiveRedisOperations<String, PublicKeyListDto> redisOperationsPublicKeyListDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:114:      ReactiveRedisConnectionFactory factory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:115:    Jackson2JsonRedisSerializer<PublicKeyListDto> serializer =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:116:        new Jackson2JsonRedisSerializer<>(PublicKeyListDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:118:    return reactiveRedisTemplate(factory, serializer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-119-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-120-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-121-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:122:  public ReactiveRedisOperations<String, SpmUser> redisOperationsUserDetails(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:123:      ReactiveRedisConnectionFactory factory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-124-    Jackson2JsonRedisSerializer<SpmUser> serializer =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-125-        new Jackson2JsonRedisSerializer<>(SpmUser.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:127:    return reactiveRedisTemplate(factory, serializer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-128-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-129-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-130-  @Bean
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:131:  @Qualifier("xsuaaJwtRedisTemplate")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:132:  public ReactiveRedisOperations<String, String> redisOperationsXsuaaJwt(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:133:      ReactiveRedisConnectionFactory factory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:134:    return new ReactiveRedisTemplate<>(factory, RedisSerializationContext.string());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-135-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-136-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:137:  private <T> ReactiveRedisTemplate<String, T> reactiveRedisTemplate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:138:      ReactiveRedisConnectionFactory factory, Jackson2JsonRedisSerializer<T> serializer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-139-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:140:    RedisSerializationContext.RedisSerializationContextBuilder<String, T> builder =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:141:        RedisSerializationContext.newSerializationContext(new StringRedisSerializer());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-142-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:143:    RedisSerializationContext<String, T> context = builder.value(serializer).build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-144-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java:145:    return new ReactiveRedisTemplate<>(factory, context);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-146-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/RedisConfiguration.java-147-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-8-      new ContentSecurityPolicyCompatHeader(HttpHeaders.X_FRAME_OPTIONS, "DENY");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-9-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java:10:  private final String key;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java:11:  private final String value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java:13:  public ContentSecurityPolicyCompatHeader(String key, String value) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java:14:    this.key = key;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-15-    this.value = value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-16-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java:18:  public String getKey() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java:19:    return key;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-20-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java:22:  public String getValue() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-23-    return value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyCompatHeader.java-24-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-5-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-6-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:7:import org.springframework.cloud.gateway.config.HttpClientCustomizer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:8:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-9-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-10-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-11-public class CustomHttpClientConfiguration {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:13:  private static final Logger logger = LoggerFactory.getLogger(CustomHttpClientConfiguration.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-15-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-26-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:28:  public static String removeQueryParams(String requestUri) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-29-    // Split the URI at the first occurrence of '?'
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:30:    String[] parts = requestUri.split("\\?", 2);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-31-    // Return the part before the '?'
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-32-    return parts[0];
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-41-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-42-   * <p>Examples: - https://746009914.jupiter.prod-eu10.orbit.sig-conn.on.dwc.tools.sap/api/resource
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:43:   * -> https://{connectivity-platform} - https://spm.signavio.com/api/v2/users/123abc ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-44-   * https://{spm}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-45-   *
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-47-   * @return sanitized URI suitable for metrics tags (scheme + generic host only)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-48-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:49:  public static String sanitizeUriForMetrics(String requestUri) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-50-    if (requestUri == null || requestUri.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-51-      return requestUri;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-54-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-55-      // Remove query parameters first
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:56:      String uriWithoutQuery = removeQueryParams(requestUri);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-58-      // Parse the URI
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-61-      // Get the host and determine service type
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:62:      String host = uri.getHost();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:63:      String sanitizedHost = sanitizeHost(host);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-64-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-65-      // Reconstruct the URI with only scheme and sanitized host (no path)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:66:      String scheme = uri.getScheme() != null ? uri.getScheme() : "https";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-67-      return scheme + "://" + sanitizedHost;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-68-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-76-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:77:   * Sanitizes the hostname to a generic service identifier. This is the key to reducing metrics
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-78-   * cardinality as tenant-specific subdomains are replaced with generic placeholders.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-79-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-80-   * <p>Examples: - 746009914.jupiter.prod-eu10.orbit.sig-conn.on.dwc.tools.sap ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:81:   * {connectivity-platform} - spm.signavio.com -> {spm} - tenant-123.app.example.com ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-82-   * {app-service}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-83-   *
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-85-   * @return generic service identifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-86-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:87:  public static String sanitizeHost(String host) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-88-    if (host == null || host.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-89-      return "{service}";
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-91-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-92-    // Convert to lowercase for consistent matching
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:93:    String lowerHost = host.toLowerCase();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-94-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-95-    // Match known service patterns and return generic identifiers
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-96-    // This prevents tenant-specific subdomains from creating unique metrics
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:98:    // Connectivity Platform (SAP Datasphere)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-99-    // Pattern: <tenant-id>.jupiter.<env>.orbit.sig-conn.on.dwc.tools.sap
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-100-    if (lowerHost.contains("jupiter") && lowerHost.contains("dwc.tools.sap")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:101:      return "{connectivity-platform}";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-102-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-103-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:104:    // SPM (Signavio Process Manager)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:105:    if (lowerHost.contains("spm") || lowerHost.contains("signavio")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-106-      return "{spm}";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-107-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-127-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-128-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:129:    // Destination Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:130:    if (lowerHost.contains("destination")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:131:      return "{destination-service}";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-132-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-133-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-137-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-138-  /** Legacy method for backward compatibility. Replaces UUIDs in URI. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:139:  public static String replaceUUIDsInUri(String requestUri) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-140-    // Regex pattern for UUIDs (both with and without hyphens)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:141:    String uuidPattern =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-142-        "\\b[0-9a-fA-F]{8}\\b(?:-[0-9a-fA-F]{4}){3}\\b-[0-9a-fA-F]{12}\\b|\\b[0-9a-fA-F]{32}\\b";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java:143:    String uriWithoutQueryParams = removeQueryParams(requestUri);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-144-    return uriWithoutQueryParams.replaceAll(uuidPattern, "{id}");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/CustomHttpClientConfiguration.java-145-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-1-package com.sap.bpi.api.gw.security.certificate.utils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.X_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-4-import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getSourceIpsFromHttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-5-import static com.sap.bpi.api.gw.filters.utils.FilterUtils.getSourceIpsFromLowerCaseHeadersMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:6:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:7:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_USER_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-9-import com.sap.bpi.api.gw.configuration.TenantServiceConfig;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-22-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-23-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:24:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:25:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:26:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:27:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:28:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-29-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-31-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-32-public class CertificateValidator {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:33:  private static final Logger logger = LoggerFactory.getLogger(CertificateValidator.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:35:  private final int certificateLifetimeHours;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:36:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-38-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-46-  public Mono<AuthorizationDecision> validateSubject(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:47:      Map<String, List<String>> lowerCaseHttpHeadersMap,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-48-      RequestOrigin requestOrigin,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:49:      String... trustedSubjects) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-50-    return getSubjectFromHeader(lowerCaseHttpHeadersMap)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-51-        .map(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:59:  public Optional<String> extractDatasphereTenantIdFromSubject(String subject) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:60:    String tenantId = null;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-61-    Pattern pattern = Pattern.compile("L=([^_]+)_TENANT");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-62-    Matcher matcher = pattern.matcher(subject);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-68-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:70:  public Optional<String> getSubjectFromHeader(Map<String, List<String>> lowerCaseHttpHeadersMap) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-71-    return Optional.ofNullable(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-72-            lowerCaseHttpHeadersMap.get(RequestWithCertificateHeader.SUBJECT.getHeaderName()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-76-  public Mono<AuthorizationDecision> handleMissingSubject(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:77:      Map<String, List<String>> lowerCaseHttpHeadersMap, RequestOrigin requestOrigin) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-78-    return handleValidationError(lowerCaseHttpHeadersMap, requestOrigin);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-81-  public Mono<AuthorizationDecision> handleUntrustedSubject(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:82:      String subject,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:83:      Map<String, List<String>> lowerCaseHttpHeadersMap,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-84-      RequestOrigin requestOrigin) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-85-    return handleValidationError(lowerCaseHttpHeadersMap, requestOrigin);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-86-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:88:  private Mono<AuthorizationDecision> handleValidationError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:89:      Map<String, List<String>> lowerCaseHttpHeadersMap, RequestOrigin requestOrigin) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:90:    String errorMsg =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-91-        "Certificate validation failed due to a missing or invalid subject. For details see audit"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-92-            + " log";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-93-    logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-94-    var sourceIps = getSourceIpsFromLowerCaseHeadersMap(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:95:    String tenantId = getHeaderValueSafely(lowerCaseHttpHeadersMap, X_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:96:    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, requestOrigin.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-97-    return Mono.just(new AuthorizationDecision(false));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-98-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-100-  public Mono<AuthorizationDecision> handleMissingDatasphereTenant(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:101:      Map<String, List<String>> lowerCaseHttpHeadersMap) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-102-    logger.error("Certificate validation failed due to a missing Datasphere tenant");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-103-    var sourceIps = getSourceIpsFromLowerCaseHeadersMap(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:104:    String tenantId = getHeaderValueSafely(lowerCaseHttpHeadersMap, X_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-105-    auditLogClientManager.logUnauthorizedAccess(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:106:        tenantId, sourceIps, RequestOrigin.DATASPHERE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-107-    return Mono.just(new AuthorizationDecision(false));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-108-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-109-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-110-  public Mono<AuthorizationDecision> handleWrongDatasphereTenantId(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:111:      Map<String, List<String>> lowerCaseHttpHeadersMap) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-112-    var sourceIps = getSourceIpsFromLowerCaseHeadersMap(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:113:    String tenantId = getHeaderValueSafely(lowerCaseHttpHeadersMap, X_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-114-    logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-115-        "Certificate validation failed due to mismatch of Datasphere tenant ID. For details see"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-116-            + " audit log.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-117-    auditLogClientManager.logUnauthorizedAccess(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:118:        tenantId, sourceIps, RequestOrigin.DATASPHERE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-119-    return Mono.just(new AuthorizationDecision(false));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-120-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-121-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-122-  public boolean isSubjectValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:123:      List<Set<String>> storedSubjectArray, Set<String> subjectFromHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-124-    return storedSubjectArray.contains(subjectFromHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-125-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:127:  public boolean isSubjectValid(Set<String> storedSubject, Set<String> subjectFromHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-128-    return storedSubject.equals(subjectFromHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-129-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-130-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:131:  public boolean isIssuerValid(List<Set<String>> storedIssuerArray, Set<String> issuerFromHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-132-    return storedIssuerArray.contains(issuerFromHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-133-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-134-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:135:  public boolean isShortLivedCertificate(String certificateHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-136-    X509Certificate certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-137-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:138:      String encodedCert = getCertificateFromHeader(certificateHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-139-      certificate = getX509CertificateFromEncodedCertificate(encodedCert);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-140-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:141:      String errorMsg = "Certificate header can not be parsed";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-142-      logger.error("{} - {}: {}", errorMsg, e.getClass(), e.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-143-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-144-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-145-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:146:    boolean isShortLived = isShortLived(certificate);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-147-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:148:    if (!isShortLived) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:149:      String errorMsg = "Certificate validation failed due to not short-lived certificate";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-150-      logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-151-      return false;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-154-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-155-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:156:  private boolean isShortLived(X509Certificate certificate) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-157-    Date notBefore = certificate.getNotBefore();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-158-    Date notAfter = certificate.getNotAfter();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-168-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-169-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:170:  public X509Certificate getX509CertificateFromEncodedCertificate(String encodedCertificate)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-171-      throws CertificateException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-172-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-173-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-174-      // Step 1: URL decode the certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:175:      String decodedCert = URLDecoder.decode(encodedCertificate, StandardCharsets.UTF_8);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-176-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:177:      // Step 2: Remove the PEM header/footer and newlines
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:178:      String pemCert =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-179-          decodedCert
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-180-              .replace("-----BEGIN CERTIFICATE-----", "")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-183-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-184-      // Step 3: Decode base64 encoded certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:185:      byte[] decodedBytes = Base64.getDecoder().decode(pemCert);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-186-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-187-      // Step 4: Create a X509Certificate object from the byte array
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-188-      CertificateFactory certFactory = CertificateFactory.getInstance("X.509");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-189-      return (X509Certificate)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:190:          certFactory.generateCertificate(new ByteArrayInputStream(decodedBytes));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-191-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-192-    } catch (CertificateException | IllegalArgumentException e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-197-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-198-  public void logInvalidCertificate(HttpHeaders headers) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:199:    List<String> sourceIps = getSourceIpsFromHttpHeaders(headers);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:200:    String tenantId = headers.getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:201:    String userId = headers.getFirst(SAP_SIGNAVIO_USER_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-202-    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-203-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-204-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:205:  public String getCertificateFromHeader(String certificateHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:206:    String CERT_HEADER_PREFIX = "Cert=";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:207:    Optional<String> certificateKeyValuePair =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-208-        Arrays.stream(certificateHeader.split(";"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-209-            .filter(s -> s.trim().startsWith("Cert="))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-210-            .findFirst();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:211:    if (certificateKeyValuePair.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-212-      throw new RuntimeException("Certificate not found in header");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-213-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:214:    return certificateKeyValuePair.get().substring(CERT_HEADER_PREFIX.length()).replace("\"", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-215-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-216-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:217:  public boolean isSubjectTrusted(String subject, List<String> trustedSubjects) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:218:    Set<String> givenSubjectComponents = parseSubjectComponents(subject);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-219-    return trustedSubjects.stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-220-        .map(this::parseSubjectComponents)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:221:        .anyMatch(givenSubjectComponents::equals);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-222-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-223-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:224:  private Set<String> parseSubjectComponents(String subject) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:225:    return Arrays.stream(subject.split(",")).map(String::trim).collect(Collectors.toSet());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-226-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-227-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:228:  public boolean areTenantServiceIssuerAndSubjectValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:229:      String issuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:230:      String subject,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-231-      List<TenantServiceConfig.TenantServiceCldSubjectAndIssuer> certificates) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-232-    if (certificates == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-233-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-234-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:235:    Set<String> issuerComponents = parseSubjectComponents(issuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:236:    Set<String> subjectComponents = parseSubjectComponents(subject);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-237-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-238-    for (TenantServiceConfig.TenantServiceCldSubjectAndIssuer cert : certificates) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-248-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-249-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:250:  private String getHeaderValueSafely(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java:251:      Map<String, List<String>> lowerCaseHttpHeadersMap, String headerName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-252-    return Optional.ofNullable(lowerCaseHttpHeadersMap.get(headerName))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/utils/CertificateValidator.java-253-        .filter(list -> !list.isEmpty())
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-1-package com.sap.bpi.api.gw.filters.utils.csp;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:3:import static com.sap.bpi.api.gw.filters.utils.csp.CspDirectiveType.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:4:import static com.sap.bpi.api.gw.filters.utils.csp.SourceList.Builder.keywords;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-5-import static com.sap.bpi.api.gw.filters.utils.csp.SourceList.Builder.urls;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-6-import static java.util.stream.Collectors.toCollection;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-13-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:14: * This class helps you to generate a Content Security Policy header.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-15- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-16- * <p>
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-22- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-23- * <p>CSP can be used in a <strong>report only mode</strong>. Call {@link #useForReportingOnly()} to
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:24: * generate a header that will not cause restrictions in the browser but will report rule
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:25: * violations. Make sure to provide a {@link #reportUri(String)}.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-26- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-27- * <p>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-28- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:29: * <p>Use {@link #nonce(String)} to add a nonce to all supported directives. At the time this is
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-30- * written this is <strong>scriptSrc</strong> and <strong>styleSrc</strong>. See <a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-31- * href="https://github.com/w3c/webappsec-csp/issues/116">this w3c issue</a>.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-32- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:33: * <p>The <strong>deprecated directive frame-src</strong> is omitted in this class.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-34- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-35- * <p>
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-37- * <h3>Source List</h3>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-38- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:39: * <p>All of the <strong>directives that end with src</strong> support similar values known as a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-40- * source list. Multiple source list values can be space separated with the exception of 'none'
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-41- * which should be the only value.
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-58- *    .reportUri("/cspreport")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-59- *    .childSrc("frame.sig.com")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:60: *    .formAction("editor.sig.com")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-61- *    .frameAncestors("iframe.sig.com")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-62- *    .pluginTypes("application/x-java-applet").build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-63- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:64: *    if (policy.hasDirectives()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:65: *        httpResponse.addHeader(policy.getHeaderName(), policy.getDirectives());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-66- *    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-67- * </pre>
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-74- *   <li>Documentation is taken from: <a
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-75- *       href="https://content-security-policy.com/">content-security-policy.com</a>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:76: *   <li><a href="https://sites.google.com/signavio.com/secure-server/content-security-policy">CSP
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-77- *       in our sites</a> with more info and references
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-78- * </ul>
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-80-public class ContentSecurityPolicyBuilder {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-81-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:82:  private boolean useForReportingOnly = false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:84:  private CspStatus status = CspStatus.ON;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-85-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:86:  private final Map<CspDirectiveType, SourceList> directives = new TreeMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:88:  private final List<ContentSecurityPolicyCompatHeader> compatHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-89-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-90-  public ContentSecurityPolicyBuilder() {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-98-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-99-    policy.forEach(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:100:        directive ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:101:            this.directive(directive.getType(), new SourceList().add(directive.getSourceList())));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-102-    this.compatHeaders = new ArrayList<>(policy.getCompatHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-103-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-104-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-105-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:106:   * Creates a builder based on the given policy. The original policy is not modified when the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-107-   * builder is used.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-108-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:109:   * @param policy Directives of this policy is used as basis for the resulting builder.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-110-   * @return A builder based on the passed in policies
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-111-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-117-    CspMode mode = useForReportingOnly ? CspMode.REPORT_ONLY : CspMode.ENFORCE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-118-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:119:    Set<CspDirective> cspDirectives =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:120:        directives.entrySet().stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:121:            .map(entry -> new CspDirective(entry.getKey(), entry.getValue()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:122:            .collect(toCollection(LinkedHashSet::new));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:123:    return new ContentSecurityPolicy(mode, cspDirectives, status, compatHeaders);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-124-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-125-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-126-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:127:   * Allows you to modify directives.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-128-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-129-   * @param changes The actual changes that shall be applied
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-130-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-131-  public ContentSecurityPolicyBuilder modify(Consumer<CspModifier> changes) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:132:    changes.accept(new CspModifier(directives, this));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-133-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-134-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-142-  public ContentSecurityPolicyBuilder copy() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-143-    ContentSecurityPolicyBuilder copy = new ContentSecurityPolicyBuilder();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:144:    directives.forEach((key, value) -> copy.putToDirectives(key, new SourceList().add(value)));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-145-    return copy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-146-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-148-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-149-   * Tell the browser to monitor a policy and report violations but to not enforce the restrictions.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:150:   * Set the {@link #reportUri(String)} to allow reporting.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-151-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-152-  public ContentSecurityPolicyBuilder useForReportingOnly() {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-156-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-157-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:158:   * Tell the browser to enforce a policy and report violations. Set the {@link #reportUri(String)}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-159-   * to allow reporting.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-160-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-171-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-172-  public ContentSecurityPolicyBuilder defaultSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:173:    putToDirectives(DEFAULT_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-174-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-175-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-181-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-182-  public ContentSecurityPolicyBuilder scriptSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:183:    putToDirectives(SCRIPT_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-184-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-185-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-191-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-192-  public ContentSecurityPolicyBuilder styleSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:193:    putToDirectives(STYLE_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-194-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-195-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-201-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-202-  public ContentSecurityPolicyBuilder imageSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:203:    putToDirectives(IMG_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-204-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-205-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-212-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-213-  public ContentSecurityPolicyBuilder connectSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:214:    putToDirectives(CONNECT_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-215-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-216-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-222-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-223-  public ContentSecurityPolicyBuilder fontSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:224:    putToDirectives(FONT_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-225-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-226-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-232-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-233-  public ContentSecurityPolicyBuilder objectSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:234:    putToDirectives(OBJECT_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-235-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-236-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-242-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-243-  public ContentSecurityPolicyBuilder mediaSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:244:    putToDirectives(MEDIA_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-245-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-246-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-251-   * You can keep the sandbox value empty to keep all restrictions in place.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-252-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:253:   * @param sandboxKeywords possible values: allow-forms allow-same-origin allow-scripts
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-254-   *     allow-popups, allow-modals, allow-orientation-lock, allow-pointer-lock, allow-presentation,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-255-   *     allow-popups-to-escape-sandbox, and allow-top-navigation
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-256-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:257:  public ContentSecurityPolicyBuilder sandbox(SandboxKeyword... sandboxKeywords) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:258:    if (sandboxKeywords == null || sandboxKeywords.length == 0) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:259:      directives.put(SANDBOX, keywords(SandboxKeyword.ALL));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-260-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:261:      directives.put(SANDBOX, keywords(sandboxKeywords));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-262-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-263-    return this;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-272-   * @param uri Example value: /cspReport
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-273-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:274:  public ContentSecurityPolicyBuilder reportUri(@Nullable String uri) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-275-    if (uri == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:276:      directives.remove(REPORT_URI);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-277-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:278:      directives.put(REPORT_URI, urls(uri));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-279-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-280-    return this;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-288-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-289-  public ContentSecurityPolicyBuilder childSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:290:    putToDirectives(CHILD_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-291-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-292-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-297-   * @param sourceList A Source List. See: {@link ContentSecurityPolicyBuilder}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-298-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:299:  public ContentSecurityPolicyBuilder formAction(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:300:    putToDirectives(FORM_ACTION, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-301-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-302-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-304-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-305-   * Defines valid sources for embedding the resource using &lt;frame&gt; &lt;iframe&gt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:306:   * &lt;object&gt; &lt;embed&gt; &lt;applet&gt;. Setting this directive to 'none' should be roughly
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:307:   * equivalent to X-Frame-Options: DENY
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-308-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-309-   * @param sourceList A Source List. See: {@link ContentSecurityPolicyBuilder}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-310-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-311-  public ContentSecurityPolicyBuilder frameAncestors(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:312:    putToDirectives(FRAME_ANCESTORS, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-313-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-314-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-320-   * @param restriction the mime types you want to allow
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-321-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:322:  public ContentSecurityPolicyBuilder pluginTypes(String restriction) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-323-    if (restriction == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:324:      directives.remove(PLUGIN_TYPES);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-325-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:326:      directives.put(PLUGIN_TYPES, urls(restriction));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-327-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-328-    return this;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-335-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-336-  public ContentSecurityPolicyBuilder frameSrc(SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:337:    putToDirectives(FRAME_SRC, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-338-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-339-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-340-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-341-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:342:   * Will add a nonce to every supported directive. As this is written this is {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-343-   * #scriptSrc(SourceList)} and {@link #styleSrc(SourceList)}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-344-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:345:   * <p>Result will look like this: {@code style-src 'nonce-<base64-encoded-string>';}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-346-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:347:   * @param nonce your nonce, should be a Base64 encoded String.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-348-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:349:  public ContentSecurityPolicyBuilder nonce(String nonce) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-350-    Stream.of(STYLE_SRC, SCRIPT_SRC)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-351-        .forEach(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:352:            directive -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:353:              directives.computeIfPresent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:354:                  directive, (oldDirective, oldValue) -> oldValue.nonce(nonce));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:355:              directives.computeIfAbsent(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:356:                  directive, (oldDirective) -> SourceList.Builder.nonce(nonce));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-357-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-358-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-359-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-360-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:361:  public ContentSecurityPolicyBuilder directive(CspDirectiveType directive, SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:362:    putToDirectives(directive, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-363-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-364-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-365-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:366:  private void putToDirectives(CspDirectiveType directive, SourceList sourceList) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-367-    if (sourceList != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:368:      directives.put(directive, sourceList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-369-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java:370:      directives.remove(directive);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-371-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/ContentSecurityPolicyBuilder.java-372-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspKeyword.java-1-package com.sap.bpi.api.gw.filters.utils.csp;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspKeyword.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspKeyword.java:3:public interface CspKeyword {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspKeyword.java-4-  // is a flag. Needs to be public, even if Intellij Idea doesn't see that.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/csp/CspKeyword.java-5-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:1:package com.sap.bpi.api.gw.security.jwt.strategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:3:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:4:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:5:import io.jsonwebtoken.JwtException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:6:import io.jsonwebtoken.Jwts;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:7:import java.util.HashMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-8-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:12:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:13:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:14:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-15-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-17-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:18: * Validation strategy for UGW (Unified Gateway) JWT tokens.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-19- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:20: * <p>UGW JWT is identified by examining the issuer claim ("iss"). The issuer must contain
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:21: * "bpi-api-gw" at the beginning (after protocol) and end with "signav.io". This JWT type is used
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-22- * for internal communication within the SAP ecosystem.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-23- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:24: * <p>Example UGW issuer: "https://bpi-api-gw.eu-staging-cloud-os-eu.suite-saas-staging.signav.io"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-25- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-26- * <p>Validation steps:
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-28- * <ol>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-29- *   <li>Extract Authorization header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:30: *   <li>Parse JWT payload to check issuer claim
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:31: *   <li>Verify issuer matches UGW pattern (bpi-api-gw...signav.io)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:32: *   <li>Verify JWT signature using UGW public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-33- *   <li>(TBD - Validate standard claims audience, expiration, ... )
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-34- * </ol>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-35- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-36-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:37:public class UgwJwtValidationStrategy implements TokenValidationStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:39:  private static final Logger logger = LoggerFactory.getLogger(UgwJwtValidationStrategy.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:40:  private static final String CLIENT_ID = "ugw-client";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:42:  private final UgwJwtConfig ugwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-44-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:45:  public UgwJwtValidationStrategy(UgwJwtConfig ugwJwtConfig) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:46:    this.ugwJwtConfig = ugwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-47-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-48-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-51-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-52-      // Extract Authorization header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:53:      String authHeader = exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-54-      if (authHeader == null || !authHeader.startsWith("Bearer ")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-55-        logger.debug("No Bearer token found, returning false");
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-57-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:59:      String token = authHeader.substring(7);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:61:      // Check if token is a UGW JWT by examining issuer claim
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:62:      boolean isUgwJwt = JwtUtils.isUgwJwt(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:63:      if (!isUgwJwt) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-64-        logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:65:            "UGW JWT validation failed: issuer does not match UGW pattern"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:66:                + " (bpi-api-gw...signav.io)");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-67-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:69:      return isUgwJwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-70-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:71:      logger.error("Error checking if token is UGW JWT: {}", e.getMessage(), e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-72-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-73-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-77-  public Mono<TokenValidationResult> validate(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-78-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:79:      // Extract JWT from Authorization header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:80:      String authHeader = exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-81-      if (authHeader == null || !authHeader.startsWith("Bearer ")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-82-        return Mono.just(TokenValidationResult.failure("Missing or invalid Authorization header"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-83-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:85:      String token = authHeader.substring(7);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:87:      // Verify JWT signature using UGW public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:88:      // parseSignedClaims() validates signature, expiration, and token structure as side effects
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:89:      // Throws JwtException if validation fails. Claims are not extracted as they are not
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:90:      // needed for backward compatibility with legacy UgwJwtToSpmJwtFilterFactory behavior.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:91:      Jwts.parser()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:92:          .verifyWith(ugwJwtConfig.getPublicKeyFromInternalKeyPair())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-93-          .build()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:94:          .parseSignedClaims(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-95-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-96-      // Build metadata for downstream filters
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:97:      Map<String, Object> metadata = new HashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:98:      // UGW JWT doesn't have a traditional client_id, use fixed identifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:99:      // Note: Legacy UgwJwtToSpmJwtFilterFactory does not validate audience,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-100-      // so we maintain the same behavior for backward compatibility
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-101-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-102-      return Mono.just(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-103-          TokenValidationResult.success(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:104:              TokenType.UGW_JWT.getTokenTypeValue(), CLIENT_ID, metadata));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-105-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:106:    } catch (JwtException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:107:      logger.error("UGW JWT signature validation failed: {}", e.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:108:      return Mono.just(TokenValidationResult.failure("UGW JWT signature validation failed"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-109-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:110:      logger.error("UGW JWT validation failed: {}", e.getMessage(), e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-111-      return Mono.just(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:112:          TokenValidationResult.failure("UGW JWT validation failed: " + e.getMessage()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-113-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-114-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-116-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-117-  public TokenType getTokenType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java:118:    return TokenType.UGW_JWT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-119-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/UgwJwtValidationStrategy.java-120-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-1-package com.sap.bpi.api.gw.filters.utils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:3:import com.sap.bpi.api.gw.dto.PublicKeyListDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-4-import com.sap.bpi.api.gw.dto.WellKnownConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-5-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:6:import io.jsonwebtoken.JwtException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:7:import io.jsonwebtoken.Jwts;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-8-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:9:import java.security.KeyFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-10-import java.security.NoSuchAlgorithmException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:11:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:12:import java.security.spec.InvalidKeySpecException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:13:import java.security.spec.RSAPublicKeySpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:14:import java.security.spec.X509EncodedKeySpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-15-import java.util.Base64;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-16-import java.util.function.Predicate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-17-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-18-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:19:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:20:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:21:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:22:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:23:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:24:import org.springframework.web.reactive.function.client.WebClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:25:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-26-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-28-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:29:public class JwtVerifierUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:30:  private final WebClient webClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:32:  private final Logger logger = LoggerFactory.getLogger(JwtVerifierUtils.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-34-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:35:  public JwtVerifierUtils(@Qualifier("genericServiceClient") WebClient genericServiceClient) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-36-    this.webClient = genericServiceClient;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-37-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:39:  public Mono<WellKnownConfigurationDto> getTokenConfiguration(String url) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-40-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-41-        .get()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-46-            HttpStatusCode::isError,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-47-            response -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:48:              String errorMsg = "Error while getting token configuration";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-49-              if (response.statusCode() == HttpStatus.NOT_FOUND) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-50-                errorMsg =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:51:                    "The JWT configuration was not found, please check auth URL in the tenant"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-52-                        + " configuration.";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-53-              }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:59:  public Mono<PublicKey> fetchPublicKey(WellKnownConfigurationDto wellKnownConfiguration) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:60:    String url = wellKnownConfiguration.getJwksUri();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:61:    return fetchPublicKey(url);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-64-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:65:   * Creates a PublicKey from PublicKeyListDto, handling both XSUAA and IAS formats. XSUAA format
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:66:   * uses 'value' field with PEM-encoded key. IAS format uses 'n' and 'e' fields with JWKS format.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-67-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:68:  private PublicKey createPublicKeyFromKeyList(PublicKeyListDto keysList) throws Exception {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:69:    if (keysList.getKeys() == null || keysList.getKeys().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:70:      throw new IllegalArgumentException("No keys found in key list");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-71-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-72-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:73:    var keyDto = keysList.getKeys().get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-74-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:75:    // Try XSUAA format first (PEM format with 'value' field)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:76:    if (keyDto.getValue() != null && !keyDto.getValue().trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:77:      return convertPemToPublicKey(keyDto.getValue());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-78-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-79-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-80-    // Try IAS format (JWKS format with 'n' and 'e' fields)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:81:    if (keyDto.getN() != null && keyDto.getE() != null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:82:      return createPublicKeyFromJwksFields(keyDto.getN(), keyDto.getE());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-83-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-85-    throw new IllegalArgumentException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:86:        "Key format not supported. Expected either 'value' field (XSUAA) or 'n'+'e' fields (IAS)");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-87-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-88-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:89:  /** Creates PublicKey from JWKS 'n' and 'e' fields (IAS format). */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:90:  private PublicKey createPublicKeyFromJwksFields(String n, String e) throws Exception {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-91-    byte[] modulusBytes = Base64.getUrlDecoder().decode(n);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-92-    byte[] exponentBytes = Base64.getUrlDecoder().decode(e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:94:    RSAPublicKeySpec spec =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:95:        new RSAPublicKeySpec(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-96-            new java.math.BigInteger(1, modulusBytes), new java.math.BigInteger(1, exponentBytes));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:98:    KeyFactory factory = KeyFactory.getInstance("RSA");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:99:    return factory.generatePublic(spec);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-100-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-101-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:102:  public Mono<PublicKey> fetchPublicKey(String jwksUri) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-103-    return webClient
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-104-        .get()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-110-                Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-111-                    new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:112:                        response.statusCode(), "Error while getting public key from issuer")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:113:        .bodyToMono(PublicKeyListDto.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-114-        .onErrorMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:115:            isNotPublicKeyIssuerException(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-116-            e -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:117:              logger.error("Error while fetching a public key", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-118-              return new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:119:                  HttpStatus.BAD_GATEWAY, "Failed to get a public key: " + e.getMessage(), e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-120-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-121-        .handle(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:122:            (keysList, sink) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-123-              try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:124:                PublicKey publicKey = createPublicKeyFromKeyList(keysList);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:125:                sink.next(publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-126-              } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:127:                sink.error(new RuntimeException("Failed to create a public key from key list", e));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-128-              }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-129-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-130-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-131-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:132:  private Predicate<? super Throwable> isNotPublicKeyIssuerException() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-133-    return e -> !(e instanceof ResponseStatusException);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-134-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-135-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:136:  public Claims getClaims(PublicKey publicKey, String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-137-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:138:      return Jwts.parser().verifyWith(publicKey).build().parseSignedClaims(token).getPayload();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:139:    } catch (JwtException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:140:      logger.error("The JWT can not be parsed or validated", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-141-      throw e;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-142-    } catch (IllegalArgumentException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:143:      logger.error("The JWT is empty or null:", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:144:      throw new IllegalArgumentException("The JWT cannot be null or empty", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-145-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-146-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-147-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:148:  private PublicKey convertPemToPublicKey(String pemString)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:149:      throws NoSuchAlgorithmException, InvalidKeySpecException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:150:    var publicKeyPem =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:151:        pemString
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:152:            .replace("-----BEGIN PUBLIC KEY-----", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:153:            .replace("-----END PUBLIC KEY-----", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-154-            .replaceAll("\\s", "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-155-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:156:    byte[] decoded = Base64.getDecoder().decode(publicKeyPem);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:157:    KeyFactory keyFactory = KeyFactory.getInstance("RSA");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:158:    X509EncodedKeySpec keySpec = new X509EncodedKeySpec(decoded);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java:159:    return keyFactory.generatePublic(keySpec);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-160-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/filters/utils/JwtVerifierUtils.java-161-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-16-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-17-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:18:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:19:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:20:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:21:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:22:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:23:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:24:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-25-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-27-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-28-public class DatasphereAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:29:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:30:  public static final String X_SIGNAVIO_TENANT_ID_ATTRIBUTE = "x-signavio-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:31:  public static final String X_DATASPHERE_TENANT_ID_ATTRIBUTE = "x-datasphere-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:33:  private final List<String> trustedSubjects;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:34:  private final Map<String, String> tenantMapping;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:35:  private final CertificateValidator certificateValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:36:  private final DatasphereTenantService tenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:37:  private final LaunchDarklyService ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:38:  private final Logger logger = LoggerFactory.getLogger(DatasphereAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-40-  public DatasphereAuthorizationManager(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-41-      CertificateValidator certificateValidator,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:42:      @Value("${app.subjects.piDatasphereTrustedSubjects}") String piDatasphereTrustedSubjects,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:43:      @Value("${app.piDatasphereTenantMapping}") String piDatasphereTenantMapping,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-44-      DatasphereTenantService tenantService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-45-      LaunchDarklyService ldService) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-55-   * trustedSubjects. Then extracts the Datasphere tenantId from the subject and checks if it is in
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-56-   * the tenantMapping. If all checks pass, takes the Datasphere tenant ID from the certificate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:57:   * subject and the Signavio tenant ID from the mapping and adds it to the request headers.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-58-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-59-  @Override
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-61-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-62-    ServerHttpRequest request = context.getExchange().getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:63:    Map<String, List<String>> lowerCaseHttpHeadersMap =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:64:        AuthorizationManagerUtils.createHeadersMapWithLowercaseKeys(request.getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-65-    ValidationResult validationResult = new ValidationResult(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-66-    if (validationResult.errorsExist()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-68-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:70:    Optional<String> subject = certificateValidator.getSubjectFromHeader(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-71-    if (subject.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-72-      logger.warn("Subject header {} from request headers is empty", SUBJECT.getHeaderName());
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-74-          lowerCaseHttpHeadersMap, RequestOrigin.DATASPHERE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-75-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:76:    String subjectValue = subject.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-78-    boolean loggingEnabled =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-83-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:85:    Optional<String> datasphereTenantIdOptional =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-86-        certificateValidator.extractDatasphereTenantIdFromSubject(subjectValue);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-87-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-93-      return certificateValidator.handleMissingDatasphereTenant(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-94-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:95:    String datasphereTenantId = datasphereTenantIdOptional.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-96-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-97-    // Retrieve Tenant Mapping(s) via Tenant Service
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-125-          DatasphereTenantMappingDto datasphereTenantMappingDto =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-126-              datasphereTenantMappingDtoOptional.get();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:127:          String externalTenantId = datasphereTenantMappingDto.externalTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-128-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-129-          if (!datasphereTenantId.equals(externalTenantId)) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-132-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-133-          // Add both tenant IDs to the exchange attributes for downstream filters
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:134:          String signavioTenantId = tenantServiceResponse.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:135:          addAttributeToExchange(context, X_SIGNAVIO_TENANT_ID_ATTRIBUTE, signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-136-          addAttributeToExchange(context, X_DATASPHERE_TENANT_ID_ATTRIBUTE, datasphereTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-137-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-140-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-141-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:142:  private void addAttributeToExchange(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java:143:      AuthorizationContext context, String attributeName, String attributeValue) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-144-    context.getExchange().getAttributes().put(attributeName, attributeValue);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/DatasphereAuthorizationManager.java-145-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-1-package com.sap.bpi.api.gw.configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:3:import com.sap.bpi.api.gw.security.certificate.utils.DestinationServiceCertificateParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-4-import java.io.ByteArrayInputStream;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:5:import java.security.KeyStore;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-6-import java.security.cert.Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-7-import java.security.cert.CertificateFactory;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-12-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-13-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:14:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:15:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:16:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-18-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:19: * Configuration class for creating and managing trust store beans used in mTLS connections. This
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:20: * configuration provides a centralized trust store that can be reused across multiple HTTP clients,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-21- * improving performance by avoiding repeated certificate parsing operations.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-22- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:23: * <p>The trust store contains CA certificates for secure mTLS connections.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-24- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-25-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-26-public class TrustStoreConfiguration {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:28:  private static final Logger logger = LoggerFactory.getLogger(TrustStoreConfiguration.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:29:  private static final String CERTIFICATE_ALIAS_PREFIX = "ca-cert";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-31-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:32:   * CA certificates for mTLS trust store containing: - ISRG Root X1: Internet Security Research
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:33:   * Group root certificate (RSA 4096-bit, Let's Encrypt) - ISRG Root X2: Internet Security Research
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:34:   * Group root certificate (ECDSA P-384, Let's Encrypt) - SAP Cloud Root CA: SAP SE root
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-35-   * certificate for SAP Cloud services
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-36-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:37:  @Value("${certificates.mtlsClientFactory.trustStore.caCertificates}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:38:  private String trustStoreCaCertificates;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-40-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-41-   * Extracts X509 certificates from the trustStoreCaCertificates variable. This method parses the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:42:   * multi-certificate PEM block and returns a list of individual certificates
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-43-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:44:   * @return List of X509Certificate objects extracted from the PEM content
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-45-   * @throws RuntimeException if certificate extraction fails
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-46-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-47-  public List<X509Certificate> extractTrustStoreCertificates() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:48:    logger.debug("Extracting certificates from injected trust store PEM content");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-50-    if (trustStoreCaCertificates == null || trustStoreCaCertificates.trim().isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-55-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:56:      String decodedPemContent =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:57:          DestinationServiceCertificateParser.decodePEMContent(trustStoreCaCertificates);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:58:      List<X509Certificate> certificates = parsePemCertificates(decodedPemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-60-      logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:61:          "Successfully extracted {} certificates from trust store PEM content",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-62-          certificates.size());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-63-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-65-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-66-      logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:67:          "Failed to extract certificates from trust store PEM content: {}", e.getMessage(), e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-68-      throw new RuntimeException("Failed to extract trust store certificates", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-69-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-72-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:73:   * Parses PEM-formatted certificate content and extracts individual X509 certificates. This method
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:74:   * handles multi-certificate PEM blocks by extracting the content from each certificate block and
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:75:   * parsing it individually.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-76-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:77:   * @param pemContent The PEM-formatted certificate content containing one or more certificates
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:78:   * @return List of X509Certificate objects parsed from the PEM content
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-79-   * @throws Exception if certificate parsing fails
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-80-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:81:  private List<X509Certificate> parsePemCertificates(String pemContent) throws Exception {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-82-    List<X509Certificate> certificates = new ArrayList<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:84:    if (pemContent == null || pemContent.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:85:      logger.debug("PEM content is null or empty, returning empty certificate list");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-86-      return certificates;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-87-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-89-    CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:91:    // Use CertificateFactory to parse all certificates from the PEM content directly
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:92:    ByteArrayInputStream pemStream = new ByteArrayInputStream(pemContent.getBytes());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-94-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-95-      Collection<? extends Certificate> parsedCertificates =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:96:          certificateFactory.generateCertificates(pemStream);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-98-      for (Certificate cert : parsedCertificates) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-107-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-108-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:109:      logger.warn("Failed to parse certificates from PEM content: {}", e.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-110-      throw e;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-111-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:113:    logger.debug("Completed PEM parsing, extracted {} certificates", certificates.size());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-114-    return certificates;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-115-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-116-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-117-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:118:   * Creates a trust store bean containing CA certificates for mTLS connections. This bean provides
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-119-   * a centralized trust store with the required CA certificates.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-120-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:121:   * @return KeyStore configured with the injected CA certificates
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-122-   * @throws RuntimeException if trust store creation fails
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-123-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:124:  @Bean(name = "mtlsTrustStore")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:125:  public KeyStore mtlsTrustStore() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:126:    logger.debug("Initializing custom mTLS trust store with injected certificates");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-127-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-128-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:129:      KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-130-      trustStore.load(null, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-131-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-140-      for (int i = 0; i < certificates.size(); i++) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-141-        X509Certificate certificate = certificates.get(i);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:142:        String alias =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:143:            CERTIFICATE_ALIAS_PREFIX + "-" + i + "-" + certificate.getSerialNumber().toString(16);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-144-        trustStore.setCertificateEntry(alias, certificate);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-145-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-148-            alias,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-149-            certificate.getSubjectX500Principal().getName(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:150:            certificate.getSerialNumber().toString(16));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-151-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-152-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-153-      logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:154:          "Custom mTLS trust store initialized successfully with {} certificates",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-155-          certificates.size());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-156-      return trustStore;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-157-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-158-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:159:      logger.error("Failed to create custom mTLS trust store: {}", e.getMessage(), e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java:160:      throw new RuntimeException("Failed to initialize custom mTLS trust store", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-161-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/configuration/TrustStoreConfiguration.java-162-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:1:package com.sap.bpi.api.gw.security.jwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:3:import static com.sap.bpi.api.gw.filters.utils.FilterUtils.SAP_SIGNAVIO_INGESTION_ENTITY_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-4-import static com.sap.bpi.api.gw.filters.utils.SpmRequestResponseFilterUtils.X_FORWARDED_FOR_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:5:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-7-import java.util.Arrays;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-9-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-10-import java.util.UUID;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:11:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:12:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:13:import org.springframework.util.MultiValueMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-15-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:16: * Context object that provides an abstraction over HTTP headers and query parameters for JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:17: * validation. Encapsulates common header extraction logic and provides helper methods for JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-18- * verifiers.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-19- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:20:public class JwtValidationContext {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:21:  private final HttpHeaders headers;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:22:  private final MultiValueMap<String, String> queryParams;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:23:  private final String requestId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:25:  private JwtValidationContext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:26:      HttpHeaders headers, MultiValueMap<String, String> queryParams, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-27-    this.headers = headers;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-28-    this.queryParams = queryParams;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:29:    this.requestId = requestId != null ? requestId : generateRequestId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-30-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:32:  public static JwtValidationContext from(HttpHeaders headers, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:33:    return new JwtValidationContext(headers, null, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-34-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:36:  public static JwtValidationContext from(HttpHeaders headers) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:37:    return new JwtValidationContext(headers, null, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-38-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:40:  public static JwtValidationContext from(ServerHttpRequest request) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:41:    return new JwtValidationContext(request.getHeaders(), request.getQueryParams(), null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-42-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:44:  public static JwtValidationContext from(ServerHttpRequest request, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:45:    return new JwtValidationContext(request.getHeaders(), request.getQueryParams(), requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-46-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-48-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:49:   * Gets the Signavio tenant ID from the sap-signavio-tenant-id header, 't' header, or 't' query
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-50-   * parameter.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-51-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-52-   * @return the tenant ID, or null if not present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-53-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:54:  public String getTenantId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:55:    // First try the sap-signavio-tenant-id header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:56:    String tenantId = headers.getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-57-    if (tenantId != null && !tenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-58-      return tenantId;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-78-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:79:   * Gets the ingestion entity ID from the sap-signavio-ingestion-entity-id header.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-80-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-81-   * @return the ingestion entity ID, or null if not present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-82-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:83:  public String getIngestionEntityId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:84:    return headers.getFirst(SAP_SIGNAVIO_INGESTION_ENTITY_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-85-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-86-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-91-   * @return list of source IPs, empty list if header not present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-92-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:93:  public List<String> getSourceIps() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-94-    return Optional.ofNullable(headers.get(X_FORWARDED_FOR_HEADER)).orElse(List.of()).stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-95-        .flatMap(header -> Arrays.stream(header.split(",")))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:96:        .map(String::trim)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-97-        .toList();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-98-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-103-   * @return the primary source IP, or null if not available
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-104-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:105:  public String getPrimarySourceIp() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:106:    List<String> sourceIps = getSourceIps();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-107-    return sourceIps.isEmpty() ? null : sourceIps.get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-108-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-109-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:110:  /** Gets the request ID, either from headers or the generated one. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:111:  public String getRequestId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-112-    return requestId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-113-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-119-   * @return the header value, or null if not present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-120-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:121:  public String getHeader(String headerName) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-122-    return headers.getFirst(headerName);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-123-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-124-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:125:  private static String generateRequestId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java:126:    return UUID.randomUUID().toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-127-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtValidationContext.java-128-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:1:package com.sap.bpi.api.gw.security.jwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:3:import com.sap.bpi.api.gw.security.jwt.strategy.TokenType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:4:import com.sap.bpi.api.gw.security.jwt.strategy.TokenValidationResult;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:5:import com.sap.bpi.api.gw.security.jwt.strategy.TokenValidationStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-6-import java.util.EnumMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-7-import java.util.List;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:11:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:12:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:13:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:14:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:15:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:16:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-18-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-20- * Unified authorization manager using Strategy Pattern.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-21- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:22: * <p>Validates multiple token types: - Joule XSUAA/IAS JWT - UGW JWT - SPM Token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-23- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-24- * <p>Benefits:
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-32- * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-33- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:34: * <p>Exchange Attributes Set: - "token-type": Token type for routing (e.g., "sap-jwt", "spm-token",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:35: * "ugw-jwt") - Additional metadata from TokenValidationResult
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-36- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-37-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-38-public class TokenAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:39:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:41:  private static final Logger logger = LoggerFactory.getLogger(TokenAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:43:  public static final String TOKEN_TYPE_ATTRIBUTE = "token-type";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:45:  private final Map<TokenType, TokenValidationStrategy> strategies;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:46:  private final TokenTypeDetector tokenTypeDetector;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-48-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:49:   * Constructor with dependency injection. Spring automatically injects all beans implementing
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-50-   * TokenValidationStrategy and the TokenTypeDetector.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-51-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:52:   * @param strategyList list of all validation strategies (auto-discovered by Spring)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-53-   * @param tokenTypeDetector detector for identifying token type
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-54-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-59-    // Build map: TokenType -> Strategy
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:60:    // Using EnumMap for better performance with enum keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-61-    this.strategies = new EnumMap<>(TokenType.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-62-    for (TokenValidationStrategy strategy : strategyList) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-104-   * @return AuthorizationDecision
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-105-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:106:  private AuthorizationDecision createAuthorizationDecision(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-107-      TokenValidationResult result, ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-108-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-119-        .getMetadata()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-120-        .forEach(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:121:            (key, value) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:122:              exchange.getAttributes().put(key, value);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java:123:              logger.debug("Set exchange attribute: {} = {}", key, value);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-124-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenAuthorizationManager.java-125-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:1:package com.sap.bpi.api.gw.security.jwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-3-import com.sap.bpi.api.gw.configuration.LaunchDarklyFeatureFlag;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:4:import com.sap.bpi.api.gw.filters.SpmTokenToSpmJwtFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-5-import com.sap.bpi.api.gw.services.LaunchDarklyService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-6-import java.util.Collection;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:7:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:8:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:9:import org.springframework.security.web.server.util.matcher.ServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:10:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-11-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-12-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-19- *   <li>The Path must either start with "/g/api/" or "/g/statics/".
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-20- *   <li>The HTTP method is GET.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:21: *   <li>The request does not contain the {@code X-Signavio-Id} header.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-22- *   <li>The request does not contain a cookie named {@code token}.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:23: *   <li>None of the Accept header values are exactly {@code text/json} (case-insensitive).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-24- * </ol>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-25- *
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-29-public class AuthenticationHeaderNotPresentMatcher implements ServerWebExchangeMatcher {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:31:  public static final String REDIRECT_TO_LOGIN = "REDIRECT_TO_LOGIN";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:32:  private final LaunchDarklyService ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-34-  public AuthenticationHeaderNotPresentMatcher(LaunchDarklyService ldService) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-45-    ServerHttpRequest request = exchange.getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:46:    String path = request.getPath().value();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-47-    HttpHeaders headers = request.getHeaders();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-48-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-59-    // 3. If the header is present do not match
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:60:    if (headers.containsKey(SpmTokenToSpmJwtFilterFactory.X_SIGNAVIO_ID_HEADER)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-61-      return MatchResult.notMatch();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-62-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-66-        request.getCookies().values().stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-67-            .flatMap(Collection::stream)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:68:            .anyMatch(cookie -> "token".equalsIgnoreCase(cookie.getName()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-69-    if (tokenInCookie) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-70-      return MatchResult.notMatch();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-73-    // 4. If the Accept header value contains text/json do not match
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-74-    if (headers.getAccept().stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java:75:        .anyMatch(mediaType -> "text/json".equalsIgnoreCase(mediaType.toString()))) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-76-      return MatchResult.notMatch();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/AuthenticationHeaderNotPresentMatcher.java-77-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-3-import com.sap.bpi.api.gw.dto.CertificateChainDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:4:import com.sap.bpi.api.gw.dto.destinationService.DestinationServiceCertificateDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:5:import com.sap.bpi.api.gw.security.certificate.utils.DestinationServiceCertificateParser;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:6:import com.sap.bpi.api.gw.services.DestinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-7-import java.security.cert.CertificateException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-8-import java.security.cert.X509Certificate;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-11-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-12-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:13:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:14:import org.springframework.http.HttpStatusCode;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:15:import org.springframework.http.ResponseEntity;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:16:import org.springframework.web.bind.annotation.GetMapping;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:17:import org.springframework.web.bind.annotation.PathVariable;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:18:import org.springframework.web.bind.annotation.RestController;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:19:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-20-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-21-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-23-public class PublicCertificatesController {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:25:  private static final Logger logger = LoggerFactory.getLogger(PublicCertificatesController.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:27:  private final DestinationService destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-28-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:29:  public static final String APIGW_V1_CERTIFICATES_PATH = "/apigw/v1/certificates";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:31:  PublicCertificatesController(DestinationService destinationService) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:32:    this.destinationService = destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-33-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-35-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:36:   * Returns the leaf certificate in PEM format for a given tenant.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-37-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:38:   * <p>This endpoint retrieves the certificate from the Destination Service, extracts only the leaf
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:39:   * certificate (excluding the private key and any intermediate/root certificates), and returns it
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:40:   * as a base64-encoded string.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-41-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-42-   * @param tenantId the tenant identifier
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-46-  @GetMapping(APIGW_V1_CERTIFICATES_PATH + "/{tenantId}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-47-  public Mono<ResponseEntity<CertificateChainDto>> getLeafCertificate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:48:      @PathVariable String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-49-    logger.debug("Fetching leaf certificate for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:51:    return destinationService
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-52-        .getCertificateWithAccessToken(tenantId)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:53:        .map(certificateDto -> processLeafCertificate(certificateDto, tenantId))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-54-        .onErrorResume(e -> handleCertificateError(e, tenantId))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-55-        .switchIfEmpty(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-61-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:63:  private ResponseEntity<CertificateChainDto> processLeafCertificate(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:64:      DestinationServiceCertificateDto certificateDto, String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-65-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:66:      String pemContent =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:67:          DestinationServiceCertificateParser.decodePEMContent(certificateDto.content());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-68-      List<X509Certificate> certificates =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:69:          DestinationServiceCertificateParser.extractCertificates(pemContent);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-71-      if (certificates.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:72:        logger.warn("No certificates found in PEM content for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-73-        return ResponseEntity.notFound().build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-74-      }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-78-      List<X509Certificate> leafOnly = List.of(leafCertificate);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-79-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:80:      String leafCertificatePem =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:81:          DestinationServiceCertificateParser.rebuildPemWithoutPrivateKey(leafOnly);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:82:      String certificateContent = Base64.getEncoder().encodeToString(leafCertificatePem.getBytes());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-84-      logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:85:          "Successfully retrieved leaf certificate (without private key) for tenant: {}", tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-86-      return ResponseEntity.ok(new CertificateChainDto(certificateDto.name(), certificateContent));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-87-    } catch (CertificateException e) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-94-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-95-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:96:  private Mono<ResponseEntity<CertificateChainDto>> handleCertificateError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java:97:      Throwable e, String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-98-    ResponseEntity<CertificateChainDto> response;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/PublicCertificatesController.java-99-    if (e instanceof ResponseStatusException rse) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java:1:package com.sap.bpi.api.gw.dto.destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java-3-import com.fasterxml.jackson.annotation.JsonProperty;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java-6- Example:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java-7- {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java:8:   "Name": "test1.pem",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java:9:   "Content": "LS0tLS1CRUdJTiBQUk..."
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java-10- }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java:11: The "Content" field contains the private key and the full certificate chain in a Base64 encoded String
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java-12-*/
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java:14:public record DestinationServiceCertificateDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/DestinationServiceCertificateDto.java:15:    @JsonProperty("Name") String name, @JsonProperty("Content") String content) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java:1:package com.sap.bpi.api.gw.security.jwt.strategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java:3:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-4-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-5-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-7- * Strategy interface for token validation.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-8- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java:9: * <p>Each concrete strategy implements validation for a specific token type (e.g., SAP JWT, SPM
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java:10: * Token, UGW JWT).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-11- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-12- * <p>The Strategy Pattern allows: - Adding new token types without modifying
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-18-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java:19:   * Checks if this strategy can handle the given request.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-20-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-21-   * @param exchange the server web exchange containing request headers
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-27-   * Validates the token in the request and returns validation result.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-28-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java:29:   * <p>This method should: 1. Extract the token from the request 2. Validate the token (signature,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-30-   * expiry, claims) 3. Extract metadata (user, tenant, client ID) 4. Return TokenValidationResult
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationStrategy.java-31-   * with success/failure
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:1:package com.sap.bpi.api.gw.security.jwt.ugw;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-3-import static io.jsonwebtoken.io.Encoders.BASE64;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-5-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:6:import io.jsonwebtoken.Jwts;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-7-import io.jsonwebtoken.io.Decoders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-8-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-9-import java.nio.ByteBuffer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-10-import java.security.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:11:import java.security.spec.InvalidKeySpecException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:12:import java.security.spec.PKCS8EncodedKeySpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:13:import java.security.spec.X509EncodedKeySpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-14-import java.util.UUID;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-15-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-16-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:17:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:18:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:19:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-21-@SuppressWarnings({"PMD.PreserveStackTrace"})
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-22-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:23:public class UgwJwtConfig {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:24:  static final int MAX_JWT_STRING_SIZE = 7 * 1024; // 7kb
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:25:  private static final String SH_256_ALGORITHM = "SHA256";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:26:  private final Logger logger = LoggerFactory.getLogger(UgwJwtConfig.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:27:  private KeyPair keyPair;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:28:  private String keyId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:29:  private final String encodedPrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:30:  private final String encodedPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:32:  @Value("${jwt.ugw.clientId}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:33:  private String audience;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-35-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:36:  public UgwJwtConfig(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:37:      @Value("${jwt.ugw.privateKey}") String encodedPrivateKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:38:      @Value("${jwt.ugw.publicKey}") String encodedPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:39:    this.encodedPrivateKey = encodedPrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:40:    this.encodedPublicKey = encodedPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:43:  public KeyPair getKeyPair() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:44:    if (keyPair == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:45:      keyPair = generateKeyPair();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-46-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:47:    return keyPair;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-48-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:50:  private KeyPair generateKeyPair() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:51:    byte[] decodedPublicKey = Decoders.BASE64.decode(encodedPublicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:52:    byte[] decodedPrivateKey = Decoders.BASE64.decode(encodedPrivateKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:54:    KeyFactory keyFactory = getKeyFactoryInstance();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:56:    PublicKey publicKey = generatePublicKey(keyFactory, decodedPublicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:57:    PrivateKey privateKey = generatePrivateKey(keyFactory, decodedPrivateKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:58:    return new KeyPair(publicKey, privateKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-59-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:61:  private String generateKeyId(PublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-62-    MessageDigest messageDigest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-63-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-64-      messageDigest = MessageDigest.getInstance(SH_256_ALGORITHM);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-65-    } catch (NoSuchAlgorithmException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:66:      logger.error("Could not find an encryption algorithm for the public key");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-67-      throw new RuntimeException(e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-68-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:69:    byte[] hash = messageDigest.digest(publicKey.getEncoded());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:70:    ByteBuffer byteBuffer = ByteBuffer.wrap(hash);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-71-    long high = byteBuffer.getLong(); // reads the first 8 bytes
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-72-    long low = byteBuffer.getLong(); // reads the next 8 bytes
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-73-    // using UUID format is not mandatory, but otherwise will need to adopt the docs
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-74-    UUID uuid = new UUID(high, low);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:75:    return uuid.toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-76-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:78:  private KeyFactory getKeyFactoryInstance() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-79-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:80:      return KeyFactory.getInstance("RSA");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-81-    } catch (NoSuchAlgorithmException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:82:      logger.error("Could not find an encryption algorithm for the key factory");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-83-      throw new RuntimeException(e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-84-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-85-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:87:  private PublicKey generatePublicKey(KeyFactory keyFactory, byte[] encodedPublicKeyBytes) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-88-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:89:      return keyFactory.generatePublic(new X509EncodedKeySpec(encodedPublicKeyBytes));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:90:    } catch (InvalidKeySpecException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-91-      logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:92:          "Could not generate a public key from the provided UGW keys. Please check the encoded"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-93-              + " value");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:94:      throw new IllegalArgumentException("Invalid UGW public key");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-95-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-96-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:98:  private PrivateKey generatePrivateKey(KeyFactory keyFactory, byte[] encodedPrivateKeyBytes) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-99-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:100:      return keyFactory.generatePrivate(new PKCS8EncodedKeySpec(encodedPrivateKeyBytes));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:101:    } catch (InvalidKeySpecException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-102-      logger.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:103:          "Could not generate a private key from the provided UGW keys. Please check the encoded"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-104-              + " value");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:105:      throw new IllegalArgumentException("Invalid UGW private key");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-106-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-107-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-108-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:109:  public String getKeyIdFromInternalKeyPair() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:110:    if (keyId == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:111:      keyId = generateKeyId(getPublicKeyFromInternalKeyPair());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-112-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:113:    return keyId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-114-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-115-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:116:  public String getKeyId(PublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:117:    // Always generate fresh ID for external keys
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:118:    return generateKeyId(publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-119-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-120-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:121:  public PublicKey getPublicKeyFromInternalKeyPair() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:122:    return getKeyPair().getPublic();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-123-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-124-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:125:  public String getPublicKeyAsEncodedString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:126:    return getPublicKeyAsEncodedString(getPublicKeyFromInternalKeyPair());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-127-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-128-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:129:  public String getPublicKeyAsEncodedString(PublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:130:    String base64EncodedKeyValue = BASE64.encode(publicKey.getEncoded());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:131:    return String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:132:        "-----BEGIN PUBLIC KEY-----\n%s\n-----END PUBLIC KEY-----", base64EncodedKeyValue);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-133-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-134-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:135:  public String getAudience() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-136-    return audience;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-137-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-138-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:139:  public String generateSignedJwt(Claims claims, String appUrl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:140:    String jwtString =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:141:        Jwts.builder()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-142-            .header()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:143:            .keyId(getKeyIdFromInternalKeyPair())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:144:            .jwkSetUrl(URI.create(appUrl + "/apigw/v1/keys"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-145-            .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-146-            .claims(claims)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:147:            .signWith(getKeyPair().getPrivate())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-148-            .compact();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-149-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:150:    int jwtSize = jwtString.getBytes().length;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:151:    if (jwtSize > MAX_JWT_STRING_SIZE) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-152-      logger.warn(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:153:          "JWT String exceeds maximum length. Current length: {}, Max length: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:154:          jwtSize,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:155:          MAX_JWT_STRING_SIZE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-156-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-157-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java:158:    return jwtString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-159-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtConfig.java-160-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:1:package com.sap.bpi.api.gw.security.jwt.strategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:3:import static com.sap.bpi.api.gw.security.jwt.TokenAuthorizationManager.TOKEN_TYPE_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.extractBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:5:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.isBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:7:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:8:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:9:import java.util.HashMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-10-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-11-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-12-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:13:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:14:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:15:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:16:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:17:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-18-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-20-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:21: * Validation strategy for Joule JWT tokens (XSUAA and IAS).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-22- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:23: * <p>Handles: - XSUAA JWT from BTP (issuer: *.ondemand.com) - IAS JWT from Identity Authentication
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-24- * Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-25- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:26: * <p>This strategy wraps the existing JouleCompositeJwtVerifier which automatically routes between
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:27: * XSUAA and IAS verifiers based on JWT content.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-28- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-29-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:30:public class SapJwtValidationStrategy implements TokenValidationStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:32:  private static final Logger logger = LoggerFactory.getLogger(SapJwtValidationStrategy.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:33:  private static final String CLIENT_ID =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-34-      "joule"; // Must match RequestOrigin.JOULE for isJouleRoute predicate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:36:  private final JwtVerifierStrategy jouleCompositeJwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:38:  public SapJwtValidationStrategy(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:39:      @Qualifier("jouleCompositeJwtVerifier") JwtVerifierStrategy jouleCompositeJwtVerifier) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:40:    this.jouleCompositeJwtVerifier = jouleCompositeJwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-43-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-44-  public boolean canHandle(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:45:    String authHeader = exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-47-    // Can handle if there's a Bearer token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:48:    // The actual JWT type validation is done in validate() method
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-49-    return isBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-50-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-52-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-53-  public Mono<TokenValidationResult> validate(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:54:    JwtValidationContext context = JwtValidationContext.from(exchange.getRequest().getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:55:    String authHeader = context.getHeader(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-56-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-57-    if (!isBearerToken(authHeader)) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-59-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:61:    String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:63:    return jouleCompositeJwtVerifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:64:        .isJwtValid(token, context)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-65-        .map(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-66-            tuple -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-67-              AuthorizationDecision decision = tuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:68:              String signavioTenantId = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-70-              if (!decision.isGranted()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:71:                logger.debug("Joule JWT validation failed");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:72:                return TokenValidationResult.failure("Joule JWT validation failed");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-73-              }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-74-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-75-              // Extract metadata to be set as exchange attributes
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:76:              Map<String, Object> metadata = new HashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:77:              metadata.put("x-signavio-tenant-id", signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-78-              metadata.put("x-client-id", CLIENT_ID); // Required for isJouleRoute predicate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:79:              metadata.put(TOKEN_TYPE_ATTRIBUTE, TokenType.SAP_JWT.getTokenTypeValue());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:81:              logger.debug("SAP JWT validation successful for tenant: {}", signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-82-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-83-              return TokenValidationResult.success(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:84:                  TokenType.SAP_JWT.getTokenTypeValue(), CLIENT_ID, metadata);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-85-            })
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-86-        .onErrorResume(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-87-            error -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:88:              logger.error("Error during Joule JWT validation", error);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-89-              return Mono.just(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-90-                  TokenValidationResult.failure(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:91:                      "Joule JWT validation error: " + error.getMessage()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-92-            });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-93-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-95-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-96-  public TokenType getTokenType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java:97:    return TokenType.SAP_JWT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-98-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SapJwtValidationStrategy.java-99-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:1:package com.sap.bpi.api.gw.security.jwt.utils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:3:import static com.sap.bpi.api.gw.filters.utils.JwtUtils.BEARER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-5-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-6-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:7:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:8:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-9-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-10-import reactor.util.function.Tuple2;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:12:public final class JwtAuthorizationManagerUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:13:  public static final String WELL_KNOWN_PATH = "/.well-known/openid-configuration";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:14:  private static final String X_CLIENT_ID_ATTRIBUTE = "x-client-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:15:  private static final String X_SIGNAVIO_TENANT_ID_ATTRIBUTE = "x-signavio-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:16:  private static final Logger logger = LoggerFactory.getLogger(JwtAuthorizationManagerUtils.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:18:  public static boolean isBearerToken(String authHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-19-    return authHeader != null && authHeader.startsWith(BEARER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-20-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:22:  public static String extractBearerToken(String authHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:23:    return authHeader.substring(BEARER.length() + 1);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-24-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:26:  public static Mono<AuthorizationDecision> handleJwtValidationResult(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:27:      AuthorizationContext context, Tuple2<AuthorizationDecision, String> tuple2, String clientId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-28-    AuthorizationDecision isValid = tuple2.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-29-    if (isValid.isGranted()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:30:      String signavioTenantId = tuple2.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:31:      addAttributesToExchange(context, signavioTenantId, clientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-32-      logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:33:          "XSUAA JWT is valid. Adding x-signavio-tenant-id attribute {} and {} x-client-id"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-34-              + " attribute to the request.",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:35:          signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-36-          clientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-37-      return Mono.just(new AuthorizationDecision(true));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-40-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:42:  private static void addAttributesToExchange(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:43:      AuthorizationContext context, String signavioTenantId, String clientId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:44:    // since Spring Webflux 6.2.0 it's not possible to modify the headers in the ServerExchange,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:45:    // therefore we use attributes. Upstream filter XsuaaJwtToSpmJwtFilterFactory relies on the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:46:    // X_SIGNAVIO_TENANT_ID_ATTRIBUTE attribute.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-47-    // The X_CLIENT_ID_ATTRIBUTE attribute is used by our RoutesConfig to determine if it is a Joule
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-48-    // request.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java:49:    context.getExchange().getAttributes().put(X_SIGNAVIO_TENANT_ID_ATTRIBUTE, signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-50-    context.getExchange().getAttributes().put(X_CLIENT_ID_ATTRIBUTE, clientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/utils/JwtAuthorizationManagerUtils.java-51-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:1:package com.sap.bpi.api.gw.security.jwt.strategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:3:import java.util.HashMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-4-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-5-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-11-public class TokenValidationResult {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:13:  private final boolean valid;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:14:  private final String tokenType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:15:  private final String clientId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:16:  private final Map<String, Object> metadata;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:17:  private final String errorMessage;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:19:  private TokenValidationResult(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-20-      boolean valid,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:21:      String tokenType,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:22:      String clientId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:23:      Map<String, Object> metadata,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:24:      String errorMessage) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-25-    this.valid = valid;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-26-    this.tokenType = tokenType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-27-    this.clientId = clientId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:28:    this.metadata = metadata != null ? metadata : new HashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-29-    this.errorMessage = errorMessage;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-30-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-33-   * Creates a successful validation result.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-34-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:35:   * @param tokenType the token type (e.g., "sap-jwt", "spm-token", "ugw-jwt")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-36-   * @param clientId the client ID extracted from token or a fixed identifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-37-   * @param metadata additional metadata to set as exchange attributes
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-39-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-40-  public static TokenValidationResult success(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:41:      String tokenType, String clientId, Map<String, Object> metadata) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-42-    return new TokenValidationResult(true, tokenType, clientId, metadata, null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-43-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-49-   * @return TokenValidationResult indicating failure
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-50-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:51:  public static TokenValidationResult failure(String errorMessage) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-52-    return new TokenValidationResult(false, null, null, null, errorMessage);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-53-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:59:  public String getTokenType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-60-    return tokenType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-61-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:63:  public String getClientId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-64-    return clientId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-65-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:67:  public Map<String, Object> getMetadata() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-68-    return metadata;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java:71:  public String getErrorMessage() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-72-    return errorMessage;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenValidationResult.java-73-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:1:package com.sap.bpi.api.gw.security.jwt.strategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-3-/**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-7-public enum TokenType {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-8-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:9:   * SAP JWT tokens (XSUAA and IAS tokens from SAP BTP).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-10-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-11-   * <p>Used by:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-12-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-13-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:14:   *   <li>{@link SapJwtValidationStrategy} for validation
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:15:   *   <li>{@link com.sap.bpi.api.gw.filters.SapJwtToSpmJwtGatewayFilterFactory} for conversion
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-16-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-17-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:18:  SAP_JWT("sap-jwt"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-20-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:21:   * UGW (Unified Gateway) JWT tokens (internal tokens issues by APIGW).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-22-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-23-   * <p>Used by:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-24-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-25-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:26:   *   <li>{@link UgwJwtValidationStrategy} for validation
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:27:   *   <li>{@link com.sap.bpi.api.gw.filters.UgwJwtToSpmJwtFilterFactory} for conversion
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-28-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-29-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:30:  UGW_JWT("ugw-jwt"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-32-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:33:   * SPM legacy tokens (X-Signavio-Id header).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-34-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-35-   * <p>Used by:
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-37-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-38-   *   <li>{@link SpmTokenValidationStrategy} for validation
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:39:   *   <li>{@link com.sap.bpi.api.gw.filters.SpmTokenToSpmJwtFilterFactory} for conversion
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-40-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-41-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-43-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-44-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:45:   * SPM symmetric JWT.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-46-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:47:   * <p>Used by {@link com.sap.bpi.api.gw.filters.UnifiedJwtConversionFilterFactory}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-48-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:49:  SPM_JWT("spm-jwt"),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-51-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-56-  UNKNOWN(null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:58:  private final String tokenTypeValue;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:60:  TokenType(String tokenTypeValue) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-61-    this.tokenTypeValue = tokenTypeValue;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-64-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:65:   * Returns the auth-type string value for this token type.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-66-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-67-   * <p>This value is stored in exchange attributes and used by downstream filters to determine
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:68:   * which JWT conversion to apply.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-69-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:70:   * @return the auth-type string (e.g., "sap-jwt", "spm-token", "ugw-jwt"), or null for UNKNOWN
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-71-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:72:  public String getTokenTypeValue() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-73-    return tokenTypeValue;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-74-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-76-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java:77:  public String toString() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-78-    return tokenTypeValue != null ? tokenTypeValue : "unknown";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/TokenType.java-79-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-6-import com.sap.bpi.api.gw.security.certificate.utils.CertificateValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-7-import com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:8:import com.sap.bpi.api.gw.services.ConnectivityPlatformTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-9-import java.security.cert.X509Certificate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-10-import java.util.List;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-12-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-13-import javax.security.auth.x500.X500Principal;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:14:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:15:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:16:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:17:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:18:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:19:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:20:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:21:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:22:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-23-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-24-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-26-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:27:public class ConnectivityPlatformAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:28:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:29:  public static final String X_SIGNAVIO_MAPPING_TYPE = "x-signavio-mapping-type";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:31:  private final ConnectivityPlatformTenantService tenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:32:  private final CertificateValidator certificateValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-34-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:35:  public ConnectivityPlatformAuthorizationManager(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:36:      ConnectivityPlatformTenantService tenantService, CertificateValidator certificateValidator) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-37-    this.tenantService = tenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-38-    this.certificateValidator = certificateValidator;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-44-    ServerHttpRequest request = context.getExchange().getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:46:    Optional<String> tenantId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:47:        Optional.ofNullable(request.getHeaders().getFirst(X_SIGNAVIO_TENANT_ID_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:49:    Optional<String> externalTenantId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-50-        Optional.ofNullable(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:51:            request.getHeaders().getFirst(X_CONNECTIVITY_PLATFORM_TENANT_ID_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-52-    if (tenantId.isEmpty() || externalTenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-53-      return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-54-          new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-55-              HttpStatus.BAD_REQUEST,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:56:              "Missing x-signavio-tenant-id or x-connectivity-platform-tenant-id header"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-57-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:59:    Map<String, List<String>> lowerCaseHttpHeadersMap =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:60:        AuthorizationManagerUtils.createHeadersMapWithLowercaseKeys(request.getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-61-    ValidationResult validationResult = new ValidationResult(lowerCaseHttpHeadersMap);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-62-    if (validationResult.errorsExist()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-64-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:66:    String requestId = getRequestIdFromHeaderOrGenerate(request);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-67-    Flux<X509Certificate> leafCertificateFlux =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-68-        tenantService.getLeafCertificates(tenantId.get(), externalTenantId.get(), requestId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-72-                certificateValidator.validateSubject(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-73-                    lowerCaseHttpHeadersMap,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java:74:                    RequestOrigin.CONNECTIVITY_PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-75-                    certificate.getSubjectX500Principal().getName(X500Principal.RFC2253)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ConnectivityPlatformAuthorizationManager.java-76-        .filter(AuthorizationDecision::isGranted)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:1:package com.sap.bpi.api.gw.security.jwt.spm;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:3:import static com.sap.bpi.api.gw.security.jwt.TokenAuthorizationManager.TOKEN_TYPE_ATTRIBUTE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.extractBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:5:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.isBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-7-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:8:import com.sap.bpi.api.gw.dto.SpmJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-9-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:10:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:11:import com.sap.bpi.api.gw.security.jwt.strategy.TokenType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-12-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-13-import java.util.stream.Stream;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-14-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-15-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:16:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:17:import org.springframework.security.web.server.util.matcher.OrServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:18:import org.springframework.security.web.server.util.matcher.PathPatternParserServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:19:import org.springframework.security.web.server.util.matcher.ServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:20:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-21-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-23-public class SpmGatewayRequestMatcher implements ServerWebExchangeMatcher {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:24:  private static final String SIGNAVIO_JWT_ISSUER = "signavio";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:26:  private final ServerWebExchangeMatcher pathPatternMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:27:  private final Logger logger = LoggerFactory.getLogger(SpmGatewayRequestMatcher.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:28:  private final ObjectMapper objectMapper = new ObjectMapper();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:30:  public SpmGatewayRequestMatcher(String... pathPatterns) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-31-    this.pathPatternMatcher =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-32-        new OrServerWebExchangeMatcher(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-38-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-39-  public Mono<MatchResult> matches(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:40:    String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-41-    return pathPatternMatcher
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-42-        .matches(exchange)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-44-            pathPatternMatchResult -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-45-              if (pathPatternMatchResult.isMatch()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:46:                String authHeader =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-47-                    exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-48-                if (isBearerToken(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:49:                  String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:50:                  if (isJwtIssuerFromSignavio(token, requestId)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-51-                    logger.debug("Processing request {} from SPM Gateway", requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-52-                    // Set token type for downstream filters
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-53-                    exchange
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-54-                        .getAttributes()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:55:                        .put(TOKEN_TYPE_ATTRIBUTE, TokenType.SPM_JWT.getTokenTypeValue());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-56-                    return MatchResult.match();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-57-                  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:64:  private boolean isJwtIssuerFromSignavio(String token, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-65-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:66:      String payload = JwtUtils.decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:67:      SpmJwtDto spmJwtDto = objectMapper.readValue(payload, SpmJwtDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:69:      return Optional.ofNullable(spmJwtDto.issuer())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:70:          .map(SIGNAVIO_JWT_ISSUER::equals)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-71-          .orElseGet(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-72-              () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-73-                logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:74:                    "JWT issuer is not present or not from Signavio in request {}", requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-75-                return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-76-              });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-77-    } catch (Exception ex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java:78:      logger.error("Failed to deserialize SPM JWT", ex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-79-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/spm/SpmGatewayRequestMatcher.java-80-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:1:package com.sap.bpi.api.gw.security.jwt.ugw;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:3:import static com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig.MAX_JWT_STRING_SIZE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:4:import static com.signavio.jwt.SignavioClaims.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:6:import com.signavio.jwt.Token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:7:import io.jsonwebtoken.JwtBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:8:import io.jsonwebtoken.Jwts;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-9-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:10:import java.security.KeyPair;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-11-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-12-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:13:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:14:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:15:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-17-@Service
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:18:public class UgwJwtService {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:20:  private final UgwJwtConfig ugwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:21:  private final String baseUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:23:  private final Logger logger = LoggerFactory.getLogger(UgwJwtService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-25-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:26:  public UgwJwtService(UgwJwtConfig ugwJwtConfig, @Value("${server.base-url}") String baseUrl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:27:    this.ugwJwtConfig = ugwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-28-    this.baseUrl = baseUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-29-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:31:  public String generateSignedAsymmetricJwtFromSpmJwt(Token spmJwt, KeyPair keyPair) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:33:    String tenantId = spmJwt.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:34:    String jwkSetUrl = baseUrl + "/apigw/v1/keys/" + tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:36:    JwtBuilder jwtBuilder =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:37:        Jwts.builder()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-38-            .header()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:39:            .keyId(ugwJwtConfig.getKeyId(keyPair.getPublic()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-40-            .jwkSetUrl(URI.create(jwkSetUrl))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-41-            .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:42:            .subject(spmJwt.getSubject())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:43:            .claim(TENANT_ID, spmJwt.getTenantId())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:44:            .claim(IS_GUEST_USER, spmJwt.isGuestUser())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:45:            .claim(IS_ANONYMOUS_USER, spmJwt.isAnonymousUser())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:46:            .claim(OAUTH_CLAIMS, spmJwt.getOauthClaims())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:47:            .claim(USER_GROUP_IDS, spmJwt.getUserGroupIds())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:48:            .claim(EXTERNAL_USER_GROUP_IDS, spmJwt.getExternalUserGroupIds())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:49:            .claim(OAUTH_SCOPES, spmJwt.getOauthScopes())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:50:            .claim(FEATURES, spmJwt.getFeatures())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:51:            .claim(IS_REVISION_MODE_PUBLISHED, spmJwt.isRevisionModePublished());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-53-    // Add optional claims only if they are present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:54:    spmJwt.isAdminUser().ifPresent(isAdminUser -> jwtBuilder.claim(IS_ADMIN_USER, isAdminUser));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:55:    spmJwt
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-56-        .getExternalUserId()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:57:        .ifPresent(externalUserId -> jwtBuilder.claim(EXTERNAL_USER_ID, externalUserId));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:58:    spmJwt.getUserId().ifPresent(userId -> jwtBuilder.claim(USER_ID, userId));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:59:    spmJwt.getRequestId().ifPresent(requestId -> jwtBuilder.claim(REQUEST_ID, requestId));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:60:    spmJwt.isInternal().ifPresent(isInternal -> jwtBuilder.claim(IS_INTERNAL, isInternal));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-61-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:62:    String jwtString = jwtBuilder.signWith(keyPair.getPrivate()).compact();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:64:    int jwtSize = jwtString.getBytes().length;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:65:    if (jwtSize > MAX_JWT_STRING_SIZE) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-66-      logger.warn(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:67:          "JWT String exceeds maximum length. Current length: {}, Max length: {}",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:68:          jwtSize,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:69:          MAX_JWT_STRING_SIZE);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-70-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java:72:    return jwtString;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-73-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtService.java-74-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-3-import com.sap.bpi.api.gw.dto.AuthTokenRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:4:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtClaims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:5:import com.sap.bpi.api.gw.security.jwt.ugw.UgwJwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-6-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-7-import jakarta.validation.Valid;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:8:import java.util.HashSet;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-9-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-10-import java.util.Set;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:12:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:13:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:14:import org.springframework.http.ResponseEntity;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:15:import org.springframework.web.bind.annotation.PostMapping;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:16:import org.springframework.web.bind.annotation.RequestBody;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:17:import org.springframework.web.bind.annotation.RestController;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-18-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-19-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-21-public class AuthTokenController {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:23:  private final UgwJwtConfig jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-25-  @Value("${server.base-url}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:26:  private String baseUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-28-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:29:  public AuthTokenController(UgwJwtConfig jwtConfig) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:30:    this.jwtConfig = jwtConfig;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-33-  @PostMapping("/apigw/v1/auth/token")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:34:  public Mono<ResponseEntity<String>> postAuthToken(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-35-      @Valid @RequestBody AuthTokenRequest authTokenRequest) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-36-    Claims claims =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:37:        new UgwJwtClaims()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-38-            .withToken(authTokenRequest.getToken())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-39-            .withTenantId(authTokenRequest.getTenant())
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-43-            .withAudiences(getAudiencesFromRequestOrDefault(authTokenRequest))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-44-            .build();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:45:    String jwt = jwtConfig.generateSignedJwt(claims, baseUrl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:47:    String jsonResponse = String.format("{\"token\": \"%s\"}", jwt);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-48-    return Mono.just(ResponseEntity.status(HttpStatus.CREATED).body(jsonResponse));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-49-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:51:  private Set<String> getAudiencesFromRequestOrDefault(AuthTokenRequest authTokenRequest) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:52:    Set<String> audiences = authTokenRequest.getAudience();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-54-    sanitizeAudiences(audiences);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-56-    if (audiences == null || audiences.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:57:      return new HashSet<>(List.of(jwtConfig.getAudience()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-58-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:59:      return new HashSet<>(audiences);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-60-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-61-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:63:  private void sanitizeAudiences(Set<String> audiences) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java:64:    if (audiences != null) audiences.removeIf(String::isBlank);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-65-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/controllers/AuthTokenController.java-66-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-6-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-7-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:8:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:9:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:10:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:11:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:12:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:13:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:14:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:15:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-16-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-18-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:19:public class UclAuthorizationManager implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:20:  @Value("${certificates.ucl.skipShortLivedCertificateCheck}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:21:  private boolean skipShortLivedCertificateCheck;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:23:  private final Logger logger = LoggerFactory.getLogger(UclAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:25:  public List<Set<String>> uclSubjectArray;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:26:  public List<Set<String>> uclIssuerArray;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:28:  private final CertificateValidator certificateValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-30-  public UclAuthorizationManager(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-31-      CertificateValidator certificateValidator,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:32:      @Value("${certificates.ucl.subject}") String uclSubject,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:33:      @Value("${certificates.ucl.issuer}") String uclIssuer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-34-    this.uclSubjectArray =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-35-        AuthorizationManagerUtils.splitMultipleSubjectsOrIssuersToSeparateParts(uclSubject);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-42-  public Mono<AuthorizationDecision> check(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-43-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:44:    Map<String, List<String>> lowerCaseHttpHeadersMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-45-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-46-      lowerCaseHttpHeadersMap = AuthorizationManagerUtils.extractAndValidateHeaders(context);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-49-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:51:    String subject =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-52-        lowerCaseHttpHeadersMap.get(RequestWithCertificateHeader.SUBJECT.getHeaderName()).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-53-    if (!certificateValidator.isSubjectValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-54-        uclSubjectArray, AuthorizationManagerUtils.splitTrimInput(subject))) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:55:      String errorMsg = "Certificate subject is not valid";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-56-      logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-57-      return Mono.error(new ResponseStatusException(HttpStatus.UNAUTHORIZED, errorMsg));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-58-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:60:    String issuer =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-61-        lowerCaseHttpHeadersMap.get(RequestWithCertificateHeader.ISSUER.getHeaderName()).get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-62-    if (!certificateValidator.isIssuerValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-63-        uclIssuerArray, AuthorizationManagerUtils.splitTrimInput(issuer))) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:64:      String errorMsg = "Certificate issuer is not valid";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-65-      logger.error(errorMsg);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-66-      return Mono.error(new ResponseStatusException(HttpStatus.UNAUTHORIZED, errorMsg));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-67-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:69:    String certificate =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-70-        lowerCaseHttpHeadersMap
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-71-            .get(RequestWithCertificateHeader.CERTIFICATE.getHeaderName())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-72-            .get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:74:    // We only check for short-lived certificates if the configuration does not explicitly skip this
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-75-    // check.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:76:    // This allows for flexibility in environments where short-lived certificates are not used or
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-77-    // managed differently.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:78:    // For example for SCE region where our own created certificates are used and not short-lived.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:79:    if (skipShortLivedCertificateCheck) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:80:      logger.debug("Short-lived certificate validation is disabled, skipping check.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-81-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:82:      if (!certificateValidator.isShortLivedCertificate(certificate)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-83-        return Mono.error(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java:84:            new ResponseStatusException(HttpStatus.UNAUTHORIZED, "Certificate is not short-lived"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-85-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/UclAuthorizationManager.java-86-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:1:package com.sap.bpi.api.gw.security.jwt.strategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:3:import java.util.HashMap;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-4-import java.util.Map;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-5-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-6-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:7:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:8:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-9-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-10-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-13- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-14- * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:15: *   <li>Detection: canHandle() checks if x-signavio-id OR cookie header is present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-16- *   <li>Validation: Always returns SUCCESS to allow request to proceed to filter layer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:17: *   <li>All actual validation is delegated to SpmTokenToSpmJwtFilterFactory for now
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-18- * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-19- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:20: * <p>The actual validation, token extraction, and JWT conversion happens in
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:21: * SpmTokenToSpmJwtFilterFactory via FilterUtils.getAuthenticationHeadersTuple3Mono(). This avoids
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-22- * duplicating the validation logic that already exists in the filter layer.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-23- */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-25-public class SpmTokenValidationStrategy implements TokenValidationStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:27:  private static final Logger logger = LoggerFactory.getLogger(SpmTokenValidationStrategy.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:28:  private static final String X_SIGNAVIO_ID_HEADER = "x-signavio-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:29:  private static final String COOKIE_HEADER = "cookie";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-31-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-32-  public boolean canHandle(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:33:    // Can handle if X-Signavio-Id header OR cookie header is present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:34:    // (GET requests can have token in cookie instead of x-signavio-id header)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:35:    String xSignavioId = exchange.getRequest().getHeaders().getFirst(X_SIGNAVIO_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:36:    String cookie = exchange.getRequest().getHeaders().getFirst(COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:38:    boolean hasXSignavioId = xSignavioId != null && !xSignavioId.trim().isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-39-    boolean hasCookie = cookie != null && !cookie.trim().isEmpty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:41:    boolean canHandle = hasXSignavioId || hasCookie;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-43-    if (canHandle) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:44:      logger.debug("Detected signavio Id or cookie, can handle SPM token authentication");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-45-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-46-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-50-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-51-  public Mono<TokenValidationResult> validate(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:52:    // SPM token validation is delegated to SpmTokenToSpmJwtFilterFactory filter via
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:53:    // UnifiedJwtConversionFilterFactory.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-54-    //
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-55-    // Architecture flow:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-56-    // 1. TokenAuthorizationManager calls this strategy to check if SPM token is present
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-57-    // 2. This strategy returns SUCCESS (pass-through) to allow request to proceed
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:58:    // 3. Request reaches UnifiedJwtConversionFilterFactory (at filter layer)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:59:    // 4. UnifiedJwtConversionFilterFactory delegates to SpmTokenToSpmJwtFilterFactory
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:60:    // 5. SpmTokenToSpmJwtFilterFactory performs actual SPM validation and JWT conversion
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-61-    //
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-62-    // This approach allows unified route to work with existing SPM token validation logic
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-65-    logger.debug("SPM token detected - passing through to filter layer for validation");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:67:    Map<String, Object> metadata = new HashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:68:    metadata.put("x-signavio-tenant-id", "to-be-set-by-filter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java:69:    metadata.put("x-signavio-user-id", "to-be-set-by-filter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/strategy/SpmTokenValidationStrategy.java-71-    return Mono.just(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-7-public class ValidationResult {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:8:  private final List<String> missingHeaders = new ArrayList<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:9:  private final List<String> duplicateHeaders = new ArrayList<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:11:  public ValidationResult(Map<String, List<String>> httpHeadersMap) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:12:    for (String header : RequestWithCertificateHeader.getAllHeaderNames()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:13:      List<String> values = httpHeadersMap.get(header);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-14-      if (values == null || values.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-15-        missingHeaders.add(header);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-16-      } else if (values.size()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:17:          > 1) { // multiple values for same header, we cannot just choose one randomly
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-18-        duplicateHeaders.add(header);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-19-      }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-25-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:27:  public String getMissingHeadersErrorMessage() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:28:    String errorMessage = "";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-29-    if (!missingHeaders.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:30:      errorMessage = "Missing header(s): " + String.join(", ", missingHeaders);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-31-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-32-    return errorMessage;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-33-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:35:  public String getDuplicateHeadersErrorMessage() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:36:    String errorMessage = "";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-37-    if (!duplicateHeaders.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:38:      errorMessage = "Duplicate header(s): " + String.join(", ", duplicateHeaders);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-39-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-40-    return errorMessage;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:43:  public String createHeaderErrorMessage() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-44-    if (missingHeaders.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-45-      return getDuplicateHeadersErrorMessage();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-47-      return getMissingHeadersErrorMessage();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-48-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java:49:      return String.format(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-50-          "%s; %s", getMissingHeadersErrorMessage(), getDuplicateHeadersErrorMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/ValidationResult.java-51-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-9-  @JsonProperty("@odata.context")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java:10:  private String odataContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-12-  @JsonProperty("value")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java:13:  private List<Object> value = new ArrayList<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-15-  public ODataResponseDto() {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-22-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java:24:  public String getOdataContext() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-25-    return odataContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-26-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java:28:  public void setOdataContext(String odataContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-29-    this.odataContext = odataContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ODataResponseDto.java-30-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:1:package com.sap.bpi.api.gw.security.jwt.ugw;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-3-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:4:import io.jsonwebtoken.Jwts;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-5-import java.time.OffsetDateTime;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-6-import java.util.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:8:public class UgwJwtClaims {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:9:  private static final int DEFAULT_EXPIRATION_TIME_IN_DAYS = 1;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:10:  public static final String TENANT_ID_CLAIM = "ten";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:11:  public static final String USER_ID_CLAIM = "uid";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:12:  public static final String TOKEN_CLAIM = "tok";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:13:  public static final String AUDIENCE_CLAIM = "aud";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:14:  public static final String IS_ADMIN_CLAIM = "adm";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:15:  public static final String ISSUED_AT_CLAIM = "iat";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:16:  public static final String EXPIRATION_CLAIM = "exp";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:18:  public static final String RATE_LIMITING_CLAIM = "zid";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:19:  public static final String FEATURES_CLAIM = "fts";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:20:  public static final String LICENSES_CLAIM = "lcs";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:21:  public static final String USER_GROUPS_CLAIM = "ugr";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:22:  private String tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:23:  private String userId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:24:  private String token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:25:  private String issuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:26:  private String subject;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:27:  private String audience;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:28:  private Set<String> audiences;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:29:  private boolean isAdmin;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:30:  private Set<String> featuresOfApps;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:31:  private List<String> licenses;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:32:  private List<String> userGroups;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:33:  private String expirationDate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:34:  private final Calendar calendar = Calendar.getInstance();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-35-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:36:  public UgwJwtClaims withTenantId(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-37-    this.tenantId = tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-38-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-39-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:41:  public UgwJwtClaims withUserId(String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-42-    this.userId = userId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-43-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-44-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:46:  public UgwJwtClaims withSubject(String subject) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-47-    this.subject = subject;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-48-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-49-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:51:  public UgwJwtClaims withIssuer(String issuer) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-52-    this.issuer = issuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-53-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-54-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:56:  public UgwJwtClaims withAudience(String audience) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-57-    this.audience = audience;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-58-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-59-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:61:  public UgwJwtClaims withAudiences(Set<String> audiences) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-62-    this.audiences = audiences;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-63-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-64-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:66:  public UgwJwtClaims withToken(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-67-    this.token = token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-68-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-69-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-70-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:71:  public UgwJwtClaims withFeaturesOfApps(Set<String> featuresOfApps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-72-    this.featuresOfApps = featuresOfApps;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-73-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-74-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:76:  public UgwJwtClaims withLicenses(List<String> licenses) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-77-    this.licenses = licenses;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-78-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:81:  public UgwJwtClaims withUserGroups(List<String> userGroups) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-82-    this.userGroups = userGroups;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-83-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-84-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-85-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:86:  public UgwJwtClaims withAdmin(boolean isAdmin) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-87-    this.isAdmin = isAdmin;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-88-    return this;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-89-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:91:  public UgwJwtClaims withExpirationDate(String expirationDate) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-92-    this.expirationDate = expirationDate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-93-    return this;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-96-  public Claims build() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-97-    Date now = calendar.getTime();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:98:    Set<String> aud;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-100-    if (audience != null && !audience.isBlank()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:101:      aud = new HashSet<>(List.of(audience));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-102-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-103-      aud = audiences;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-104-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-105-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:106:    return Jwts.claims()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:107:        .id(UUID.randomUUID().toString())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-108-        .issuedAt(now)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-109-        .issuer(issuer)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-117-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-118-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:119:  private Map<String, Object> getNonStandardClaims() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:120:    Map<String, Object> nonStandardClaims = new HashMap<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-121-    nonStandardClaims.put(TENANT_ID_CLAIM, tenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-122-    nonStandardClaims.put(USER_ID_CLAIM, userId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-135-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-136-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java:137:  private Date createExpirationDate() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-138-    if (expirationDate == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ugw/UgwJwtClaims.java-139-      calendar.add(Calendar.DAY_OF_MONTH, DEFAULT_EXPIRATION_TIME_IN_DAYS);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-14-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-15-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:16:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:17:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:18:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:19:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:20:import org.springframework.http.server.reactive.ServerHttpRequest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:21:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:22:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:23:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:24:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:25:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:26:import org.springframework.web.server.ResponseStatusException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-27-import reactor.core.publisher.Flux;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-28-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-30-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:31:public class SPMAuthorizationManager implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:33:  public static final String SAP_SIGNAVIO_TENANT_ID_HEADER = "sap-signavio-tenant-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:34:  public static final String SAP_SIGNAVIO_USER_ID_HEADER = "sap-signavio-user-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:35:  private final CertificateValidator certificateValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:36:  private final List<Set<String>> trustedSubjects;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:37:  private final List<Set<String>> trustedIssuers;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:38:  private final String trustedTenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:39:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:41:  private final Logger logger = LoggerFactory.getLogger(SPMAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-43-  @Autowired
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-45-      CertificateValidator certificateValidator,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-46-      AuditLogClientManager auditLogClientManager,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:47:      @Value("${app.spm.trustedSubjects}") String spmTrustedSubjects,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:48:      @Value("${app.spm.trustedIssuers}") String spmTrustedIssuers,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:49:      @Value("${app.spm.trustedTenant}") String spmTrustedTenant) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-50-    this.certificateValidator = certificateValidator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-51-    this.auditLogClientManager = auditLogClientManager;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-62-    ServerHttpRequest request = context.getExchange().getRequest();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:64:    String certificateHeader = request.getHeaders().getFirst(CERTIFICATE.getHeaderName());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-66-    Flux<X509Certificate> leafCertificateFlux;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-70-          new ResponseStatusException(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-71-              HttpStatus.BAD_REQUEST,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:72:              "Missing sap-signavio-tenant-id or sap-signavio-user-id header or values are"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-73-                  + " incorrect"));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-74-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-76-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:77:      String encodedCertificate = certificateValidator.getCertificateFromHeader(certificateHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-78-      leafCertificateFlux =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-79-          Flux.just(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-125-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:127:  private boolean areHeadersValid(HttpHeaders headers) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:128:    Optional<String> tenantId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:129:        Optional.ofNullable(headers.getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-130-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:131:    Optional<String> userId = Optional.ofNullable(headers.getFirst(SAP_SIGNAVIO_USER_ID_HEADER));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-132-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-133-    boolean isTenantValid =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-138-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-139-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:140:  private void logCertValidationFailure(HttpHeaders headers) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:141:    List<String> sourceIps = getSourceIpsFromHttpHeaders(headers);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:142:    String tenantId = headers.getFirst(SAP_SIGNAVIO_TENANT_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java:143:    String userId = headers.getFirst(SAP_SIGNAVIO_USER_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-144-    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/certificate/SPMAuthorizationManager.java-145-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateAttributes.java:1:package com.sap.bpi.api.gw.dto.destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateAttributes.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateAttributes.java-3-import com.fasterxml.jackson.annotation.JsonProperty;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateAttributes.java-5-public record CertificateAttributes(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateAttributes.java-6-    @JsonProperty("AutomaticRenew") boolean automaticRenew,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateAttributes.java:7:    @JsonProperty("CN") String cn,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateAttributes.java-8-    @JsonProperty("Validity") CertificateValidity validity) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java-3-public record SpgUser(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java:4:    String id,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java:5:    String email,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java-6-    boolean isAdmin,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java:7:    String organizationId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java:8:    String organizationKey,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpgUser.java:9:    String tenantId) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:1:package com.sap.bpi.api.gw.security.jwt.joule;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:3:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:4:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:5:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-6-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-7-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:8:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:9:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:10:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:11:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-12-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-13-import reactor.util.function.Tuple2;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-15-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:16: * JouleCompositeJwtVerifier provides unified JWT verification for Joule routes by routing between
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:17: * XSUAA and IAS JWT verifiers based on JWT type detection.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-18- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:19: * <p>This composite verifier maintains backward compatibility with existing XSUAA JWT flows while
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:20: * enabling support for IAS JWTs. It uses JWT content analysis to determine the appropriate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-21- * verification strategy.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-22- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:23: * <p>JWT Routing Logic: - XSUAA JWTs: Contains ext_attr.enhancer: "XSUAA" claim  routed to
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:24: * JouleXsuaaJwtVerifier - IAS JWTs: All other JWTs  routed to JouleIasJwtVerifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-25- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:26:@Service("jouleCompositeJwtVerifier")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:27:public class JouleCompositeJwtVerifier implements JwtVerifierStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:28:  private final Logger logger = LoggerFactory.getLogger(JouleCompositeJwtVerifier.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:30:  private final JwtVerifierStrategy xsuaaJwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:31:  private final JwtVerifierStrategy iasJwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-33-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:34:  public JouleCompositeJwtVerifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:35:      @Qualifier("jouleXsuaaJwtVerifier") JwtVerifierStrategy xsuaaJwtVerifier,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:36:      @Qualifier("jouleIasJwtVerifier") JwtVerifierStrategy iasJwtVerifier) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:37:    this.xsuaaJwtVerifier = xsuaaJwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:38:    this.iasJwtVerifier = iasJwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-39-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-40-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-41-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:42:  public Mono<Tuple2<AuthorizationDecision, String>> isJwtValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:43:      String token, JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-45-    if (token == null || token.trim().isEmpty()) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-50-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:51:      if (JwtUtils.isXsuaaJwt(token)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:52:        logger.debug("Routing JWT to XSUAA verifier");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:53:        return xsuaaJwtVerifier.isJwtValid(token, jwtValidationContext);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-54-      } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:55:        logger.debug("Routing JWT to IAS verifier");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:56:        return iasJwtVerifier.isJwtValid(token, jwtValidationContext);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-57-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-58-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:59:      logger.error("Error during JWT type detection", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-60-      return Mono.just(createDeniedResult());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-61-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java:64:  private Tuple2<AuthorizationDecision, String> createDeniedResult() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-65-    return reactor.util.function.Tuples.of(new AuthorizationDecision(false), "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleCompositeJwtVerifier.java-66-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ExternalUserInfo.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ExternalUserInfo.java-3-public record ExternalUserInfo(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/ExternalUserInfo.java:4:    String connectedAccountId, String email, String externalId, String tenantId) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-4-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-5-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:6:import org.springframework.data.redis.core.ReactiveRedisOperations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-7-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-9-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:10: * Generic Redis service for caching operations. This service provides basic Redis operations for
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-11- * any type T.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-12- *
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-15-public class GenericRedisService<T> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:17:  private static final Logger logger = LoggerFactory.getLogger(GenericRedisService.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:18:  private final ReactiveRedisOperations<String, T> operations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:20:  public GenericRedisService(ReactiveRedisOperations<String, T> operations) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-21-    this.operations = operations;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-22-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-24-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:25:   * Get a value from Redis by key.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-26-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:27:   * @param key The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-28-   * @return Mono of the cached value, empty if not found
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-29-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:30:  public Mono<T> get(String key) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:31:    if (key == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-32-      return Mono.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-33-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:35:    logger.debug("Attempting to retrieve value from Redis for key: {}", key);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-36-    return operations
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-37-        .opsForValue()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:38:        .get(key)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:39:        .doOnNext(value -> logger.debug("Retrieved value from Redis for key: {}", key))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:40:        .doOnError(e -> logger.error("Error retrieving value from Redis for key: {}", key, e));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-42-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-44-   * Set a value in Redis with TTL.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-45-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:46:   * @param key The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-47-   * @param value The value to cache
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:48:   * @param ttl Time to live
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-49-   * @return Mono<Boolean> indicating success/failure
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-50-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:51:  public Mono<Boolean> set(String key, T value, Duration ttl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:52:    if (key == null || value == null || ttl == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-53-      return Mono.just(false);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-54-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:56:    logger.debug("Saving value to Redis with key: {} and TTL: {}", key, ttl);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-57-    return operations
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-58-        .opsForValue()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:59:        .set(key, value, ttl)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-60-        .doOnNext(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-61-            success ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-62-                logger.debug(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:63:                    "Saved value to Redis with key: {}, TTL: {}, success: {}", key, ttl, success))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-64-        .doOnError(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java:65:            e -> logger.error("Error saving value to Redis for key: {} with TTL: {}", key, ttl, e));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-66-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/GenericRedisService.java-67-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-13-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:14: * Utility class for generating Redis keys used across different caching services. Contains all key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-15- * generation logic extracted from the original Redis services.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-16- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:17:public class RedisKeyUtils {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:19:  private static final Logger logger = LoggerFactory.getLogger(RedisKeyUtils.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-20-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:21:  // Key prefixes for different cache types
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:22:  public static final String SPM_USER_PREFIX = "spm-user::";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:23:  public static final String XSUAA_JWT_PREFIX = "xsuaa-jwt::";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:24:  public static final String PUBLIC_KEYS_KEY = "publicKeys";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:25:  public static final String CONNECTIVITY_PLATFORM_TENANT_PUBLIC_KEY_PREFIX =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:26:      "connectivity-platform-tenant-public-key::";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:28:  public static String createTenantPublicKeyRedisKey(String tenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:29:    return CONNECTIVITY_PLATFORM_TENANT_PUBLIC_KEY_PREFIX + tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-30-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-32-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:33:   * Create Redis key for SPM user caching with feature sets.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-34-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:35:   * @param xSignavioId The X-Signavio-Id header value
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-36-   * @param jSessionId The JSESSIONID cookie value
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-37-   * @param clientIp The client IP address
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-38-   * @param featureSets The feature sets
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:39:   * @return The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-40-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:41:  public static String createSpmUserKey(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:42:      String xSignavioId, String jSessionId, String clientIp, Set<FeatureApplication> featureSets) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:43:    return createSpmUserKey(xSignavioId, jSessionId, clientIp, featureSets.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-44-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-46-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:47:   * Create Redis key for SPM user caching.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-48-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:49:   * @param xSignavioId The X-Signavio-Id header value
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-50-   * @param jSessionId The JSESSIONID cookie value
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-51-   * @param clientIp The client IP address
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:52:   * @return The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-53-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:54:  public static String createSpmUserKey(String xSignavioId, String jSessionId, String clientIp) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:55:    return SPM_USER_PREFIX + hashString(xSignavioId + jSessionId + clientIp);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-56-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-58-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:59:   * Create Redis key for SPM user caching with feature sets as string.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-60-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:61:   * @param xSignavioId The X-Signavio-Id header value
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-62-   * @param jSessionId The JSESSIONID cookie value
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-63-   * @param clientIp The client IP address
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:64:   * @param featureSets The feature sets as string
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:65:   * @return The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-66-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:67:  public static String createSpmUserKey(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:68:      String xSignavioId, String jSessionId, String clientIp, String featureSets) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:69:    return SPM_USER_PREFIX + hashString(xSignavioId + jSessionId + clientIp + featureSets);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-70-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-72-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:73:   * Create Redis key for SPM user caching from tuple with feature sets.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-74-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-75-   * @param tokenCookieClientIpTuple Tuple containing token, cookie, and client IP
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-76-   * @param featureSets The feature sets
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:77:   * @return The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-78-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:79:  public static String createSpmUserKey(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:80:      Tuple3<String, String, String> tokenCookieClientIpTuple,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-81-      Set<FeatureApplication> featureSets) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:82:    return createSpmUserKey(tokenCookieClientIpTuple, featureSets.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-83-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-85-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:86:   * Create Redis key for SPM user caching from tuple with feature sets as string.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-87-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-88-   * @param tokenCookieClientIpTuple Tuple containing token, cookie, and client IP
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:89:   * @param featureSets The feature sets as string
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:90:   * @return The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-91-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:92:  public static String createSpmUserKey(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:93:      Tuple3<String, String, String> tokenCookieClientIpTuple, String featureSets) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:94:    String xSignavioId = tokenCookieClientIpTuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:95:    String cookie = tokenCookieClientIpTuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:96:    String clientIp = tokenCookieClientIpTuple.getT3();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-97-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:98:    String jSessionId = extractJSessionIdFromCookie(cookie);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:99:    return createSpmUserKey(xSignavioId, jSessionId, clientIp, featureSets);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-100-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-101-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-102-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:103:   * Create Redis key for XSUAA JWT caching.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-104-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-105-   * @param sessionId The SAML session ID
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:106:   * @return The Redis key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-107-   * @throws IllegalArgumentException if sessionId is null or empty
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-108-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:109:  public static String createXsuaaJwtKey(String sessionId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-110-    if (sessionId == null || sessionId.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-111-      throw new IllegalArgumentException("Session ID cannot be null or empty");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-112-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:113:    return XSUAA_JWT_PREFIX + sessionId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-114-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-115-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-116-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:117:   * Extract JSESSIONID from cookie string.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-118-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:119:   * @param cookie The cookie string
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:120:   * @return The JSESSIONID value or empty string if not found
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-121-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:122:  private static String extractJSessionIdFromCookie(String cookie) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-123-    return Arrays.stream(cookie.split(";"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-124-        .filter(s -> s.contains("JSESSIONID"))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-129-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-130-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:131:   * Hash a string using SHA-256.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-132-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:133:   * @param input The input string to hash
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:134:   * @return The hex representation of the hash
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-135-   * @throws RuntimeException if SHA-256 algorithm is not available
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-136-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:137:  public static String hashString(String input) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-138-    MessageDigest messageDigest;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-139-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-140-      messageDigest = MessageDigest.getInstance("SHA-256");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-141-    } catch (NoSuchAlgorithmException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:142:      logger.error("Could not find SHA-256 hashing algorithm for redis key creation");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-143-      throw new RuntimeException("SHA-256 algorithm not available", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-144-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-145-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:146:    byte[] encodedHash = messageDigest.digest(input.getBytes(StandardCharsets.UTF_8));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:147:    return bytesToHex(encodedHash);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-148-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-149-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-150-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:151:   * Convert byte array to hex string.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-152-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:153:   * @param hash The byte array to convert
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:154:   * @return The hex string representation
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-155-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:156:  private static String bytesToHex(byte[] hash) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:157:    StringBuilder hexString = new StringBuilder(2 * hash.length);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:158:    for (byte b : hash) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:159:      hexString.append(String.format("%02x", b));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-160-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:161:    return hexString.toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-162-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-163-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-164-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:165:   * Sanitizes user-controllable strings for safe logging by removing control characters that could
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-166-   * be used for log injection attacks.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-167-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:168:   * @param input the string to sanitize
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:169:   * @return sanitized string with control characters removed
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-170-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java:171:  public static String sanitizeForLogging(String input) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-172-    if (input == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/caching/RedisKeyUtils.java-173-      return null;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/XsuaaJwtExtraAttributes.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/XsuaaJwtExtraAttributes.java-5-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/XsuaaJwtExtraAttributes.java:6:public record XsuaaJwtExtraAttributes(String enhancer, String subaccountid) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:1:package com.sap.bpi.api.gw.security.jwt.joule;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.JOULE;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-5-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-6-import com.sap.bpi.api.gw.configuration.LaunchDarklyFeatureFlag;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:7:import com.sap.bpi.api.gw.dto.SapJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-8-import com.sap.bpi.api.gw.dto.WellKnownConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-9-import com.sap.bpi.api.gw.dto.tenant.ExternalTenantMappingResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:10:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:11:import com.sap.bpi.api.gw.filters.utils.JwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-12-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:13:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-14-import com.sap.bpi.api.gw.services.JouleXsuaaTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-15-import com.sap.bpi.api.gw.services.LaunchDarklyService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-16-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:17:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-18-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-19-import java.util.Set;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:20:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:21:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:22:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-23-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-24-import reactor.util.function.Tuple2;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-26-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-27-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:28: * In order to verify the content of the XSUAA JWT, we need to get the public key first. Even though
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:29: * the link to the key is provided in the jku claim of the JWT, it is unsafe to use it directly.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-30- * Instead, we should fetch the jwks_uri from the issuer's well-known configuration endpoint and use
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:31: * it to get the public key. In order to get the well-known configuration, we need to get the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-32- * authentication url from the tenant mapping which is stored at the Tenant Service. We can query
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:33: * Tenant Service using the BTP subaccount ID from the JWT.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-34- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:35:@Service("jouleXsuaaJwtVerifier")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:36:public class JouleXsuaaJwtVerifier extends JouleJwtVerifier {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:37:  public static final String EXT_ATTR_CLAIM = "ext_attr";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:39:  private final JouleXsuaaTenantService jouleXsuaaTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:40:  private final LaunchDarklyService ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:41:  private final ObjectMapper objectMapper = new ObjectMapper();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-43-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:44:  public JouleXsuaaJwtVerifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-45-      JouleXsuaaTenantService jouleXsuaaTenantService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-46-      LaunchDarklyService ldService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:47:      JwtVerifierUtils jwtVerifierUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-48-      AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:49:    super(jwtVerifierUtils, auditLogClientManager);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-50-    this.jouleXsuaaTenantService = jouleXsuaaTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-51-    this.ldService = ldService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-52-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:54:  public Mono<ExternalTenantMappingResponse> getTenantMapping(String tenantIdentifier) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-55-    return jouleXsuaaTenantService.getTenantMapping(tenantIdentifier);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-56-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-58-  public Mono<WellKnownConfigurationDto> getTokenConfiguration(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-59-      ExternalTenantMappingResponse tenantMapping) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:60:    String url =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:61:        tenantMapping.getAdditionalInfo().assignedTenant().configuration().url() + WELL_KNOWN_PATH;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:62:    return jwtVerifierUtils.getTokenConfiguration(url);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-63-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-64-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-65-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:66:  protected String getJwtType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:67:    return "XSUAA JWT";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-68-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-70-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:71:  public Mono<Tuple2<AuthorizationDecision, String>> isJwtValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:72:      String token, JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-73-    AuthorizationDecision notGranted = new AuthorizationDecision(false);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:74:    Tuple2<AuthorizationDecision, String> notGrantedAuthDecisionTuple = Tuples.of(notGranted, "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-76-    // Extract BTP subaccount ID from token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:77:    Optional<String> btpSubaccountId = getBtpSubaccountId(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-78-    if (btpSubaccountId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:79:      logger.error("Failed to extract BTP subaccount ID from XSUAA JWT");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-80-      return Mono.just(notGrantedAuthDecisionTuple);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-81-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-85-        // Get token configuration using tenant mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-86-        .zipWhen(this::getTokenConfiguration, Tuples::of)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:87:        // Fetch public key using the configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-88-        .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:89:            tuple -> jwtVerifierUtils.fetchPublicKey(tuple.getT2()),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:90:            (tuple, publicKey) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:91:              WellKnownConfigurationDto jwtConfiguration = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-92-              ExternalTenantMappingResponse tenantMapping = tuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-93-              try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:94:                Claims claims = getClaims(publicKey, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-95-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-96-                // Check issuer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:97:                String actualIssuer = claims.getIssuer();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:98:                if (!jwtConfiguration.getIssuer().equals(actualIssuer)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:99:                  String signavioTenantId = tenantMapping.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:100:                  String userId = claims.getId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:101:                  logJwtIssuerInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-102-                      actualIssuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:103:                      jwtConfiguration.getIssuer(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:104:                      signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:105:                      jwtValidationContext.getSourceIps(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-106-                      userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-107-                  return notGrantedAuthDecisionTuple;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-111-                // Check audience (client ID)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-112-                if (ldService.isFeatureEnabled(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:113:                    LaunchDarklyFeatureFlag.XSUAA_JWT_AUDIENCE_VALIDATION)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:114:                  Set<String> audience = claims.getAudience();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:115:                  String clientId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:116:                      tenantMapping.getAdditionalInfo().assignedTenant().configuration().clientId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-117-                  logger.debug("Client ID: {}", clientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-118-                  if (audience == null || !audience.contains(clientId)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-119-                    logger.debug("Audience: {}", audience);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:120:                    String signavioTenantId = tenantMapping.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:121:                    String userId = claims.getId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:122:                    logJwtAudienceInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-123-                        clientId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-124-                        audience,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:125:                        signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:126:                        jwtValidationContext.getSourceIps(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-127-                        userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-128-                    return notGrantedAuthDecisionTuple;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-130-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-131-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:132:                String signavioTenantId = tenantMapping.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:133:                return Tuples.of(new AuthorizationDecision(true), signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-134-              } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:135:                String signavioTenantId = tenantMapping.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:136:                String userId = getUserId(token, publicKey);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:137:                logJwtValidationFailed(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:138:                    e, signavioTenantId, jwtValidationContext.getSourceIps(), userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-139-                return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-140-              }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-143-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-144-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:145:  public Claims getClaims(PublicKey publicKey, String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:146:    return jwtVerifierUtils.getClaims(publicKey, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-147-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-148-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:149:  private String getUserId(String token, PublicKey publicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:150:    String userId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-151-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:152:      userId = getClaims(publicKey, token).getId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-153-    } catch (Exception ex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:154:      logger.error("Error while getting userId from XSUAA JWT", ex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-155-      // If we can't get user ID from token, use a placeholder
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:156:      userId = JOULE.toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-157-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-158-    return userId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-159-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-160-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:161:  private Optional<String> getBtpSubaccountId(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-162-    // get BTP subaccount ID from token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:163:    SapJwtDto xsuaaJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-164-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:165:      String payload = JwtUtils.decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:166:      xsuaaJwtDto = objectMapper.readValue(payload, SapJwtDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-167-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:168:      logger.error("Failed to deserialize XSUAA JWT", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-169-      return Optional.empty();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-170-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java:171:    return Optional.of(xsuaaJwtDto.extraAttributes().subaccountid());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-172-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleXsuaaJwtVerifier.java-173-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java:1:package com.sap.bpi.api.gw.security.jwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java:3:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java-4-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java-5-import reactor.util.function.Tuple2;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java-7-@SuppressWarnings("PMD.ImplicitFunctionalInterface")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java:8:public interface JwtVerifierStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java:9:  Mono<Tuple2<AuthorizationDecision, String>> isJwtValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java:10:      String token, JwtValidationContext jwtValidationContext);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/JwtVerifierStrategy.java-11-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-1-package com.sap.bpi.api.gw.routes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:3:import org.springframework.beans.factory.annotation.Value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:4:import org.springframework.boot.context.properties.ConfigurationProperties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:5:import org.springframework.boot.context.properties.EnableConfigurationProperties;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:6:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-8-@Configuration
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-12-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-13-  @Value("${app.insightsCentralEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:14:  private String insightsCentralEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-16-  @Value("${app.commentsServerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:17:  private String commentsServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-19-  @Value("${app.notificationsServerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:20:  private String notificationsServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-22-  @Value("${app.searchServerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:23:  private String searchServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-25-  @Value("${app.tasksServerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:26:  private String tasksServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-28-  @Value("${app.suiteCommentsEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:29:  private String suiteCommentsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-31-  @Value("${app.suiteNotificationsEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:32:  private String suiteNotificationsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-34-  @Value("${app.suiteTasksEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:35:  private String suiteTasksEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-36-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-37-  @Value("${app.piGraphqlEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:38:  private String piGraphqlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-39-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-40-  @Value("${app.piGraphqlCanaryEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:41:  private String piGraphqlCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-43-  @Value("${app.spiInsightsClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:44:  private String spiInsightsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-46-  @Value("${app.globalServerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:47:  private String globalServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-48-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-49-  @Value("${app.graphqlEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:50:  private String graphqlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-51-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-52-  @Value("${app.piClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:53:  private String piClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-55-  @Value("${app.piClientCanaryEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:56:  private String piClientCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-58-  @Value("${app.piEtlEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:59:  private String piEtlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-61-  @Value("${app.piEtlCanaryEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:62:  private String piEtlCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-64-  @Value("${app.spgEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:65:  private String spgEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-67-  @Value("${app.spgPublicAPIEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:68:  private String spgPublicAPIEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-70-  @Value("${app.spgAnalyticAPIEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:71:  private String spgAnalyticAPIEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-72-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-73-  @Value("${app.spgApprovalsServiceEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:74:  private String spgApprovalsServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-76-  @Value("${app.spgReadConfirmationEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:77:  private String spgReadConfirmationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-78-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-79-  @Value("${app.spiIngestionEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:80:  private String spiIngestionEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-81-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-82-  @Value("${app.spiIngestionHealthEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:83:  private String spiIngestionHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-85-  @Value("${app.spmEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:86:  private String spmEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-87-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-88-  @Value("${app.vmEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:89:  private String vmEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:91:  @Value("${app.spiSignalEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:92:  private String spiSignalEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-94-  @Value("${app.idmpsEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:95:  private String idmpsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-96-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-97-  @Value("${app.jmServerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:98:  private String jmServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-100-  @Value("${app.jmMetricsEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:101:  private String jmMetricsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-102-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-103-  @Value("${app.jmClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:104:  private String jmClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-105-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-106-  @Value("${app.suiteLibraryEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:107:  private String suiteLibraryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-108-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-109-  @Value("${app.suiteClientsHubEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:110:  private String suiteClientsHubEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-111-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-112-  @Value("${app.userManagementEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:113:  private String userManagementEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-114-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-115-  @Value("${app.labsEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:116:  private String labsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-117-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-118-  @Value("${app.tenantServiceEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:119:  private String tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-120-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-121-  @Value("${app.piDataCopyEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:122:  private String piDataCopyEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-123-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-124-  @Value("${app.piDatasphereEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:125:  private String piDatasphereEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-127-  @Value("${app.piActionLayerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:128:  private String piActionLayerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-129-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-130-  @Value("${app.piJ2pClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:131:  private String piJ2pClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-132-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-133-  @Value("${app.piRcaFrontendEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:134:  private String piRcaFrontendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-135-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:136:  @Value("${app.piValueAnalysisClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:137:  private String piValueAnalysisClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-138-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-139-  @Value("${app.processAiRecommenderEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:140:  private String processAiRecommenderEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-141-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-142-  @Value("${app.processAiCrafterEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:143:  private String processAiCrafterEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-144-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-145-  @Value("${app.valEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:146:  private String valEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-147-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:148:  @Value("${app.piArchimedesEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:149:  private String piArchimedesEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-150-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:151:  @Value("${app.piArchimedesHealthEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:152:  private String piArchimedesHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-153-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-154-  @Value("${app.spmImpexEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:155:  private String spmImpexEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-156-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:157:  @Value("${app.connectivityPlatformIntegrationEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:158:  private String connectivityPlatformIntegrationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-159-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:160:  @Value("${app.connectivityPlatformIntegrationHealthEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:161:  private String connectivityPlatformIntegrationHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-162-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-163-  @Value("${app.dmnXmlServiceEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:164:  private String dmnXmlServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-165-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-166-  @Value("${app.benchmarkCentralEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:167:  private String benchmarkCentralEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-168-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-169-  @Value("${app.benchmarkFrontendEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:170:  private String benchmarkFrontendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-171-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-172-  @Value("${app.suiteAnalyticsSpmServiceEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:173:  private String suiteAnalyticsSpmServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-174-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-175-  @Value("${app.processAiAssetsEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:176:  private String processAiAssetsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-177-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-178-  @Value("${app.jouleSkillsBackendEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:179:  private String jouleSkillsBackendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-180-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-181-  @Value("${app.tasksClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:182:  private String tasksClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-183-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-184-  @Value("${app.commentsClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:185:  private String commentsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-186-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-187-  @Value("${app.notificationsClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:188:  private String notificationsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-189-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-190-  @Value("${app.searchClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:191:  private String searchClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-192-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-193-  @Value("${app.libraryMfeServerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:194:  private String libraryMfeServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-195-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-196-  @Value("${app.insightsCentralAssetsEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:197:  private String insightsCentralAssetsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-198-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-199-  @Value("${app.contentPropagationEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:200:  private String contentPropagationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-201-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-202-  @Value("${app.valClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:203:  private String valClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-204-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-205-  @Value("${app.libraryMfeClientEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:206:  private String libraryMfeClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-207-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-208-  @Value("${app.customSvgEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:209:  private String customSvgEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-210-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-211-  @Value("${app.spiData}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:212:  private String spiDataEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-213-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-214-  @Value("${app.piDataStore}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:215:  private String piDataStoreEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-216-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-217-  @Value("${app.dictionaryRoleSuggestorEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:218:  private String dictionaryRoleSuggestorEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-219-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-220-  @Value("${app.suiteTasksManagementEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:221:  private String suiteTasksManagementEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-222-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-223-  @Value("${app.transformationAdvisorEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:224:  private String transformationAdvisorEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-225-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-226-  @Value("${app.transformationManagerEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:227:  private String transformationManagerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-228-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-229-  @Value("${app.suiteRepositoryEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:230:  private String suiteRepositoryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-231-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-232-  @Value("${app.processAiReagentEndpoint}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:233:  private String processAiReagentEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-234-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:235:  public String getSpiInsightsClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-236-    return spiInsightsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-237-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-238-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:239:  public String getSpmEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-240-    return spmEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-241-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-242-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:243:  public String getCommentsServerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-244-    return commentsServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-245-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-246-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:247:  public String getNotificationsServerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-248-    return notificationsServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-249-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-250-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:251:  public String getSuiteCommentsEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-252-    return suiteCommentsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-253-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-254-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:255:  public String getSuiteTasksEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-256-    return suiteTasksEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-257-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-258-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:259:  public String getSuiteNotificationsEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-260-    return suiteNotificationsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-261-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-262-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:263:  public String getSearchServerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-264-    return searchServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-265-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-266-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:267:  public String getTasksServerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-268-    return tasksServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-269-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-270-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:271:  public String getGraphqlEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-272-    return graphqlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-273-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-274-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:275:  public String getPiClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-276-    return piClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-277-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-278-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:279:  public String getPiClientCanaryEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-280-    return piClientCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-281-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-282-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:283:  public String getPiEtlEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-284-    return piEtlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-285-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-286-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:287:  public String getPiEtlCanaryEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-288-    return piEtlCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-289-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-290-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:291:  public String getPiActionLayerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-292-    return piActionLayerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-293-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-294-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:295:  public String getInsightsCentralEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-296-    return insightsCentralEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-297-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-298-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:299:  public String getVmEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-300-    return vmEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-301-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-302-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:303:  public String getSpiIngestionEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-304-    return spiIngestionEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-305-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-306-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:307:  public String getSpiIngestionHealthEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-308-    return spiIngestionHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-309-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-310-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:311:  public String getSpgEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-312-    return spgEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-313-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-314-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:315:  public String getSpiSignalEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:316:    return spiSignalEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-317-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-318-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:319:  public String getIdmpsEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-320-    return idmpsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-321-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-322-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:323:  public String getJmServerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-324-    return jmServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-325-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-326-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:327:  public String getJmMetricsEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-328-    return jmMetricsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-329-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-330-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:331:  public String getJmClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-332-    return jmClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-333-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-334-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:335:  public String getSuiteLibraryEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-336-    return suiteLibraryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-337-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-338-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:339:  public String getSuiteClientsHubEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-340-    return suiteClientsHubEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-341-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-342-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:343:  public String getUserManagementEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-344-    return userManagementEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-345-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-346-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:347:  public String getLabsEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-348-    return labsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-349-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-350-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:351:  public String getTenantServiceEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-352-    return tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-353-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-354-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:355:  public String getSpgPublicAPIEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-356-    return spgPublicAPIEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-357-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-358-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:359:  public String getSpgAnalyticAPIEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-360-    return spgAnalyticAPIEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-361-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-362-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:363:  public String getSpgApprovalsServiceEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-364-    return spgApprovalsServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-365-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-366-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:367:  public String getSpgReadConfirmationEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-368-    return spgReadConfirmationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-369-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-370-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:371:  public String getPiDataCopyEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-372-    return piDataCopyEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-373-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-374-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:375:  public String getPiGraphqlEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-376-    return piGraphqlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-377-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-378-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:379:  public String getGlobalServerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-380-    return globalServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-381-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-382-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:383:  public String getPiJ2pClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-384-    return piJ2pClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-385-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-386-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:387:  public String getPiRcaFrontendEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-388-    return piRcaFrontendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-389-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-390-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:391:  public String getConnectivityPlatformIntegrationEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:392:    return connectivityPlatformIntegrationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-393-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-394-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:395:  public String getTransformationAdvisorEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-396-    return transformationAdvisorEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-397-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-398-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:399:  public void setConnectivityPlatformIntegrationEndpoint(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:400:      String connectivityPlatformIntegrationEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:401:    this.connectivityPlatformIntegrationEndpoint = connectivityPlatformIntegrationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-402-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-403-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:404:  public String getConnectivityPlatformIntegrationHealthEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:405:    return connectivityPlatformIntegrationHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-406-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-407-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:408:  public void setConnectivityPlatformIntegrationHealthEndpoint(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:409:      String connectivityPlatformIntegrationHealthEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:410:    this.connectivityPlatformIntegrationHealthEndpoint =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:411:        connectivityPlatformIntegrationHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-412-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-413-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:414:  public void setSpiInsightsClientEndpoint(String spiInsightsClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-415-    this.spiInsightsClientEndpoint = spiInsightsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-416-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-417-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:418:  public void setSpgPublicAPIEndpoint(String spgPublicAPIEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-419-    this.spgPublicAPIEndpoint = spgPublicAPIEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-420-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-421-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:422:  public void setSpgAnalyticAPIEndpoint(String spgAnalyticAPIEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-423-    this.spgAnalyticAPIEndpoint = spgAnalyticAPIEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-424-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-425-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:426:  public void setSpgApprovalsServiceEndpoint(String spgApprovalsServiceEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-427-    this.spgApprovalsServiceEndpoint = spgApprovalsServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-428-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-429-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:430:  public void setSpgReadConfirmationEndpoint(String spgReadConfirmationEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-431-    this.spgReadConfirmationEndpoint = spgReadConfirmationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-432-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-433-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:434:  public void setPiDataCopyEndpoint(String piDataCopyEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-435-    this.piDataCopyEndpoint = piDataCopyEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-436-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-437-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:438:  public void setGraphqlEndpoint(String graphqlEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-439-    this.graphqlEndpoint = graphqlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-440-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-441-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:442:  public void setPiClientEndpoint(String piClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-443-    this.piClientEndpoint = piClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-444-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-445-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:446:  public void setPiClientCanaryEndpoint(String piClientCanaryEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-447-    this.piClientCanaryEndpoint = piClientCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-448-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-449-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:450:  public void setPiEtlEndpoint(String piEtlEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-451-    this.piEtlEndpoint = piEtlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-452-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-453-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:454:  public void setPiActionLayerEndpoint(String piActionLayerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-455-    this.piActionLayerEndpoint = piActionLayerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-456-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-457-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:458:  public void setPiJ2pClientEndpoint(String piJ2pClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-459-    this.piJ2pClientEndpoint = piJ2pClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-460-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-461-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:462:  public void setPiRcaFrontendEndpoint(String piRcaFrontendEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-463-    this.piRcaFrontendEndpoint = piRcaFrontendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-464-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-465-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:466:  public void setPiEtlCanaryEndpoint(String piEtlCanaryEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-467-    this.piEtlCanaryEndpoint = piEtlCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-468-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-469-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:470:  public void setJmServerEndpoint(String jmServerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-471-    this.jmServerEndpoint = jmServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-472-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-473-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:474:  public void setJmMetricsEndpoint(String jmMetricsEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-475-    this.jmMetricsEndpoint = jmMetricsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-476-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-477-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:478:  public void setJmClientEndpoint(String jmClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-479-    this.jmClientEndpoint = jmClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-480-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-481-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:482:  public void setSuiteLibraryEndpoint(String suiteLibraryEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-483-    this.suiteLibraryEndpoint = suiteLibraryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-484-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-485-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:486:  public void setSuiteClientsHubEndpoint(String suiteClientsHubEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-487-    this.suiteClientsHubEndpoint = suiteClientsHubEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-488-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-489-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:490:  public void setUserManagementEndpoint(String userManagementEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-491-    this.userManagementEndpoint = userManagementEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-492-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-493-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:494:  public void setLabsEndpoint(String labsEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-495-    this.labsEndpoint = labsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-496-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-497-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:498:  public void setTenantServiceEndpoint(String tenantServiceEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-499-    this.tenantServiceEndpoint = tenantServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-500-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-501-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:502:  public void setSpmEndpoint(String spmEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-503-    this.spmEndpoint = spmEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-504-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-505-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:506:  public void setSpgEndpoint(String spgEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-507-    this.spgEndpoint = spgEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-508-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-509-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:510:  public void setSpiSignalEndpoint(String spiSignalEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:511:    this.spiSignalEndpoint = spiSignalEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-512-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-513-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:514:  public void setSpiIngestionEndpoint(String spiIngestionEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-515-    this.spiIngestionEndpoint = spiIngestionEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-516-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-517-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:518:  public void setSpiIngestionHealthEndpoint(String spiIngestionHealthEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-519-    this.spiIngestionHealthEndpoint = spiIngestionHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-520-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-521-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:522:  public void setGlobalServerEndpoint(String globalServerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-523-    this.globalServerEndpoint = globalServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-524-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-525-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:526:  public void setInsightsCentralEndpoint(String insightsCentralEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-527-    this.insightsCentralEndpoint = insightsCentralEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-528-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-529-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:530:  public void setPiGraphqlEndpoint(String piGraphqlEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-531-    this.piGraphqlEndpoint = piGraphqlEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-532-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-533-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:534:  public void setCommentsServerEndpoint(String commentsServerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-535-    this.commentsServerEndpoint = commentsServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-536-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-537-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:538:  public void setNotificationsServerEndpoint(String notificationsServerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-539-    this.notificationsServerEndpoint = notificationsServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-540-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-541-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:542:  public void setSearchServerEndpoint(String searchServerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-543-    this.searchServerEndpoint = searchServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-544-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-545-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:546:  public void setTasksServerEndpoint(String tasksServerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-547-    this.tasksServerEndpoint = tasksServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-548-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-549-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:550:  public void setSuiteCommentsEndpoint(String suiteCommentsEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-551-    this.suiteCommentsEndpoint = suiteCommentsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-552-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-553-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:554:  public void setSuiteNotificationsEndpoint(String suiteNotificationsEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-555-    this.suiteNotificationsEndpoint = suiteNotificationsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-556-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-557-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:558:  public void setSuiteTasksEndpoint(String suiteTasksEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-559-    this.suiteTasksEndpoint = suiteTasksEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-560-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-561-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:562:  public void setPiDatasphereEndpoint(String piDatasphereEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-563-    this.piDatasphereEndpoint = piDatasphereEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-564-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-565-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:566:  public String getPiDatasphereEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-567-    return piDatasphereEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-568-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-569-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:570:  public String getPiGraphqlCanaryEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-571-    return piGraphqlCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-572-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-573-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:574:  public void setPiGraphqlCanaryEndpoint(String piGraphqlCanaryEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-575-    this.piGraphqlCanaryEndpoint = piGraphqlCanaryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-576-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-577-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:578:  public String getProcessAiRecommenderEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-579-    return processAiRecommenderEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-580-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-581-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:582:  public void setProcessAiRecommenderEndpoint(String processAiRecommenderEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-583-    this.processAiRecommenderEndpoint = processAiRecommenderEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-584-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-585-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:586:  public String getProcessAiCrafterEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-587-    return processAiCrafterEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-588-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-589-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:590:  public void setProcessAiCrafterEndpoint(String processAiCrafterEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-591-    this.processAiCrafterEndpoint = processAiCrafterEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-592-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-593-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:594:  public String getValEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-595-    return valEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-596-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-597-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:598:  public void setValEndpoint(String valEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-599-    this.valEndpoint = valEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-600-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-601-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:602:  public String getPiArchimedesEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:603:    return piArchimedesEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-604-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-605-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:606:  public void setPiArchimedesEndpoint(String archimedesEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:607:    this.piArchimedesEndpoint = archimedesEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-608-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-609-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:610:  public String getPiArchimedesHealthEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:611:    return piArchimedesHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-612-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-613-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:614:  public void setPiArchimedesHealthEndpoint(String piArchimedesHealthEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:615:    this.piArchimedesHealthEndpoint = piArchimedesHealthEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-616-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-617-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:618:  public String getSpmImpexEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-619-    return spmImpexEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-620-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-621-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:622:  public String getDmnXmlServiceEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-623-    return dmnXmlServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-624-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-625-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:626:  public void setDmnXmlServiceEndpoint(String dmnXmlServiceEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-627-    this.dmnXmlServiceEndpoint = dmnXmlServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-628-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-629-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:630:  public String getPiValueAnalysisClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:631:    return piValueAnalysisClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-632-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-633-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:634:  public void setPiValueAnalysisClientEndpoint(String piValueAnalysisClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:635:    this.piValueAnalysisClientEndpoint = piValueAnalysisClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-636-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-637-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:638:  public String getBenchmarkCentralEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-639-    return benchmarkCentralEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-640-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-641-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:642:  public void setBenchmarkCentralEndpoint(String benchmarkCentralEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-643-    this.benchmarkCentralEndpoint = benchmarkCentralEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-644-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-645-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:646:  public String getBenchmarkFrontendEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-647-    return benchmarkFrontendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-648-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-649-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:650:  public void setBenchmarkFrontendEndpoint(String benchmarkFrontedEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-651-    this.benchmarkFrontendEndpoint = benchmarkFrontedEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-652-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-653-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:654:  public String getSuiteAnalyticsSpmServiceEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-655-    return suiteAnalyticsSpmServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-656-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-657-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:658:  public void setSuiteAnalyticsSpmServiceEndpoint(String suiteAnalyticsSpmServiceEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-659-    this.suiteAnalyticsSpmServiceEndpoint = suiteAnalyticsSpmServiceEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-660-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-661-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:662:  public String getProcessAiAssetsEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-663-    return processAiAssetsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-664-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-665-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:666:  public void setProcessAiAssetsEndpoint(String processAiAssetsEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-667-    this.processAiAssetsEndpoint = processAiAssetsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-668-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-669-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:670:  public String getJouleSkillsBackendEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-671-    return jouleSkillsBackendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-672-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-673-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:674:  public void setJouleSkillsBackendEndpoint(String jouleSkillsBackendEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-675-    this.jouleSkillsBackendEndpoint = jouleSkillsBackendEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-676-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-677-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:678:  public String getTasksClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-679-    return tasksClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-680-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-681-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:682:  public void setTasksClientEndpoint(String tasksClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-683-    this.tasksClientEndpoint = tasksClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-684-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-685-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:686:  public String getCommentsClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-687-    return commentsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-688-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-689-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:690:  public void setCommentsClientEndpoint(String commentsClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-691-    this.commentsClientEndpoint = commentsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-692-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-693-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:694:  public String getNotificationsClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-695-    return notificationsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-696-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-697-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:698:  public void setNotificationsClientEndpoint(String notificationsClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-699-    this.notificationsClientEndpoint = notificationsClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-700-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-701-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:702:  public String getSearchClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-703-    return searchClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-704-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-705-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:706:  public void setSearchClientEndpoint(String searchClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-707-    this.searchClientEndpoint = searchClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-708-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-709-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:710:  public String getLibraryMfeServerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-711-    return libraryMfeServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-712-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-713-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:714:  public void setLibraryMfeServerEndpoint(String libraryMfeServerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-715-    this.libraryMfeServerEndpoint = libraryMfeServerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-716-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-717-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:718:  public String getInsightsCentralAssetsEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-719-    return insightsCentralAssetsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-720-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-721-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:722:  public void setInsightsCentralAssetsEndpoint(String insightsCentralAssetsEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-723-    this.insightsCentralAssetsEndpoint = insightsCentralAssetsEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-724-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-725-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:726:  public String getContentPropagationEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-727-    return contentPropagationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-728-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-729-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:730:  public void setContentPropagationEndpoint(String contentPropagationEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-731-    this.contentPropagationEndpoint = contentPropagationEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-732-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-733-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:734:  public String getValClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-735-    return valClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-736-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-737-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:738:  public void setValClientEndpoint(String valClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-739-    this.valClientEndpoint = valClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-740-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-741-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:742:  public String getLibraryMfeClientEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-743-    return libraryMfeClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-744-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-745-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:746:  public void setLibraryMfeClientEndpoint(String libraryMfeClientEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-747-    this.libraryMfeClientEndpoint = libraryMfeClientEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-748-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-749-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:750:  public String getCustomSvgEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-751-    return customSvgEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-752-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-753-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:754:  public void setCustomSvgEndpoint(String customSvgEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-755-    this.customSvgEndpoint = customSvgEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-756-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-757-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:758:  public String getPiDataStoreEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-759-    return piDataStoreEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-760-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-761-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:762:  public void setPiDataStoreEndpoint(String piDataStoreEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-763-    this.piDataStoreEndpoint = piDataStoreEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-764-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-765-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:766:  public String getSpiDataEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-767-    return spiDataEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-768-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-769-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:770:  public void setSpiDataEndpoint(String spiDataEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-771-    this.spiDataEndpoint = spiDataEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-772-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-773-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:774:  public String getDictionaryRoleSuggestorEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-775-    return dictionaryRoleSuggestorEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-776-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-777-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:778:  public void setDictionaryRoleSuggestorEndpoint(String dictionaryRoleSuggestorEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-779-    this.dictionaryRoleSuggestorEndpoint = dictionaryRoleSuggestorEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-780-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-781-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:782:  public String getSuiteTasksManagementEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-783-    return suiteTasksManagementEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-784-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-785-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:786:  public void setSuiteTasksManagementEndpoint(String suiteTasksManagementEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-787-    this.suiteTasksManagementEndpoint = suiteTasksManagementEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-788-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-789-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:790:  public void setTransformationAdvisorEndpoint(String transformationAdvisorEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-791-    this.transformationAdvisorEndpoint = transformationAdvisorEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-792-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-793-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:794:  public String getTransformationManagerEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-795-    return transformationManagerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-796-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-797-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:798:  public void setTransformationManagerEndpoint(String transformationManagerEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-799-    this.transformationManagerEndpoint = transformationManagerEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-800-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-801-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:802:  public String getSuiteRepositoryEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-803-    return suiteRepositoryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-804-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-805-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:806:  public void setSuiteRepositoryEndpoint(String suiteRepositoryEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-807-    this.suiteRepositoryEndpoint = suiteRepositoryEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-808-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-809-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:810:  public String getProcessAiReagentEndpoint() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-811-    return processAiReagentEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-812-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-813-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java:814:  public void setProcessAiReagentEndpoint(String processAiReagentEndpoint) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-815-    this.processAiReagentEndpoint = processAiReagentEndpoint;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/UriConfiguration.java-816-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateValidity.java:1:package com.sap.bpi.api.gw.dto.destinationService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateValidity.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateValidity.java-3-import com.fasterxml.jackson.annotation.JsonProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateValidity.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateValidity.java-5-public record CertificateValidity(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/destinationService/CertificateValidity.java:6:    @JsonProperty("TimeUnit") String timeUnit, @JsonProperty("Value") int value) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:1:package com.sap.bpi.api.gw.security.jwt.joule;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-3-import com.sap.bpi.api.gw.dto.WellKnownConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:4:import com.sap.bpi.api.gw.filters.utils.JwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-5-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:6:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:7:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-8-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-9-import java.util.Set;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-14-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:15: * Abstract base class for Joule JWT verification strategies.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-16- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:17: * <p>This class provides common helper methods for JWT verification in the Joule use case,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:18: * including fetching configuration, public keys, and logging. Subclasses implement the full {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:19: * #isJwtValid} method according to their specific needs (IAS vs XSUAA).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-20- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:21:public abstract class JouleJwtVerifier implements JwtVerifierStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:22:  public static final String WELL_KNOWN_PATH = "/.well-known/openid-configuration";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-24-  protected final Logger logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:25:  protected final JwtVerifierUtils jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-26-  protected final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:28:  protected JouleJwtVerifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:29:      JwtVerifierUtils jwtVerifierUtils, AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-30-    this.logger = LoggerFactory.getLogger(getClass());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:31:    this.jwtVerifierUtils = jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-32-    this.auditLogClientManager = auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-33-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-34-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-35-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:36:   * Fetches the public key from the issuer's JWKS endpoint.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-37-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-38-   * @param wellKnownConfiguration the well-known configuration containing the JWKS URI
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:39:   * @return Mono containing the public key
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-40-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:41:  public Mono<PublicKey> fetchPublicKey(WellKnownConfigurationDto wellKnownConfiguration) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:42:    return jwtVerifierUtils.fetchPublicKey(wellKnownConfiguration);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-43-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-44-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-45-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:46:   * Returns the JWT type for logging purposes.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-47-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:48:   * @return the JWT type name (e.g., "IAS JWT", "XSUAA JWT")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-49-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:50:  protected abstract String getJwtType();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-51-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:52:  /** Logs JWT validation failure with audit logging. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:53:  protected void logJwtValidationFailed(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:54:      Exception e, String tenantId, List<String> sourceIps, String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-55-    logger.error("Failed to validate the token:", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-56-    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:59:  /** Logs invalid JWT audience with audit logging. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:60:  protected void logJwtAudienceInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:61:      String expectedClientId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:62:      Set<String> audience,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:63:      String tenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:64:      List<String> sourceIps,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:65:      String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-66-    logger.error("Token audience does not contain client ID {}", expectedClientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-67-    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-68-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-69-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:70:  /** Logs invalid JWT issuer with audit logging. */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:71:  protected void logJwtIssuerInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:72:      String actualIssuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:73:      String trustedJwtIssuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:74:      String tenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:75:      List<String> sourceIps,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java:76:      String userId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-77-    logger.error("Token issuer \"{}\" is not valid", actualIssuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleJwtVerifier.java-78-    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, userId);
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1-package com.sap.bpi.api.gw.routes;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:3:import static com.sap.bpi.api.gw.security.certificate.ConnectivityPlatformAuthorizationManager.X_SIGNAVIO_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-4-import static com.sap.bpi.api.gw.security.certificate.RequestWithCertificateHeader.CERTIFICATE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:5:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_TENANT_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:6:import static com.sap.bpi.api.gw.security.certificate.SPMAuthorizationManager.SAP_SIGNAVIO_USER_ID_HEADER;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:7:import static com.sap.bpi.api.gw.security.certificate.utils.MappingTypes.CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-9-import com.sap.bpi.api.gw.features.FeatureApplication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-10-import com.sap.bpi.api.gw.filters.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-11-import com.sap.bpi.api.gw.filters.RedirectToLoginGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:12:import com.sap.bpi.api.gw.jwt.JwtTargetType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-13-import com.sap.bpi.api.gw.predicates.JouleRoutePredicateFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-14-import com.sap.bpi.api.gw.predicates.RedirectToLoginRoutePredicateFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-15-import java.util.function.Function;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-16-import java.util.function.Predicate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:17:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:18:import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:19:import org.springframework.cloud.gateway.filter.GatewayFilter;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:20:import org.springframework.cloud.gateway.filter.factory.SpringCloudCircuitBreakerFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:21:import org.springframework.cloud.gateway.route.RouteLocator;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:22:import org.springframework.cloud.gateway.route.builder.GatewayFilterSpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:23:import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:24:import org.springframework.cloud.gateway.route.builder.UriSpec;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:25:import org.springframework.context.annotation.Bean;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:26:import org.springframework.context.annotation.Configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:27:import org.springframework.http.HttpMethod;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:28:import org.springframework.http.HttpStatus;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:29:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-30-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-31-@Configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-32-public class RoutesConfiguration {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:34:  public static final String SET_COOKIE = "Set-Cookie";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:35:  @Autowired private UriConfiguration uriConfiguration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:36:  @Autowired private TokenResponseRewriteFunction tokenResponseRewriteFunction;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:37:  @Autowired private SpmResponseHeadersRewriteFilterFactory spmResponseHeadersRewriteFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:38:  @Autowired private SpmJwtWithIpsTenantIdFilterFactory spmJwtWithIpsTenantIdFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:39:  @Autowired private SpmJwtWithPathTenantIdFilterFactory spmJwtWithPathTenantIdFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:40:  @Autowired private SpmTokenToSpmJwtFilterFactory spmTokenToSpmJwtFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:41:  @Autowired private SpgTokenToUgwJwtFilterFactory spgTokenToUgwJwtFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:42:  @Autowired private UgwJwtToSpmJwtFilterFactory ugwJwtReplacementFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:43:  @Autowired private UgwJwtToPiDataCopyTokenFilterFactory ugwJwtExtractionFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:44:  @Autowired private UgwJwtToSpgTokenFilterFactory ugwJwtToSpgTokenFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:45:  @Autowired private CspResponseFilterFactory cspResponseFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:46:  @Autowired private ApprovalsGatewayFilterFactory approvalsGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:47:  @Autowired private RedirectToLoginGatewayFilterFactory redirectToLoginFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:48:  @Autowired private PinsDynamicRoutingGatewayFilterFactory pinsDynamicRoutingGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-49-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-50-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:51:  private SamlSessionToXsuaaJwtGatewayFilterFactory samlSessionToXsuaaJwtGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:53:  @Autowired private XSignavioTenantIdToSpmJwtFilterFactory xSignavioTenantIdToSpmJwtFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-55-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:56:  private SpmUserIdAndTenantIdToSpmJwtFilterFactory spmUserIdAndTenantIdToSpmJwtFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-57-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-58-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:59:  private DatasphereTenantIdToSpmJwtFilterFactory datasphereTenantIdToSpmJwtFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:61:  @Autowired private SapJwtToSpmJwtGatewayFilterFactory sapJwtToSpmJwtGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-63-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:64:  private IngestionTokenToAuthHeaderFilterFactory ingestionTokenToAuthHeaderFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-65-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-66-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:67:  private SpmJwtToAsymmetricJwtGatewayFilterFactory spmJwtToAsymmetricJwtGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-68-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-69-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:70:  private ConnectivityPlatformMtlsGatewayFilterFactory connectivityPlatformMtlsGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:72:  @Autowired private MtlsOnlyRoutingGatewayFilterFactory mtlsOnlyRoutingGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:74:  @Autowired private StandardRoutingGatewayFilterFactory standardRoutingGatewayFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-75-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:76:  @Autowired private UnifiedJwtConversionFilterFactory unifiedJwtConversionFilterFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-77-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-78-  // Config server is using -1 already as default order
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:79:  private static final int JOULE_ROUTE_ORDER = -2;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:80:  private static final String CSP_HEADER = "content-security-policy";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-81-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:82:  public static final String UCL_TENANT_PROVISIONING_REROUTING_PATH =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-83-      "/v1/tenants/${tenantId}/spii/notifications";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:85:  public static final String VARIANT_MANAGEMENT_UI_ROUTE_ID = "variant_management_ui_route";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:86:  public static final String PI_DATASPHERE_ROUTE_ID = "pi_datasphere_route";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:87:  public static final String X_DESTINATION_SERVICE = "X-Destination-Service";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:88:  public static final String X_DESTINATION_SERVICE_IMPEX =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-89-      "http://spm-platform-impex.spm.svc.cluster.local";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-90-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-98-      RedirectToLoginRoutePredicateFactory redirectToLoginRoutePredicateFactory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-99-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:100:    GatewayFilter ugwJwtToPiDataCopyTokenFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:101:        ugwJwtExtractionFilterFactory.apply(new UgwJwtToPiDataCopyTokenFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-102-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:103:    GatewayFilter spgTokenToUgwJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:104:        spgTokenToUgwJwtFilterFactory.apply(new SpgTokenToUgwJwtFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-105-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:106:    GatewayFilter ugwJwtToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:107:        ugwJwtReplacementFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:108:            new UgwJwtToSpmJwtFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-109-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:110:    GatewayFilter xsuaaJwtToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:111:        sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:112:            new SapJwtToSpmJwtGatewayFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-113-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:114:    GatewayFilter spmJwtWithIpsTenantIdFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:115:        spmJwtWithIpsTenantIdFilterFactory.apply(new SpmJwtWithIpsTenantIdFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-116-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:117:    GatewayFilter spmJwtWithPathTenantIdFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:118:        spmJwtWithPathTenantIdFilterFactory.apply(new SpmJwtWithPathTenantIdFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-119-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:120:    GatewayFilter ugwJwtReplaceAuthHeaderFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:121:        ugwJwtToSpgTokenFilterFactory.apply(new UgwJwtToSpgTokenFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-122-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:123:    GatewayFilter spmTokenToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:124:        spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:125:            new SpmTokenToSpmJwtFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-126-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:127:    GatewayFilter spmJwtWithSystemUserFilterConnectivity =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:128:        xSignavioTenantIdToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:129:            new XSignavioTenantIdToSpmJwtFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-130-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:131:    GatewayFilter spmUserIdAndTenantIdToSpmJwtFilterSpm =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:132:        spmUserIdAndTenantIdToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:133:            new SpmUserIdAndTenantIdToSpmJwtFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-134-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:135:    GatewayFilter spmJwtWithSystemUserFilterDatasphere =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:136:        datasphereTenantIdToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:137:            new DatasphereTenantIdToSpmJwtFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-138-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-139-    GatewayFilter ingestionTokenToAuthHeaderFilter =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-160-        redirectToLoginFilterFactory.apply(new RedirectToLoginGatewayFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-161-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:162:    GatewayFilter samlSessionToXsuaaJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:163:        samlSessionToXsuaaJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:164:            new SamlSessionToXsuaaJwtGatewayFilterFactory.Config());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-165-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-166-    GatewayFilter pinsDynamicRoutingFilter =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-192-        // with @ConditionalOnProperty to support feature flag toggling.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-193-        // See: legacyGraphqlRoutes() and unifiedGraphqlRoute() methods below.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:194:        // NOTE: pi_graphql_signal_route_for_joule, pi_signal_route, and pi-graphql-route have been
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-195-        // moved to separate beans with @ConditionalOnProperty to support feature flag toggling.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:196:        // See: legacyPiGraphqlRoutes() and pi_graphql_signal_route_unified in unifiedJouleRoutes()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-197-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-198-            "pi_graphql_options_route",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-214-                            f.rewritePath("^/api-gw-proxy/g/api/pi-graphql(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-215-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:216:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:217:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-218-                                            FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-219-                                            FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-229-                            f.rewritePath("^/g/api/pidata(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-230-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:231:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:232:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-233-                                            FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-234-                                            FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-245-                            f.rewritePath("^/g/api/pi-query/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-246-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:247:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:248:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-249-                                            FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-250-                                            FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-261-                            f.rewritePath("^/g/api/pi-graphql-canary/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-262-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:263:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:264:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-265-                                            FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-266-                                            FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-297-                            f.rewritePath("^/g/api/library(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-298-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:299:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:300:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-301-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-302-                                            FeatureApplication.SUITE_LIBRARY)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-330-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-331-                            f.rewritePath("^/g/api/labs(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:332:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-333-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-334-                    .uri(uriConfiguration.getLabsEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-410-                            f.rewritePath("^/g/statics/pi-value-analysis-client(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-411-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:412:                    .uri(uriConfiguration.getPiValueAnalysisClientEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-413-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-414-            "insights_central_options_route",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-431-                            f.rewritePath("^/api-gw-proxy/suite/insights-central/v1/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-432-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:433:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:434:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-435-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-436-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-444-                            f.rewritePath("^/suite/insights-central/v1/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-445-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:446:                                    ugwJwtReplacementFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:447:                                        new UgwJwtToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-448-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-449-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-478-                            f.rewritePath("^/g/api/comments/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-479-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:480:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:481:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-482-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-483-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-490-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-491-                            f.rewritePath("^/g/api/notifications/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:492:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-493-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-494-                    .uri(uriConfiguration.getSuiteNotificationsEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-501-                            f.rewritePath("^/g/api/suite-tasks-mgmt-svc/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-502-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:503:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:504:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-505-                                            FeatureApplication.COLLABORATION_HUB)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-506-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-514-                            f.rewritePath("^/g/api/suite-tasks/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-515-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:516:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:517:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-518-                                            FeatureApplication.PLATFORM)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-519-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-527-                            f.rewritePath("^/api-gw-proxy/g/api/comments-server/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-528-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:529:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:530:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-531-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-532-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-540-                            f.rewritePath("^/g/api/comments-server/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-541-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:542:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:543:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-544-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-545-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-552-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-553-                            f.rewritePath("^/g/api/notifications-server", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:554:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-555-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-556-                    .uri(uriConfiguration.getNotificationsServerEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-567-                            f.rewritePath("^/g/api/tasks-server/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-568-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:569:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:570:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-571-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-572-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-580-                            f.rewritePath("^/g/api/dictionary-role-suggestor(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-581-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:582:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:583:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-584-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-585-                                            FeatureApplication.COLLABORATION_HUB)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-613-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-614-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:615:                            f.filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-616-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-617-                    .uri(uriConfiguration.getGlobalServerEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-622-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-623-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:624:                            f.filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-625-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-626-                    .uri(uriConfiguration.getDmnXmlServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-633-                            f.rewritePath("^/auth/v1/token", "/p/login")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-634-                                .modifyResponseBody(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:635:                                    String.class,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:636:                                    String.class,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-637-                                    tokenResponseRewriteFunction.apply())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-638-                                .removeResponseHeader(CSP_HEADER))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-655-                                .filter(tokenRequestFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-656-                                .modifyResponseBody(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:657:                                    String.class,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:658:                                    String.class,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-659-                                    tokenResponseRewriteFunction.apply())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-660-                                .removeResponseHeader(CSP_HEADER))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-708-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-709-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:710:            "spi_signal_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-711-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:712:                p.path("/pi/signal/odata/**")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-713-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-714-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:715:                            f.rewritePath("^/pi/signal/odata", "/pi-odata")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-716-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:717:                    .uri(uriConfiguration.getSpiSignalEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-718-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:719:            "spg_trigger_route_for_connectivity_platform",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-720-            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-721-                r.header(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:722:                        X_SIGNAVIO_MAPPING_TYPE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:723:                        CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE.toString())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-724-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-725-                    .path("/spg/api/v1/**")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-727-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-728-                            f.rewritePath("^/spg", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:729:                                .filter(spmJwtWithSystemUserFilterConnectivity)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-730-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-731-                    .uri(uriConfiguration.getSpgEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-747-                            f.rewritePath("^/spg/analytics", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-748-                                .removeRequestHeader("X-FORWARDED-PROTO")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:749:                                .filter(ugwJwtReplaceAuthHeaderFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-750-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-751-                    .uri(uriConfiguration.getSpgAnalyticAPIEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-758-                            f.filter(approvalsGatewayFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-759-                                .rewritePath("^/spg/approvals/[^/]+", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:760:                                .filter(spgTokenToUgwJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-761-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-762-                    .uri(uriConfiguration.getSpgApprovalsServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-774-                                */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-775-                                .rewritePath("^/spg/approvals/v1/[^/]+/variables", "/v1/variables")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:776:                                .filter(spgTokenToUgwJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-777-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-778-                    .uri(uriConfiguration.getSpgApprovalsServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-788-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-789-                            f.rewritePath("^/spg/approvals", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:790:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-791-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-792-                    .uri(uriConfiguration.getSpgApprovalsServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-802-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-803-                            f.rewritePath("^/spg/approvals", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:804:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-805-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-806-                    .uri(uriConfiguration.getSpgApprovalsServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-818-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-819-                            f.rewritePath("^/g/api/read-confirmation", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:820:                                .filter(spmTokenToSpmJwtFilter))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-821-                    .uri(uriConfiguration.getSpgReadConfirmationEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-822-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-827-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-828-                            f.rewritePath("^/g/api/process-rating", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:829:                                .filter(spmTokenToSpmJwtFilter))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-830-                    .uri(uriConfiguration.getSpgReadConfirmationEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-831-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-834-                p.path("/g/api/recipients/**")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-835-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:836:                        f -> f.rewritePath("^/g/api/recipients", "").filter(spmTokenToSpmJwtFilter))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-837-                    .uri(uriConfiguration.getSpgReadConfirmationEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-838-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-843-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-844-                            f.rewritePath("^/idmps", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:845:                                .filter(spmJwtWithIpsTenantIdFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-846-                                .retry(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-847-                                    config ->
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-879-                    .uri(uriConfiguration.getJmServerEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-880-        // jm_route_for_joule moved to conditional bean:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:881:        // - legacyJmRoutes() - active when feature.unifiedJouleRoutes.enabled=false
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:882:        // - jm_route_unified in unifiedJouleRoutes() - active when
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-883-        // feature.unifiedJouleRoutes.enabled=true
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-884-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-889-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-890-                            f.rewritePath("^/jm", "/api")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:891:                                .filter(ugwJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-892-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-893-                    .uri(uriConfiguration.getJmMetricsEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-899-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-900-                            f.rewritePath("^/pi/data-copy", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:901:                                .filter(ugwJwtToPiDataCopyTokenFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-902-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-903-                    .uri(uriConfiguration.getPiDataCopyEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-923-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-924-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:925:            "connectivity_platform_integration_ui_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-926-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-927-                p.path("/api/v1/t2p/**", "/api/v1/calm/**")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-928-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-929-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:930:                            f.filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-931-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:932:                    .uri(uriConfiguration.getConnectivityPlatformIntegrationEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-933-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:934:            "connectivity_platform_integration_health_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-935-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:936:                p.path("/connectivity-platform-integration/health")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-937-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-938-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-939-                            f.rewritePath(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:940:                                    "^/connectivity-platform-integration/health",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-941-                                    "/actuator/health/readiness")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-942-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:943:                    .uri(uriConfiguration.getConnectivityPlatformIntegrationHealthEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-944-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-945-            "spm_model_approval_expiration_route",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-953-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-954-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:955:            "spm_route_for_connectivity_platform",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-956-            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-957-                r.header(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:958:                        X_SIGNAVIO_MAPPING_TYPE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:959:                        CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE.toString())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-960-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-961-                    .path("/spm/v1/**")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-963-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-964-                            f.rewritePath("^/spm/v1", "/p")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:965:                                .filter(spmJwtWithSystemUserFilterConnectivity)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-966-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-967-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-968-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:969:            "archimedes_health_route_for_connectivity_platform",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-970-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:971:                p.path("/pi/archimedes/healthz")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-972-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-973-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:974:                            f.rewritePath("^/pi/archimedes/healthz", "/health")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-975-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:976:                    .uri(uriConfiguration.getPiArchimedesHealthEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-977-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:978:            "archimedes_route_for_connectivity_platform",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-979-            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-980-                r.header(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:981:                        X_SIGNAVIO_MAPPING_TYPE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:982:                        CONNECTIVITY_PLATFORM_TENANT_MAPPING_TYPE.toString())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-983-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-984-                    .path("/pi/v1/**")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-986-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-987-                            f.rewritePath("^/pi/v1", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:988:                                .filter(spmJwtWithSystemUserFilterConnectivity)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-989-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:990:                    .uri(uriConfiguration.getPiArchimedesEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-991-        // spm_route_for_joule moved to conditional bean:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:992:        // - legacySpmRoutes() - active when feature.unifiedJouleRoutes.enabled=false
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:993:        // - spm_route_unified in unifiedJouleRoutes() - active when
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-994-        // feature.unifiedJouleRoutes.enabled=true
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-995-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1003-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1004-                            f.rewritePath("^/spm/internal/v1", "/api/v2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1005:                                .filter(xsuaaJwtToSpmJwtFilter))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1006-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1007:        // The X_DESTINATION_SERVICE header is used only internally within the APIGW
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1008-        // to route the request to the SPM impex service. It is added in the bpi-api-gw
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1009-        // virtualservice and is removed before the request is sent to the SPM impex service.
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1012-            "spm_internal_api_route_for_impex",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1013-            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1014:                r.header(X_DESTINATION_SERVICE, X_DESTINATION_SERVICE_IMPEX)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1015-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1016-                    .path("/spm/internal/v1/**")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1022-            "spm_route_for_impex",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1023-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1024:                p.header(X_DESTINATION_SERVICE, X_DESTINATION_SERVICE_IMPEX)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1025-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1026-                    .path("/spm/v1/**")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1035-                    .header(CERTIFICATE.getHeaderName())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1036-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1037:                    .header(SAP_SIGNAVIO_TENANT_ID_HEADER)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1038-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1039:                    .header(SAP_SIGNAVIO_USER_ID_HEADER)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1040-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1041-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1042-                            f.rewritePath("^/spm/v1", "/p")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1043:                                .filter(spmUserIdAndTenantIdToSpmJwtFilterSpm)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1044-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1045-                    .uri(uriConfiguration.getSpmEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1052-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1053-        // Variant Management routes moved to conditional beans:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1054:        // - legacyVariantManagementRoutes() - active when feature.unifiedJouleRoutes.enabled=false
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1055:        // - unifiedVariantManagementRoute() - active when feature.unifiedJouleRoutes.enabled=true
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1056-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1057-            PI_DATASPHERE_ROUTE_ID,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1061-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1062-                            f.rewritePath("^/pi/v1", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1063:                                .filter(spmJwtWithSystemUserFilterDatasphere))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1064-                    .uri(uriConfiguration.getPiDatasphereEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1065-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1072-                                    "^/spii/v1/tenantMappings/(?<tenantId>.*)",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1073-                                    UCL_TENANT_PROVISIONING_REROUTING_PATH)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1074:                                .filter(spmJwtWithPathTenantIdFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1075-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1076-                    .uri(uriConfiguration.getTenantServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1081-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1082-                    .path("/p/glossary")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1083:                    .filters(f -> f.filter(spmTokenToSpmJwtFilter).removeResponseHeader(SET_COOKIE))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1084-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1085-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1102-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1103-                            f.rewritePath("^/jouleskillsbackend/v1", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1104:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1105-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1106-                    .uri(uriConfiguration.getJouleSkillsBackendEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1113-                            f.rewritePath("^/g/api/process-ai-assets", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1114-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1115:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1116:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1117-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1118-                                            FeatureApplication.PROCESS_AI)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1133-                            f.rewritePath("^/g/api/process-ai-crafter(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1134-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1135:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1136:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1137-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1138-                                            FeatureApplication.PROCESS_AI)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1149-                    .filters(f -> f.rewritePath("^/process-ai-reagent", ""))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1150-                    .uri(uriConfiguration.getProcessAiReagentEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1151:        // val_route_for_joule and val_route moved to legacyValRoutes bean (active when
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1152-        // feature.unifiedJouleRoutes.enabled=false)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1153-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1159-                            f.rewritePath("^/val/v1", "/creators/v1")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1160-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1161:                                    ugwJwtReplacementFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1162:                                        new UgwJwtToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1163-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1164-                                            FeatureApplication.PROCESS_INTELLIGENCE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1188-                    .uri(uriConfiguration.getTenantServiceEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1189-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1190:            "tenant_service_public_key_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1191-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1192-                p.method(HttpMethod.GET)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1193-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1194:                    .path("/tenantservice/v1/lifecycle/events/verification/publicKey")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1195-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1196-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1197-                            f.rewritePath(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1198:                                "^/tenantservice/v1/lifecycle/events/verification/publicKey",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1199:                                "/v1/tenants/lifecycle/events/verification/public-key"))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1200-                    .uri(uriConfiguration.getTenantServiceEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1201-        // benchmark_central_route_for_joule and benchmark_central_graphql_route moved to
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1202-        // conditional bean:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1203:        // - legacyBenchmarkCentralRoutes() - active when feature.unifiedJouleRoutes.enabled=false
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1204:        // - benchmark_central_route_unified in unifiedJouleRoutes() - active when
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1205-        // feature.unifiedJouleRoutes.enabled=true
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1206-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1211-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1212-                            f.rewritePath("^/api-gw-proxy/g/api/benchmark-central", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1213:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1214-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1215-                    .uri(uriConfiguration.getBenchmarkCentralEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1231-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1232-                            f.rewritePath("^/api-gw-proxy/g/statics/bma-mfe(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1233:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1234-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1235-                    .uri(uriConfiguration.getBenchmarkFrontendEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1250-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1251-                            f.rewritePath("^/g/api/suite-analytics-spm-service", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1252:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1253-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1254-                    .uri(uriConfiguration.getSuiteAnalyticsSpmServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1270-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1271-                            f.rewritePath("^/api-gw-proxy/g/statics/tasks-client/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1272:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1273-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1274-                    .uri(uriConfiguration.getTasksClientEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1290-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1291-                            f.rewritePath("^/api-gw-proxy/g/statics/comments-client/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1292:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1293-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1294-                    .uri(uriConfiguration.getCommentsClientEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1310-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1311-                            f.rewritePath("^/api-gw-proxy/g/statics/notifications-client/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1312:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1313-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1314-                    .uri(uriConfiguration.getNotificationsClientEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1330-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1331-                            f.rewritePath("^/api-gw-proxy/g/statics/search-client/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1332:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1333-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1334-                    .uri(uriConfiguration.getSearchClientEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1341-                            f.rewritePath("^/g/api/library-mfe-server/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1342-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1343:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1344:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1345-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1346-                                            FeatureApplication.SUITE_LIBRARY)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1355-                            f.rewritePath("^/g/api/insights-central/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1356-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1357:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1358:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1359-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1360-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1378-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1379-                            f.rewritePath("^/api-gw-proxy/g/statics/insights-central-assets/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1380:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1381-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1382-                    .uri(uriConfiguration.getInsightsCentralAssetsEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1388-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1389-                            f.rewritePath("^/g/api/content-propagation/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1390:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1391-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1392-                    .uri(uriConfiguration.getContentPropagationEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1398-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1399-                            f.rewritePath("^/g/api/tenant-service/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1400:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1401-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1402-                    .uri(uriConfiguration.getTenantServiceEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1412-                    .uri(uriConfiguration.getValClientEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1413-        // jm_gql_route moved to conditional bean:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1414:        // - legacyJmRoutes() - active when feature.unifiedJouleRoutes.enabled=false
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1415:        // - jm_route_unified in unifiedJouleRoutes() - active when
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1416-        // feature.unifiedJouleRoutes.enabled=true
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1417-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1422-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1423-                            f.rewritePath("^/g/api/library-mfe-client/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1424:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1425-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1426-                    .uri(uriConfiguration.getLibraryMfeClientEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1442-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1443-                            f.rewritePath("^/g/api/custom-svg(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1444:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1445-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1446-                    .uri(uriConfiguration.getCustomSvgEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1452-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1453-                            f.rewritePath("^/api/v2/custom-svg(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1454:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1455-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1456-                    .uri(uriConfiguration.getCustomSvgEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1457-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1458:            "connectivity_platform_integration_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1459-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1460:                p.path("/g/api/connectivity-platform-integration/**")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1461-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1462-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1463:                            f.rewritePath("^/g/api/connectivity-platform-integration/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1464-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1465:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1466:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1467-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1468-                                            FeatureApplication.COLLABORATION_HUB)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1469-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1470:                    .uri(uriConfiguration.getConnectivityPlatformIntegrationEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1471-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1472-        // Dynamic routing for pins_route URI is determined by
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1481-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1482-                            f.rewritePath("/pins/(?<segment>.*)", "/api/v1/${segment}")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1483:                                .filter(samlSessionToXsuaaJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1484-                                .filter(pinsDynamicRoutingFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1485-                                .filter(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1498-                    .uri(uriConfiguration.getProcessAiReagentEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1499-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1500:            "spm_to_connectivity_platform_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1501-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1502-                p.path("/sigc/**")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1504-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1505-                            f.filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1506:                                    spmJwtToAsymmetricJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1507:                                        new SpmJwtToAsymmetricJwtGatewayFilterFactory.Config()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1508-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1509:                                    connectivityPlatformMtlsGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1510:                                        new ConnectivityPlatformMtlsGatewayFilterFactory.Config()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1511-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1512:                                    mtlsOnlyRoutingGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1513:                                        new MtlsOnlyRoutingGatewayFilterFactory.Config()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1514-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1515-                    .uri("no://op"))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1523-                            f.rewritePath("^/g/api/transformation-advisor(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1524-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1525:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1526:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1527-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1528-                                            FeatureApplication.GATEWAY,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1548-                            f.rewritePath("^/api-gw-proxy/transformationmanager/v1/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1549-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1550:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1551:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1552-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1553-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1561-                            f.rewritePath("^/transformationmanager/v1/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1562-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1563:                                    ugwJwtReplacementFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1564:                                        new UgwJwtToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1565-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1566-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1575-                            f.rewritePath("^/g/api/suite-repository/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1576-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1577:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1578:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1579-                                            FeatureApplication.PLATFORM)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1580-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1589-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1590-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1591:   *   <li>graphql_route_for_joule - Handles /hub/v1/graphql with Joule JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1592:   *   <li>graphql_route - Handles /g/api/graphql and /g/api/graphql/active-features with SPM token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1593-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1594-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1595:   * <p>Feature Flag: Active when {@code feature.unifiedJouleRoutes.enabled = false} (default)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1596-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1597-   * <p>These routes will be disabled when the unified route is enabled. They are kept for backward
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1605-  public RouteLocator legacyGraphqlRoutes(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1606-      RouteLocatorBuilder builder, JouleRoutePredicateFactory jouleRoutePredicateFactory) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1607:    GatewayFilter xsuaaJwtToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1608:        sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1609:            new SapJwtToSpmJwtGatewayFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1610-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1611:    GatewayFilter spmTokenToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1612:        spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1613:            new SpmTokenToSpmJwtFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1614-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1615-    Predicate<ServerWebExchange> isJouleRoute =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1628-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1629-                            f.rewritePath("^/hub/v1/graphql", "/g/api/graphql")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1630:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1631-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1632-                    .uri(uriConfiguration.getGraphqlEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1634-            "graphql_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1635-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1636:                p.path("/g/api/graphql", "/g/api/graphql/active-features")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1637-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1638-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1639:                            f.rewritePath("^/g/api/graphql/active-features", "/active-features")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1640:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1641-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1642-                    .uri(uriConfiguration.getGraphqlEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1645-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1646-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1647:   * Unified Joule Routes using TokenAuthorizationManager and UnifiedJwtConversionFilterFactory.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1648-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1649-   * <p>Feature Flag: Controlled by {@code feature.unifiedJouleRoutes.enabled} (default: false)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1650-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1651-   * <p>When enabled, these routes take precedence over the old duplicate routes. Old routes are
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1652:   * automatically disabled when this bean is active.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1653-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1654-  @Bean
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1665-    // GraphQL uses PLATFORM feature only
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1666-    GatewayFilter graphqlUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1667:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1668:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1669:                JwtTargetType.SPM_JWT, FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1670-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1671-    // Variant Management needs both PLATFORM and VARIANT_MANAGEMENT features
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1672-    GatewayFilter variantManagementUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1673:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1674:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1675:                JwtTargetType.SPM_JWT,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1676-                FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1677-                FeatureApplication.VARIANT_MANAGEMENT));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1679-    // Process AI Recommender needs both PLATFORM and PROCESS_AI features
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1680-    GatewayFilter processAiRecommenderUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1681:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1682:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1683:                JwtTargetType.SPM_JWT, FeatureApplication.PLATFORM, FeatureApplication.PROCESS_AI));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1684-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1685-    // Process AI Reagent uses PROCESS_AI feature only
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1686-    GatewayFilter processAiReagentUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1687:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1688:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1689:                JwtTargetType.SPM_JWT, FeatureApplication.PROCESS_AI));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1690-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1691-    // SPM uses PLATFORM feature only
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1692-    GatewayFilter spmUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1693:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1694:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1695:                JwtTargetType.SPM_JWT, FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1696-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1697-    // JM uses PLATFORM feature (matching UI route configuration)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1698-    GatewayFilter jmUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1699:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1700:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1701:                JwtTargetType.SPM_JWT, FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1702-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1703-    // Benchmark Central uses both PLATFORM and PROCESS_TRANSFORMATION_MANAGER features
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1704-    GatewayFilter benchmarkCentralUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1705:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1706:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1707:                JwtTargetType.SPM_JWT,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1708-                FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1709-                FeatureApplication.PROCESS_TRANSFORMATION_MANAGER));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1711-    // Joule Skills Backend uses PLATFORM feature only
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1712-    GatewayFilter jouleSkillsBackendUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1713:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1714:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1715:                JwtTargetType.SPM_JWT, FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1716-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1717-    // SPM Internal API uses PLATFORM feature only
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1718-    GatewayFilter spmInternalApiUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1719:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1720:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1721:                JwtTargetType.SPM_JWT, FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1722-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1723-    // Value Accelerator uses PLATFORM, PROCESS_INTELLIGENCE, ETL, and ANALYTICS_DATASTORE features
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1724-    // Note: Using features from val_route (UI route) for unified route
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1725-    GatewayFilter valUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1726:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1727:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1728:                JwtTargetType.SPM_JWT,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1729-                FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1730-                FeatureApplication.PROCESS_INTELLIGENCE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1734-    // PI GraphQL uses PROCESS_INTELLIGENCE, ANALYTICS_DATASTORE, and ETL features
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1735-    GatewayFilter piGraphqlUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1736:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1737:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1738:                JwtTargetType.SPM_JWT,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1739-                FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1740-                FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1743-    // Search Server uses PLATFORM feature only
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1744-    GatewayFilter searchServerUnifiedFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1745:        unifiedJwtConversionFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1746:            new UnifiedJwtConversionFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1747:                JwtTargetType.SPM_JWT, FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1748-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1749-    // CSP response filter for UI requests
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1758-            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1759-                r.order(JOULE_ROUTE_ORDER) // Same priority as Joule route (-2) to match first
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1760:                    .path("/hub/v1/graphql", "/g/api/graphql", "/g/api/graphql/active-features")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1761-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1762-                        f ->
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1764-                                // Rewrite Joule path to GraphQL endpoint
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1765-                                .rewritePath("^/hub/v1/graphql", "/g/api/graphql")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1766:                                // Rewrite active-features path
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1767:                                .rewritePath("^/g/api/graphql/active-features", "/active-features")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1768-                                // Unified conversion filter (reads auth-type attribute set by
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1769-                                // TokenAuthorizationManager)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1862-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1863-                    .uri(uriConfiguration.getBenchmarkCentralEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1864:        // Joule Skills Backend Unified Route (Joule path - open for future UI/UGW JWT support)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1865-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1866-            "joule_skills_backend_route_unified",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1892-                                .filter(spmInternalApiUnifiedFilter))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1893-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1894:        // Process AI Reagent Unified Route (Joule path - open for future UI/UGW JWT support)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1895-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1896-            "process_ai_reagent_route_unified",
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1909-                    .uri(uriConfiguration.getProcessAiReagentEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1910-        // Value Accelerator Unified Route (combines Joule and UI paths)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1911:        // Note: val_v1_route (UGW JWT path /val/v1/**) remains separate due to different
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1912-        // rewrite pattern
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1913-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1928-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1929-                    .uri(uriConfiguration.getValEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1930:        // PI GraphQL Unified Route (combines Joule, UGW JWT, and UI paths)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1931-        // Note: pi-graphql-route-for-btp and pi_graphql_options_route remain separate
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1932-        // CSP filter conditionally applied only to UI paths (legacy behavior preservation)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1933-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1934:            "pi_graphql_signal_route_unified",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1935-            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1936-                r.order(JOULE_ROUTE_ORDER) // Same priority as Joule route (-2) to match first
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1937-                    .path(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1938-                        "/pi/v1/graphql",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1939:                        "/pi/v1/signal",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1940-                        "/g/api/pi-graphql",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1941-                        "/g/api/pi-graphql/**")
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1956-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1957-                                    (exchange, chain) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1958:                                      String path = exchange.getRequest().getURI().getPath();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1959-                                      if (path.startsWith("/g/api/pi-graphql")) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1960-                                        // Apply CSP filter for UI paths only (matches legacy
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1963-                                      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1964-                                      // Skip CSP filter for Joule/UGW paths (matches legacy
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:1965:                                      // pi_graphql_signal_route_for_joule and pi_signal_route)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1966-                                      return chain.filter(exchange);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-1967-                                    })
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2001-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2002-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2003:   *   <li>process_ai_recommender_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2004-   *   <li>process_ai_recommender_route: Handles SPM Token authentication (UI path)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2005-   * </ul>
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2008-   * endpoint.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2009-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2010:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2011-   * process_ai_recommender_route_unified takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2012-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2035-                            f.rewritePath("^/process-ai-recommender", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2036-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2037:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2038:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2039-                                            FeatureApplication.PROCESS_AI))))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2040-                    .uri(uriConfiguration.getProcessAiRecommenderEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2047-                            f.rewritePath("^/g/api/process-ai-recommender", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2048-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2049:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2050:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2051-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2052-                                            FeatureApplication.PROCESS_AI)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2063-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2064-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2065:   *   <li>variant_management_for_joule: Handles Joule JWT (XSUAA/IAS) authentication
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2066:   *   <li>variant_management_route: Handles UGW JWT authentication
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2067-   *   <li>variant_management_ui_route: Handles SPM Token authentication (UI path)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2068-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2069-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2070:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2071-   * unifiedVariantManagementRoute() takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2072-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2095-                            f.rewritePath("^/variant-management", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2096-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2097:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2098:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2099-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2100-                                            FeatureApplication.VARIANT_MANAGEMENT)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2109-                            f.rewritePath("^/variant-management", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2110-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2111:                                    ugwJwtReplacementFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2112:                                        new UgwJwtToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2113-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2114-                                            FeatureApplication.VARIANT_MANAGEMENT)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2123-                            f.rewritePath("^/g/api/variant-management", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2124-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2125:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2126:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2127-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2128-                                            FeatureApplication.VARIANT_MANAGEMENT)))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2135-   * Legacy SPM Routes (Duplicate Routes).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2136-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2137:   * <p>These are the original routes for SPM with Joule JWT authentication:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2138-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2139-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2140:   *   <li>spm_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication for /spm/v1/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2141-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2142-   *
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2144-   * path) and requires bidirectional conversion (request + response filters).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2145-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2146:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2147-   * spm_route_unified takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2148-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2158-    Predicate<ServerWebExchange> isJouleRoute = jouleRoutePredicateFactory.apply(jouleConfig);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2159-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2160:    GatewayFilter xsuaaJwtToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2161:        sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2162:            new SapJwtToSpmJwtGatewayFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2163-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2164-    return builder
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2171-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2172-                    .path("/spm/v1/**")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2173:                    .filters(f -> f.rewritePath("^/spm/v1", "/p").filter(xsuaaJwtToSpmJwtFilter))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2174-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2175-        .build();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2182-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2183-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2184:   *   <li>jm_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication for /jm/v1/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2185-   *   <li>jm_gql_route: Handles SPM Token authentication (UI path) for /g/api/jm-gql/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2186-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2187-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2188:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2189-   * jm_route_unified takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2190-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2200-    Predicate<ServerWebExchange> isJouleRoute = jouleRoutePredicateFactory.apply(jouleConfig);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2201-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2202:    GatewayFilter spmTokenToSpmJwtFilterWithJourneyModeling =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2203:        spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2204:            new SpmTokenToSpmJwtFilterFactory.Config(FeatureApplication.JOURNEY_MODELING));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2205-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2206-    return builder
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2217-                            f.rewritePath("^/jm/v1/jm-gql", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2218-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2219:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2220:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2221-                                            FeatureApplication.JOURNEY_MODELING))))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2222-                    .uri(uriConfiguration.getJmServerEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2228-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2229-                            f.rewritePath("^/g/api/jm-gql/", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2230:                                .filter(spmTokenToSpmJwtFilterWithJourneyModeling)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2231-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2232-                    .uri(uriConfiguration.getJmServerEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2241-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2242-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2243:   *   <li>benchmark_central_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication for
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2244-   *       /benchmarks/v1/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2245-   *   <li>benchmark_central_graphql_route: Handles SPM Token authentication (UI path) for
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2247-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2248-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2249:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2250-   * benchmark_central_route_unified takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2251-   *
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2264-    Predicate<ServerWebExchange> isJouleRoute = jouleRoutePredicateFactory.apply(jouleConfig);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2265-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2266:    GatewayFilter spmTokenToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2267:        spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2268:            new SpmTokenToSpmJwtFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2269-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2270-    return builder
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2281-                            f.rewritePath("^/benchmarks/v1", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2282-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2283:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2284:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2285-                                            FeatureApplication.PROCESS_TRANSFORMATION_MANAGER)))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2286-                                .circuitBreaker(this::handleRouteCircuitBreaker))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2293-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2294-                            f.rewritePath("^/g/api/benchmark-central", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2295:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2296-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2297-                    .uri(uriConfiguration.getBenchmarkCentralEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2302-   * Legacy Joule Skills Backend Routes (Duplicate Routes).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2303-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2304:   * <p>These are the original routes for Joule Skills Backend with Joule JWT authentication:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2305-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2306-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2307:   *   <li>joule_skills_backend_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication for
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2308-   *       /jouleskillsbackend/v1/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2309-   * </ul>
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2312-   * endpoint.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2313-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2314:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2315-   * joule_skills_backend_route_unified takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2316-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2326-    Predicate<ServerWebExchange> isJouleRoute = jouleRoutePredicateFactory.apply(jouleConfig);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2327-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2328:    GatewayFilter xsuaaJwtToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2329:        sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2330:            new SapJwtToSpmJwtGatewayFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2331-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2332-    return builder
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2342-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2343-                            f.rewritePath("^/jouleskillsbackend/v1", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2344:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2345-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2346-                    .uri(uriConfiguration.getJouleSkillsBackendEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2351-   * Legacy SPM Internal API Routes (Duplicate Routes).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2352-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2353:   * <p>These are the original routes for SPM Internal API with Joule JWT authentication:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2354-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2355-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2356:   *   <li>spm_internal_api_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication for
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2357-   *       /spm/internal/v1/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2358-   * </ul>
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2360-   * <p>Note: Similar to SPM route but for internal API paths.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2361-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2362:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2363-   * spm_internal_api_route_unified takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2364-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2374-    Predicate<ServerWebExchange> isJouleRoute = jouleRoutePredicateFactory.apply(jouleConfig);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2375-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2376:    GatewayFilter xsuaaJwtToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2377:        sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2378:            new SapJwtToSpmJwtGatewayFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2379-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2380-    return builder
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2390-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2391-                            f.rewritePath("^/spm/internal/v1", "/api/v2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2392:                                .filter(xsuaaJwtToSpmJwtFilter))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2393-                    .uri(uriConfiguration.getSpmEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2394-        .build();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2396-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2397-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2398:   * Legacy PI GraphQL and Signal Routes (Triplicate Routes).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2399-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2400:   * <p>These are the original 3 separate routes for PI GraphQL/Signal with different authentication
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2401-   * mechanisms:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2402-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2403-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2404:   *   <li>pi_graphql_signal_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication for
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2405:   *       /pi/v1/graphql and /pi/v1/signal
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2406:   *   <li>pi_signal_route: Handles UGW JWT authentication for /pi/v1/signal only
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2407-   *   <li>pi-graphql-route: Handles SPM Token authentication (UI path) for /g/api/pi-graphql/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2408-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2409-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2410:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2411:   * pi_graphql_signal_route_unified takes over.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2412-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2413-   * <p>Note: pi_graphql_options_route and pi-graphql-route-for-btp remain in main bean (not
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2431-        .routes()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2432-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2433:            "pi_graphql_signal_route_for_joule",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2434-            r ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2435-                r.order(JOULE_ROUTE_ORDER)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2436-                    .predicate(isJouleRoute)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2437-                    .and()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2438:                    .path("/pi/v1/graphql", "/pi/v1/signal")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2439-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2440-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2441-                            f.rewritePath("^/pi/v1", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2442-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2443:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2444:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2445-                                            FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2446-                                            FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2449-                    .uri(uriConfiguration.getPiGraphqlEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2450-        .route(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2451:            "pi_signal_route",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2452-            p ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2453:                p.path("/pi/v1/signal")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2454-                    .filters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2455-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2456:                            f.rewritePath("^/pi/v1/signal", "/signal")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2457-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2458:                                    ugwJwtReplacementFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2459:                                        new UgwJwtToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2460-                                            FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2461-                                            FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2471-                            f.rewritePath("^/g/api/pi-graphql(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2472-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2473:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2474:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2475-                                            FeatureApplication.PROCESS_INTELLIGENCE,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2476-                                            FeatureApplication.ANALYTICS_DATASTORE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2489-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2490-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2491:   *   <li>search_server_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication, rewrites
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2492-   *       /suite/search/v1/query -> /
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2493-   *   <li>search_server_ui_route: Handles SPM Token authentication (UI path), rewrites
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2495-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2496-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2497:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2498-   * search_server_route_unified takes over with PLATFORM feature.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2499-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2509-    Predicate<ServerWebExchange> isJouleRoute = jouleRoutePredicateFactory.apply(jouleConfig);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2510-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2511:    GatewayFilter xsuaaJwtToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2512:        sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2513:            new SapJwtToSpmJwtGatewayFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2514-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2515:    GatewayFilter spmTokenToSpmJwtFilter =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2516:        spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2517:            new SpmTokenToSpmJwtFilterFactory.Config(FeatureApplication.PLATFORM));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2518-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2519-    return builder
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2529-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2530-                            f.rewritePath("^/suite/search/v1/query", "/")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2531:                                .filter(xsuaaJwtToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2532-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2533-                    .uri(uriConfiguration.getSearchServerEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2539-                        f ->
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2540-                            f.rewritePath("^/g/api/search-server(/(.*))?", "/$2")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2541:                                .filter(spmTokenToSpmJwtFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2542-                                .circuitBreaker(this::handleRouteCircuitBreaker))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2543-                    .uri(uriConfiguration.getSearchServerEndpoint()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2552-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2553-   * <ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2554:   *   <li>val_route_for_joule: Handles Joule JWT (XSUAA/IAS) authentication with NO features
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2555-   *       (legacy behavior)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2556-   *   <li>val_route: Handles SPM Token authentication (UI path) with 4 features
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2557-   * </ul>
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2558-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2559:   * <p>Note: val_v1_route (UGW JWT path) remains in the main routes bean as it was not migrated due
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2560-   * to different path rewrite pattern (/val/v1 -> /creators/v1).
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2561-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2562:   * <p>Active when feature.unifiedJouleRoutes.enabled = false (default). When enabled, the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2563-   * val_route_unified takes over with features from val_route.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2564-   */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2580-                            f.rewritePath("^/val/joule", "/joule")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2581-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2582:                                    sapJwtToSpmJwtGatewayFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2583:                                        new SapJwtToSpmJwtGatewayFilterFactory.Config())))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2584-                    .uri(uriConfiguration.getValEndpoint()))
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2585-        .route(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2591-                            f.rewritePath("^/g/api/val", "")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2592-                                .filter(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2593:                                    spmTokenToSpmJwtFilterFactory.apply(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2594:                                        new SpmTokenToSpmJwtFilterFactory.Config(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2595-                                            FeatureApplication.PLATFORM,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2596-                                            FeatureApplication.PROCESS_INTELLIGENCE,
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2602-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2603-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2604:  private void handleRouteCircuitBreaker(SpringCloudCircuitBreakerFilterFactory.Config config) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2605-    config.setName("circuitbreaker_filter");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2606-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2607-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2608:  private Function<GatewayFilterSpec, UriSpec> configureSpmRequestResponseFilters(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2609:      String regexPath, String replacement, GatewayFilter tokenRequestFilter) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2610-    SpmResponseHeadersRewriteFilterFactory.Config responseConfig =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2611-        new SpmResponseHeadersRewriteFilterFactory.Config();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2618-        f.rewritePath(regexPath, replacement)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2619-            .removeRequestHeader("Authorization")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java:2620:            .removeRequestHeader(X_DESTINATION_SERVICE)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2621-            .filter(tokenRequestFilter)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/routes/RoutesConfiguration.java-2622-            .filter(spmResponseHeadersRewriteFilter)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:1:package com.sap.bpi.api.gw.security.jwt.joule;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.JOULE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-5-import com.sap.bpi.api.gw.dto.WellKnownConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:6:import com.sap.bpi.api.gw.dto.tenant.SignavioTenantMappingResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:7:import com.sap.bpi.api.gw.filters.utils.JwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-8-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:9:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-10-import com.sap.bpi.api.gw.services.JouleIasTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-11-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-12-import java.util.Set;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:13:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:14:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:15:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-16-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-17-import reactor.util.function.Tuple2;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-20-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:21: * JouleIasJwtVerifier service is for IAS JWT verification for Joule use case.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-22- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:23: * <p>In order to verify the content of the IAS JWT, we need to get the public key first. Even
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:24: * though the link to the key is provided in the jku claim of the JWT, it is unsafe to use it
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-25- * directly. Instead, we should fetch the jwks_uri from the issuer's well-known configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:26: * endpoint and use it to get the public key. In order to get the well-known configuration, we need
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-27- * to get the authentication url from the tenant mapping which is stored at the Tenant Service. We
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:28: * query Tenant Service using the Signavio tenant ID from the 't' header or query parameter.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-29- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:30:@Service("jouleIasJwtVerifier")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:31:public class JouleIasJwtVerifier extends JouleJwtVerifier {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:32:  private final JouleIasTenantService jouleIasTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-34-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:35:  public JouleIasJwtVerifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-36-      JouleIasTenantService jouleIasTenantService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:37:      JwtVerifierUtils jwtVerifierUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-38-      AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:39:    super(jwtVerifierUtils, auditLogClientManager);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-40-    this.jouleIasTenantService = jouleIasTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:43:  public Mono<SignavioTenantMappingResponse> getTenantMapping(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:44:      String tenantIdentifier, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-45-    return jouleIasTenantService.getTenantMapping(tenantIdentifier, requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-46-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-48-  public Mono<WellKnownConfigurationDto> getTokenConfiguration(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:49:      SignavioTenantMappingResponse tenantMapping) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:50:    String url =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:51:        tenantMapping.getMappings().get(0).additionalInfo().assignedTenant().configuration().url()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-52-            + WELL_KNOWN_PATH;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:53:    return jwtVerifierUtils.getTokenConfiguration(url);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-54-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-55-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-56-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:57:  protected String getJwtType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:58:    return "IAS JWT";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-59-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-60-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-61-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:62:  public Mono<Tuple2<AuthorizationDecision, String>> isJwtValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:63:      String token, JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-64-    AuthorizationDecision notGranted = new AuthorizationDecision(false);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:65:    Tuple2<AuthorizationDecision, String> notGrantedAuthDecisionTuple = Tuples.of(notGranted, "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:67:    // Extract Signavio tenant ID from header or query parameter
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:68:    String signavioTenantId = jwtValidationContext.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:69:    if (signavioTenantId == null || signavioTenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:70:      logSignavioTenantIdMissing();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-71-      return Mono.just(notGrantedAuthDecisionTuple);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-72-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-74-    // Get tenant mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:75:    return getTenantMapping(signavioTenantId, jwtValidationContext.getRequestId())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-76-        // Get token configuration using tenant mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-77-        .zipWhen(this::getTokenConfiguration, Tuples::of)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:78:        // Fetch public key using the configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-79-        .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:80:            tuple -> jwtVerifierUtils.fetchPublicKey(tuple.getT2()),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:81:            (tuple, publicKey) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:82:              WellKnownConfigurationDto jwtConfiguration = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:83:              SignavioTenantMappingResponse tenantMapping = tuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-84-              try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:85:                Claims claims = jwtVerifierUtils.getClaims(publicKey, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-87-                // Check issuer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:88:                String actualIssuer = claims.getIssuer();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:89:                if (!jwtConfiguration.getIssuer().equals(actualIssuer)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:90:                  logJwtIssuerInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-91-                      actualIssuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:92:                      jwtConfiguration.getIssuer(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:93:                      signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:94:                      jwtValidationContext.getSourceIps(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:95:                      JOULE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-96-                  return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-97-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-98-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-99-                // Check audience (client ID)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:100:                Set<String> audience = claims.getAudience();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:101:                String clientId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-102-                    tenantMapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-103-                        .getMappings()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-104-                        .get(0)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-105-                        .additionalInfo()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:106:                        .assignedTenant()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-107-                        .configuration()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-108-                        .clientId();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-110-                if (audience == null || !audience.contains(clientId)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-111-                  logger.debug("Audience: {}", audience);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:112:                  logJwtAudienceInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-113-                      clientId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-114-                      audience,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:115:                      signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:116:                      jwtValidationContext.getSourceIps(),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:117:                      JOULE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-118-                  return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-119-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-120-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:121:                return Tuples.of(new AuthorizationDecision(true), signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-122-              } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:123:                logJwtValidationFailed(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:124:                    e, signavioTenantId, jwtValidationContext.getSourceIps(), JOULE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-125-                return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-126-              }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-129-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-130-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:131:  private void logSignavioTenantIdMissing() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java:132:    logger.error("Signavio tenant ID is missing");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-133-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleIasJwtVerifier.java-134-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-8-// Copied from SPM repo:
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java:9:// https://github.com/signavio/process-manager/blob/develop/platform-api/src/main/java/com/signavio/api/dto/config/security/TrustedFrameAncestorsDto.java#L9
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-10-public class TrustedFrameAncestorsDto {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-12-  @JsonProperty("domains")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java:13:  private List<String> domains;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-15-  @JsonProperty("invalidDomains")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java:16:  private List<String> invalidDomains;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java:18:  public static TrustedFrameAncestorsDto create(List<String> validDomains) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-19-    return withInvalidDomains(validDomains, emptyList());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-20-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-22-  public static TrustedFrameAncestorsDto withInvalidDomains(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java:23:      List<String> validDomains, List<String> invalidDomains) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-24-    TrustedFrameAncestorsDto trustedFrameAncestorsDto = new TrustedFrameAncestorsDto();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-25-    trustedFrameAncestorsDto.domains = validDomains;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-32-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-33-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java:34:  public List<String> getDomains() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-35-    return domains;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-36-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-37-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java:38:  public List<String> getInvalidDomains() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-39-    return invalidDomains;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/TrustedFrameAncestorsDto.java-40-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-5-public class WellKnownConfigurationDto {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java:6:  private String issuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-8-  @JsonProperty("jwks_uri")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java:9:  private String jwksUri;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java:11:  public WellKnownConfigurationDto(String issuer, String jwksUri) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-12-    this.issuer = issuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-13-    this.jwksUri = jwksUri;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-14-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java:16:  public String getIssuer() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-17-    return issuer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-18-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java:20:  public String getJwksUri() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-21-    return jwksUri;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/WellKnownConfigurationDto.java-22-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-3-public class CredentialStorePayload {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java:4:  private String name;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java:5:  private String value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java:6:  private CredentialStoreMetadata metadata;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java:8:  public String getName() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-9-    return name;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-10-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java:12:  public void setName(String name) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-13-    this.name = name;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-14-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java:16:  public String getValue() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-17-    return value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-18-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java:20:  public void setValue(String value) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-21-    this.value = value;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStorePayload.java-22-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CnRecordDto.java-3-import com.fasterxml.jackson.annotation.JsonProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CnRecordDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/CnRecordDto.java:5:public record CnRecordDto(@JsonProperty("cn_record") String cnRecord, String url) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-11-  @JsonProperty("token")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-12-  @NotBlank(message = "Invalid request: missing token")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:13:  private String token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-14-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-15-  @JsonProperty("tenant")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-16-  @NotBlank(message = "Invalid request: missing tenant")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:17:  private String tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-19-  @JsonProperty("userId")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:20:  private String userId; // userID, random, user
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-22-  @JsonProperty("expiration")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-23-  @ValidISO8601Timestamp
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:24:  private String expirationDate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-26-  @JsonProperty("audience")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-27-  @JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:28:  private Set<String> audience;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-30-  AuthTokenRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:31:      String token, String tenant, String expirationDate, String userId, Set<String> audiences) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-32-    this.token = token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-33-    this.tenant = tenant;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-37-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-38-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:39:  public String getToken() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-40-    return token;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-41-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:43:  public String getTenant() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-44-    return tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-45-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-46-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:47:  public String getExpirationDate() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-48-    return expirationDate;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-49-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-50-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:51:  public String getUserId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-52-    return userId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-53-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-54-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java:55:  public Set<String> getAudience() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-56-    return audience;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/AuthTokenRequest.java-57-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:1:package com.sap.bpi.api.gw.security.jwt;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:3:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.extractBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.isBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:6:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:7:import com.sap.bpi.api.gw.security.jwt.strategy.TokenType;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-8-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-9-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:10:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:11:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:12:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-14-/**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-18- * handle the request.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-19- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:20: * <p>Detection logic: 1. Check for Bearer token in Authorization header - Decode JWT payload -
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:21: * Check for UGW issuer  UGW_JWT - Check for XSUAA claims  SAP_JWT - Check for BTP issuer 
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:22: * SAP_JWT 2. Check for X-Signavio-Id header  SPM_TOKEN 3. Check for Cookie header  SPM_TOKEN (GET
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-23- * request edge case) 4. Else  UNKNOWN
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-24- */
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-26-public class TokenTypeDetector {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-27-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:28:  private static final Logger logger = LoggerFactory.getLogger(TokenTypeDetector.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:29:  private static final String X_SIGNAVIO_ID_HEADER = "x-signavio-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:30:  private static final String COOKIE_HEADER = "Cookie";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-31-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-32-  /**
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-37-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-38-  public TokenType detectTokenType(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:39:    String authHeader = exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:40:    String xSignavioIdHeader = exchange.getRequest().getHeaders().getFirst(X_SIGNAVIO_ID_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-41-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:42:    // Check for Bearer token (JWT)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-43-    if (isBearerToken(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:44:      String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:45:      return detectJwtType(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-46-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:48:    // Check for x-signavio-id header
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:49:    if (xSignavioIdHeader != null && !xSignavioIdHeader.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-50-      return TokenType.SPM_TOKEN;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-51-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-52-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-53-    // Check for cookieHeader (GET request with token included in cookie header case)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:54:    String cookieHeader = exchange.getRequest().getHeaders().getFirst(COOKIE_HEADER);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-55-    if (cookieHeader != null && !cookieHeader.trim().isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-56-      return TokenType.SPM_TOKEN;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-63-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:64:   * Detects the specific JWT type by examining the token payload.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-65-   *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:66:   * @param token the JWT token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:67:   * @return the JWT token type
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-68-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:69:  private TokenType detectJwtType(String token) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-70-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:71:      // IMPORTANT: Check for UGW JWT first (by issuer claim)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:72:      // UGW JWT is identified by issuer that contains "bpi-api-gw" at the beginning
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:73:      // and ends with "signav.io"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:74:      if (JwtUtils.isUgwJwt(token)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:75:        logger.debug("Detected UGW JWT token via issuer claim");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:76:        return TokenType.UGW_JWT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-77-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-78-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:79:      // Check if it's an XSUAA JWT
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:80:      if (JwtUtils.isXsuaaJwt(token)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:81:        logger.debug("Detected XSUAA JWT token");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:82:        return TokenType.SAP_JWT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-83-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-85-      // Check if issuer is from BTP
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:86:      if (JwtUtils.isIssuerFromBtp(token)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:87:        logger.debug("Detected BTP JWT (IAS or other SAP JWT)");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:88:        return TokenType.SAP_JWT;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-89-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-90-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:91:      logger.debug("JWT type could not be determined, treating as unknown");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-92-      return TokenType.UNKNOWN;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-93-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-94-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java:95:      logger.warn("Failed to decode JWT token for type detection: {}", e.getMessage());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-96-      return TokenType.UNKNOWN;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/TokenTypeDetector.java-97-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java-7-public record SpmUser(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:8:    String id,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:9:    String firstname,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:10:    String lastname,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:11:    String name,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:12:    String email,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:13:    String language,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java-14-    boolean isAdmin,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:15:    String tenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:16:    Map<String, Set<String>> featuresOfApps,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:17:    List<String> groups,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:18:    List<String> groupIds,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SpmUser.java:19:    List<String> licenses) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:1:package com.sap.bpi.api.gw.security.jwt.joule;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.JOULE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:6:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:7:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:8:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:9:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:10:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:11:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:12:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:13:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:14:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:15:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:16:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-17-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-19-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-20-public class JouleAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:21:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:22:  private final JwtVerifierStrategy jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:23:  public static final String X_CLIENT_ID_ATTRIBUTE = "x-client-id";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-24-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-25-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-26-  public JouleAuthorizationManager(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:27:      @Qualifier("jouleCompositeJwtVerifier") JwtVerifierStrategy jwtVerifier) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:28:    this.jwtVerifier = jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-29-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-30-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-33-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-34-    ServerWebExchange exchange = context.getExchange();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:35:    JwtValidationContext jwtValidationContext =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:36:        JwtValidationContext.from(exchange.getRequest().getHeaders());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:37:    String authHeader = jwtValidationContext.getHeader(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-38-    if (isBearerToken(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:39:      String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:40:      return jwtVerifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:41:          .isJwtValid(token, jwtValidationContext)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java:42:          .flatMap(tuple2 -> handleJwtValidationResult(context, tuple2, JOULE.toString()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-43-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleAuthorizationManager.java-44-    return Mono.just(new AuthorizationDecision(false));
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-3-import com.fasterxml.jackson.annotation.JsonProperty;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:5:public class CredentialStoreEncryptionKeys {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:6:  @JsonProperty("client_private_key")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:7:  private String clientPrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:9:  @JsonProperty("server_public_key")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:10:  private String serverPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:12:  public String getClientPrivateKey() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:13:    return clientPrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-14-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:16:  public void setClientPrivateKey(String clientPrivateKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:17:    this.clientPrivateKey = clientPrivateKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-18-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:20:  public String getServerPublicKey() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:21:    return serverPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-22-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:24:  public void setServerPublicKey(String serverPublicKey) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java:25:    this.serverPublicKey = serverPublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-26-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreEncryptionKeys.java-27-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-5-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:7:public class PublicKeyListDto {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:9:  @JsonProperty("keys")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:10:  private List<PublicKeyDto> publicKeys = new ArrayList<>();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-11-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:12:  public List<PublicKeyDto> getKeys() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:13:    return publicKeys;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-14-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:16:  public PublicKeyListDto() {}
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:18:  public PublicKeyListDto(PublicKeyDto publicKeyDto) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java:19:    this.publicKeys.add(publicKeyDto);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-20-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/PublicKeyListDto.java-21-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/IasJwtDto.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/IasJwtDto.java-6-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/IasJwtDto.java:7:public record IasJwtDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/IasJwtDto.java:8:    String email,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/IasJwtDto.java:9:    @JsonProperty("ias_iss") String issuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/IasJwtDto.java:10:    @JsonProperty("app_tid") String signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/IasJwtDto.java:11:    @JsonProperty("uid") String uid) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java-6-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java:7:public record SapJwtDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java:8:    String email,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java:9:    @JsonProperty("iss") String issuer,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java:10:    @JsonProperty("user_uuid") String userUuid,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java:11:    @JsonProperty("uid") String uid,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/SapJwtDto.java:12:    @JsonProperty("ext_attr") XsuaaJwtExtraAttributes extraAttributes) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:1:package com.sap.bpi.api.gw.security.jwt.ias;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.WORKZONE;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.WELL_KNOWN_PATH;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-6-import com.sap.bpi.api.gw.dto.WellKnownConfigurationDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-7-import com.sap.bpi.api.gw.dto.tenant.workzone.WorkzoneTenantServiceResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:8:import com.sap.bpi.api.gw.filters.utils.JwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-9-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:10:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:11:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-12-import com.sap.bpi.api.gw.services.WorkzoneIasTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-13-import io.jsonwebtoken.Claims;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:14:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-15-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-16-import java.util.Set;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-17-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-18-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:19:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:20:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:21:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-22-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-23-import reactor.util.function.Tuple2;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-26-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:27: * WorkzoneIasJwtVerifier service is for IAS JWT verification for Workzone CDM use case.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-28- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:29: * <p>In order to verify the content of the IAS JWT, we need to get the public key first. Even
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:30: * though the link to the key is provided in the jku claim of the JWT, it is unsafe to use it
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-31- * directly. Instead, we should fetch the jwks_uri from the issuer's well-known configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:32: * endpoint and use it to get the public key. In order to get the well-known configuration, we need
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-33- * to get the authentication url from the tenant mapping which is stored at the Tenant Service. We
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:34: * query Tenant Service using the Signavio tenant ID from the 't' header or query parameter.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-35- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:36:@Service("workzoneIasJwtVerifier")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:37:public class WorkzoneIasJwtVerifier implements JwtVerifierStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:38:  private final Logger logger = LoggerFactory.getLogger(WorkzoneIasJwtVerifier.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:39:  private final WorkzoneIasTenantService workzoneIasTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:40:  private final JwtVerifierUtils jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:41:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-42-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-43-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:44:  public WorkzoneIasJwtVerifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-45-      WorkzoneIasTenantService workzoneIasTenantService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:46:      JwtVerifierUtils jwtVerifierUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-47-      AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-48-    this.workzoneIasTenantService = workzoneIasTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:49:    this.jwtVerifierUtils = jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-50-    this.auditLogClientManager = auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-51-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-53-  public Mono<WellKnownConfigurationDto> getTokenConfiguration(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-54-      WorkzoneTenantServiceResponse tenantMapping) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:55:    String url = tenantMapping.getTokenServiceUrl() + WELL_KNOWN_PATH;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:56:    return jwtVerifierUtils.getTokenConfiguration(url);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-57-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-58-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:59:  public Mono<PublicKey> fetchPublicKey(WellKnownConfigurationDto wellKnownConfiguration) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:60:    return jwtVerifierUtils.fetchPublicKey(wellKnownConfiguration);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-61-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-62-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-63-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:64:   * Gets the well-known OpenID configuration (issuer and a jwks_uri) Checks if the JWT valid by
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:65:   * verifying the signature with the public key, and checking the issuer and audience. Expiry date
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:66:   * is checked by the JWT parser.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-67-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-68-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:69:  public Mono<Tuple2<AuthorizationDecision, String>> isJwtValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:70:      String token, JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-71-    AuthorizationDecision notGranted = new AuthorizationDecision(false);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:72:    Tuple2<AuthorizationDecision, String> notGrantedAuthDecisionTuple = Tuples.of(notGranted, "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:74:    // Extract Signavio tenant ID from header or query parameter
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:75:    String signavioTenantId = jwtValidationContext.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:76:    if (signavioTenantId == null || signavioTenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:77:      logSignavioTenantIdMissing();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-78-      return Mono.just(notGrantedAuthDecisionTuple);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-79-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-81-    // get tenant mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-82-    Mono<WorkzoneTenantServiceResponse> tenantMappingMono =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:83:        workzoneIasTenantService.getTenantMapping(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-84-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-85-    // validate token
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-87-        // first get the token configuration using the tenant mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-88-        .zipWhen(this::getTokenConfiguration, Tuples::of)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:89:        // then fetch the public key using the configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-90-        .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:91:            tuple -> jwtVerifierUtils.fetchPublicKey(tuple.getT2()),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:92:            (tuple, publicKey) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:93:              WellKnownConfigurationDto jwtConfiguration = tuple.getT2();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-94-              WorkzoneTenantServiceResponse tenantMapping = tuple.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-95-              try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:96:                Claims claims = jwtVerifierUtils.getClaims(publicKey, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-97-                // Check issuer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:98:                String actualIssuer = claims.getIssuer();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:99:                if (!jwtConfiguration.getIssuer().equals(actualIssuer)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:100:                  logJwtIssuerInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:101:                      actualIssuer, signavioTenantId, jwtValidationContext.getSourceIps());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-102-                  return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-103-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-104-                // Check audience (client ID)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:105:                Set<String> audience = claims.getAudience();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:106:                String clientId = tenantMapping.getClientId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-107-                logger.debug("Client ID: {}", clientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-108-                if (audience == null || !audience.contains(clientId)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-109-                  logger.debug("Audience: {}", audience);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:110:                  logJwtAudienceInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:111:                      clientId, signavioTenantId, jwtValidationContext.getSourceIps());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-112-                  return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-113-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:114:                return Tuples.of(new AuthorizationDecision(true), signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-115-              } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:116:                logJwtValidationFailed(e, signavioTenantId, jwtValidationContext.getSourceIps());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-117-                return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-118-              }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-121-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-122-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:123:  private void logJwtValidationFailed(Exception e, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-124-    logger.error("Failed to validate the token:", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:125:    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, WORKZONE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-126-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-127-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:128:  private void logJwtAudienceInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:129:      String expectedClientId, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-130-    logger.error("Token audience does not contain client ID {}", expectedClientId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-131-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:132:    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, WORKZONE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-133-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-134-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:135:  private void logJwtIssuerInvalid(String actualIssuer, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-136-    logger.error("Token issuer \"{}\" is not valid", actualIssuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-137-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:138:    auditLogClientManager.logUnauthorizedAccess(tenantId, sourceIps, WORKZONE.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-139-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-140-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:141:  private void logSignavioTenantIdMissing() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java:142:    logger.error("Signavio tenant ID is missing");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-143-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneIasJwtVerifier.java-144-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-3-public class CredentialStoreMetadata {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java:4:  private String callbackUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java:6:  public String getCallbackUrl() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-7-    return callbackUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-8-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-9-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java:10:  public void setCallbackUrl(String callbackUrl) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-11-    this.callbackUrl = callbackUrl;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/credentialStore/CredentialStoreMetadata.java-12-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java-3-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java:5:public class SignavioTenantMappingResponse extends TenantServiceResponse {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java:6:  private final List<TenantMappingDto> mappings;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java:8:  public SignavioTenantMappingResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java:9:      String signavioTenantId, String type, List<TenantMappingDto> mappings) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java:10:    super(signavioTenantId, type);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java-11-    this.mappings = mappings;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/SignavioTenantMappingResponse.java-12-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:1:package com.sap.bpi.api.gw.security.jwt.ias;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.BTP;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-6-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:7:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:8:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-9-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-10-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:11:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:12:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:13:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:14:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:15:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:16:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:17:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:18:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:19:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-20-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-21-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-22-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-23-public class IngestionAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:24:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:26:  private final Logger logger = LoggerFactory.getLogger(IngestionAuthorizationManager.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:27:  private final JwtVerifierStrategy jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:28:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-30-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-31-  public IngestionAuthorizationManager(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:32:      @Qualifier("iasJwtVerifier") JwtVerifierStrategy jwtVerifier,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-33-      AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:34:    this.jwtVerifier = jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-35-    this.auditLogClientManager = auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-36-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-40-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-41-    ServerWebExchange exchange = context.getExchange();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:42:    JwtValidationContext jwtValidationContext =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:43:        JwtValidationContext.from(exchange.getRequest().getHeaders(), null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:44:    String authHeader = jwtValidationContext.getHeader(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-45-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-46-    if (isBearerToken(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:47:      String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:48:      return jwtVerifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:49:          .isJwtValid(token, jwtValidationContext)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-50-          .flatMap(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-51-              tuple2 -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-52-                AuthorizationDecision decision = tuple2.getT1();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-53-                if (decision.isGranted()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:54:                  logger.debug("IAS JWT is valid.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-55-                } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:56:                  logUnauthenticatedRequest(jwtValidationContext, tuple2.getT2());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-57-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:58:                return handleJwtValidationResult(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:59:                    context, tuple2, jwtValidationContext.getPrimarySourceIp());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-60-              });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-61-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:62:      logMissingAuthBearerToken(jwtValidationContext);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-63-      return Mono.just(new AuthorizationDecision(false));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-64-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-65-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:67:  private void logMissingAuthBearerToken(JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-68-    logger.debug("No Bearer token in Authorization header present. Rejecting request.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:69:    var sourceIps = jwtValidationContext.getSourceIps();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:70:    String tenantId = jwtValidationContext.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:71:    auditLogClientManager.logUnauthenticatedAccess(tenantId, sourceIps, BTP.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-72-    ;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-73-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-74-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:75:  private void logUnauthenticatedRequest(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:76:      JwtValidationContext jwtValidationContext, String signavioTenantId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:77:    logger.debug("IAS JWT invalid. Rejecting request.");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:78:    var sourceIps = jwtValidationContext.getSourceIps();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java:79:    auditLogClientManager.logUnauthenticatedAccess(signavioTenantId, sourceIps, BTP.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-80-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionAuthorizationManager.java-81-}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:1:package com.sap.bpi.api.gw.security.jwt.ias;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:3:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.*;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:5:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:6:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:7:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:8:import org.springframework.beans.factory.annotation.Qualifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:9:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:10:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:11:import org.springframework.security.authorization.ReactiveAuthorizationManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:12:import org.springframework.security.core.Authentication;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:13:import org.springframework.security.web.server.authorization.AuthorizationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:14:import org.springframework.stereotype.Component;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:15:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-16-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-17-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-18-@Component
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-19-public class WorkzoneCdmAuthorizationManager
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:20:    implements ReactiveAuthorizationManager<AuthorizationContext> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:21:  private final JwtVerifierStrategy jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-23-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-24-  public WorkzoneCdmAuthorizationManager(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:25:      @Qualifier("workzoneIasJwtVerifier") JwtVerifierStrategy jwtVerifier) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:26:    this.jwtVerifier = jwtVerifier;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-27-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-28-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-31-      Mono<Authentication> authentication, AuthorizationContext context) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-32-    ServerWebExchange exchange = context.getExchange();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:33:    JwtValidationContext jwtValidationContext = JwtValidationContext.from(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:34:    String authHeader = jwtValidationContext.getHeader(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-35-    if (isBearerToken(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:36:      String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:37:      return jwtVerifier
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java:38:          .isJwtValid(token, jwtValidationContext)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-39-          .flatMap(decisionAndTenantId -> Mono.just(decisionAndTenantId.getT1()));
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/WorkzoneCdmAuthorizationManager.java-40-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantMappingDto.java-1-package com.sap.bpi.api.gw.dto.tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantMappingDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantMappingDto.java:3:public record TenantMappingDto(String externalTenantId, AdditionalInfoDto additionalInfo) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/IpsConfigurationDto.java-1-package com.sap.bpi.api.gw.dto.tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/IpsConfigurationDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/IpsConfigurationDto.java:3:public record IpsConfigurationDto(String tenantId, String type, ConfigurationDto configuration) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:1:package com.sap.bpi.api.gw.security.jwt.joule;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:3:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.extractBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:4:import static com.sap.bpi.api.gw.security.jwt.utils.JwtAuthorizationManagerUtils.isBearerToken;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-6-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:7:import com.sap.bpi.api.gw.dto.SapJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-8-import com.sap.bpi.api.gw.filters.utils.FilterUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:9:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-10-import java.net.MalformedURLException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-11-import java.net.URL;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-14-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-15-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:16:import org.springframework.http.HttpHeaders;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:17:import org.springframework.security.web.server.util.matcher.OrServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:18:import org.springframework.security.web.server.util.matcher.PathPatternParserServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:19:import org.springframework.security.web.server.util.matcher.ServerWebExchangeMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:20:import org.springframework.web.server.ServerWebExchange;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-21-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-22-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-23-public class JouleRequestMatcher implements ServerWebExchangeMatcher {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:24:  private static final String BTP_JWT_ISSUER_HOST = "ondemand.com";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-25-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:26:  private final Logger logger = LoggerFactory.getLogger(JouleRequestMatcher.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:27:  private final ServerWebExchangeMatcher pathPatternMatcher;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:28:  private final ObjectMapper objectMapper = new ObjectMapper();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-29-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:30:  public JouleRequestMatcher(String... pathPatterns) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-31-    this.pathPatternMatcher =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-32-        new OrServerWebExchangeMatcher(
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-38-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-39-  public Mono<MatchResult> matches(ServerWebExchange exchange) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:40:    String requestId = FilterUtils.getRequestIdFromHeaderOrGenerate(exchange.getRequest());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-41-    return pathPatternMatcher
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-42-        .matches(exchange)
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-44-            pathPatternMatchResult -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-45-              if (pathPatternMatchResult.isMatch()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:46:                String authHeader =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-47-                    exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-48-                if (isBearerToken(authHeader)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:49:                  String token = extractBearerToken(authHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:50:                  if (isJwtIssuerFromBtp(token, requestId)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-51-                    logger.debug("Processing request {} from Joule", requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-52-                    return MatchResult.match();
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-59-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-60-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:61:   * Note: Non-standard check - for now all JWT from BTP are from Joule. Checks if the request is
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:62:   * coming from Joule by verifying the JWT issuer is from BTP.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-63-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:64:  private boolean isJwtIssuerFromBtp(String token, String requestId) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-65-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:66:      String payload = JwtUtils.decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:67:      SapJwtDto xsuaaJwtDto = objectMapper.readValue(payload, SapJwtDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:68:      return Optional.ofNullable(xsuaaJwtDto.issuer())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-69-          .map(this::isBtpHost)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-70-          .orElseGet(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-71-              () -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:72:                logger.debug("JWT issuer is not present or not from BTP in request {}", requestId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-73-                return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-74-              });
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-75-    } catch (Exception ex) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:76:      logger.error("Failed to deserialize Xsuaa JWT", ex);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-77-      return false;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-78-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-79-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-80-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:81:  private boolean isBtpHost(String urlString) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-82-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:83:      URL url = new URL(urlString);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:84:      String host = url.getHost();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:85:      logger.debug("JWT issuer {} is from BTP", urlString);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java:86:      return host.endsWith(BTP_JWT_ISSUER_HOST);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-87-    } catch (MalformedURLException e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/joule/JouleRequestMatcher.java-88-      logger.error("Invalid URL: {}", e.getMessage());
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-6- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-7-public class TenantServiceResponse {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java:8:  private final String tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java:9:  private final String type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-10-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java:11:  public TenantServiceResponse(String tenantId, String type) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-12-    this.tenantId = tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-13-    this.type = type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-14-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-15-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java:16:  public String getTenantId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-17-    return tenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-18-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-19-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java:20:  public String getType() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-21-    return type;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/TenantServiceResponse.java-22-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AdditionalInfoDto.java-1-package com.sap.bpi.api.gw.dto.tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AdditionalInfoDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AdditionalInfoDto.java:3:public record AdditionalInfoDto(AssignedTenantDto assignedTenant) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-3-public class ExternalTenantMappingResponse extends TenantServiceResponse {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java:4:  private final String externalTenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java:5:  private final AdditionalInfoDto additionalInfo;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-7-  public ExternalTenantMappingResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java:8:      String signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java:9:      String externalTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java:10:      String type,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-11-      AdditionalInfoDto additionalInfo) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java:12:    super(signavioTenantId, type);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-13-    this.externalTenantId = externalTenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-14-    this.additionalInfo = additionalInfo;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-15-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-16-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java:17:  public String getExternalTenantId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-18-    return externalTenantId;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ExternalTenantMappingResponse.java-19-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:1:package com.sap.bpi.api.gw.security.jwt.ias;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-3-import static com.sap.bpi.api.gw.security.certificate.utils.RequestOrigin.BTP;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-5-import com.fasterxml.jackson.databind.ObjectMapper;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:6:import com.sap.bpi.api.gw.dto.IasJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-7-import com.sap.bpi.api.gw.dto.tenant.ias.TenantServiceIasTypeResponse;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-8-import com.sap.bpi.api.gw.dto.tenant.ias.TrustedClientDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:9:import com.sap.bpi.api.gw.filters.utils.JwtUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:10:import com.sap.bpi.api.gw.filters.utils.JwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-11-import com.sap.bpi.api.gw.global.AuditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:12:import com.sap.bpi.api.gw.security.jwt.JwtValidationContext;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:13:import com.sap.bpi.api.gw.security.jwt.JwtVerifierStrategy;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-14-import com.sap.bpi.api.gw.services.IasTenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-15-import io.jsonwebtoken.Claims;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-17-import java.net.URI;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-18-import java.net.URISyntaxException;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:19:import java.security.PublicKey;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-20-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-21-import java.util.Optional;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-22-import java.util.Set;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:23:import org.apache.commons.lang3.StringUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-24-import org.slf4j.Logger;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-25-import org.slf4j.LoggerFactory;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:26:import org.springframework.beans.factory.annotation.Autowired;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:27:import org.springframework.security.authorization.AuthorizationDecision;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:28:import org.springframework.stereotype.Service;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-29-import reactor.core.publisher.Mono;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-30-import reactor.util.function.Tuple2;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-33-/**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:34: * IasJwtVerifier service is for IAS JWT verification and originally implemented to support the
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-35- * Ingestion API v2 use case.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-36- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:37: * <p>In order to verify the content of the IAS JWT, we need to get the public key first. Even
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:38: * though the link to the key is provided in the jku claim of the JWT, it is unsafe to use it
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-39- * directly. Instead, we should fetch the jwks_uri from the issuer's well-known configuration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:40: * endpoint and use it to get the public key. In order to get the well-known configuration, we need
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-41- * to get the authentication url from the tenant mapping which is stored at the Tenant Service. We
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:42: * can query Tenant Service using the tenant ID from the JWT's app_tid claim.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-43- */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:44:@Service("iasJwtVerifier")
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:45:public class IngestionIasJwtVerifier implements JwtVerifierStrategy {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:46:  public static final String TENANT_CONFIGURATION_PATH = "/v1/tenants/%s/configurations?type=%s";
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-47-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:48:  private final Logger logger = LoggerFactory.getLogger(IngestionIasJwtVerifier.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:49:  private final ObjectMapper objectMapper = new ObjectMapper();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:50:  private final IasTenantService tenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:51:  private final JwtVerifierUtils jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:52:  private final AuditLogClientManager auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-53-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-54-  @Autowired
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:55:  public IngestionIasJwtVerifier(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-56-      IasTenantService tenantService,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:57:      JwtVerifierUtils jwtVerifierUtils,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-58-      AuditLogClientManager auditLogClientManager) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-59-    this.tenantService = tenantService;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:60:    this.jwtVerifierUtils = jwtVerifierUtils;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-61-    this.auditLogClientManager = auditLogClientManager;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-62-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-63-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:64:  public Mono<PublicKey> fetchPublicKey(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:65:      TenantServiceIasTypeResponse tenantConfiguration, String ingestionTokenHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-66-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-67-    Optional<TrustedClientDto> matchingClient =
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-70-            .findFirst();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-71-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:72:    String jwksUri = matchingClient.map(TrustedClientDto::jwksUri).orElse(null);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-73-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-74-    if (jwksUri == null) {
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-82-        "Fetched jwksUri {} for ingestion token header (value omitted for security)", jwksUri);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-83-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:84:    return jwtVerifierUtils.fetchPublicKey(jwksUri);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-85-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-86-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-87-  /**
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:88:   * Gets the well-know OpenID configuration (issuer and a jwks_uri) Checks if the JWT valid by
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:89:   * verifying the signature with the public key, and checking the issuer, audience, and Signavio
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-90-   * tenant ID. Expiry date is checked by the {@link
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:91:   * io.jsonwebtoken.impl.DefaultJwtParser#parse(Reader)} method.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-92-   */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-93-  @Override
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:94:  public Mono<Tuple2<AuthorizationDecision, String>> isJwtValid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:95:      String token, JwtValidationContext jwtValidationContext) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-96-    AuthorizationDecision notGranted = new AuthorizationDecision(false);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:97:    Tuple2<AuthorizationDecision, String> notGrantedAuthDecisionTuple = Tuples.of(notGranted, "");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-98-    // get BTP subaccount ID from token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:99:    IasJwtDto iasJwtDto;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:100:    String tenantFromHeader = jwtValidationContext.getTenantId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-101-    try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:102:      String payload = JwtUtils.decodeJwtPayload(token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:103:      iasJwtDto = objectMapper.readValue(payload, IasJwtDto.class);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-104-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-105-    } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:106:      logJwtDeserializationFailed(e, tenantFromHeader, jwtValidationContext.getSourceIps());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-107-      return Mono.just(notGrantedAuthDecisionTuple);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-108-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:109:    String signavioTenantId =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:110:        chooseSignavioTenantId(iasJwtDto.signavioTenantId(), tenantFromHeader);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:111:    if (signavioTenantId == null || signavioTenantId.isEmpty()) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-112-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:113:      logSignavioTenantIdMissing();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-114-      return Mono.just(notGrantedAuthDecisionTuple);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-115-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-116-    // get tenant mapping
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-117-    Mono<TenantServiceIasTypeResponse> tenantConfiguration =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:118:        tenantService.getTenantMapping(signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-119-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:120:    String ingestionToken = jwtValidationContext.getIngestionEntityId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-121-    // validate token
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-122-    return tenantConfiguration
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-123-        .zipWhen(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:124:            tenantServiceResponse -> fetchPublicKey(tenantServiceResponse, ingestionToken),
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:125:            (tenantServiceResponse, publicKey) -> {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-126-              try {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:127:                Claims claims = jwtVerifierUtils.getClaims(publicKey, token);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-128-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-129-                // Check issuer
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:130:                String actualIssuer = claims.getIssuer();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:131:                String trustedJwtIssuer =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-132-                    convertJwksUriToIssuer(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-133-                        tenantServiceResponse.getConfiguration().trustedClients().stream()
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-136-                            .get()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-137-                            .jwksUri());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:138:                String userId = getUserIdFromJwtOrDefault(claims);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:139:                if (!trustedJwtIssuer.equals(actualIssuer)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:140:                  logJwtIssuerInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:141:                      actualIssuer, userId, signavioTenantId, jwtValidationContext.getSourceIps());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-142-                  return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-143-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-144-                // Check audience (client ID of the provider IAS)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:145:                Set<String> audience = claims.getAudience();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:146:                String expectedAudience =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-147-                    tenantServiceResponse.getConfiguration().trustedClients().stream()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-148-                        .filter(client -> ingestionToken.equals(client.entityId()))
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-151-                        .clientId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-152-                if (!audience.contains(expectedAudience)) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:153:                  logJwtAudienceInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-154-                      expectedAudience,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-155-                      userId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:156:                      signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:157:                      jwtValidationContext.getSourceIps());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-158-                  return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-159-                }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-160-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:161:                return Tuples.of(new AuthorizationDecision(true), signavioTenantId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-162-              } catch (Exception e) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:163:                logJwtValidationFailed(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:164:                    e, BTP.toString(), signavioTenantId, jwtValidationContext.getSourceIps());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-165-                return notGrantedAuthDecisionTuple;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-166-              }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-169-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-170-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:171:  private void logJwtValidationFailed(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:172:      Exception e, String userId, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-173-    logger.error("Failed to validate the token:", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-174-    auditLogClientManager.logUnauthenticatedAccess(tenantId, sourceIps, userId);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-175-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-176-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:177:  private void logJwtAudienceInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:178:      String expectedAudience, String userId, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-179-    logger.error("Token audience does not contain expected value {}", expectedAudience);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-180-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-182-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-183-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:184:  private void logJwtIssuerInvalid(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:185:      String actualIssuer, String userId, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-186-    logger.error("Token issuer \"{}\" is not valid", actualIssuer);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-187-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-189-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-190-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:191:  private void logJwtDeserializationFailed(Exception e, String tenantId, List<String> sourceIps) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:192:    logger.error("Failed to deserialize IAS JWT", e);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:193:    auditLogClientManager.logUnauthenticatedAccess(tenantId, sourceIps, BTP.toString());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-194-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-195-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:196:  private void logSignavioTenantIdMissing() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:197:    logger.error("Signavio tenant ID is missing");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-198-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-199-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:200:  private String chooseSignavioTenantId(String tenantFromJwt, String tenantFromHeader) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:201:    return StringUtils.isNotEmpty(tenantFromJwt) ? tenantFromJwt : tenantFromHeader;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-202-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-203-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:204:  private String getUserIdFromJwtOrDefault(Claims claims) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:205:    return claims != null && StringUtils.isNotEmpty(claims.getId())
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-206-        ? claims.getId()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:207:        : BTP.toString();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-208-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-209-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:210:  private String convertJwksUriToIssuer(String jwksUri) throws URISyntaxException {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-211-    URI uri = new URI(jwksUri);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-212-    if (uri.getPort() == -1) { // URI may or may not contain port
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:213:      return String.format("%s://%s", uri.getScheme(), uri.getHost());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-214-    } else {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java:215:      return String.format("%s://%s:%s", uri.getScheme(), uri.getHost(), uri.getPort());
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-216-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/security/jwt/ias/IngestionIasJwtVerifier.java-217-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereAdditionalInfoDto.java-1-package com.sap.bpi.api.gw.dto.tenant.datasphere;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereAdditionalInfoDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereAdditionalInfoDto.java:3:public record DatasphereAdditionalInfoDto(String subject) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationDto.java-5-public record InsightsCentralTenantConfigurationDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationDto.java:6:    String name,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationDto.java:7:    String category,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationDto.java:8:    String type,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationDto.java-9-    List<InsightsCentralTenantConfigurationValueDto> value,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationDto.java:10:    String object) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/CertificateDto.java-1-package com.sap.bpi.api.gw.dto.tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/CertificateDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/CertificateDto.java:3:public record CertificateDto(String cert, String type) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/XsuaaCredentialDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/XsuaaCredentialDto.java-5-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/XsuaaCredentialDto.java:6:public record XsuaaCredentialDto(String clientId, String tokenEndpoint) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAdditionalInfoDto.java-1-package com.sap.bpi.api.gw.dto.tenant.pam;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAdditionalInfoDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAdditionalInfoDto.java:3:public record PamAdditionalInfoDto(PamAssignedTenantDto assignedTenant) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-6-public class WorkzoneTenantServiceResponse extends TenantServiceResponse {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:7:  private final List<WorkzoneMappingDto> mappings;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-8-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-9-  public WorkzoneTenantServiceResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:10:      String tenantId, String type, List<WorkzoneMappingDto> mappings) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-11-    super(tenantId, type);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-12-    this.mappings = mappings;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-17-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-18-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:19:  public String getClientId() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-20-    return mappings.isEmpty()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-21-        ? null
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-23-            .get(0)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-24-            .additionalInfo()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:25:            .receiverTenant()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-26-            .configuration()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-27-            .credentials()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-28-            .outboundCommunication()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:29:            .oauth2mtls()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-30-            .clientId();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-31-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:33:  public String getTokenServiceUrl() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-34-    return mappings.isEmpty()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-35-        ? null
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-37-            .get(0)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-38-            .additionalInfo()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:39:            .receiverTenant()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-40-            .configuration()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-41-            .credentials()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-42-            .outboundCommunication()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java:43:            .oauth2mtls()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-44-            .tokenServiceUrl();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneTenantServiceResponse.java-45-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneAdditionalInfoDto.java-1-package com.sap.bpi.api.gw.dto.tenant.workzone;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneAdditionalInfoDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneAdditionalInfoDto.java:3:public record WorkzoneAdditionalInfoDto(ReceiverTenantDto receiverTenant) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java-1-package com.sap.bpi.api.gw.dto.tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java:3:import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java:4:import com.sap.bpi.api.gw.adapters.AssignedTenantConfigurationDeserializer;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java:6:@JsonDeserialize(using = AssignedTenantConfigurationDeserializer.class)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java:7:public record AssignedTenantConfigurationDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantConfigurationDto.java:8:    String url, String certificateChain, String clientId) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneMappingDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneMappingDto.java-3-public record WorkzoneMappingDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/WorkzoneMappingDto.java:4:    String externalTenantId, WorkzoneAdditionalInfoDto additionalInfo) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationValueDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationValueDto.java-5-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralTenantConfigurationValueDto.java:6:public record InsightsCentralTenantConfigurationValueDto(String route) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/IasJwtData.java-3-import java.util.List;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/IasJwtData.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/IasJwtData.java:5:public record IasJwtData(List<TrustedClientDto> trustedClients) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamEndpointsDto.java-5-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamEndpointsDto.java-6-public record PamEndpointsDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamEndpointsDto.java:7:    String appsEndpoint, String contentEndpoint, String credentialRefreshEndpoint) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralConfigurationDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralConfigurationDto.java-3-public record InsightsCentralConfigurationDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/insights/InsightsCentralConfigurationDto.java:4:    String rel, String href, InsightsCentralTenantConfigurationDto rep) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TrustedClientDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TrustedClientDto.java-3-/*TrustedClientDto holds the information about a client configuration based on entityId (a globally unique identifier across PINT)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TrustedClientDto.java:4: *is used to determine the jwksUri to fetch the public key during IAS JWT validation.
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TrustedClientDto.java-5- *
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TrustedClientDto.java:6: * @see IasJwtVerifier#fetchPublicKey()
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TrustedClientDto.java-7- * */
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TrustedClientDto.java:8:public record TrustedClientDto(String jwksUri, String clientId, String entityId) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantMappingDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantMappingDto.java-3-public record DatasphereTenantMappingDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantMappingDto.java:4:    String externalTenantId, DatasphereAdditionalInfoDto additionalInfo) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java-1-package com.sap.bpi.api.gw.dto.tenant.pam;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java:3:public record PamAssignedTenantDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java:4:    String uclAssignmentId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java:5:    String subaccountId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java-6-    PamConfigurationDto configuration,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java:7:    String applicationUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamAssignedTenantDto.java:8:    String applicationNamespace) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/OutboundCommunicationDto.java-1-package com.sap.bpi.api.gw.dto.tenant.workzone;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/OutboundCommunicationDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/OutboundCommunicationDto.java:3:public record OutboundCommunicationDto(OAuth2MtlsDto oauth2mtls) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java-1-package com.sap.bpi.api.gw.dto.tenant;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java:3:public record AssignedTenantDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java:4:    String uclAssignmentId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java:5:    String subaccountId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java:6:    AssignedTenantConfigurationDto configuration,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java:7:    String applicationUrl,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/AssignedTenantDto.java:8:    String applicationNamespace) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamTenantMappingDto.java-1-package com.sap.bpi.api.gw.dto.tenant.pam;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamTenantMappingDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/PamTenantMappingDto.java:3:public record PamTenantMappingDto(String externalTenantId, PamAdditionalInfoDto additionalInfo) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-5-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-6-/*
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java:7:* example payload (IDs are randomly generated):
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-8- {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-9-  "tenantId": "d1911e1712354c73at9d4ebg558b6e6f",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java:10:  "type": "signavio_to_btp_sub_account_id_connectivity_platform_subscription",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-11-  "mappings": [
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-12-    {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-13-      "externalTenantId": "53ea35ed-4847-4e21-9223-4e6gb08f7ce9",
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-14-      "additionalInfo": {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java:15:        "subject": "CN=SIGNAVIO_USER,L=53ea35ed-4847-4e21-9223-4e6gb08f7ce9_TENANT,OU=6414r245-39c3-4ed4-b5d3-c49f5f5f479b,OU=Canary,OU=SAP Cloud Platform Clients,O=SAP SE,C=AU"
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-16-      }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-17-    }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-20-*/
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-21-public class DatasphereTenantServiceResponse extends TenantServiceResponse {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java:22:  private final List<DatasphereTenantMappingDto> mappings;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-23-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-24-  public DatasphereTenantServiceResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java:25:      String tenantId, String type, List<DatasphereTenantMappingDto> mappings) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-26-    super(tenantId, type);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/datasphere/DatasphereTenantServiceResponse.java-27-    this.mappings = mappings;
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/spm/SpmConfigurationDto.java-1-package com.sap.bpi.api.gw.dto.tenant.spm;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/spm/SpmConfigurationDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/spm/SpmConfigurationDto.java:3:public record SpmConfigurationDto(String rel, String href, SpmTenantConfigurationDto rep) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-6-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-7-public class TenantServicePamTypeResponse extends TenantServiceResponse {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:8:  private final List<PamTenantMappingDto> mappings;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-9-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-10-  public TenantServicePamTypeResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:11:      @JsonProperty("tenantId") String signavioTenantId,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:12:      @JsonProperty("type") String type,
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-13-      @JsonProperty("mappings") List<PamTenantMappingDto> mappings) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:14:    super(signavioTenantId, type);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-15-    this.mappings = mappings;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-16-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-27-    PamTenantMappingDto firstMapping = mappings.get(0);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-28-    if (firstMapping.additionalInfo() == null
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:29:        || firstMapping.additionalInfo().assignedTenant() == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:30:      throw new IllegalStateException("No assigned tenant found in tenant mapping");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-31-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-32-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-33-    PamConfigurationDto configuration =
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:34:        firstMapping.additionalInfo().assignedTenant().configuration();
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-35-    if (configuration == null) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java:36:      throw new IllegalStateException("No configuration found in assigned tenant");
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-37-    }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/pam/TenantServicePamTypeResponse.java-38-
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/OAuth2MtlsDto.java-1-package com.sap.bpi.api.gw.dto.tenant.workzone;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/OAuth2MtlsDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/OAuth2MtlsDto.java:3:public record OAuth2MtlsDto(String clientId, String tokenServiceUrl) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/ReceiverTenantDto.java-1-package com.sap.bpi.api.gw.dto.tenant.workzone;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/ReceiverTenantDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/workzone/ReceiverTenantDto.java:3:public record ReceiverTenantDto(WorkzoneConfigurationDto configuration) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/spm/SpmTenantConfigurationDto.java-2-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/spm/SpmTenantConfigurationDto.java-3-public record SpmTenantConfigurationDto(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/spm/SpmTenantConfigurationDto.java:4:    String name, String category, String type, String value, String object) {}
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-5-public class TenantServiceIasTypeResponse extends TenantServiceResponse {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java:6:  private final IasJwtData configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-7-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-8-  public TenantServiceIasTypeResponse(
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java:9:      String signavioTenantId, String type, IasJwtData configuration) {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java:10:    super(signavioTenantId, type);
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-11-    this.configuration = configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-12-  }
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-13-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java:14:  public IasJwtData getConfiguration() {
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-15-    return configuration;
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/TenantServiceIasTypeResponse.java-16-  }
--
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/IasCredentialDto.java-4-
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/IasCredentialDto.java-5-@JsonIgnoreProperties(ignoreUnknown = true)
./bpi-api-gw/src/main/java/com/sap/bpi/api/gw/dto/tenant/ias/IasCredentialDto.java:6:public record IasCredentialDto(String clientId, String tenantUrl) {}
