./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:1:package com.signavio.jwt;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-2-
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:3:import com.auth0.jwt.algorithms.Algorithm;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-4-import org.slf4j.Logger;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-5-import org.slf4j.LoggerFactory;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-6-
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:7:import static com.auth0.jwt.algorithms.Algorithm.HMAC256;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-8-
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-9-
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-10-/**
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:11: * Singleton. Chosen algorithm and secret should never change!
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:12: * Don't let the JWT itself dictate the algorithm! Security risk!
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-13- */
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:14:class SymmetricEncryptionService {
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-15-	
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:16:	private static final Logger LOGGER = LoggerFactory.getLogger(SymmetricEncryptionService.class);
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:17:	private static final int KEY_LENGTH = 64;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-18-	
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:19:	private final ConfigurationProvider configurationProvider;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-20-	
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-21-	
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:22:	SymmetricEncryptionService(ConfigurationProvider configurationProvider) {
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-23-		this.configurationProvider = configurationProvider;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-24-	}
--
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-26-	
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-27-	Algorithm getAlgorithm() {
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:28:		return HMAC256(validateAndGetSecret());
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-29-	}
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-30-	
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-31-	
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-32-	/**
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:33:	 * @return the secret key shared between the signavio systems.
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-34-	 *
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:35:	 * @see ConfigurationProvider#getSecret()
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-36-	 */
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:37:	String validateAndGetSecret() {
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:38:		String secret = configurationProvider.getSecret();
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-39-		
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:40:		if (secret == null || secret.trim().isEmpty()) {
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:41:			LOGGER.error("The ConfigurationProvider returned a missing or empty secret!");
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:42:		} else if (secret.getBytes().length != KEY_LENGTH) {
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:43:			LOGGER.warn("The secret does not have recommended length of 64 bytes! The length is: {} bytes.",
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:44:					secret.getBytes().length);
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-45-		}
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-46-		
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java:47:		return secret;
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-48-	}
./src/main/java/com/signavio/jwt/SymmetricEncryptionService.java-49-}
--
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java:1:package com.signavio.jwt.exception;
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java-2-
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java-3-/**
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java:4: * Custom exception for JWT related errors.
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java-5- */
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java:6:public class JwtServiceException extends RuntimeException {
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java-7-	
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java:8:	public JwtServiceException(String message, Throwable cause) {
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java-9-		super(message, cause);
./src/main/java/com/signavio/jwt/exception/JwtServiceException.java-10-	}
--
./src/main/java/com/signavio/jwt/exception/JwtCreationException.java:1:package com.signavio.jwt.exception;
./src/main/java/com/signavio/jwt/exception/JwtCreationException.java-2-
./src/main/java/com/signavio/jwt/exception/JwtCreationException.java:3:public class JwtCreationException extends JwtServiceException {
./src/main/java/com/signavio/jwt/exception/JwtCreationException.java-4-	
./src/main/java/com/signavio/jwt/exception/JwtCreationException.java:5:	public JwtCreationException(String message, Throwable cause) {
./src/main/java/com/signavio/jwt/exception/JwtCreationException.java-6-		super(message, cause);
./src/main/java/com/signavio/jwt/exception/JwtCreationException.java-7-	}
--
./src/main/java/com/signavio/jwt/exception/JwtVerificationException.java:1:package com.signavio.jwt.exception;
./src/main/java/com/signavio/jwt/exception/JwtVerificationException.java-2-
./src/main/java/com/signavio/jwt/exception/JwtVerificationException.java:3:public class JwtVerificationException extends JwtServiceException {
./src/main/java/com/signavio/jwt/exception/JwtVerificationException.java-4-	
./src/main/java/com/signavio/jwt/exception/JwtVerificationException.java:5:	public JwtVerificationException(String message, Throwable cause) {
./src/main/java/com/signavio/jwt/exception/JwtVerificationException.java-6-		super(message, cause);
./src/main/java/com/signavio/jwt/exception/JwtVerificationException.java-7-	}
--
./src/main/java/com/signavio/jwt/exception/InvalidClaimException.java:1:package com.signavio.jwt.exception;
./src/main/java/com/signavio/jwt/exception/InvalidClaimException.java-2-
./src/main/java/com/signavio/jwt/exception/InvalidClaimException.java:3:public class InvalidClaimException extends JwtServiceException {
./src/main/java/com/signavio/jwt/exception/InvalidClaimException.java-4-	
./src/main/java/com/signavio/jwt/exception/InvalidClaimException.java:5:	public InvalidClaimException(String message, Throwable cause) {
./src/main/java/com/signavio/jwt/exception/InvalidClaimException.java-6-		super(message, cause);
./src/main/java/com/signavio/jwt/exception/InvalidClaimException.java-7-	}
--
./sonar-project.properties-1-sonar.host.url=https://sonar.tools.sap
./sonar-project.properties-2-
./sonar-project.properties:3:sonar.projectKey=com.sap.signavio.authentication
./sonar-project.properties:4:sonar.projectName=com.sap.signavio.authentication
./sonar-project.properties-5-
./sonar-project.properties-6-sonar.inclusions=src/main/java/**
--
./src/main/java/com/signavio/jwt/SignavioClaims.java:1:package com.signavio.jwt;
./src/main/java/com/signavio/jwt/SignavioClaims.java-2-
./src/main/java/com/signavio/jwt/SignavioClaims.java-3-/**
./src/main/java/com/signavio/jwt/SignavioClaims.java:4: * contains all the key names for claims inside of the JWT.
./src/main/java/com/signavio/jwt/SignavioClaims.java:5: * They are shorten to three letters to reduce the size of generated JWT.
./src/main/java/com/signavio/jwt/SignavioClaims.java-6- */
./src/main/java/com/signavio/jwt/SignavioClaims.java-7-@SuppressWarnings("WeakerAccess") // public api
./src/main/java/com/signavio/jwt/SignavioClaims.java:8:public final class SignavioClaims {
./src/main/java/com/signavio/jwt/SignavioClaims.java-9-	
./src/main/java/com/signavio/jwt/SignavioClaims.java:10:	public static final String TENANT_ID = "ten";
./src/main/java/com/signavio/jwt/SignavioClaims.java:11:	public static final String IS_GUEST_USER = "gue";
./src/main/java/com/signavio/jwt/SignavioClaims.java:12:	public static final String IS_ANONYMOUS_USER = "ano";
./src/main/java/com/signavio/jwt/SignavioClaims.java:13:	public static final String IS_ADMIN_USER = "adm";
./src/main/java/com/signavio/jwt/SignavioClaims.java:14:	public static final String EXTERNAL_USER_ID = "eui";
./src/main/java/com/signavio/jwt/SignavioClaims.java:15:	public static final String USER_ID = "uid";
./src/main/java/com/signavio/jwt/SignavioClaims.java:16:	public static final String USER_GROUP_IDS = "ugr";
./src/main/java/com/signavio/jwt/SignavioClaims.java:17:	public static final String REQUEST_ID = "rid";
./src/main/java/com/signavio/jwt/SignavioClaims.java:18:	public static final String EXTERNAL_USER_GROUP_IDS = "egi";
./src/main/java/com/signavio/jwt/SignavioClaims.java:19:	public static final String OAUTH_CLAIMS = "ocl";
./src/main/java/com/signavio/jwt/SignavioClaims.java:20:	public static final String OAUTH_SCOPES = "osc";
./src/main/java/com/signavio/jwt/SignavioClaims.java:21:	public static final String FEATURES = "fts";
./src/main/java/com/signavio/jwt/SignavioClaims.java:22:	public static final String IS_INTERNAL = "int";
./src/main/java/com/signavio/jwt/SignavioClaims.java:23:	public static final String IS_REVISION_MODE_PUBLISHED = "rmp";
./src/main/java/com/signavio/jwt/SignavioClaims.java-24-	
./src/main/java/com/signavio/jwt/SignavioClaims.java:25:	private SignavioClaims() {
./src/main/java/com/signavio/jwt/SignavioClaims.java-26-	
./src/main/java/com/signavio/jwt/SignavioClaims.java-27-	}
--
./owaspDependencyCheckSuppressions.xml-17-        <suppress>
./owaspDependencyCheckSuppressions.xml-18-            <notes><![CDATA[
./owaspDependencyCheckSuppressions.xml:19:                False positive: database's vulnerabilities listed as database connector's.
./owaspDependencyCheckSuppressions.xml-20-
./owaspDependencyCheckSuppressions.xml-21-                File name: mysql-connector-java-5.1.21.jar
--
./owaspDependencyCheckSuppressions.xml-29-    -->
./owaspDependencyCheckSuppressions.xml-30-    <suppress>
./owaspDependencyCheckSuppressions.xml:31:        <notes><![CDATA[False positive as per https://github.com/FasterXML/jackson-databind/issues/3972]]></notes>
./owaspDependencyCheckSuppressions.xml-32-        <cve>CVE-2023-35116</cve>
./owaspDependencyCheckSuppressions.xml-33-    </suppress>
--
./gradlew-10-# Resolve links: $0 may be a link
./gradlew-11-PRG="$0"
./gradlew:12:# Need this for relative symlinks.
./gradlew-13-while [ -h "$PRG" ] ; do
./gradlew-14-    ls=`ls -ld "$PRG"`
--
./gradlew-89-fi
./gradlew-90-
./gradlew:91:# Increase the maximum file descriptors if we can.
./gradlew-92-if [ "$cygwin" = "false" -a "$darwin" = "false" -a "$nonstop" = "false" ] ; then
./gradlew-93-    MAX_FD_LIMIT=`ulimit -H -n`
--
./gradlew-98-        ulimit -n $MAX_FD
./gradlew-99-        if [ $? -ne 0 ] ; then
./gradlew:100:            warn "Could not set maximum file descriptor limit: $MAX_FD"
./gradlew-101-        fi
./gradlew-102-    else
./gradlew:103:        warn "Could not query maximum file descriptor limit: $MAX_FD_LIMIT"
./gradlew-104-    fi
./gradlew-105-fi
--
./gradlew-165-eval set -- $DEFAULT_JVM_OPTS $JAVA_OPTS $GRADLE_OPTS "\"-Dorg.gradle.appname=$APP_BASE_NAME\"" -classpath "\"$CLASSPATH\"" org.gradle.wrapper.GradleWrapperMain "$APP_ARGS"
./gradlew-166-
./gradlew:167:# by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
./gradlew-168-if [ "$(uname)" = "Darwin" ] && [ "$HOME" = "$PWD" ]; then
./gradlew-169-  cd "$(dirname "$0")"
--
./src/main/java/com/signavio/jwt/exception/TokenExpiredException.java:1:package com.signavio.jwt.exception;
./src/main/java/com/signavio/jwt/exception/TokenExpiredException.java-2-
./src/main/java/com/signavio/jwt/exception/TokenExpiredException.java:3:public class TokenExpiredException extends JwtServiceException {
./src/main/java/com/signavio/jwt/exception/TokenExpiredException.java-4-	
./src/main/java/com/signavio/jwt/exception/TokenExpiredException.java:5:	public TokenExpiredException(String message, Throwable cause) {
./src/main/java/com/signavio/jwt/exception/TokenExpiredException.java-6-		super(message, cause);
./src/main/java/com/signavio/jwt/exception/TokenExpiredException.java-7-	}
--
./build.gradle-7-}
./build.gradle-8-
./build.gradle:9:group = 'com.signavio'
./build.gradle-10-
./build.gradle-11-repositories {
--
./build.gradle-49-
./build.gradle-50-    implementation 'org.slf4j:slf4j-api:2.0.17'
./build.gradle:51:    implementation 'com.auth0:java-jwt:4.5.0'
./build.gradle-52-    implementation 'com.fasterxml.jackson.core:jackson-core:2.20.1'
./build.gradle-53-    implementation 'com.fasterxml.jackson.core:jackson-databind:2.20.1'
--
./build.gradle-72-
./build.gradle-73-tasks.register('sourceJar', Jar) {
./build.gradle:74:    archiveClassifier = 'sources'
./build.gradle-75-    from sourceSets.main.allJava
./build.gradle-76-}
--
./build.gradle-78-
./build.gradle-79-tasks.register('javadocJar', Jar) {
./build.gradle:80:    archiveClassifier = 'javadoc'
./build.gradle-81-    from javadoc
./build.gradle-82-}
--
./build.gradle-86-test {
./build.gradle-87-    useTestNG()
./build.gradle:88:    afterSuite { desc, result ->
./build.gradle:89:        if (!desc.parent)
./build.gradle-90-            println("${result.resultType} " +
./build.gradle-91-                    "(${result.testCount} tests, " +
--
./build.gradle-94-                    "${result.skippedTestCount} skipped)")
./build.gradle-95-    }
./build.gradle:96:    finalizedBy jacocoTestReport // report is always generated after tests run
./build.gradle-97-
./build.gradle-98-}
--
./build.gradle-115-
./build.gradle-116-    analyzers {
./build.gradle:117:        archiveEnabled = true
./build.gradle-118-    }
./build.gradle-119-
--
./src/main/java/com/signavio/jwt/Jwt.java:1:package com.signavio.jwt;
./src/main/java/com/signavio/jwt/Jwt.java-2-
./src/main/java/com/signavio/jwt/Jwt.java-3-import java.util.Collection;
./src/main/java/com/signavio/jwt/Jwt.java:4:import java.util.HashMap;
./src/main/java/com/signavio/jwt/Jwt.java:5:import java.util.HashSet;
./src/main/java/com/signavio/jwt/Jwt.java-6-import java.util.Map;
./src/main/java/com/signavio/jwt/Jwt.java-7-import java.util.Optional;
--
./src/main/java/com/signavio/jwt/Jwt.java-11-
./src/main/java/com/signavio/jwt/Jwt.java-12-/**
./src/main/java/com/signavio/jwt/Jwt.java:13: * Our internal jwt data representation. Users of this project should implement Token themselves.
./src/main/java/com/signavio/jwt/Jwt.java-14- */
./src/main/java/com/signavio/jwt/Jwt.java:15:class Jwt implements Token {
./src/main/java/com/signavio/jwt/Jwt.java-16-	
./src/main/java/com/signavio/jwt/Jwt.java:17:	private final String tenantId;
./src/main/java/com/signavio/jwt/Jwt.java:18:	private final String subject;
./src/main/java/com/signavio/jwt/Jwt.java:19:	private final boolean isGuestUser;
./src/main/java/com/signavio/jwt/Jwt.java:20:	private final boolean isAnonymousUser;
./src/main/java/com/signavio/jwt/Jwt.java-21-	
./src/main/java/com/signavio/jwt/Jwt.java:22:	private String externalUserId;
./src/main/java/com/signavio/jwt/Jwt.java:23:	private Boolean isAdminUser;
./src/main/java/com/signavio/jwt/Jwt.java:24:	private String userId;
./src/main/java/com/signavio/jwt/Jwt.java:25:	private Set<String> userGroupIds = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java:26:	private Set<String> externalUserGroupIds = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java:27:	private String requestId;
./src/main/java/com/signavio/jwt/Jwt.java:28:	private Set<String> oauthScopes = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java:29:	private Map<String, String> oauthClaims = new HashMap<>();
./src/main/java/com/signavio/jwt/Jwt.java:30:	private Set<String> features = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java:31:	private Boolean isInternal = null;
./src/main/java/com/signavio/jwt/Jwt.java:32:	private boolean isRevisionModePublished = false;
./src/main/java/com/signavio/jwt/Jwt.java-33-	
./src/main/java/com/signavio/jwt/Jwt.java:34:	Jwt(String tenantId, String subject, boolean isGuestUser, boolean isAnonymousUser) {
./src/main/java/com/signavio/jwt/Jwt.java-35-		this.tenantId = requireNonNull(tenantId);
./src/main/java/com/signavio/jwt/Jwt.java-36-		this.subject = requireNonNull(subject);
--
./src/main/java/com/signavio/jwt/Jwt.java-42-	
./src/main/java/com/signavio/jwt/Jwt.java-43-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:44:	public String getSubject() {
./src/main/java/com/signavio/jwt/Jwt.java-45-		return subject;
./src/main/java/com/signavio/jwt/Jwt.java-46-	}
--
./src/main/java/com/signavio/jwt/Jwt.java-48-	
./src/main/java/com/signavio/jwt/Jwt.java-49-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:50:	public String getTenantId() {
./src/main/java/com/signavio/jwt/Jwt.java-51-		return tenantId;
./src/main/java/com/signavio/jwt/Jwt.java-52-	}
--
./src/main/java/com/signavio/jwt/Jwt.java-66-	
./src/main/java/com/signavio/jwt/Jwt.java-67-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:68:	public Optional<String> getExternalUserId() {
./src/main/java/com/signavio/jwt/Jwt.java-69-		return Optional.ofNullable(externalUserId);
./src/main/java/com/signavio/jwt/Jwt.java-70-	}
./src/main/java/com/signavio/jwt/Jwt.java-71-	
./src/main/java/com/signavio/jwt/Jwt.java-72-	
./src/main/java/com/signavio/jwt/Jwt.java:73:	public void setExternalUserId(String externalUserId) {
./src/main/java/com/signavio/jwt/Jwt.java-74-		this.externalUserId = externalUserId;
./src/main/java/com/signavio/jwt/Jwt.java-75-	}
--
./src/main/java/com/signavio/jwt/Jwt.java-77-	
./src/main/java/com/signavio/jwt/Jwt.java-78-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:79:	public Set<String> getExternalUserGroupIds() {
./src/main/java/com/signavio/jwt/Jwt.java-80-		return externalUserGroupIds;
./src/main/java/com/signavio/jwt/Jwt.java-81-	}
./src/main/java/com/signavio/jwt/Jwt.java-82-	
./src/main/java/com/signavio/jwt/Jwt.java-83-	
./src/main/java/com/signavio/jwt/Jwt.java:84:	public void setExternalUserGroupIds(Collection<String> externalUserGroupIds) {
./src/main/java/com/signavio/jwt/Jwt.java:85:		this.externalUserGroupIds = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java-86-		if (externalUserGroupIds != null) {
./src/main/java/com/signavio/jwt/Jwt.java-87-			this.externalUserGroupIds.addAll(externalUserGroupIds);
--
./src/main/java/com/signavio/jwt/Jwt.java-91-	
./src/main/java/com/signavio/jwt/Jwt.java-92-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:93:	public Optional<String> getUserId() {
./src/main/java/com/signavio/jwt/Jwt.java-94-		return Optional.ofNullable(userId);
./src/main/java/com/signavio/jwt/Jwt.java-95-	}
./src/main/java/com/signavio/jwt/Jwt.java-96-	
./src/main/java/com/signavio/jwt/Jwt.java-97-	
./src/main/java/com/signavio/jwt/Jwt.java:98:	public void setUserId(String userId) {
./src/main/java/com/signavio/jwt/Jwt.java-99-		this.userId = userId;
./src/main/java/com/signavio/jwt/Jwt.java-100-	}
--
./src/main/java/com/signavio/jwt/Jwt.java-102-	
./src/main/java/com/signavio/jwt/Jwt.java-103-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:104:	public Set<String> getUserGroupIds() {
./src/main/java/com/signavio/jwt/Jwt.java-105-		return userGroupIds;
./src/main/java/com/signavio/jwt/Jwt.java-106-	}
./src/main/java/com/signavio/jwt/Jwt.java-107-	
./src/main/java/com/signavio/jwt/Jwt.java-108-	
./src/main/java/com/signavio/jwt/Jwt.java:109:	public void setUserGroupIds(Collection<String> userGroupIds) {
./src/main/java/com/signavio/jwt/Jwt.java:110:		this.userGroupIds = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java-111-		if (userGroupIds != null) {
./src/main/java/com/signavio/jwt/Jwt.java-112-			this.userGroupIds.addAll(userGroupIds);
--
./src/main/java/com/signavio/jwt/Jwt.java-116-	
./src/main/java/com/signavio/jwt/Jwt.java-117-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:118:	public Optional<String> getRequestId() {
./src/main/java/com/signavio/jwt/Jwt.java-119-		return Optional.ofNullable(requestId);
./src/main/java/com/signavio/jwt/Jwt.java-120-	}
./src/main/java/com/signavio/jwt/Jwt.java-121-	
./src/main/java/com/signavio/jwt/Jwt.java-122-	
./src/main/java/com/signavio/jwt/Jwt.java:123:	public void setRequestId(String requestId) {
./src/main/java/com/signavio/jwt/Jwt.java-124-		this.requestId = requestId;
./src/main/java/com/signavio/jwt/Jwt.java-125-	}
--
./src/main/java/com/signavio/jwt/Jwt.java-127-	
./src/main/java/com/signavio/jwt/Jwt.java-128-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:129:	public Set<String> getOauthScopes() {
./src/main/java/com/signavio/jwt/Jwt.java-130-		return oauthScopes;
./src/main/java/com/signavio/jwt/Jwt.java-131-	}
./src/main/java/com/signavio/jwt/Jwt.java-132-	
./src/main/java/com/signavio/jwt/Jwt.java-133-	
./src/main/java/com/signavio/jwt/Jwt.java:134:	public void setOauthScopes(Collection<String> oauthScopes) {
./src/main/java/com/signavio/jwt/Jwt.java:135:		this.oauthScopes = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java-136-		if (oauthScopes != null) {
./src/main/java/com/signavio/jwt/Jwt.java-137-			this.oauthScopes.addAll(oauthScopes);
--
./src/main/java/com/signavio/jwt/Jwt.java-141-	
./src/main/java/com/signavio/jwt/Jwt.java-142-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:143:	public Map<String, String> getOauthClaims() {
./src/main/java/com/signavio/jwt/Jwt.java-144-		return oauthClaims;
./src/main/java/com/signavio/jwt/Jwt.java-145-	}
./src/main/java/com/signavio/jwt/Jwt.java-146-	
./src/main/java/com/signavio/jwt/Jwt.java-147-	
./src/main/java/com/signavio/jwt/Jwt.java:148:	public void setOauthClaims(Map<String, String> oauthClaims) {
./src/main/java/com/signavio/jwt/Jwt.java:149:		this.oauthClaims = new HashMap<>();
./src/main/java/com/signavio/jwt/Jwt.java-150-		if (oauthClaims != null) {
./src/main/java/com/signavio/jwt/Jwt.java-151-			this.oauthClaims.putAll(oauthClaims);
--
./src/main/java/com/signavio/jwt/Jwt.java-166-	
./src/main/java/com/signavio/jwt/Jwt.java-167-	@Override
./src/main/java/com/signavio/jwt/Jwt.java:168:	public Set<String> getFeatures() {
./src/main/java/com/signavio/jwt/Jwt.java-169-		return this.features;
./src/main/java/com/signavio/jwt/Jwt.java-170-	}
./src/main/java/com/signavio/jwt/Jwt.java-171-	
./src/main/java/com/signavio/jwt/Jwt.java-172-	
./src/main/java/com/signavio/jwt/Jwt.java:173:	public void setFeatures(Collection<String> features) {
./src/main/java/com/signavio/jwt/Jwt.java:174:		this.features = new HashSet<>();
./src/main/java/com/signavio/jwt/Jwt.java-175-		if (features != null) {
./src/main/java/com/signavio/jwt/Jwt.java-176-			this.features.addAll(features);
--
./src/main/java/com/signavio/jwt/JwtService.java:1:package com.signavio.jwt;
./src/main/java/com/signavio/jwt/JwtService.java-2-
./src/main/java/com/signavio/jwt/JwtService.java-3-import java.io.IOException;
--
./src/main/java/com/signavio/jwt/JwtService.java-6-import java.util.Collection;
./src/main/java/com/signavio/jwt/JwtService.java-7-import java.util.Date;
./src/main/java/com/signavio/jwt/JwtService.java:8:import java.util.HashMap;
./src/main/java/com/signavio/jwt/JwtService.java-9-import java.util.Map;
./src/main/java/com/signavio/jwt/JwtService.java-10-import java.util.Optional;
--
./src/main/java/com/signavio/jwt/JwtService.java-12-import java.util.stream.Stream;
./src/main/java/com/signavio/jwt/JwtService.java-13-
./src/main/java/com/signavio/jwt/JwtService.java:14:import com.auth0.jwt.exceptions.JWTCreationException;
./src/main/java/com/signavio/jwt/JwtService.java:15:import com.signavio.jwt.exception.AlgorithmMismatchException;
./src/main/java/com/signavio/jwt/JwtService.java:16:import com.signavio.jwt.exception.JwtCreationException;
./src/main/java/com/signavio/jwt/JwtService.java:17:import com.signavio.jwt.exception.JwtVerificationException;
./src/main/java/com/signavio/jwt/JwtService.java:18:import com.signavio.jwt.exception.TokenExpiredException;
./src/main/java/com/signavio/jwt/JwtService.java:19:import com.signavio.jwt.exception.InvalidClaimException;
./src/main/java/com/signavio/jwt/JwtService.java-20-import jakarta.inject.Inject;
./src/main/java/com/signavio/jwt/JwtService.java-21-
./src/main/java/com/signavio/jwt/JwtService.java:22:import com.auth0.jwt.JWT;
./src/main/java/com/signavio/jwt/JwtService.java:23:import com.auth0.jwt.JWTVerifier;
./src/main/java/com/signavio/jwt/JwtService.java:24:import com.auth0.jwt.algorithms.Algorithm;
./src/main/java/com/signavio/jwt/JwtService.java:25:import com.auth0.jwt.exceptions.JWTVerificationException;
./src/main/java/com/signavio/jwt/JwtService.java:26:import com.auth0.jwt.interfaces.DecodedJWT;
./src/main/java/com/signavio/jwt/JwtService.java-27-import com.fasterxml.jackson.core.JsonProcessingException;
./src/main/java/com/signavio/jwt/JwtService.java-28-import com.fasterxml.jackson.core.type.TypeReference;
--
./src/main/java/com/signavio/jwt/JwtService.java-31-import org.slf4j.LoggerFactory;
./src/main/java/com/signavio/jwt/JwtService.java-32-
./src/main/java/com/signavio/jwt/JwtService.java:33:import static com.auth0.jwt.RegisteredClaims.SUBJECT;
./src/main/java/com/signavio/jwt/JwtService.java:34:import static com.signavio.jwt.SignavioClaims.EXTERNAL_USER_GROUP_IDS;
./src/main/java/com/signavio/jwt/JwtService.java:35:import static com.signavio.jwt.SignavioClaims.EXTERNAL_USER_ID;
./src/main/java/com/signavio/jwt/JwtService.java:36:import static com.signavio.jwt.SignavioClaims.FEATURES;
./src/main/java/com/signavio/jwt/JwtService.java:37:import static com.signavio.jwt.SignavioClaims.IS_INTERNAL;
./src/main/java/com/signavio/jwt/JwtService.java:38:import static com.signavio.jwt.SignavioClaims.IS_ADMIN_USER;
./src/main/java/com/signavio/jwt/JwtService.java:39:import static com.signavio.jwt.SignavioClaims.IS_ANONYMOUS_USER;
./src/main/java/com/signavio/jwt/JwtService.java:40:import static com.signavio.jwt.SignavioClaims.IS_GUEST_USER;
./src/main/java/com/signavio/jwt/JwtService.java:41:import static com.signavio.jwt.SignavioClaims.IS_REVISION_MODE_PUBLISHED;
./src/main/java/com/signavio/jwt/JwtService.java:42:import static com.signavio.jwt.SignavioClaims.OAUTH_CLAIMS;
./src/main/java/com/signavio/jwt/JwtService.java:43:import static com.signavio.jwt.SignavioClaims.OAUTH_SCOPES;
./src/main/java/com/signavio/jwt/JwtService.java:44:import static com.signavio.jwt.SignavioClaims.REQUEST_ID;
./src/main/java/com/signavio/jwt/JwtService.java:45:import static com.signavio.jwt.SignavioClaims.TENANT_ID;
./src/main/java/com/signavio/jwt/JwtService.java:46:import static com.signavio.jwt.SignavioClaims.USER_GROUP_IDS;
./src/main/java/com/signavio/jwt/JwtService.java:47:import static com.signavio.jwt.SignavioClaims.USER_ID;
./src/main/java/com/signavio/jwt/JwtService.java-48-import static java.util.Calendar.MINUTE;
./src/main/java/com/signavio/jwt/JwtService.java-49-import static java.util.Objects.requireNonNull;
--
./src/main/java/com/signavio/jwt/JwtService.java-51-
./src/main/java/com/signavio/jwt/JwtService.java-52-/**
./src/main/java/com/signavio/jwt/JwtService.java:53: * Service for creating and parsing JWT (JSON Web Token).
./src/main/java/com/signavio/jwt/JwtService.java-54- */
./src/main/java/com/signavio/jwt/JwtService.java-55-@SuppressWarnings("unused") // public api
./src/main/java/com/signavio/jwt/JwtService.java:56:public class JwtService {
./src/main/java/com/signavio/jwt/JwtService.java-57-	
./src/main/java/com/signavio/jwt/JwtService.java:58:	private static final Logger LOGGER = LoggerFactory.getLogger(JwtService.class);
./src/main/java/com/signavio/jwt/JwtService.java:59:	private static final int MAX_HEADER_SIZE = 7 * 1024; // 7kb
./src/main/java/com/signavio/jwt/JwtService.java:60:	private static final int DEFAULT_JWT_VALIDITY_TIME_IN_MINUTES = 10;
./src/main/java/com/signavio/jwt/JwtService.java:61:	private static final long DEFAULT_JWT_VERIFICATION_TIMESTAMP_TOLERANCE_IN_SECONDS = 0L;
./src/main/java/com/signavio/jwt/JwtService.java-62-	
./src/main/java/com/signavio/jwt/JwtService.java:63:	private static final String ISSUER_SIGNAVIO = "signavio";
./src/main/java/com/signavio/jwt/JwtService.java:64:	private static final String BEARER = "Bearer";
./src/main/java/com/signavio/jwt/JwtService.java-65-	
./src/main/java/com/signavio/jwt/JwtService.java:66:	private final Algorithm algorithm;
./src/main/java/com/signavio/jwt/JwtService.java-67-	/**
./src/main/java/com/signavio/jwt/JwtService.java:68:	 * Defines the time in minutes a JWT is valid.
./src/main/java/com/signavio/jwt/JwtService.java-69-	 * Must be greater then Zero.
./src/main/java/com/signavio/jwt/JwtService.java-70-	 */
./src/main/java/com/signavio/jwt/JwtService.java:71:	private int jwtValidityTimeInMinutes = DEFAULT_JWT_VALIDITY_TIME_IN_MINUTES;
./src/main/java/com/signavio/jwt/JwtService.java-72-	/**
./src/main/java/com/signavio/jwt/JwtService.java:73:	 * Defines a time tolerance in seconds when verifying the issued_at, not_before or expires_at claims of a JWT.
./src/main/java/com/signavio/jwt/JwtService.java:74:	 * A value greater than Zero adds the respective tolerance and lowers issues with time synchronisation.
./src/main/java/com/signavio/jwt/JwtService.java-75-	 * <p>
./src/main/java/com/signavio/jwt/JwtService.java-76-	 * Must be greater or equal to Zero.
./src/main/java/com/signavio/jwt/JwtService.java-77-	 */
./src/main/java/com/signavio/jwt/JwtService.java:78:	private long jwtVerificationTimestampToleranceInSeconds = DEFAULT_JWT_VERIFICATION_TIMESTAMP_TOLERANCE_IN_SECONDS;
./src/main/java/com/signavio/jwt/JwtService.java-79-	
./src/main/java/com/signavio/jwt/JwtService.java-80-	@Inject
./src/main/java/com/signavio/jwt/JwtService.java:81:	public JwtService(ConfigurationProvider configurationProvider) {
./src/main/java/com/signavio/jwt/JwtService.java:82:		algorithm = getSymmetricEncryptionService(configurationProvider).getAlgorithm();
./src/main/java/com/signavio/jwt/JwtService.java-83-		applyConfiguration(configurationProvider);
./src/main/java/com/signavio/jwt/JwtService.java-84-	}
./src/main/java/com/signavio/jwt/JwtService.java-85-	
./src/main/java/com/signavio/jwt/JwtService.java:86:	private void applyConfiguration(ConfigurationProvider configurationProvider) {
./src/main/java/com/signavio/jwt/JwtService.java:87:		configurationProvider.getJwtValidityTime()
./src/main/java/com/signavio/jwt/JwtService.java-88-				.ifPresent(validityTime -> {
./src/main/java/com/signavio/jwt/JwtService.java-89-					if (validityTime > 0) {
./src/main/java/com/signavio/jwt/JwtService.java:90:						this.jwtValidityTimeInMinutes = validityTime;
./src/main/java/com/signavio/jwt/JwtService.java-91-					} else {
./src/main/java/com/signavio/jwt/JwtService.java:92:						LOGGER.error("Jwt validity time must be greater than 0 minutes");
./src/main/java/com/signavio/jwt/JwtService.java-93-					}
./src/main/java/com/signavio/jwt/JwtService.java-94-				});
./src/main/java/com/signavio/jwt/JwtService.java:95:		configurationProvider.getJwtVerificationTimestampTolerance()
./src/main/java/com/signavio/jwt/JwtService.java-96-				.ifPresent(tolerance -> {
./src/main/java/com/signavio/jwt/JwtService.java-97-					if (tolerance >= 0L) {
./src/main/java/com/signavio/jwt/JwtService.java:98:						this.jwtVerificationTimestampToleranceInSeconds = tolerance;
./src/main/java/com/signavio/jwt/JwtService.java-99-					} else {
./src/main/java/com/signavio/jwt/JwtService.java:100:						LOGGER.error("Jwt verification timestamp tolerance must be greater or equal to 0 seconds");
./src/main/java/com/signavio/jwt/JwtService.java-101-					}
./src/main/java/com/signavio/jwt/JwtService.java-102-				});
--
./src/main/java/com/signavio/jwt/JwtService.java-105-	
./src/main/java/com/signavio/jwt/JwtService.java-106-	/**
./src/main/java/com/signavio/jwt/JwtService.java:107:	 * Returns the JWT validity time in minutes.
./src/main/java/com/signavio/jwt/JwtService.java-108-	 * The value will be greater than zero.
./src/main/java/com/signavio/jwt/JwtService.java-109-	 *
./src/main/java/com/signavio/jwt/JwtService.java:110:	 * @return JWT validity time in minutes
./src/main/java/com/signavio/jwt/JwtService.java-111-	 */
./src/main/java/com/signavio/jwt/JwtService.java:112:	public int getJwtValidityTime() {
./src/main/java/com/signavio/jwt/JwtService.java:113:		return jwtValidityTimeInMinutes;
./src/main/java/com/signavio/jwt/JwtService.java-114-	}
./src/main/java/com/signavio/jwt/JwtService.java-115-	
./src/main/java/com/signavio/jwt/JwtService.java-116-	/**
./src/main/java/com/signavio/jwt/JwtService.java:117:	 * Returns the tolerance in seconds used when verifying the issued_at, not_before or expires_at claims.
./src/main/java/com/signavio/jwt/JwtService.java-118-	 * The value will be greater or equal to Zero.
./src/main/java/com/signavio/jwt/JwtService.java-119-	 *
./src/main/java/com/signavio/jwt/JwtService.java:120:	 * @return JWT timestamp verification tolerance in seconds
./src/main/java/com/signavio/jwt/JwtService.java-121-	 */
./src/main/java/com/signavio/jwt/JwtService.java:122:	public long getJwtVerificationTimestampTolerance() {
./src/main/java/com/signavio/jwt/JwtService.java:123:		return jwtVerificationTimestampToleranceInSeconds;
./src/main/java/com/signavio/jwt/JwtService.java-124-	}
./src/main/java/com/signavio/jwt/JwtService.java-125-	
./src/main/java/com/signavio/jwt/JwtService.java-126-	
./src/main/java/com/signavio/jwt/JwtService.java:127:	SymmetricEncryptionService getSymmetricEncryptionService(ConfigurationProvider configurationProvider) {
./src/main/java/com/signavio/jwt/JwtService.java:128:		return new SymmetricEncryptionService(configurationProvider);
./src/main/java/com/signavio/jwt/JwtService.java-129-	}
./src/main/java/com/signavio/jwt/JwtService.java-130-	
./src/main/java/com/signavio/jwt/JwtService.java-131-	
./src/main/java/com/signavio/jwt/JwtService.java-132-	/**
./src/main/java/com/signavio/jwt/JwtService.java:133:	 * Generates a Jwt from a HTTP header value.
./src/main/java/com/signavio/jwt/JwtService.java-134-	 *
./src/main/java/com/signavio/jwt/JwtService.java-135-	 * @param headerValue raw header value including Bearer
./src/main/java/com/signavio/jwt/JwtService.java-136-	 * @return The Token parsed from the header if the input has the correct format and the token ist still valid,
./src/main/java/com/signavio/jwt/JwtService.java:137:	 *  empty Optional if the input String does not match the general Token format.
./src/main/java/com/signavio/jwt/JwtService.java:138:	 * @throws JWTVerificationException if the token exists but is no longer valid
./src/main/java/com/signavio/jwt/JwtService.java-139-	 */
./src/main/java/com/signavio/jwt/JwtService.java:140:	public Optional<Token> fromAuthorizationHeader(String headerValue) {
./src/main/java/com/signavio/jwt/JwtService.java-141-		return getRawTokenFromAuthorizationHeader(headerValue)
./src/main/java/com/signavio/jwt/JwtService.java:142:				.map(this::fromRawString);
./src/main/java/com/signavio/jwt/JwtService.java-143-	}
./src/main/java/com/signavio/jwt/JwtService.java-144-	
--
./src/main/java/com/signavio/jwt/JwtService.java-146-	
./src/main/java/com/signavio/jwt/JwtService.java-147-	/**
./src/main/java/com/signavio/jwt/JwtService.java:148:	 * Verifies the given token's authenticity and integrity.
./src/main/java/com/signavio/jwt/JwtService.java-149-	 *
./src/main/java/com/signavio/jwt/JwtService.java:150:	 * @param rawToken The JWT string
./src/main/java/com/signavio/jwt/JwtService.java-151-	 *
./src/main/java/com/signavio/jwt/JwtService.java:152:	 * @return The decoded JWT.
./src/main/java/com/signavio/jwt/JwtService.java:153:	 * @throws JWTVerificationException if the token exists but is no longer valid
./src/main/java/com/signavio/jwt/JwtService.java-154-	 */
./src/main/java/com/signavio/jwt/JwtService.java:155:	public Token fromRawString(String rawToken) {
./src/main/java/com/signavio/jwt/JwtService.java-156-		try {
./src/main/java/com/signavio/jwt/JwtService.java-157-		
./src/main/java/com/signavio/jwt/JwtService.java-158-		requireNonNull(rawToken, "Raw token must not be null");
./src/main/java/com/signavio/jwt/JwtService.java:159:		JWTVerifier jwtVerifier = JWT.require(algorithm)
./src/main/java/com/signavio/jwt/JwtService.java:160:				.withIssuer(ISSUER_SIGNAVIO)
./src/main/java/com/signavio/jwt/JwtService.java:161:				.acceptLeeway(jwtVerificationTimestampToleranceInSeconds)
./src/main/java/com/signavio/jwt/JwtService.java-162-				.build();
./src/main/java/com/signavio/jwt/JwtService.java:163:		DecodedJWT decodedJWT = jwtVerifier.verify(rawToken);
./src/main/java/com/signavio/jwt/JwtService.java-164-		
./src/main/java/com/signavio/jwt/JwtService.java:165:		String subject = decodedJWT.getSubject();
./src/main/java/com/signavio/jwt/JwtService.java:166:		String tenantId = decodedJWT.getClaim(TENANT_ID).asString();
./src/main/java/com/signavio/jwt/JwtService.java:167:		Boolean isGuestUser = decodedJWT.getClaim(IS_GUEST_USER).asBoolean();
./src/main/java/com/signavio/jwt/JwtService.java:168:		Boolean isAnonymousUser = decodedJWT.getClaim(IS_ANONYMOUS_USER).asBoolean();
./src/main/java/com/signavio/jwt/JwtService.java-169-		
./src/main/java/com/signavio/jwt/JwtService.java-170-		checkMandatoryFields(subject, tenantId, isGuestUser, isAnonymousUser);
./src/main/java/com/signavio/jwt/JwtService.java-171-		
./src/main/java/com/signavio/jwt/JwtService.java:172:		Jwt jwt = new Jwt(tenantId, subject, isGuestUser, isAnonymousUser);
./src/main/java/com/signavio/jwt/JwtService.java:173:		jwt.setExternalUserId(decodedJWT.getClaim(EXTERNAL_USER_ID).asString());
./src/main/java/com/signavio/jwt/JwtService.java:174:		jwt.setRequestId(decodedJWT.getClaim(REQUEST_ID).asString());
./src/main/java/com/signavio/jwt/JwtService.java:175:		jwt.setUserId(decodedJWT.getClaim(USER_ID).asString());
./src/main/java/com/signavio/jwt/JwtService.java:176:		jwt.setUserGroupIds(decodedJWT.getClaim(USER_GROUP_IDS).asList(String.class));
./src/main/java/com/signavio/jwt/JwtService.java:177:		jwt.setExternalUserGroupIds(decodedJWT.getClaim(EXTERNAL_USER_GROUP_IDS).asList(String.class));
./src/main/java/com/signavio/jwt/JwtService.java:178:		jwt.setOauthScopes(decodedJWT.getClaim(OAUTH_SCOPES).asList(String.class));
./src/main/java/com/signavio/jwt/JwtService.java:179:		jwt.setOauthClaims(keyValueStringToMap(decodedJWT.getClaim(OAUTH_CLAIMS).asString()));
./src/main/java/com/signavio/jwt/JwtService.java:180:		jwt.setIsAdminUser(decodedJWT.getClaim(IS_ADMIN_USER).asBoolean());
./src/main/java/com/signavio/jwt/JwtService.java:181:		jwt.setFeatures(decodedJWT.getClaim(FEATURES).asList(String.class));
./src/main/java/com/signavio/jwt/JwtService.java:182:		jwt.setInternal(decodedJWT.getClaim(IS_INTERNAL).asBoolean());
./src/main/java/com/signavio/jwt/JwtService.java:183:		jwt.setRevisionModePublished(decodedJWT.getClaim(IS_REVISION_MODE_PUBLISHED).asBoolean());
./src/main/java/com/signavio/jwt/JwtService.java:184:		return jwt;
./src/main/java/com/signavio/jwt/JwtService.java-185-		
./src/main/java/com/signavio/jwt/JwtService.java:186:		} catch (com.auth0.jwt.exceptions.TokenExpiredException e) {
./src/main/java/com/signavio/jwt/JwtService.java-187-			throw new TokenExpiredException(e.getMessage(), e);
./src/main/java/com/signavio/jwt/JwtService.java:188:		} catch (com.auth0.jwt.exceptions.InvalidClaimException e) {
./src/main/java/com/signavio/jwt/JwtService.java-189-			throw new InvalidClaimException(e.getMessage(), e);
./src/main/java/com/signavio/jwt/JwtService.java:190:		} catch (com.auth0.jwt.exceptions.AlgorithmMismatchException e) {
./src/main/java/com/signavio/jwt/JwtService.java-191-			throw new AlgorithmMismatchException(e.getMessage(), e);
./src/main/java/com/signavio/jwt/JwtService.java:192:		} catch (JWTVerificationException e) {
./src/main/java/com/signavio/jwt/JwtService.java:193:			throw new JwtVerificationException(e.getMessage(), e);
./src/main/java/com/signavio/jwt/JwtService.java-194-		}
./src/main/java/com/signavio/jwt/JwtService.java-195-	}
--
./src/main/java/com/signavio/jwt/JwtService.java-199-	
./src/main/java/com/signavio/jwt/JwtService.java-200-	/**
./src/main/java/com/signavio/jwt/JwtService.java:201:	 * Checks if one of the mandatory fields is null. If one or more are null, a {@link JWTVerificationException} is
./src/main/java/com/signavio/jwt/JwtService.java-202-	 * thrown.
./src/main/java/com/signavio/jwt/JwtService.java-203-	 */
./src/main/java/com/signavio/jwt/JwtService.java:204:	private void checkMandatoryFields(String subject, String tenantId, Boolean isGuestUser, Boolean isAnonymousUser) {
./src/main/java/com/signavio/jwt/JwtService.java:205:		String missingClaims = Stream.of(
./src/main/java/com/signavio/jwt/JwtService.java:206:				new SimpleEntry<>(subject, (Supplier<String>) () -> "'" + SUBJECT + "' (Subject)"),
./src/main/java/com/signavio/jwt/JwtService.java:207:				new SimpleEntry<>(tenantId, (Supplier<String>) () -> "'" + TENANT_ID + "' (Tenant id)"),
./src/main/java/com/signavio/jwt/JwtService.java:208:				new SimpleEntry<>(isGuestUser, (Supplier<String>) () -> "'" + IS_GUEST_USER + "' (Is guest user)"),
./src/main/java/com/signavio/jwt/JwtService.java:209:				new SimpleEntry<>(isAnonymousUser, (Supplier<String>) () -> "'" + IS_ANONYMOUS_USER + "' (Is anonymous user)"))
./src/main/java/com/signavio/jwt/JwtService.java:210:				.filter(pair -> pair.getKey() == null)
./src/main/java/com/signavio/jwt/JwtService.java-211-				.map(SimpleEntry::getValue)
./src/main/java/com/signavio/jwt/JwtService.java-212-				.map(Supplier::get)
--
./src/main/java/com/signavio/jwt/JwtService.java-214-		
./src/main/java/com/signavio/jwt/JwtService.java-215-		if (missingClaims.length() > 0) {
./src/main/java/com/signavio/jwt/JwtService.java:216:			throw new JWTVerificationException("The following required claims are missing: " + missingClaims);
./src/main/java/com/signavio/jwt/JwtService.java-217-		}
./src/main/java/com/signavio/jwt/JwtService.java-218-	}
--
./src/main/java/com/signavio/jwt/JwtService.java-220-	
./src/main/java/com/signavio/jwt/JwtService.java-221-	/**
./src/main/java/com/signavio/jwt/JwtService.java:222:	 * Creates a bearer token string usable in an authorization header.
./src/main/java/com/signavio/jwt/JwtService.java-223-	 *
./src/main/java/com/signavio/jwt/JwtService.java:224:	 * @param token The token to be converted into a bearer token string.
./src/main/java/com/signavio/jwt/JwtService.java-225-	 *
./src/main/java/com/signavio/jwt/JwtService.java:226:	 * @return Returns the converted bearer token string.
./src/main/java/com/signavio/jwt/JwtService.java-227-	 *
./src/main/java/com/signavio/jwt/JwtService.java:228:	 * @see #asSignedTokenString(Token) for further details on conversion from token to a signed token string.
./src/main/java/com/signavio/jwt/JwtService.java-229-	 */
./src/main/java/com/signavio/jwt/JwtService.java:230:	public String asAuthorizationHeader(Token token) {
./src/main/java/com/signavio/jwt/JwtService.java-231-		requireNonNull(token, "Token must not be null");
./src/main/java/com/signavio/jwt/JwtService.java:232:		String authorizationHeader = BEARER + " " + asSignedTokenString(token);
./src/main/java/com/signavio/jwt/JwtService.java-233-		
./src/main/java/com/signavio/jwt/JwtService.java-234-		if (authorizationHeader.getBytes().length > MAX_HEADER_SIZE) {
--
./src/main/java/com/signavio/jwt/JwtService.java-240-	
./src/main/java/com/signavio/jwt/JwtService.java-241-	// visible for testing
./src/main/java/com/signavio/jwt/JwtService.java:242:	void logWarningThatHeaderIsToLong(String authorizationHeader) {
./src/main/java/com/signavio/jwt/JwtService.java-243-		LOGGER.warn("Authorization header exceeds max length.\n"
./src/main/java/com/signavio/jwt/JwtService.java-244-				+ "   Actual length: " + authorizationHeader.getBytes().length + "\n"
--
./src/main/java/com/signavio/jwt/JwtService.java-248-	
./src/main/java/com/signavio/jwt/JwtService.java-249-	/**
./src/main/java/com/signavio/jwt/JwtService.java:250:	 * Creates the JWT with public claims:
./src/main/java/com/signavio/jwt/JwtService.java-251-	 * <ul>
./src/main/java/com/signavio/jwt/JwtService.java-252-	 * <li>iss - Issuer</li>
--
./src/main/java/com/signavio/jwt/JwtService.java-255-	 * <li>exp - Expiration Time</li>
./src/main/java/com/signavio/jwt/JwtService.java-256-	 * </ul>
./src/main/java/com/signavio/jwt/JwtService.java:257:	 * and with private claims:
./src/main/java/com/signavio/jwt/JwtService.java-258-	 * <ul>
./src/main/java/com/signavio/jwt/JwtService.java-259-	 * <li>ten - Tenant Id</li>
--
./src/main/java/com/signavio/jwt/JwtService.java-262-	 * </ul>
./src/main/java/com/signavio/jwt/JwtService.java-263-	 * <p>
./src/main/java/com/signavio/jwt/JwtService.java:264:	 * Uses the data provided by given token and creates a signed string. If you plan to use the token in an HTTP
./src/main/java/com/signavio/jwt/JwtService.java-265-	 * header, consider to use {@link #asAuthorizationHeader(Token)}.
./src/main/java/com/signavio/jwt/JwtService.java-266-	 *
./src/main/java/com/signavio/jwt/JwtService.java-267-	 * @param token The {@link Token} with all necessary claims
./src/main/java/com/signavio/jwt/JwtService.java-268-	 *
./src/main/java/com/signavio/jwt/JwtService.java:269:	 * @return The signed token string.
./src/main/java/com/signavio/jwt/JwtService.java-270-	 */
./src/main/java/com/signavio/jwt/JwtService.java:271:	public String asSignedTokenString(Token token) {
./src/main/java/com/signavio/jwt/JwtService.java-272-		requireNonNull(token, "Token must not be null");
./src/main/java/com/signavio/jwt/JwtService.java-273-		
--
./src/main/java/com/signavio/jwt/JwtService.java-275-		Date now = calendar.getTime();
./src/main/java/com/signavio/jwt/JwtService.java-276-		
./src/main/java/com/signavio/jwt/JwtService.java:277:		calendar.add(MINUTE, jwtValidityTimeInMinutes);
./src/main/java/com/signavio/jwt/JwtService.java-278-		Date expiration = calendar.getTime();
./src/main/java/com/signavio/jwt/JwtService.java-279-		
./src/main/java/com/signavio/jwt/JwtService.java-280-		try {
./src/main/java/com/signavio/jwt/JwtService.java-281-		
./src/main/java/com/signavio/jwt/JwtService.java:282:		return JWT.create()
./src/main/java/com/signavio/jwt/JwtService.java:283:				.withIssuer(ISSUER_SIGNAVIO)
./src/main/java/com/signavio/jwt/JwtService.java-284-				.withSubject(token.getSubject())
./src/main/java/com/signavio/jwt/JwtService.java-285-				.withIssuedAt(now)
--
./src/main/java/com/signavio/jwt/JwtService.java-296-				.withArrayClaim(EXTERNAL_USER_GROUP_IDS, toArray(token.getExternalUserGroupIds()))
./src/main/java/com/signavio/jwt/JwtService.java-297-				.withArrayClaim(OAUTH_SCOPES, toArray(token.getOauthScopes()))
./src/main/java/com/signavio/jwt/JwtService.java:298:				.withClaim(OAUTH_CLAIMS, mapToKeyValueString(token.getOauthClaims()))
./src/main/java/com/signavio/jwt/JwtService.java-299-				.withArrayClaim(FEATURES, toArray(token.getFeatures()))
./src/main/java/com/signavio/jwt/JwtService.java-300-				.withClaim(IS_INTERNAL, token.isInternal().orElse(null))
./src/main/java/com/signavio/jwt/JwtService.java-301-				.withClaim(IS_REVISION_MODE_PUBLISHED, token.isRevisionModePublished())
./src/main/java/com/signavio/jwt/JwtService.java:302:				.sign(algorithm);
./src/main/java/com/signavio/jwt/JwtService.java:303:		} catch (JWTCreationException e) {
./src/main/java/com/signavio/jwt/JwtService.java:304:			throw new JwtCreationException("Error creating JWT", e);
./src/main/java/com/signavio/jwt/JwtService.java-305-		}
./src/main/java/com/signavio/jwt/JwtService.java-306-	}
./src/main/java/com/signavio/jwt/JwtService.java-307-	
./src/main/java/com/signavio/jwt/JwtService.java:308:	private String mapToKeyValueString(Map<String, String> payload) {
./src/main/java/com/signavio/jwt/JwtService.java-309-		try {
./src/main/java/com/signavio/jwt/JwtService.java:310:			return new ObjectMapper().writeValueAsString(payload);
./src/main/java/com/signavio/jwt/JwtService.java-311-		} catch (JsonProcessingException e) {
./src/main/java/com/signavio/jwt/JwtService.java-312-			LOGGER.warn("Could not serialize payload", e);
--
./src/main/java/com/signavio/jwt/JwtService.java-315-	}
./src/main/java/com/signavio/jwt/JwtService.java-316-	
./src/main/java/com/signavio/jwt/JwtService.java:317:	private Map<String,String> keyValueStringToMap(String payload) {
./src/main/java/com/signavio/jwt/JwtService.java-318-		if(payload == null) {
./src/main/java/com/signavio/jwt/JwtService.java-319-			return null;
./src/main/java/com/signavio/jwt/JwtService.java-320-		} else {
./src/main/java/com/signavio/jwt/JwtService.java-321-			try {
./src/main/java/com/signavio/jwt/JwtService.java:322:				return new ObjectMapper().readValue(payload, new TypeReference<HashMap<String, String>>() {});
./src/main/java/com/signavio/jwt/JwtService.java-323-			} catch (IOException e) {
./src/main/java/com/signavio/jwt/JwtService.java:324:				LOGGER.warn("Could not deserialize payload", e);
./src/main/java/com/signavio/jwt/JwtService.java-325-				return null;
./src/main/java/com/signavio/jwt/JwtService.java-326-			}
--
./src/main/java/com/signavio/jwt/JwtService.java-329-	
./src/main/java/com/signavio/jwt/JwtService.java-330-	
./src/main/java/com/signavio/jwt/JwtService.java:331:	private String[] toArray(Collection<String> elements) {
./src/main/java/com/signavio/jwt/JwtService.java-332-		if (elements != null) {
./src/main/java/com/signavio/jwt/JwtService.java:333:			return elements.toArray(new String[0]);
./src/main/java/com/signavio/jwt/JwtService.java-334-		} else {
./src/main/java/com/signavio/jwt/JwtService.java:335:			return new String[0];
./src/main/java/com/signavio/jwt/JwtService.java-336-		}
./src/main/java/com/signavio/jwt/JwtService.java-337-	}
--
./src/main/java/com/signavio/jwt/JwtService.java-339-	
./src/main/java/com/signavio/jwt/JwtService.java-340-	/**
./src/main/java/com/signavio/jwt/JwtService.java:341:	 * The "Authorization" header starts with the authorization type, here "Bearer", followed by the token string.
./src/main/java/com/signavio/jwt/JwtService.java:342:	 * We are only interested in the token string, so we extract it.
./src/main/java/com/signavio/jwt/JwtService.java-343-	 */
./src/main/java/com/signavio/jwt/JwtService.java:344:	private Optional<String> getRawTokenFromAuthorizationHeader(String header) {
./src/main/java/com/signavio/jwt/JwtService.java-345-		if (header == null) {
./src/main/java/com/signavio/jwt/JwtService.java-346-			return Optional.empty();
./src/main/java/com/signavio/jwt/JwtService.java-347-		}
./src/main/java/com/signavio/jwt/JwtService.java-348-		
./src/main/java/com/signavio/jwt/JwtService.java:349:		String[] parts = header.split(" ");
./src/main/java/com/signavio/jwt/JwtService.java-350-		// check if this has the correct format
./src/main/java/com/signavio/jwt/JwtService.java-351-		if (parts.length == 2
./src/main/java/com/signavio/jwt/JwtService.java:352:				&& BEARER.equalsIgnoreCase(parts[0])
./src/main/java/com/signavio/jwt/JwtService.java:353:				&& matchJwtPattern(parts[1])) {
./src/main/java/com/signavio/jwt/JwtService.java-354-			return Optional.of(parts[1]);
./src/main/java/com/signavio/jwt/JwtService.java-355-		}
--
./src/main/java/com/signavio/jwt/JwtService.java-359-	
./src/main/java/com/signavio/jwt/JwtService.java-360-	
./src/main/java/com/signavio/jwt/JwtService.java:361:	private boolean matchJwtPattern(String rawJwt) {
./src/main/java/com/signavio/jwt/JwtService.java:362:		return rawJwt.chars()
./src/main/java/com/signavio/jwt/JwtService.java-363-				.filter(ch -> ch == '.')
./src/main/java/com/signavio/jwt/JwtService.java-364-				.count() == 2;
--
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java:1:package com.signavio.jwt.exception;
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java-2-
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java-3-
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java:4:public class AlgorithmMismatchException extends JwtServiceException {
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java-5-	
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java:6:	public AlgorithmMismatchException(String message, Throwable cause) {
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java-7-		super(message, cause);
./src/main/java/com/signavio/jwt/exception/AlgorithmMismatchException.java-8-	}
--
./metadata.yaml-6-metadata:
./metadata.yaml-7-  displayName: authentication
./metadata.yaml:8:  description: the Signavio JWT authentication library
./metadata.yaml-9-  labels:
./metadata.yaml-10-    language: java
./metadata.yaml:11:    # anyKey: anyValue
./metadata.yaml-12-  tags: # These tags are enriched with the Github repository topics
./metadata.yaml-13-    # - Tag 1
--
./metadata.yaml-29-     - channelType: slack
./metadata.yaml-30-       value: '#ipa'
./metadata.yaml:31:       link: https://sap.enterprise.slack.com/archives/C0547E72Z6G
./metadata.yaml-32-  links:
./metadata.yaml-33-    - name: Blackduck
./metadata.yaml-34-      url: https://sap-cci.app.blackduck.com/api/projects/b397ac60-32e5-49ce-8a4e-cf4b05befe79/versions/7e91f983-7cd1-47ca-b01f-308d92b3a634/components
./metadata.yaml:35:      description: Blackduck scan results
./metadata.yaml-36-    - name: SonarQube
./metadata.yaml:37:      url: https://sonar.tools.sap/dashboard?id=com.sap.signavio.authentication
./metadata.yaml-38-  ci:
./metadata.yaml-39-    pipelineLinks:
./metadata.yaml-40-      - name: GitHub Action workflows
./metadata.yaml:41:        url: https://github.tools.sap/signavio/authentication/actions
./metadata.yaml-42-  docs:
./metadata.yaml-43-    techDocsLinks:
--
./renovate.json-12-    },
./renovate.json-13-    {
./renovate.json:14:      "matchPackageNames": "com.signavio:authentication",
./renovate.json-15-      "enabled": false
./renovate.json-16-    },
--
./src/main/java/com/signavio/jwt/Token.java:1:package com.signavio.jwt;
./src/main/java/com/signavio/jwt/Token.java-2-
./src/main/java/com/signavio/jwt/Token.java-3-import java.io.Serializable;
--
./src/main/java/com/signavio/jwt/Token.java-13-	 * @return The Email Address of the subject.
./src/main/java/com/signavio/jwt/Token.java-14-	 */
./src/main/java/com/signavio/jwt/Token.java:15:	String getSubject();
./src/main/java/com/signavio/jwt/Token.java-16-	
./src/main/java/com/signavio/jwt/Token.java-17-	/**
./src/main/java/com/signavio/jwt/Token.java-18-	 * @return Id of the users tenant/workspace
./src/main/java/com/signavio/jwt/Token.java-19-	 */
./src/main/java/com/signavio/jwt/Token.java:20:	String getTenantId();
./src/main/java/com/signavio/jwt/Token.java-21-	
./src/main/java/com/signavio/jwt/Token.java-22-	/**
--
./src/main/java/com/signavio/jwt/Token.java-35-	 * @return optional: UUID of the external user.
./src/main/java/com/signavio/jwt/Token.java-36-	 */
./src/main/java/com/signavio/jwt/Token.java:37:	Optional<String> getExternalUserId();
./src/main/java/com/signavio/jwt/Token.java-38-	
./src/main/java/com/signavio/jwt/Token.java-39-	/**
--
./src/main/java/com/signavio/jwt/Token.java-42-	 * @return optional: userid
./src/main/java/com/signavio/jwt/Token.java-43-	 */
./src/main/java/com/signavio/jwt/Token.java:44:	Optional<String> getUserId();
./src/main/java/com/signavio/jwt/Token.java-45-	
./src/main/java/com/signavio/jwt/Token.java-46-	/**
--
./src/main/java/com/signavio/jwt/Token.java-49-	 * @return ids of the user's groups
./src/main/java/com/signavio/jwt/Token.java-50-	 */
./src/main/java/com/signavio/jwt/Token.java:51:	Set<String> getUserGroupIds();
./src/main/java/com/signavio/jwt/Token.java-52-	
./src/main/java/com/signavio/jwt/Token.java-53-	
--
./src/main/java/com/signavio/jwt/Token.java-57-	 * @return ids of the user's external groups
./src/main/java/com/signavio/jwt/Token.java-58-	 */
./src/main/java/com/signavio/jwt/Token.java:59:	Set<String> getExternalUserGroupIds();
./src/main/java/com/signavio/jwt/Token.java-60-	
./src/main/java/com/signavio/jwt/Token.java-61-	
--
./src/main/java/com/signavio/jwt/Token.java-65-	 * @return optional: unique id per external request that can be used to relate log messages
./src/main/java/com/signavio/jwt/Token.java-66-	 */
./src/main/java/com/signavio/jwt/Token.java:67:	Optional<String> getRequestId();
./src/main/java/com/signavio/jwt/Token.java-68-	
./src/main/java/com/signavio/jwt/Token.java-69-	/**
--
./src/main/java/com/signavio/jwt/Token.java-73-	 * @return Oauth scope names
./src/main/java/com/signavio/jwt/Token.java-74-	 */
./src/main/java/com/signavio/jwt/Token.java:75:	Set<String> getOauthScopes();
./src/main/java/com/signavio/jwt/Token.java-76-	
./src/main/java/com/signavio/jwt/Token.java-77-	/**
--
./src/main/java/com/signavio/jwt/Token.java-81-	 * @return Oauth claims
./src/main/java/com/signavio/jwt/Token.java-82-	 */
./src/main/java/com/signavio/jwt/Token.java:83:	Map<String, String> getOauthClaims();
./src/main/java/com/signavio/jwt/Token.java-84-	
./src/main/java/com/signavio/jwt/Token.java-85-	/**
--
./src/main/java/com/signavio/jwt/Token.java-88-	Optional<Boolean> isAdminUser();
./src/main/java/com/signavio/jwt/Token.java-89-	
./src/main/java/com/signavio/jwt/Token.java:90:	Set<String> getFeatures();
./src/main/java/com/signavio/jwt/Token.java-91-	
./src/main/java/com/signavio/jwt/Token.java-92-	/**
./src/main/java/com/signavio/jwt/Token.java:93:	 * @return optional: true when the token is issued by a Signavio service
./src/main/java/com/signavio/jwt/Token.java-94-	 */
./src/main/java/com/signavio/jwt/Token.java-95-	Optional<Boolean> isInternal() ;
--
./src/main/java/com/signavio/jwt/Token.java-97-	/**
./src/main/java/com/signavio/jwt/Token.java-98-	 * Checks if the revision mode of the Token is "PUBLISHED", in the context of the Collaboration Hub only able
./src/main/java/com/signavio/jwt/Token.java:99:	 * to access published content. The default is <code>false</code> giving the Token access to the HEAD revision and
./src/main/java/com/signavio/jwt/Token.java-100-	 * also not published content.
./src/main/java/com/signavio/jwt/Token.java-101-	 * @return true, if the access should be limited to published revision content, false otherwise (default).
--
./CHANGELOG.md-1-# Change Log
./CHANGELOG.md-2-## 1.23.1
./CHANGELOG.md:3:- Fixed not found native JWT exceptions because of disallowing JWT dependency users
./CHANGELOG.md:4:  - Added exceptions to complement which is: AlgorithmMismatchException, JwtCreationException, JwtVerificationException, TokenExpiredException, InvalidClaimException
./CHANGELOG.md-5-    
./CHANGELOG.md-6-## 1.23.0
--
./CHANGELOG.md-11-- Update dependency com.fasterxml.jackson.core:jackson-databind from v2.15.2 to v2.17.0
./CHANGELOG.md-12-- Update dependency org.slf4j:slf4j-api from v2.0.12 to v2.0.13
./CHANGELOG.md:13:- Update Signavio/cumulus orb from v0.0.2 to v0.0.3 
./CHANGELOG.md:14:- Update Signavio/blackduck orb from v1.12.0 to v1.16.4
./CHANGELOG.md-15-
./CHANGELOG.md-16-## 1.21.0
--
./CHANGELOG.md-20-## 1.20.0
./CHANGELOG.md-21-- Updated dependencies
./CHANGELOG.md:22:  - com.auth0:java-jwt:4.4.0
./CHANGELOG.md-23-  - org.slf4j:slf4j-api:2.0.12
./CHANGELOG.md-24-
--
./CHANGELOG.md-33-  - gradle v7.5.1
./CHANGELOG.md-34-  - org.testng:testng:7.6.1
./CHANGELOG.md:35:  - removed deprecated Signavio-propietary gradle release plugins
./CHANGELOG.md-36-  - Added artifact publishing via CircleCI pipeline
./CHANGELOG.md-37-
./CHANGELOG.md-38-## 1.18.0
./CHANGELOG.md-39-- Updated dependencies
./CHANGELOG.md:40:  - com.auth0:java-jwt:3.18.3
./CHANGELOG.md-41-  - org.testng:testng:7.4.0
./CHANGELOG.md-42-  - org.assertj:assertj-core:3.19.0
--
./CHANGELOG.md-49-- Updated dependencies
./CHANGELOG.md-50-  - org.slf4j:slf4j-api:1.7.30
./CHANGELOG.md:51:  - com.auth0:java-jwt:3.10.2
./CHANGELOG.md-52-  - org.testng:testng:7.1.0
./CHANGELOG.md-53-  - org.owasp.dependencycheck:5.3.2.1
./CHANGELOG.md-54-
./CHANGELOG.md-55-## 1.16.0
./CHANGELOG.md:56:- added `isInternal` method to `Token` and JWT, and `int` claim to identify tokens that were issued by a Signavio service
./CHANGELOG.md-57-
./CHANGELOG.md-58-## 1.15.0
--
./CHANGELOG.md-60-- Updated dependencies
./CHANGELOG.md-61-  - org.slf4j:slf4j-api:1.7.29
./CHANGELOG.md:62:  - com.auth0:java-jwt:3.8.3
./CHANGELOG.md-63-  - org.assertj:assertj-core:3.14.0
./CHANGELOG.md-64-  - org.testng:testng:7.0.0
./CHANGELOG.md:65:- minor refactorings: making fields final, reduce visibility, extract method
--
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:1:package com.signavio.jwt;
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-2-
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-3-
--
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-6-/**
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-7- * This should be implemented by all projects which use this repository.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:8: * With this you can configure your secret with which you encrypt and decrypt your tokens
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:9: * and override some default settings of the JwtService.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-10- */
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-11-public interface ConfigurationProvider {
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-12-	
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-13-	/**
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:14:	 * Key length should not exceed B (byte-length of block size the algorithm H operates upon)
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:15:	 * because it would need to be hashed first using H.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:16:	 * But key length should be at least L (byte length of hash output of H). Anything less is strongly discouraged. <p>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:17:	 * For HMAC-SHA256 Algorithm, B and L are:
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-18-	 * <ul>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-19-	 * <li>B=512 bits</li>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-20-	 * <li>L=256 bits</li>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-21-	 * </ul>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:22:	 * <strong>IMPORTANT: provide a key which has 64 bytes.</strong> See why, above.<br>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:23:	 * Recommendation: Change keys regularly!
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-24-	 *
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:25:	 * @return the secret key shared between the signavio systems.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-26-	 */
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:27:	String getSecret();
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-28-	
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-29-	
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-30-	/**
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:31:	 * Time in minutes a JWT will be valid.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-32-	 * Must be greater then Zero. <p>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-33-	 *
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:34:	 * Overwrites the DEFAULT_JWT_VALIDITY_TIME setting 10 minutes if a none empty Optional is returned.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-35-	 *
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-36-	 *
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-37-	 * @return Empty Optional to use the default value or a new validity time in minutes
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-38-	 */
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:39:	default Optional<Integer> getJwtValidityTime() {
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-40-		return Optional.empty();
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-41-	}
--
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-43-	
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-44-	/**
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:45:	 * Clock tolerance in seconds which is added when verifying the issued_at, not_before or expires_at claims.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-46-	 * Must be greater or equal to Zero. <p>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-47-	 * The tolerance is required in scenarios when setting up time synchronisation on different servers doesn't
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:48:	 * yield high enough accuracy. For the verifying server a valid JWT could look like it was issued
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:49:	 * in the future (instead of the past). The tolerance will be applied to the timestamp before verifying it. <p>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-50-	 *
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-51-	 * Recommendation: First set up time synchronisation on your servers and optimise it to higher accuracy before returning a value here. <p>
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-52-	 *
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:53:	 * Overwrites the DEFAULT_JWT_VERIFICATION_TIMESTAMP_TOLERANCE_IN_SECONDS setting.
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-54-	 *
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-55-	 * @return Empty Optional to use the default value or a new tolerance value in seconds
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-56-	 */
./src/main/java/com/signavio/jwt/ConfigurationProvider.java:57:	default Optional<Long> getJwtVerificationTimestampTolerance() {
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-58-		return Optional.empty();
./src/main/java/com/signavio/jwt/ConfigurationProvider.java-59-	}
--
./README.md:1:[![Hyperspace Pipeline](https://github.tools.sap/signavio/authentication/actions/workflows/signavio-gpp.yml/badge.svg)](https://github.tools.sap/signavio/authentication/actions/workflows/signavio-gpp.yml)
./README.md-2-
./README.md:3:[Hyperspace Portal](https://portal.hyperspace.tools.sap/projects/signavio-process-manager/components/authentication/overview)
./README.md-4-
./README.md:5:# JWT (JSON Web Token)
./README.md:6:A Java implementation for Signavio specific JWT usages.
./README.md-7-
./README.md:8:For an introduction to JWT, read https://jwt.io/introduction/
./README.md-9-
./README.md-10-TL;DR:
./README.md:11:JWT is stateless authentication because it is self-contained.
./README.md-12-It contains (among other things) the subject (user) and his rights.
./README.md:13:The information is signed with a [MAC](https://en.wikipedia.org/wiki/Message_authentication_code "Message Authentication Code")
./README.md-14-and thus can be verified for integrity and authenticity.
./README.md-15-
--
./README.md-18-    {
./README.md-19-      "alg": "HS256",
./README.md:20:      "typ": "JWT"
./README.md-21-    }
./README.md-22-    {
--
./README.md-31-## Repository access
./README.md-32-
./README.md:33:CAM Profile Admins: [BPI Signavio Github Process Manager Admin](https://spc.ondemand.com/sap/bc/webdynpro/a1sspc/cam_wd_central?item=request&profile=BPI%20Signavio%20Github%20Process%20Manager%20Admin)
./README.md:34:CAM Profile Developers: [BPI Signavio Github Process Manager Developer](https://spc.ondemand.com/sap/bc/webdynpro/a1sspc/cam_wd_central?item=request&profile=BPI%20Signavio%20Github%20Process%20Manager%20Developer)
./README.md-35-
./README.md-36-
./README.md-37-## Installation
./README.md-38-### Gradle
./README.md:39:    compile(group: 'com.signavio', name: 'authentication', version: '1.23.1-20250711082228+a20d2eb47a94bcfeeb83eac703598fb49ff14ca7')
./README.md-40-    
./README.md-41-This is published in the SAP internal artifactory:
./README.md:42:https://common.repositories.cloud.sap/artifactory/deploy-releases-hyperspace-maven/com/signavio/authentication/
./README.md-43-
./README.md-44-### Renovate
--
./README.md-55-
./README.md-56-## Available Algorithms
./README.md:57:`HMAC256` defined as `HS256` in the JWT which is HMAC with SHA-256.
./README.md:58:This is a symmetric encryption algorithm. Keep your key secret!
./README.md-59-You cannot choose this for now. But you can change it in this project itself.
./README.md-60-
./README.md-61-## Usage
./README.md:62:Jwt uses a secret to sign tokens. The secret is exactly 64 Bytes long and encoded as Base64. 
./README.md:63:Since we don't know how your application provides the secret that is shared by all jwt applications we need a small
./README.md:64:class from you that provides it. This class needs to implement the `ConfigurationProvider` interface and is passed as 
./README.md:65:constructor argument to the `JwtService`.
./README.md-66-
./README.md-67-* Example:
./README.md-68-
./README.md-69-    	public class MyConfigurationProvider implements ConfigurationProvider {
./README.md:70:    		public String getSecret(){
./README.md:71:    			return secretMethodToLoadSecretFromASecretPlace();
./README.md-72-    		}
./README.md-73-    		
--
./README.md-80-    bind(ConfigurationProvider.class).to(YourImplementation.class);
./README.md-81-
./README.md:82:In the class where you need the `JwtService` (main class) make sure to always inject the same `JwtService`. Use the singleton pattern.
./README.md:83:You never want to change your algorithm and your secret in the course of one application run.
./README.md-84-You can do this e.g. like:
./README.md-85-    
./README.md-86-    @Inject
./README.md:87:    JwtService jwtService
./README.md-88-    
./README.md:89:Remember, it is good practice to change your secret from time to time!  
./README.md:90:But you need to change it in sync with all applications using the same secret for validation.
./README.md-91-
./README.md-92-
./README.md:93:The `ConfigurationProvider` provides two more settings to the `JwtService`. 
./README.md-94-You don't need to override those methods. Then the default value will be used.
./README.md-95-
./README.md:96:* `Optional<Integer> getJwtValidityTime()` - Specify a different validity time in minutes for your JWTs (default: 10 minutes)
./README.md:97:* `Optional<Long> getJwtVerificationTimestampTolerance()` - Specify a tolerance in seconds for JWT timestamp verifications (default: 0 seconds)
./README.md-98-
./README.md-99-Both methods return an empty `Optional` if the default setting should be used.
./README.md-100-
./README.md:101:### Provide the Jwt token data
./README.md:102:In order to make requests using Jwt you must get access to a signed Jwt string. To do so you have to provide an 
./README.md:103:implementation of `com.signavio.jwt.Token`. This interface defines 7 methods which provide the data that is necessary 
./README.md:104:for creating a signed Jwt string. Tenant id, subject (Email Address), isGuestUser and isAnonymousUser are required.
./README.md-105-* Example:
./README.md-106-
./README.md:107:    	public class Jwt implements Token {
./README.md-108-    		[...]
./README.md-109-    	
./README.md:110:    		@Override public String getSubject() {
./README.md-111-    			return subject;
./README.md-112-    		}
./README.md-113-    		
./README.md:114:    		@Override public String getTenantId() {
./README.md-115-    			return tenantId;
./README.md-116-    		}
--
./README.md-124-    		}
./README.md-125-    		
./README.md:126:    		@Override public Optional<String> getExternalUserId() {
./README.md-127-    			return Optional.ofNullable(externalUserId);
./README.md-128-    		}
./README.md-129-    		
./README.md-130-    		@Override
./README.md:131:    		public Set<String> getExternalUserGroupIds() {
./README.md-132-            	return externalUserGroupIds;
./README.md-133-            }
./README.md-134-    		
./README.md-135-    		@Override
./README.md:136:    		public Optional<String> getUserId() {
./README.md-137-    		    return Optional.ofNullable(userId);
./README.md-138-    	    }
./README.md-139-    		
./README.md-140-    		@Override
./README.md:141:    		public Set<String> getUserGroupIds() {
./README.md-142-    			return userGroupIds;
./README.md-143-    		}
./README.md-144-    		
./README.md-145-    		@Override
./README.md:146:    		public Optional<String> getRequestId() {
./README.md-147-    			return Optional.ofNullable(requestId);
./README.md-148-    		}
--
./README.md-154-    		
./README.md-155-            @Override
./README.md:156:            public Set<String> getFeatures() {
./README.md-157-                return this.features;
./README.md-158-            }
--
./README.md-163-
./README.md-164-Why do we don't provide an implementation?
./README.md:165:Since we don't know how you plan to store your Jwt data, we cannot provide an all purpose fitting class.
./README.md-166-You could have it as json representation or as a DB entity that needs special annotations. The token interface allows 
./README.md-167-you as much flexibility as possible.
./README.md-168-
./README.md:169:### Sign a token
./README.md:170:For signing your token and encoding it with base64, call `JwtService.asSignedTokenString(Token)`. 
./README.md:171:The result is a JWT string with all claims in the token. If you plan to use the token in the `Authorization`
./README.md:172:header with the prefix `Bearer `, you can call `JwtService.asAuthorizationHeader(Token)` which adds
./README.md-173-the `Bearer ` prefix for you. 
./README.md-174-
./README.md:175:### Verify and parse a token
./README.md:176:Just call `JwtService.fromRawString(String)` with your rawToken being the JWT as String.
./README.md:177:If the token has a valid signature, has the issuer "signavio", and the correct algorithm header claim,
./README.md-178-and is not expired, it returns a `Token`.
./README.md-179-
./README.md:180:If you get your token from the `Authorization` header just call `JwtService.fromAuthorizationHeader(String)`
./README.md-181-which also takes care of the `Bearer ` prefix.
./README.md-182-
./README.md:183:### Using Jwt token in the platform
./README.md:184:In order to use a Jwt token in the platform just pass an instance of `AccessToken` to one of the `JwtService.as*(Token)`
./README.md:185:methods to get a signed token. The `AccessToken` already implements the Token interface.
./README.md-186-
./README.md:187:## Signavio Claims
./README.md-188-Along with the standard public claims
./README.md-189-* `iss` - Issuer
--
./README.md-192-* `exp` - Expiration Time
./README.md-193-
./README.md:194:the token will have the following **mandatory** private claims:
./README.md-195-
./README.md-196-* `ten` - tenant id
--
./README.md-198-* `ano` - is anonymous user (boolean)
./README.md-199-
./README.md:200:and the following **optional** private claims:
./README.md-201-
./README.md-202-* `eui` - external user id (possibly set when user is a guest)
